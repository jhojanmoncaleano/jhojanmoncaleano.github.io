self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.103.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[103],{1788:function(e,n,t){"use strict";var r,i,c;t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return c})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(c||(c={}))},1917:function(e,n,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1974:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(266);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},2036:function(e,n,t){"use strict";t.d(n,"a",(function(){return f}));var r=t(5),i=t(283),c=t(50),o=t(2199),a=t(96),s=t(2),u=t(30),d=t(2039),l=t(2037);function f(e,n,t,f=!1,b=null){if(!e||!e.Id||!e.mailboxInfo)return null;const m=Object(d.b)(e.mailboxInfo),h=null==m?void 0:m.downloadUrlBase,O=Object(l.a)(e.mailboxInfo);if(b=b||Object(r.c)(n,encodeURIComponent(e.Id)),!h||f&&"Firefox"===Object(a.a)().browser){const e=o.e+b+"&X-OWA-CANARY="+Object(c.a)();return Object(u.a)(e)}let p="{0}{1}/{2}";Object(i.a)()&&(p+="&isc=1");let g=Object(r.c)(p,h,O,b);return t&&(g+="&token="+(null==m?void 0:m.downloadToken),g+="&X-OWA-CANARY="+Object(c.a)()),g+="&owa="+window.location.hostname,g+="&scriptVer="+Object(s.u)()||!1,g}},2037:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(209),i=t(272);function c(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const n=e.userIdentity&&Object(i.r)(e.userIdentity),t="GroupMailbox"===e.type;return n&&!t?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2039:function(e,n,t){"use strict";var r=t(272);const i={};function c(e){return i[e]}function o(e,n){const t=i[e];i[e]=Object.assign(Object.assign({},t),n)}var a=t(49),s=t(707),u=t(61),d=t(914),l=t(807),f=t(32);var b=t(40),m=t(1718),h=t(1715);const O=Object(l.b)({timeBetweenRetryInMS:()=>3e4});async function p(e){const n=async()=>{try{let n={};return Object(s.b)()?n={sourceId:Object(d.a)(null==e?void 0:e.userIdentity)}:Object(r.r)(e.userIdentity)&&(n=await async function(e){let n={};n.headers=new Headers;const t=await Object(m.a)(e);return Object(h.b)(n.headers,t),n}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(n)}catch(e){throw b.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},t=c(e.userIdentity);if(!(null==t?void 0:t.isRefreshingDownloadToken)){o(e.userIdentity,{isRefreshingDownloadToken:!0});let t=0;const{retriableFunc:r}=O(async()=>{t++;const r=await n();b.h.info("update new token"),o(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),i=new u.c("AttachmentRefreshDownloadToken");try{await r(),i.addCustomData([t]),i.end()}catch(n){b.h.warn(`Retry to refresh token failed: ${n}`),i.addCustomData([t]),i.endWithError("ServerError",n),o(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function g(e){const n=Object(r.r)(e.userIdentity)?Object(a.h)(e.userIdentity):Object(a.g)(),t=null==n?void 0:n.ApplicationSettings;if(t){const n=t.DownloadUrlBase;o(e.userIdentity,{downloadUrlBase:n,downloadToken:t.FirstDownloadToken}),n&&function(e,n){n=n<1?1:n,Object(s.b)()&&p(e),setInterval(()=>{p(e)},6e4*n)}(e,t.DownloadTokenRefreshMinutes)}}var w=t(266);function v(e){const n=Object(r.j)(null==e?void 0:e.userIdentity),t=c(null==e?void 0:e.userIdentity);if((null==t?void 0:t.downloadToken)&&(null==t?void 0:t.downloadUrlBase))return t;switch(n){case null:case"Office365":case"Outlook":g(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(w.a)(n)}const i=c(e.userIdentity);return i||(Object(u.o)("FilesUrlDataNotFound",{accountProviderType:n}),b.h.warn("Unable to get the url data")),i}function j(e){if(!e)return null;const n=v(e);return null==n?void 0:n.downloadToken}t.d(n,"b",(function(){return v})),t.d(n,"a",(function(){return j}))},2081:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},2101:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(3);const i=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},2102:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2125:function(e,n,t){"use strict";var r=t(1754);function i(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=t(1974),o=t(1822);function a(){return i()}function s(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(o.a)(e)}(e))}(e)?i():[]).map(c.a)}t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return s}))},2199:function(e,n,t){"use strict";t.d(n,"e",(function(){return r})),t.d(n,"a",(function(){return i})),t.d(n,"f",(function(){return c})),t.d(n,"b",(function(){return o})),t.d(n,"g",(function(){return a})),t.d(n,"d",(function(){return s})),t.d(n,"c",(function(){return u})),t.d(n,"h",(function(){return d}));const r="/owa/",i="service.svc/s/GetFileAttachment?id={0}",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",o="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",a="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",s="service.svc/s/GetAttachmentThumbnail?id={0}",u="pdfprint.aspx?id={0}",d="pdfprint.aspx?id={0}&location={1}"},2247:function(e,n,t){"use strict";t.d(n,"h",(function(){return u})),t.d(n,"i",(function(){return d})),t.d(n,"f",(function(){return l})),t.d(n,"k",(function(){return f})),t.d(n,"m",(function(){return b})),t.d(n,"e",(function(){return m})),t.d(n,"g",(function(){return h})),t.d(n,"j",(function(){return O})),t.d(n,"l",(function(){return p}));var r=t(20),i=t(2101);t.d(n,"n",(function(){return i.a}));var c=t(2081);t.d(n,"a",(function(){return c.a}));var o=t(1917);t.d(n,"d",(function(){return o.b})),t.d(n,"c",(function(){return o.a}));var a=t(2102);t.d(n,"b",(function(){return a.a}));const s=new r.c(()=>Promise.all([t.e(0),t.e(26),t.e(94),t.e(735)]).then(t.bind(null,3285))),u=new r.b(s,e=>e.getSharingInformation),d=new r.b(s,e=>e.getSharingIssuesForSharingData),l=new r.b(s,e=>e.getInfoBarCreator),f=new r.b(s,e=>e.hasLargeDLRecipient),b=new r.b(s,e=>e.hasRecipientExpansionFailure),m=new r.b(s,e=>e.getGroupsAndSmallDLs),h=new r.b(s,e=>e.getInvididualRecipients),O=new r.b(s,e=>e.hasGetRecipientPermissionFailed),p=new r.b(s,e=>e.logSharingTipChangesForLinkRemoval)},2251:function(e,n,t){"use strict";var r=t(266),i=t(5),c=t(50),o=t(2199);const a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var s=t(2036),u=t(30);function d(e,n,t,d,l=0,f=0,b=!0,m=null,h=null){let O;switch(t){case 0:O=o.f;break;case 3:O=o.h;break;case 1:if(!function(e){if(!e)return!1;let n=null;const t=e.lastIndexOf(".");return t>0&&(n=e.substr(t).toLowerCase()),!!n&&a.indexOf(n.toLowerCase())>=0}(m))return null;O=o.g;break;default:Object(r.a)(t)}let p=d?f:l;!p&&l&&(p=l);let g=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(O,encodeURIComponent(e.Id),encodeURIComponent(n)),p);const w=Object(s.a)(e,O,!0,3===t,g);if(w)return w;let v=Object(i.c)("{0}{1}{2}",o.e,h,g);if(b){v=`${v}&X-OWA-CANARY=${Object(c.a)()}`}return Object(u.a)(v)}function l(e,n,t=!1,c=!0){let a;switch(n){case 0:a=o.a;break;case 1:a=o.b;break;case 2:a=o.d;break;case 3:a=o.c;break;default:return Object(r.a)(n)}if(!Object(i.k)(a)){const r=Object(s.a)(e,a,c,3===n);return Object(i.c)("{0}{1}{2}",r,t?"&isDownload=true":"","&animation=true")}return null}t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return l}))},2324:function(e,n,t){"use strict";var r=t(20);const i=[0,1];var c=t(2449),o=t(2415),a=t(5),s=t(266),u=t(1788);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(a.b)(o.a),messageParts:[Object(a.b)(o.a),l()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(a.b)(c.b),messageParts:[Object(a.b)(c.b),l()],color:u.a.Red};default:return Object(s.a)(e)}}function l(){return{text:Object(a.b)(c.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=t(2125),b=t(1974),m=t(44),h=t(1754);function O(){const e=Object(h.a)();if(Object(m.j)("fwk-devTools")){if(Object(m.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(m.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function p(){const e=O();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}t.d(n,"g",(function(){return w})),t.d(n,"a",(function(){return i})),t.d(n,"f",(function(){return d})),t.d(n,"b",(function(){return f.a})),t.d(n,"e",(function(){return b.a})),t.d(n,"d",(function(){return p})),t.d(n,"c",(function(){return O}));const g=new r.c(()=>t.e(2036).then(t.bind(null,18919))),w=new r.b(g,e=>e.getAccessIssuesForAttachments)},2377:function(e,n,t){"use strict";var r=t(266),i=t(2532),c=t(50),o=t(2686);function a(e,n,t,c,a=!0){var s;const{Name:u,OriginalPermissionType:d,PermissionType:l}=n,f=Object(o.a)(n),b="GroupMailbox"===(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(t){case 0:case 3:return i.b(e,f,t,c,l,d,a,u,b);case 1:return n.AttachmentPreviewUrl?n.AttachmentPreviewUrl:i.b(e,f,1,c,l,d,a,u,b);case 2:return n.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function s(e,n,t=!1,r=!0){return i.a(e,n,t,r)}function u(e,n,t,r,o=!1){const u=t?a(e,n,1,r,!1):s(e,1,o,!1);if(t)return{url:u,init:{credentials:"include",headers:new Headers}};{const n=i.c(e.mailboxInfo),t=new Headers;return t.set("X-Token",n),t.set("X-OWA-CANARY",Object(c.a)()),{url:u,init:{headers:t}}}}function d(e,n,t,r,i,c=!1){return r?a(e,n,t,i):s(e,t,c)}t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return s})),t.d(n,"c",(function(){return u}))},2415:function(e){e.exports=JSON.parse('{"a":"kca"}')},2449:function(e){e.exports=JSON.parse('{"a":"eca","b":"fca"}')},2532:function(e,n,t){"use strict";var r=t(2251);t.d(n,"a",(function(){return r.a})),t.d(n,"b",(function(){return r.b}));var i=t(2039);t.d(n,"c",(function(){return i.a}));var c=t(2037);t.d(n,"e",(function(){return c.a}));var o=t(2036);t.d(n,"d",(function(){return o.a}))},2657:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(32);function i(e,n){return Object(r.a)("GetWacAttachmentInfo",e,n)}},2686:function(e,n,t){"use strict";function r(e){let n=null;return n=e.AttachLongPathName,n||(n=e.WebUrl),n}t.d(n,"a",(function(){return r}))},2697:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(4);const i=new r.d(()=>t.e(1346).then(t.bind(null,4123))),c=new r.a(i,e=>e.logSigsDatapoint)},3015:function(e,n,t){"use strict";var r=t(3350),i=t(4065),c=t(1738),o=t(699);n.a=Object(o.action)("removeAttachmentFromWell")((function(e,n,t=!0,o=!0){const a=Object(c.a)(n.attachmentId);if(!a)return;let s,u=!1;1===n.attachmentType?(s=e.inlineAttachments,u=!0):s=e.imageViewAttachments.some(e=>e.attachmentId===n.attachmentId)?e.imageViewAttachments:e.docViewAttachments;let d=!1;for(let e=0;e<s.length;e++)if(s[e].attachmentId===n.attachmentId){s.splice(e,1),d=!0;break}t&&d&&(u||!n.isCloudy)&&Object(r.a)(e,-1*a.model.Size),o&&Object(i.a)(n.attachmentId)}))},3205:function(e,n,t){"use strict";function r(e,n){n&&e&&(e.addCustomData({httpStatusCode:n.status}),function(e,n){n&&e&&e.addCustomData({frontendServer:n.get("x-feserver"),requestId:n.get("request-id"),backendServer:n.get("x-beserver"),backendHttpStatus:n.get("x-backendhttpstatus"),serverVersion:n.get("x-owa-version")})}(e,n.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function c(e,n){e.addCustomProperty("ErrorInformation",n)}function o(e,n){let t="";t=n?"Empty response from server":"Null response from server",c(e,t)}t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return i})),t.d(n,"d",(function(){return c})),t.d(n,"b",(function(){return o}))},3350:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.mutatorAction)("changeTotalClassicAttachmentSize",(function(e,n){e.totalClassicAttachmentSize+=n}))},807:function(e,n,t){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:n,timeBetweenRetryInMS:t}=e;return e=>{let r=0,i=!1;const c=(o,a)=>{i?a(new Error("The function retry was cancelled")):(r++,e().then(e=>o(e)).catch(e=>{n&&r>=n?a(e):setTimeout(()=>c(o,a),t(r))}))};return{retriableFunc:()=>new Promise((e,n)=>c(e,n)),cancel:()=>i=!0}}}function i(e){return n=>Math.pow(2,n)*e}t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.103.js.map
self.scriptsLoaded['owa.103.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.103.js'] = (new Date()).getTime();