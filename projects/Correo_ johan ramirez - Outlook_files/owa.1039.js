self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1039.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1039,2033],{164:function(t,e,n){"use strict";function i(){var t=Object.create(null),e=0,n=0,i=0,r=!1;function o(e){i--,delete t[e]}this.put=function(e,n,r,s){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==s&&"function"!=typeof s)throw new Error("Cache timeout callback must be a function");var u=t[e];u?clearTimeout(u.timeout):i++;var a={value:n,expire:r+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){o(e),s&&s(e,n)}.bind(this),r)),t[e]=a,n},this.del=function(e){var n=!0,i=t[e];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&o(e),n},this.clear=function(){for(var o in t)clearTimeout(t[o].timeout);i=0,t=Object.create(null),r&&(e=0,n=0)},this.get=function(o){var s=t[o];if(void 0!==s){if(isNaN(s.expire)||s.expire>=Date.now())return r&&e++,s.value;r&&n++,i--,delete t[o]}else r&&n++;return null},this.size=function(){return i},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){r=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var i=t[n];e[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var i=JSON.parse(e),r=Date.now(),o=n&&n.skipDuplicates;for(var s in i)if(i.hasOwnProperty(s)){if(o)if(t[s])continue;var u=i[s],a=u.expire-r;if(a<=0){this.del(s);continue}a=a>0?a:void 0,this.put(s,u.value,a)}return this.size()}}t.exports=new i,t.exports.Cache=i},19479:function(t,e,n){"use strict";n.r(e);var i=n(391),r=n(936),o=n(44),s=n(5);const u=1;let a=null;const c="/{0}/api/v2.0/me/connectednotes",f="NotesClient",l="NotesClientB2",h="NotesFabric";async function d(){let[t,e]=Object(i.getAccessTokenforResourceAsLazy)(window.location.origin,"OwaNotesFeedBootstrap");return t||(t=await e),a||(a=Object(r.a)(u)),a.add(()=>fetch(function(){let t=f;return Object(o.j)("notes-B2Endpoint")&&(t=l),Object(o.j)("notes-microRepoEndpoint")&&(t=h),Object(s.c)(c,t)}(),{method:"GET",headers:{Authorization:Object(i.buildAuthorizationHeader)(t),"Content-Type":"application/json"}}))}var p=n(267),m=n(3699),w=n(2577),b=n(121);let v=!1;async function k(){if(!Object(m.b)()&&!v){v=!0;const t=await d();if(Object(p.a)(t.status)){const e=(await t.json()).value;Object(b.a)("floodgate")&&e.length>0&&(w.b.import().then(t=>{t("SamsungNotesSynced")}),Object(m.a)())}}}n.d(e,"initializeOneNoteFeed",(function(){return k}))},198:function(t,e,n){"use strict";var i=n(40);let r;function o(){return null==r&&(r="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),r}var s=n(108);const u=500,a=[],c=[],f=[];let l=!0;function h(t,e){Object(i.g)((t,e,n)=>{l&&(e==i.b.Error&&c.push({message:t,error:n}),a.push({message:t,level:e}))}),t(p),e(p),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(u):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(u))}function d(t){const e=Object(s.a)(t);return l=!1,{traces:a,errors:c,network:f,usage:e}}function p(){l&&f.push(arguments)}n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"d",(function(){return s.b})),n.d(e,"c",(function(){return o}))},2577:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));var i=n(20);const r=new i.c(()=>Promise.all([n.e(24),n.e(27),n.e(115),n.e(762)]).then(n.bind(null,4256))),o=new i.a(r,t=>t.loadAndInitializeFloodgateEngine),s=new i.b(r,t=>t.logFloodgateActivity)},267:function(t,e,n){"use strict";var i=n(912);n.d(e,"a",(function(){return i.a}))},276:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return a}));var i=n(117),r=n(97),o=n(2);let s;function u(t){s=t}async function a(t){var e,n;if(Object(o.P)())return r.f.importAndExecute(Object(i.a)());const u=s&&await s(void 0,t);if(u&&u.length>0){if("bearer"===(null===(e=null==u?void 0:u.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return u.split(" ")[1];if("msauth1.0"===(null===(n=null==u?void 0:u.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return u}}},417:function(t,e,n){"use strict";class i{constructor(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(t){this.taskList.unshift(t),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(e,"a",(function(){return i}))},912:function(t,e,n){"use strict";function i(t){return t>=200&&t<300}n.d(e,"a",(function(){return i}))},936:function(t,e,n){"use strict";function i(t){let e=0;const n=[];function i(){e-=1,n.length>0&&n.shift()()}return{add:function(r){return new Promise((o,s)=>{const u=()=>{e+=1,r().then(t=>{i(),o(t)},t=>{i(),s(t)})};e===t?n.push(u):u()})},getRunningCount:()=>e,getQueueLength:()=>n.length}}n.d(e,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.1039.js.map
self.scriptsLoaded['owa.1039.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1039.js'] = (new Date()).getTime();