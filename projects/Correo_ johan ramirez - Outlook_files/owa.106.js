self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.106.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[106],{11735:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),o=n(3083),i=n(311),a=n(5964),c=n(56),s=n(2703);function u(t,e,n){return t&&Object(s.c)(a.d.TXPSettingsLoad,function(t,e){return{entryPoint:t,entityType:e}}(e,n)),Object(c.b)().then(t=>(t["cache-control"]="no-store",Object(o.b)(Object(r.c)(a.a,a.f),Object(i.a)(),!0,t,null)))}},2132:function(t,e,n){"use strict";var r=n(3),o=n(5963),i=n(32);async function a(){let t=await Object(i.a)("GetMailboxCalendarConfiguration",{},e);var e;return t.ErrorCode?null:t.Options}async function c(){o.a.calendarConfiguration||s(await a())}const s=Object(r.mutatorAction)("setCalendarConfiguration",t=>{o.a.calendarConfiguration=t});var u=n(699),l=n(5964),d=n(11735),f=n(44),b=n(2703),p=n(40);async function O(t,e){if(Object(f.j)(l.c))try{const n=await Object(d.a)(t,e),r=n.status;j(200===r?await n.json():null,r),200!==r&&Object(b.c)(l.d.TXPSettingsResponseError,[r,n.statusText])}catch(t){p.h.warn("[TXP]"+t.message),Object(b.c)(l.d.TXPSettingsResponseError,t.message)}}const j=Object(r.mutatorAction)("setTxpSettings",(t,e)=>{o.a.txpSettings=t,o.a.statusCode=e});var g=Object(u.action)("initTxpSettings")((function(){o.a.txpSettings||O()})),v=n(4606);const h=Object(r.action)("updateTxpSettingFlag",(t,e,n)=>({flagName:t,enabled:e,value:n}));Object(r.mutator)(h,t=>{const e=Object(v.a)(),{flagName:n}=t;"CreateEventsFromEmailAsPrivate"==n||"ShowAsTrips"==n?e[n]=t.enabled:n&&e&&e.EntityTypeSettings&&e.EntityTypeSettings[n]&&(e.EntityTypeSettings[n].ProcessingLevel=t.value)});var m=n(1);function w(t){return Object.assign({__type:"SetMailboxCalendarConfigurationRequest:#Exchange"},t)}function S(t,e){return void 0===t||t.__type||(t=w(t)),Object(i.a)("SetMailboxCalendarConfiguration",t,e)}var y=n(245),C=n(29);function T(t){var e;if(null===(e=Object(C.a)().PolicySettings)||void 0===e?void 0:e.LocalEventsEnabled)return S(w({Header:Object(y.b)(),Options:t}));{const{LocalEventsEnabled:e,LocalEventsLocation:n}=t,r=Object(m.__rest)(t,["LocalEventsEnabled","LocalEventsLocation"]);return S(w({Header:Object(y.b)(),Options:r}))}}var x=n(294),E=n.n(x),P=Object(u.action)("storeCalendarMailboxConfiguration")((function(t){E()(o.a.calendarConfiguration,t)}));async function k(t){return P(t),await T(t)}function A(){return o.a.calendarConfiguration}var L=()=>{var t,e;return null===(e=null===(t=o.a.calendarConfiguration)||void 0===t?void 0:t.WorkingHoursTimeZone)||void 0===e?void 0:e.TimeZoneId},R=Object(r.mutatorAction)("updateCalendarMailboxConfiguration",(function(t){E()(A(),t)})),H=n(9697);n.d(e,"g",(function(){return k})),n.d(e,"c",(function(){return A})),n.d(e,"b",(function(){return L})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return g})),n.d(e,"f",(function(){return O})),n.d(e,"i",(function(){return R})),n.d(e,"h",(function(){return T})),n.d(e,"a",(function(){return H.a})),n.d(e,"j",(function(){return h})),c(),g()},2997:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var r=n(2),o=n(36),i=n(49);function a(){let t=Object(r.v)("targetServer"),e="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.v)(e)}function c(){let t=function(){let t="",e=Object(o.b)().pathname.split("/").filter(t=>t.length);return e.length>=2&&e[1].match(/.+@.+/)&&(t=e[1]),t}();if(0===t.length){let e=Object(i.g)();if(null==e?void 0:e.SessionSettings){let n=e.SessionSettings.ExternalDirectoryTenantGuid,r=e.SessionSettings.UserPuid;r&&n&&(t=`PUID:${r}@${n}`)}}return 0===t.length&&(t=a()),t}},3083:function(t,e,n){"use strict";var r=n(44),o=n(267),i=n(6),a=n(597),c=n(2997),s=n(50),u=n(154),l=n(151),d=n(391),f=n(40),b=n(81),p=n(621);const O="owsserver",j="owsapi";var g=n(2),v=n(155),h=n(156),m=n(13);n.d(e,"g",(function(){return C})),n.d(e,"c",(function(){return x})),n.d(e,"e",(function(){return E})),n.d(e,"d",(function(){return P})),n.d(e,"f",(function(){return k})),n.d(e,"b",(function(){return A})),n.d(e,"a",(function(){return L}));const w=2048;var S=null;const y=new Map([["OutlookOptions","fwk-owsprimecosmic-outlookoptions"]]);function C(t,e,n,o,i,c,s,u,l){const f="object"==typeof n&&n.customHeaders||s,b=f?Object.keys(f).reduce((t,e)=>(t[e.toLowerCase()]=f[e],t),{}):void 0;let p="object"==typeof n?Object.assign(Object.assign({},n),{customHeaders:b}):{returnFullResponse:n,correlationId:i,requestObject:c,customHeaders:b,throwServiceError:u,includeCredentials:l};if(!p.customHeaders||!p.customHeaders.authorization){void 0===p.includeCredentials&&(p.includeCredentials=!Object(r.j)("auth-authzHeaderNoCookies"));let n=Object(a.n)(),[i,c]=Object(d.getAccessTokenforResourceAsLazy)(n,"OwsGateway");return i?T(t,e,p,o,i):c.then(n=>T(t,e,p,o,n))}return T(t,e,p,o)}function T(t,e,n,d,C){var T;const{returnFullResponse:x,correlationId:E,requestObject:P,customHeaders:k,throwServiceError:A,sendPayloadAsBody:L,includeCredentials:R}=n;let H=new Headers;H.append("X-OWA-CANARY",Object(s.a)()),H.append("X-MS-AppName","owa-react"+Object(a.r)()),H.set("X-OWA-SessionId",Object(g.M)());const I={n:Object(u.a)().toString()};E&&(H.append("client-request-id",E),I.cri=E),k&&Object.keys(k).forEach(t=>{H.append(t,k[t])});const q=Object(b.b)();if(q&&(H.append(b.a,q),I.cv=q),C){const t="Authorization";if(C.length>0&&"msauth1.0"===(null===(T=null==C?void 0:C.split(" ")[0])||void 0===T?void 0:T.toLowerCase()))H.append(t,C);else{if(Object(r.j)("fwk-devTools")){var X=C.split(".");3==X.length&&0!==X[2].length||f.d(`BearerTokenIncomplete ${X.length}`)}H.append(t,`Bearer  ${C}`)}}let M={method:e,credentials:!1!==R?"same-origin":"omit",body:n.requestBody,headers:H};if(P){H.append("Content-Type","application/json");const n=JSON.stringify(P),o=t.search(/ows\/|owa\//i)>=0;if(Object(r.j)("fwk-emptyPost")&&o&&"POST"==e&&!L){const t=encodeURIComponent(n);t.length<w?H.append("X-OWA-UrlPostData",t):M.body=n}else M.body=n}Object(v.a)(H),Object(h.a)(H);const N=function(t){const e=new RegExp(/\bows\//,"i");if(t.match(e)){let e=t.split("/");if(e.length>3&&"api"==e[1]||e.length>2){return"api"==e[1]?e[3]:e[2]}}return null}(t);if(null!=N){const e=function(t){if(y.has(t)){let e=y.get(t);if(e)return Object(r.j)(e)}return!1}(N);if(e){const e=new RegExp(/\bows\//,"i");t=t.replace(e,"owsprime/")}null==d&&(d=e?"OWSPrimeCosmic"+N:"OWSPrime"+N)}let $=async function(t,e){if(!e||!e["x-anchormailbox"]){let e=Object(m.a)().getAnchorMailbox?await Object(m.a)().getAnchorMailbox():Object(c.a)();e&&e.length>0&&(t.headers.append("x-anchormailbox",e),t.headers.append("X-RoutingParameter-SessionKey",e))}return t}(M,k);const F=function(t,e){var n=function(t,e){var n=Object(a.x)(t,e),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(a.g)(r[0]),n=r.join("/"));return Object(a.a)(n)}(Object(r.j)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",t),o=Object(a.n)()+n;if(Object(r.j)("fwk-devTools")&&Object(i.f)(O)&&(Object(i.c)(j)==t||!Object(i.f)(j))&&(null==S&&(S=confirm(`A query param '${O}' is set to redirect some of calls to '${Object(i.c)(O)}'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.`)),S)){var c=t.split("/");c.length>0&&("ows"==c.shift()||"owsprime"==c.shift())&&(t=c.join("/")),o=Object(i.c)(O)+"/"+t}return Object(a.v)(o,e)}(t,I),U=Object(l.a)(F,$);return Object(p.a)(M,n,U,d,F),U.then(n=>{if(x)return n;if(Object(o.a)(n.status))return n.text().then(t=>t?JSON.parse(t):{});throw new Error(`${e} request to ${t} failed, http error:${n.status}`)}).catch(t=>{if(f.h.warn(t),A){throw{stack:t.stack,message:t.message,correlationVector:q,correlationId:n.correlationId,networkError:!0}}return[]})}function x(t,e){var n,r;let o="OWSGateway";try{let t=null===(r=null===(n=JSON.parse(e))||void 0===n?void 0:n[0])||void 0===r?void 0:r.operationName;null!=t&&(o=o+"."+t)}catch(t){}return C(t,"POST",{requestBody:e,customHeaders:{"Content-Type":"application/json"},returnFullResponse:!0},o)}function E(t,e,n,r,o,i,a,c,s,u){return C(t,"POST",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,sendPayloadAsBody:a,includeCredentials:c,datapoint:u},s)}function P(t,e,n,r,o,i,a,c){return C(t,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,includeCredentials:a},c)}function k(t,e,n,r,o,i,a,c){return C(t,"PUT",r,a,n,e,o,i,c)}function A(t,e,n,r,o,i,a){return C(t,"GET",n,a,e,void 0,r,o,i)}function L(t,e,n,r,o,i,a,c){return C(t,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,includeCredentials:a},c)}},4606:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(5963);function o(){return r.a.txpSettings}},5963:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.createStore)("calendarConfiguration",{calendarConfiguration:null,txpSettings:null,statusCode:0})()},5964:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return s}));const r="cal-txp-optionsV2",o="txpb2/api/v1.1/me/{0}",i="txpb2/api/v1.0/me/{0}",a="UserSettings",c="Unblock",s={TXPSettingsLoad:"TxpSettingsLoad",TXPSettingsResponseError:"TXPSettingsResponseError",TxpSettingsSaveV2:"TxpSettingsSaveV2",TxpUnblock:"TxpUnblock"}},9697:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.None=0]="None",t[t.FlightDisabled=1]="FlightDisabled",t[t.TemporarilyAutoblocked=2]="TemporarilyAutoblocked",t[t.PermanentlyAutoblocked=3]="PermanentlyAutoblocked"}(r||(r={}))}}]);
//# sourceMappingURL=owa.106.js.map
self.scriptsLoaded['owa.106.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.106.js'] = (new Date()).getTime();