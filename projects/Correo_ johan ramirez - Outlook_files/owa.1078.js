self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1078.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1078],{10147:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return o})),t.d(n,"d",(function(){return c}));const i="mailtoHandlerIgnoredCount",r=14,o=6048e5,c={"https://outlook-sdf.office.com":"AugAIqsZDxGSVhnlEo0b/F1lgqztKRxkOfYrcIOvWJmm9lvo+HbqtpfvOBJRTp3paOK7ecDCRlNFfaFmsvKBFHIAAAB6eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLm9mZmljZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYzNzYxMjUxMX0=","https://outlook.office.com":"Am+WI2I40F25oTkqP5Ys+utnzwAsoI6jqgTlGG8to9eAkFQVDlvx9QtDpAiLN0k0TGCfySH4S2C3aZCKxd/XX68AAAB2eyJvcmlnaW4iOiJodHRwczovL291dGxvb2sub2ZmaWNlLmNvbTo0NDMiLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiZmVhdHVyZSI6IlBhcnNlVXJsUHJvdG9jb2xIYW5kbGVyIiwiZXhwaXJ5IjoxNjM3NjEyNTI5fQ==","https://outlook-sdf.live.com":"AlSSLoybQyyL2N1S9eNsW42rpOymUMKCA6xw5hHCENqtpbtg93HxlyXhbjVyEYxHg9QxNqSOvrbsQjBKhtEawvQAAAB4eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLmxpdmUuY29tOjQ0MyIsImlzU3ViZG9tYWluIjp0cnVlLCJmZWF0dXJlIjoiUGFyc2VVcmxQcm90b2NvbEhhbmRsZXIiLCJleHBpcnkiOjE2Mzc2MTI1NTR9","https://outlook.live.com":"AkTNbUVviYOixRg4gKB7FammnVLuqXtO9VR71GZdDUPbUeMF0B0KYkHhpAVBc56Isq9A2zxibVh1AUlArykZTtIAAAB0eyJvcmlnaW4iOiJodHRwczovL291dGxvb2subGl2ZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYzNzYxMjU0OH0="}},1796:function(e,n,t){"use strict";var i=t(1717),r=t(40),o=t(6),c=t(14),a=t(3),l=Object(a.mutatorAction)("initializeLightning",(function(e){if(r.h.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new c.ObservableMap,e)for(let n of e)Object(i.a)().unseenItems.set(n.identity,n)}));var s=t(312);const u="ows/v1.0/lightning/items/unseen";function d(){return r.h.info("initialize lightning from server"),Object(s.b)(u).then(e=>{let n=e.map(b);l(n)})}function b(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var f=t(29);let m;const O="lightning",w="UnseenLightening";function j(){if(!m){const n=Object(o.c)(O);if(n)m=function(e){r.h.info("initialize lightning from override query parameter");let n=e.split(",").map(e=>({identity:e,visible:!1}));return l(n),Promise.resolve()}(n);else{let n=Object(f.a)().PrimeSettings;if(null==n?void 0:n.Items)for(let t of n.Items)if(t.Id===w&&t.Value){e=t.Value,r.h.info("initialize lightning from session data"),l(e.map(e=>({identity:e.id,visible:!1,category:e.category}))),m=Promise.resolve();break}m||(m=d())}}var e;return m}var v=t(2058);let h=Object(a.action)("lightup",e=>({id:e}));var p=h;Object(a.mutator)(h,e=>{r.h.info(`lightup - id:${e.id}`),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;const n=Object(i.a)().unseenItems.get(e.id);n&&(n.visible=!0)}),Object(a.orchestrator)(h,(function(e){Object(v.a)("LIGHTUP",e.id)}));var g,I=t(597);function y(e,n){if(r.h.info(`lightupOrReject - id:${e}, recurrenceCount:${n}, lightedCount:${Object(i.a)().lightedCount}, lastShown:${Object(i.a)().lastShownId}`),Object(I.w)())return void r.h.info("lightning is disabled for deeplink");if(!Object(i.a)().unseenItems.has(e))return;(!Object(i.a)().lastShownId||function(e,n){let t=!1;const{lastShownId:r}=Object(i.a)();if(r&&n&&!function(){const{lastShownId:e,unseenItems:n}=Object(i.a)();return e&&n.has(e)&&n.get(e).visible}()){let i=n.indexOf(r),o=n.indexOf(e);i>=0&&i+1==o&&(t=!0)}return t}(e,n)||function(e){const n=Object(i.a)().unseenItems.get(e);return!!n&&n.category==g.UIFeatureDiscovery}(e)||function(e){const n=Object(i.a)().unseenItems.get(e);return!!n&&n.category==g.Compliance}(e))&&p(e)}function A(e,n,t){r.h.info(`beginLightning - id:${e}`),n(()=>{j().then(()=>y(e,t)).catch(n=>{r.h.warn(`something is wrong, lightning id:${e}, reason:${n}`)})})}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(g||(g={}));var B=t(1798),U=t(1828);t.d(n,"d",(function(){return i.b})),t.d(n,"b",(function(){return A})),t.d(n,"a",(function(){return B.a})),t.d(n,"c",(function(){return U.a}))},1861:function(e,n,t){"use strict";var i=t(21),r=t(1796),o=t(0),c=t.n(o),a=t(1804);function l(e,n){const t=(n,t)=>c.a.createElement(s,Object.assign({},n),c.a.createElement(e,Object.assign({},n)));return t.displayName=e.displayName,n?c.a.forwardRef(t):t}const s=Object(i.a)((function(e){const{lid:n,when:t,series:i,children:o,disposeOnUnmount:l=!0}=e;return c.a.useEffect(()=>(Object(r.b)(n,t,i),()=>{l&&r.c.importAndExecute(n)}),[]),o&&Object(a.a)(n)?c.a.createElement(c.a.Fragment,null,o):null}));var u=t(1916);t.d(n,"c",(function(){return l})),t.d(n,"a",(function(){return s})),t.d(n,"e",(function(){return a.a})),t.d(n,"d",(function(){return u.a})),t.d(n,"b",(function(){return r.a}))},19282:function(e,n,t){"use strict";t.r(n);var i=t(21),r=t(0),o=t(1861),c=t(20);const a=new c.c(()=>t.e(1176).then(t.bind(null,19599)));let l=Object(c.d)(a,e=>e.IrisUpsellBanner);var s=t(8730);const u=new c.c(()=>t.e(1065).then(t.bind(null,19600))),d=Object(c.d)(u,e=>e.MailtoProtocolUpsellBanner);var b,f=t(3);!function(e){e.IrisUpsell="IrisUpsell",e.OWAMailHandlerUpsell="OWAMailHandlerUpsell",e.CommercialBizBar="CommercialBizBar",e.None=""}(b||(b={}));let m=Object(f.createStore)("UpsellBannerState",{upsellBannerType:b.None})();var O=t(44),w=t(8723),j=Object(f.mutatorAction)("setUpsellBannerType",e=>{m.upsellBannerType=e}),v=t(96),h=t(6892),p=t(121),g=t(29);const I=async function(){var e=await h.e.importAndExecute();return Object(O.j)("fwk-mailtoProtocolHandler")&&Object(p.a)("showOWAMailtoBanner")&&Object(s.a)()&&Object(s.b)()?(j(b.OWAMailHandlerUpsell),!0):Object(O.j)("iris-commercial-bizbar")&&Object(v.n)()&&e?y(b.CommercialBizBar):!(Object(v.i)()||Object(v.e)()||Object(v.o)()||Object(v.k)()||!Object(O.j)("edge-iris-upsell-experiment"))&&y(b.IrisUpsell)};async function y(e){const{IsConsumerChild:n}=Object(g.a)();if(n)return!1;let t=await w.b.import();return(null==t?void 0:t.message)||await w.c.importAndExecute(),j(e),!!t.message}const A=Object(i.a)((function(){const[e,n]=r.useState(!1);if(r.useEffect(()=>{!async function(){let e=await I();n(e)}()},[]),e)switch(m.upsellBannerType){case b.CommercialBizBar:return r.createElement(l,{lid:o.b.CommercialBizBar});case b.IrisUpsell:return r.createElement(l,{lid:o.b.EdgeUpsell});case b.OWAMailHandlerUpsell:return r.createElement(d,{lid:o.b.MailtoProtocolHandler});default:return r.createElement("div",null)}return null}));t.d(n,"TopUpsellBanner",(function(){return A}))},2058:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var i=t(61),r=t(1798);function o(e,n){Object.keys(r.a).some(t=>r.a[t]==n&&(Object(i.o)(e,{key:t,id:n},{isCore:!0}),!0))}},6892:function(e,n,t){"use strict";t.d(n,"c",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"e",(function(){return a})),t.d(n,"f",(function(){return l})),t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return u}));var i=t(20);const r=new i.c(()=>Promise.all([t.e(0),t.e(1111)]).then(t.bind(null,11081)));let o=new i.a(r,e=>e.isFeedbackPolicyEnabled),c=new i.a(r,e=>e.isNpsSurveyPolicyEnabled),a=new i.a(r,e=>e.isOutlookRecommendationEnabled),l=new i.a(r,e=>e.isScreenshotPolicyEnabled),s=new i.a(r,e=>e.isContactPolicyEnabled),u=new i.a(r,e=>e.isContentPolicyEnabled)},8723:function(e,n,t){"use strict";t.d(n,"c",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return l})),t.d(n,"f",(function(){return s})),t.d(n,"e",(function(){return u}));var i=t(20);const r=new i.c(()=>Promise.all([t.e(0),t.e(1154)]).then(t.bind(null,12778)));let o=new i.a(r,e=>e.initializeUpsellBarState),c=new i.a(r,e=>e.initializeLeftNavUpsellState),a=new i.b(r,e=>e.ArcStore),l=new i.b(r,e=>e.BizBarArcStore),s=new i.a(r,e=>e.makeImpressionCall),u=new i.a(r,e=>e.makeBeaconCall)},8730:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return l}));var i=t(10147),r=t(11),o=t(96);function c(){var e;return!!(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)}function a(){if(!Object(r.b)(window,"MailToBannerAskAgainLater")){const e=Object(r.a)(window,i.b);if(e){const n=parseInt(e);Object(r.e)(window,i.b,(n+1).toString())}else Object(r.e)(window,i.b,"1")}}function l(){if(Object(o.f)()||Object(o.g)())return!1;if(Object(r.c)(window)){if(Object(r.b)(window,"MailToBannerTryItNow")||Object(r.b)(window,"MailToBannerClose"))return!1;if(Object(r.b)(window,"MailToBannerAskAgainLater"))return(new Date).getTime()-Number(Object(r.a)(window,"MailToBannerAskAgainLater"))>=i.a;{const e=Object(r.a)(window,i.b);return!e||parseInt(e)<=i.c}}return!1}}}]);
//# sourceMappingURL=owa.1078.js.map
self.scriptsLoaded['owa.1078.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1078.js'] = (new Date()).getTime();