self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.111.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[111],{378:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return d})),n.d(t,"r",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"q",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"u",(function(){return I})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return w})),n.d(t,"v",(function(){return v})),n.d(t,"k",(function(){return H})),n.d(t,"h",(function(){return S})),n.d(t,"o",(function(){return V})),n.d(t,"m",(function(){return N})),n.d(t,"l",(function(){return P})),n.d(t,"p",(function(){return M})),n.d(t,"n",(function(){return b}));var s,o,i,r,a,u=n(76);!function(e){e.Unknown="Unknown",e.WW="WW",e.Dogfood="Dogfood",e.SIP="SIP",e.BlackForest="BlackForest",e.DONMT="DONMT",e.MSIT="MSIT",e.Gallatin="Gallatin",e.SDFV2="SDFV2",e.PDT="PDT",e.TDF="TDF",e.ITAR="ITAR"}(s||(s={})),function(e){e.Unknown="Unknown",e.AG08="AG08",e.AG09="AG09",e.BlackForest="BlackForest",e.DITAR="DITAR",e.DoD="DoD",e.Dogfood="Dogfood",e.Gallatin="Gallatin",e.GCCModerate="GCCModerate",e.GccHigh="GccHigh",e.GovCloud="GovCloud",e.ITAR="ITAR",e.Prod="Prod"}(o||(o={})),function(e){e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.FirstRelease="FirstRelease",e.WW="WW",e.Unknown="Unknown"}(i||(i={})),function(e){e.Business="Business",e.Consumer="Consumer"}(r||(r={})),function(e){e.Unknown="Unknown",e.DevTools="DevTools"}(a||(a={}));class c{static ArrayOfRectDimensionsValue(e){for(let t=0;t<e.length;t++)e[t]=c.RectDimensionsValue(e[t]);return e}static ArrayOfKeyValuePairValue(e){for(let t=0;t<e.length;t++)e[t]=c.KeyValuePairValue(e[t]);return e}static ArrayOfStringValue(e){return e}static PhysicalRingEnumValue(e){return e}static VariantEnvironmentEnumValue(e){return e}static LogicalRingEnumValue(e){return e}static UserTypeValue(e){return e}static HotKeyValue(e){return e}static WindowDimensionsValue(e){return e}static RectDimensionsValue(e){return e}static UpdateFrameContextValue(e){const t=e;return t.window=c.WindowDimensionsValue(t.window),t.titleBar=c.RectDimensionsValue(t.titleBar),t.excluded=c.ArrayOfRectDimensionsValue(t.excluded),t}static DiagnosticInfoValue(e){const t=e;return t.physicalRing=c.PhysicalRingEnumValue(t.physicalRing),t.variantEnv=c.VariantEnvironmentEnumValue(t.variantEnv),t.logicalRing=c.LogicalRingEnumValue(t.logicalRing),t.userType=c.UserTypeValue(t.userType),t}static KeyValuePairValue(e){return e}static WindowStateValue(e){return e}static CloseParamsValue(e){return e}static ToggleMaximizeParamsValue(e){return e}static MinimizeParamsValue(e){return e}static MaximizeParamsValue(e){return e}static RestoreParamsValue(e){return e}static BootCompletedParamsValue(e){const t=e;return void 0!==t.info&&(t.info=c.DiagnosticInfoValue(t.info)),t}static BootFailedParamsValue(e){const t=e;return void 0!==t.telemetry&&(t.telemetry=c.ArrayOfKeyValuePairValue(t.telemetry)),t}static UpdateHostParamsValue(e){return e}static UpdateFlightsParamsValue(e){return e}static UpdateFrameParamsValue(e){const t=e;return t.context=c.UpdateFrameContextValue(t.context),t}static UpdateMainWindowIconParamsValue(e){return e}static PopoutLoadedParamsValue(e){return e}static MainWindowCreatedParamsValue(e){return e}static InitialWindowStateParamsValue(e){const t=e;return t.windowState=c.WindowStateValue(t.windowState),t}static UpdateWindowStateParamsValue(e){const t=e;return t.windowState=c.WindowStateValue(t.windowState),t}static HotKeyPressedParamsValue(e){const t=e;return t.hotKey=c.HotKeyValue(t.hotKey),t}}async function d(e){await u.throwIfVersionIsNotSupported("System",.4);const t={windowId:e};return u.HostBridge.invokeHost("System.close",t,void 0)}async function l(e){await u.throwIfVersionIsNotSupported("System",.4);const t={windowId:e};return u.HostBridge.invokeHost("System.toggleMaximize",t,void 0)}async function f(e){await u.throwIfVersionIsNotSupported("System",.4);const t={windowId:e};return u.HostBridge.invokeHost("System.minimize",t,void 0)}async function p(e){await u.throwIfVersionIsNotSupported("System",.9);const t={windowId:e};return u.HostBridge.invokeHost("System.maximize",t,void 0)}async function g(e){await u.throwIfVersionIsNotSupported("System",.9);const t={windowId:e};return u.HostBridge.invokeHost("System.restore",t,void 0)}async function h(e){await u.throwIfVersionIsNotSupported("System",.3);const t={info:e};return u.HostBridge.invokeHost("System.bootCompleted",t,void 0)}async function m(e){await u.throwIfVersionIsNotSupported("System",.6);const t={telemetry:e};return u.HostBridge.invokeHost("System.bootFailed",t,void 0)}async function I(e){await u.throwIfVersionIsNotSupported("System",.1);const t={forceUpdate:e};return u.HostBridge.invokeHost("System.updateHost",t,void 0)}async function y(e,t){await u.throwIfVersionIsNotSupported("System",.7);const n={flights:e,bootFlights:t};return u.HostBridge.invokeHost("System.updateFlights",n,void 0)}async function w(e,t){await u.throwIfVersionIsNotSupported("System",.5);const n={context:e,windwowId:t};return u.HostBridge.invokeHost("System.updateFrame",n,void 0)}async function v(e,t){await u.throwIfVersionIsNotSupported("System",.8);const n={fullIconResourcePath:e,overlayIconResourcePath:t};return u.HostBridge.invokeHost("System.updateMainWindowIcon",n,void 0)}async function H(e){await u.throwIfVersionIsNotSupported("System",.4);const t={windowId:e};return u.HostBridge.invokeHost("System.popoutLoaded",t,void 0)}async function S(e){await u.throwIfVersionIsNotSupported("System",.8);const t={hotKey:e};return u.HostBridge.invokeHost("System.hotKeyPressed",t,void 0)}function V(e){return u.HostBridge.registerForEvent("System.promptUpdateHost",(function(){e()}))}function N(e){return u.HostBridge.registerForEvent("System.mainWindowCreated",(function(t){if(t){const n=c.MainWindowCreatedParamsValue(t);e(n.instanceId,n.isRefresh)}}))}function P(e){return u.HostBridge.registerForEvent("System.initialWindowState",(function(t){if(t){const n=c.InitialWindowStateParamsValue(t);e(n.windowState)}}))}function M(e){return u.HostBridge.registerForEvent("System.updateWindowState",(function(t){if(t){const n=c.UpdateWindowStateParamsValue(t);e(n.windowState)}}))}function b(e){return u.HostBridge.registerForEvent("System.openNewWindow",(function(){e()}))}},76:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(o,i){function r(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}u((s=s.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,s,o,i,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(o=2&i[0]?s.return:i[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,s=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){r.label=i[1];break}if(6===i[0]&&r.label<o[1]){r.label=o[1],o=i;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(i);break}o[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],s=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfVersionIsNotSupported=t.IsVersonSupportedByHost=t.isPIEHostPresent=t.HostBridge=void 0;var i=function(){function e(){this.nextHandlerId=1,this.registeredHandlers=new Map}return e.prototype.registerHandler=function(e){var t=this,n=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(n,e),function(){t.unregisterHandler(n)}},e.prototype.RaiseEvent=function(e){this.registeredHandlers.forEach((function(t){t(e)}))},e.prototype.HasHandlers=function(){return 0!==this.registeredHandlers.size},e.prototype.unregisterHandler=function(e){this.registeredHandlers.has(e)&&this.registeredHandlers.delete(e)},e}(),r=function(){function e(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.abandonedCallHandlers=new i,this.namespaceVersionChangeHandlers=new i,this.hostNotificationHandlers=new i,this.firstSyncIdCall=!0,this.nextSyncId=1,this.maxMessageId=2147483647}return e.prototype.isNamespaceVersionChange=function(e){return e.isIdRequest&&"version-change"===e.messageName&&-3===e.messageId},e.prototype.onMessageFromHost=function(e){if("app/pie"===e.contentType)if(this.raiseMessageInfoIfNeeded(e,!1),e.isEvent){var t=e.messageName;this.eventHandlers.has(t)&&this.eventHandlers.get(t).RaiseEvent(e.args)}else{var n=e.messageId;if(this.pendingMessages.has(n)){var s=this.pendingMessages.get(n);this.pendingMessages.delete(n),e.abandoned?this.abandonedCallHandlers.RaiseEvent(e.messageName):e.wasSuccessful?s.resolve(s.postProcessing?s.postProcessing(e.message):e.message):s.reject(new Error(e.messageName+":"+e.errorMessage))}else this.isNamespaceVersionChange(e)&&this.namespaceVersionChangeHandlers.RaiseEvent(e.message)}},e.prototype.addMessageToPendingMessages=function(e,t,n){var s=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var o={resolve:e,reject:t,postProcessing:n};return this.pendingMessages.set(s,o),s},e.prototype.invokeIdRequest=function(e,t,n,s,o){var i={contentType:"app/pie",messageName:t,isIdRequest:!0,messageId:this.addMessageToPendingMessages(s,o),message:n};this.raiseMessageInfoIfNeeded(i,!0,!0),e.sendMessageToHost(i)},e.throwPieSyncNotSupported=function(){throw new Error("Synchronous bridge not supported")},e.prototype.getNextSyncId=function(e){this.firstSyncIdCall&&(this.nextSyncId=e.getStartingSyncId(),this.firstSyncIdCall=!1);var t=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,t},e.prototype.invokeOnHostSync=function(t,n,s,o,i,r){if(t.sendMessageToHostSync){var a=this.addMessageToPendingMessages(o,i,r),u={contentType:"app/pie",messageName:n,syncId:this.getNextSyncId(t),messageId:a,message:s};this.raiseMessageInfoIfNeeded(u,!0,!1),t.sendMessageToHostSync(u)}else e.throwPieSyncNotSupported()},e.prototype.invokeOnHost=function(e,t,n,s,o,i){var r={contentType:"app/pie",messageName:t,messageId:this.addMessageToPendingMessages(s,o,i),message:n};this.raiseMessageInfoIfNeeded(r,!0,!0),e.sendMessageToHost(r)},e.prototype.registerForEvent=function(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new i),this.eventHandlers.get(e).registerHandler(t)},e.prototype.registerForAbandonedCalls=function(e){return this.abandonedCallHandlers.registerHandler(e)},e.prototype.registerForNamespaceVersionChange=function(e){return this.namespaceVersionChangeHandlers.registerHandler(e)},e.prototype.registerForHostMessageNotification=function(e){return this.hostNotificationHandlers.registerHandler(e)},e.prototype.raiseMessageInfoIfNeeded=function(e,t,n){if(this.hostNotificationHandlers.HasHandlers()){var s={isToHost:t,isAsync:n,messageName:e.messageName,isIdRequest:e.isIdRequest,syncId:e.syncId,messageId:e.messageId,isEvent:e.isEvent,wasSuccessful:e.wasSuccessful,abandoned:e.abandoned};this.hostNotificationHandlers.RaiseEvent(s)}},e}(),a=function(){function e(e){this.bridge=e,this.processor=new r,this.instanceId=null,this.namespaceVersions=new Map;var t=function(e){this.namespaceVersions.has(e)&&this.namespaceVersions.delete(e)}.bind(this);this.processor.registerForNamespaceVersionChange(t);var n=function(e){this.processor.onMessageFromHost(e)}.bind(this);this.bridge.addHostMessageHandler(n)}return e.prototype.isUsingBridge=function(e){return this.bridge===e},e.prototype.invokeHost=function(e,t,n){var s=this;return new Promise((function(o,i){s.processor.invokeOnHost(s.bridge,e,t,o,i,n)}))},e.prototype.invokeHostSync=function(e,t,n){var s;return this.processor.invokeOnHostSync(this.bridge,e,t,(function(e){s=e}),(function(e){throw e}),n),s},e.prototype.invokeIdRequestOnHost=function(e,t){var n=this;return new Promise((function(s,o){n.processor.invokeIdRequest(n.bridge,e,t,s,o)}))},e.prototype.registerForEvent=function(e,t){return this.processor.registerForEvent(e,t)},e.prototype.registerForAbandonedCalls=function(e){return this.processor.registerForAbandonedCalls(e)},e.prototype.registerForHostMessageNotification=function(e){return this.processor.registerForHostMessageNotification(e)},e.prototype.getInstanceId=function(){var e=this;return new Promise((function(t,n){e.instanceId?t(e.instanceId):e.invokeIdRequestOnHost("instance","id").then((function(n){e.instanceId=n,t(e.instanceId)})).catch((function(e){n(e)}))}))},e.prototype.getNamespaceVersion=function(e){var t=this;return new Promise((function(n,s){t.namespaceVersions.has(e)?n(t.namespaceVersions.get(e)):t.invokeIdRequestOnHost("version",e).then((function(o){var i=parseFloat(o);isNaN(i)?s("Non numeric version returned"):(t.namespaceVersions.set(e,i),n(i))})).catch((function(e){s(e)}))}))},e}(),u=function(){function e(){}return e.setGlobalPreprocessCheck=function(t){e._globalPreprocessCheck=t},e.isInitializationNeeded=function(t){return!e._implInstance||!e._implInstance.isUsingBridge(t)},e.initialize=function(t){e.isInitializationNeeded(t)&&(e._implInstance=new a(t))},e.resetBridgeForUnitTests=function(){e._implInstance=null},e.reloadBridgeForUnitTests=function(){if(e._implInstance){var t=e._implInstance.bridge;e._implInstance=new a(t)}},e.failBridgeNotInitialized=function(){return new Promise((function(e,t){t(new Error("HostBridge not initialized"))}))},e.invokeHost=function(t,n,i){return s(this,void 0,void 0,(function(){return o(this,(function(s){switch(s.label){case 0:return e._implInstance?e._globalPreprocessCheck?[4,e._globalPreprocessCheck(t)]:[3,2]:[3,3];case 1:s.sent(),s.label=2;case 2:return[2,e._implInstance.invokeHost(t,n,i)];case 3:return[2,e.failBridgeNotInitialized()]}}))}))},e.invokeHostSync=function(t,n,s){if(e._implInstance)return e._implInstance.invokeHostSync(t,n,s);throw new Error("HostBridge not initialized")},e.getInstanceId=function(){return s(this,void 0,void 0,(function(){return o(this,(function(t){return e._implInstance?[2,e._implInstance.getInstanceId()]:[2,e.failBridgeNotInitialized()]}))}))},e.getNamespaceVersion=function(t){return s(this,void 0,void 0,(function(){return o(this,(function(n){return e._implInstance?[2,e._implInstance.getNamespaceVersion(t)]:[2,e.failBridgeNotInitialized()]}))}))},e.registerForEvent=function(t,n){return e._implInstance?e._implInstance.registerForEvent(t,n):null},e.registerForAbandonedCalls=function(t){return e._implInstance?e._implInstance.registerForAbandonedCalls(t):null},e.registerForHostMessageNotification=function(t){return e._implInstance?e._implInstance.registerForHostMessageNotification(t):null},e.throwPieSyncNotSupported=function(){r.throwPieSyncNotSupported()},e._implInstance=null,e._globalPreprocessCheck=null,e}();function c(){return s(this,void 0,void 0,(function(){return o(this,(function(e){return[2,new Promise((function(e){u.getInstanceId().then((function(t){e(!!t)})).catch((function(){e(!1)}))}))]}))}))}function d(e,t,n){return s(this,void 0,void 0,(function(){var s;return o(this,(function(o){switch(o.label){case 0:return[4,c()];case 1:return o.sent()?[4,u.getNamespaceVersion(e)]:[3,3];case 2:if((s=o.sent())>=t&&(!n||s<n))return[2,!0];o.label=3;case 3:return[2,!1]}}))}))}t.HostBridge=u,t.isPIEHostPresent=c,t.IsVersonSupportedByHost=d,t.throwIfVersionIsNotSupported=function(e,t,n){return s(this,void 0,void 0,(function(){return o(this,(function(s){switch(s.label){case 0:return[4,d(e,t,n)];case 1:if(!s.sent())throw new Error("VersionNotSupported for "+e+": "+t+", "+n);return[2]}}))}))}}}]);
//# sourceMappingURL=owa.111.js.map
self.scriptsLoaded['owa.111.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.111.js'] = (new Date()).getTime();