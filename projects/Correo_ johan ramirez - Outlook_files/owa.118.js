self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.118.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[118],{11204:function(e,t,n){"use strict";var i=n(11339),r=n(9180),o=n(9181),a=n(4136),c=n(7288),u=function(e,t){var n=this,i=null,u=Object(a.o)(e.processTelemetry),s=Object(a.o)(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(e){i=e},n.processTelemetry=function(a,l){l||(l=t);var f=e?e.identifier:"TelemetryPluginChain";Object(r.b)(l?l.core():null,(function(){return f+":processTelemetry"}),(function(){if(e&&u){n._hasRun=!0;try{l.setNext(i),s&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(a,l)}catch(n){var t=i&&i._hasRun;i&&t||l.diagLog().throwInternal(o.a.CRITICAL,o.b.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+Object(c.a)(n)),i&&!t&&i.processTelemetry(a,l)}}else i&&(n._hasRun=!0,i.processTelemetry(a,l))}),(function(){return{item:a}}),!a.sync)}};function s(e,t){var n=[];if(e&&e.length>0)for(var i=null,r=0;r<e.length;r++){var o=e[r];if(o&&Object(a.o)(o.processTelemetry)){var c=new u(o,t);n.push(c),i&&i.setNext(c),i=c}}return n.length>0?n[0]:null}n.d(t,"a",(function(){return l}));var l=function e(t,n,r,o){var c=this,u=null;null!==o&&(t&&Object(a.o)(t.getPlugin)?u=function(e,t,n){var i=[],r=!n;if(e)for(;e;){var o=e.getPlugin();(r||o===n)&&(r=!0,i.push(o)),e=e.getNext()}return r||i.push(n),s(i,t)}(t,c,o||t.getPlugin()):o?u=function(e,t,n){var i=e,r=!1;return n&&e&&(i=[],Object(a.a)(e,(function(e){(r||e===n)&&(r=!0,i.push(e))}))),n&&!r&&(i||(i=[]),i.push(n)),s(i,t)}(t,c,o):Object(a.x)(o)&&(u=s(t,c))),c.core=function(){return r},c.diagLog=function(){return Object(i.c)(r,n)},c.getCfg=function(){return n},c.getExtCfg=function(e,t){var i;if(void 0===t&&(t={}),n){var r=n.extensionConfig;r&&e&&(i=r[e])}return i||t},c.getConfig=function(e,t,i){var r;void 0===i&&(i=!1);var o=c.getExtCfg(e,null);return o&&!Object(a.r)(o[t])?r=o[t]:n&&!Object(a.r)(n[t])&&(r=n[t]),Object(a.r)(r)?i:r},c.hasNext=function(){return null!=u},c.getNext=function(){return u},c.setNext=function(e){u=e},c.processNext=function(e){var t=u;t&&(u=t.getNext(),t.processTelemetry(e,c))},c.createNew=function(t,i){return void 0===t&&(t=null),new e(t||u,n,r,i)}}},11339:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return v}));var i=n(9181),r=n(7288),o=n(2359),a=n(4136),c="AI (Internal): ",u="AI: ",s="AITR_";function l(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var f=function(){function e(e,t,n,i){void 0===n&&(n=!1);this.messageId=e,this.message=(n?u:c)+e;var o="";Object(r.l)()&&(o=Object(r.f)().stringify(i));var a=(t?" message:"+l(t):"")+(i?" props:"+l(o):"");this.message+=a}return e.dataType="MessageData",e}();function d(e,t){return(e||{}).logger||new v(t)}var v=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,c={};Object(o.a)(e,this,(function(e){function o(e,n){var i=t[e];return Object(a.r)(i)?n:i}Object(a.r)(t)&&(t={}),e.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},e.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},e.throwInternal=function(t,n,r,o,u){void 0===u&&(u=!1);var s=new f(n,r,u,o);if(e.enableDebugExceptions())throw s;if(!Object(a.x)(s.message)){var l=e.consoleLoggingLevel();if(u){var d=+s.messageId;!c[d]&&l>=i.a.WARNING&&(e.warnToConsole(s.message),c[d]=!0)}else l>=i.a.WARNING&&e.warnToConsole(s.message);e.logInternalMessage(t,s)}},e.warnToConsole=function(e){var t=Object(r.b)();if(t){var n="log";t.warn&&(n="warn"),Object(a.o)(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,c={}},e.logInternalMessage=function(t,r){if(!(n>=e.maxInternalMessageLimit())){var o=!0,a=s+r.messageId;if(c[a]?o=!1:c[a]=!0,o&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(r),n++),n===e.maxInternalMessageLimit())){var u="Internal events throttle limit per PageView reached for this app.",l=new f(i.b.MessageLimitPerPVExceeded,u,!1);e.queue.push(l),e.warnToConsole(u)}}}}))}},11340:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i="iKey",r="extensionConfig"},13062:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var i="REAL_TIME",r="NEAR_REAL_TIME",o="BEST_EFFORT"},13063:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}},13064:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(11204),r=n(4136),o=n(11340),a="getPlugin",c=function(){function e(){var e=this,t=!1,n=null,c=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){c=e},e.processNext=function(e,t){t?t.processNext(e):c&&Object(r.o)(c.processTelemetry)&&c.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var r=t;if(!r){var o=n||new i.a(null,{},e.core);r=c&&c[a]?o.createNew(null,c[a]):o.createNew(null,c)}return r},e._baseTelInit=function(u,s,l,f){u&&Object(r.D)(u,o.a,[],null,r.r),!f&&s&&(f=s.getProcessTelContext().getNext());var d=c;c&&c[a]&&(d=c[a]()),e.core=s,n=new i.a(f,u,s,d),t=!0}}return e.prototype.initialize=function(e,t,n,i){this._baseTelInit(e,t,n,i)},e}()},19315:function(e,t,n){"use strict";var i=n(18790),r=n(13060),o=n(9180),a=n(7288),c=n(11337),u=n(4136),s=n(13063),l=n(9181),f=n(13064),d=n(13062),v=function(){function e(t,n){var i=n?[].concat(n):[];this.iKey=function(){return t},this.count=function(){return i.length},this.events=function(){return i},this.addEvents=function(e,t){return void 0===t&&(t=!0),e&&e.length>0?(i=t?i.concat(e):e.concat(i),e.length):0},this.split=function(n,r){var o=new e(t);if(n<i.length){var a=i.length-n;Object(u.r)(r)||(a=r<a?r:a),o.addEvents(i.splice(n,a),!0)}return o}}return e.create=function(t,n){return new e(t,n)},e}(),g=n(11336),b=n(2359),h=20,p=3984588,y=65e3,m=2e6,O=Math.min(m,y),j="metadata",C="f",x=/\./,T=function e(t,n,i,a){var c=!!a,s=n,l={};Object(b.a)(e,this,(function(e){function n(e,t,o,a,f,d,v){Object(u.z)(e,(function(e,g){var b=null;if(g||Object(r.n)(g)){var h=o,p=e,y=f,m=t;if(c&&!a&&x.test(e)){var O=e.split("."),j=O.length;if(j>1){y&&(y=y.slice());for(var C=0;C<j-1;C++){var T=O[C];m=m[T]=m[T]||{},h+="."+T,y&&y.push(T)}p=O[j-1]}}if(b=a&&function(e,t){var n=l[e];return void 0===n&&(e.length>=7&&(n=Object(u.G)(e,"ext.metadata")||Object(u.G)(e,"ext.web")),l[e]=n),n}(h)||!s||!s.handleField(h,p)?Object(r.q)(p,g,i):s.value(h,p,g,i)){var w=b.value;if(m[p]=w,d&&d(y,p,b),v&&"object"==typeof w&&!Object(u.k)(w)){var I=y;I&&(I=I.slice()).push(p),n(g,w,h+"."+p,a,I,d,v)}}}}))}e.createPayload=function(e,t,n,i,r,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:i,sendType:o,sendReason:r}},e.appendPayload=function(n,i,r){var a=n&&i&&!n.overflow;return a&&Object(o.b)(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=i.events(),o=n.payloadBlob,a=n.numEvents,c=!1,s=[],l=[],f=n.isBeacon,d=f?y:p,g=f?O:m,b=0,j=0;b<t.length;){var C=t[b];if(C){if(a>=r){n.overflow=i.split(b);break}var x=e.getEventBlob(C);if(x&&x.length<=g){var T=x.length;if(o.length+T>d){n.overflow=i.split(b);break}o&&(o+="\n"),o+=x,++j>h&&(o.substr(0,1),j=0),c=!0,a++}else x?s.push(C):l.push(C),t.splice(b,1),b--}b++}if(s&&s.length>0&&n.sizeExceed.push(v.create(i.iKey(),s)),l&&l.length>0&&n.failedEvts.push(v.create(i.iKey(),l)),c){n.batches.push(i),n.payloadBlob=o,n.numEvents=a;var w=i.iKey();-1===Object(u.b)(n.apiKeys,w)&&n.apiKeys.push(w)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),a},e.getEventBlob=function(e){try{return Object(o.b)(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+Object(r.j)(e.iKey);var i={},o=e.ext;o&&(t.ext=i,Object(u.z)(o,(function(e,t){n(t,i[e]={},"ext."+e,!0,null,null,!0)})));var a=t.data={};a.baseType=e.baseType;var c=a.baseData={};return n(e.baseData,c,"baseData",!1,["baseData"],(function(e,t,n){w(i,e,t,n)}),!0),n(e.data,a,"data",!1,[],(function(e,t,n){w(i,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))};function w(e,t,n,i){if(i&&e){var o=Object(r.g)(i.value,i.kind,i.propertyType);if(o>-1){var a=e[j];a||(a=e[j]={f:{}});var c=a[C];if(c||(c=a[C]={}),t)for(var s=0;s<t.length;s++){var l=t[s];c[l]||(c[l]={f:{}});var f=c[l][C];f||(f=c[l][C]={}),c=f}c=c[n]={},Object(u.k)(i.value)?c.a={t:o}:c.t=o}}}var I,S=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),P=1e3,k=function e(){var t={};Object(b.a)(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var i=(a=e.split(","),c=[],a&&Object(u.a)(a,(function(e){c.push(Object(u.H)(e))})),c);if("this-request-only"===n)return i;for(var r=parseInt(n,10)*P,o=0;o<i.length;++o)t[i[o]]=Object(u.f)()+r}catch(e){return[]}var a,c;return[]},e.isTenantKilled=function(e){var n=t,i=Object(u.H)(e);return void 0!==n[i]&&n[i]>Object(u.f)()||(delete n[i],!1)}}))},N=function e(){var t=!0,n=!0,i=!0,r="use-collector-delta",o=!1;Object(b.a)(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){i&&(i=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){o||(e?(r=e,n=!0,o=!0):n=!1,t=!0)}}))},_="POST",R="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",E="drop",M="send",L="rspFail",K="oth",z="no-cache, no-store",A="application/x-json-stream",B="cache-control",q="content-type",H="kill-tokens",D="kill-duration",F="kill-duration-seconds",U="time-delta-millis",Q=((I={})[1]="requeue",I[100]="requeue",I[200]="sent",I[8004]=E,I[8003]=E,I);function V(e){try{return e.responseText}catch(e){}return""}function W(e,t){var n=!1;if(e&&t){var i=Object(u.B)(e);if(i&&i.length>0)for(var r=t.toLowerCase(),o=0;o<i.length;o++){var a=i[o];if(a&&Object(u.j)(t,a)&&a.toLowerCase()===r){n=!0;break}}}return n}var G=function e(t,n,i,s){this._responseHandlers=[];var f,d,v,h,p="?cors=true&"+q.toLowerCase()+"="+A+"&client-id=NO_AUTH&client-version="+r.a,y=new k,m=!1,O=new N,j=!1,C=0,x=!0,w=[],I={},P=[],G=null,J=!1,X=!1;Object(b.a)(e,this,(function(e){var b=!0;function k(e,t){for(var n=0,i=null,r=0;null==i&&r<e.length;)1===(n=e[r])?Object(a.r)()?i=N:Object(a.q)()&&(i=Y):2===n&&Object(a.n)(t)?i=$:j&&3===n&&Object(a.m)()&&(i=ee),r++;return i?{_transport:n,_isSync:t,sendPOST:i}:null}function N(e,t,n){var i=new XDomainRequest;i.open(_,e.urlString),i.onload=function(){var e=V(i);Z(t,200,{},e),de(e)},i.onerror=function(){Z(t,400,{})},i.ontimeout=function(){Z(t,500,{})},i.onprogress=function(){},n?i.send(e.data):f._setTimeoutOverride((function(){i.send(e.data)}),0)}function $(e,t,n){var i,r=((i={body:e.data,method:_})[R]=!0,i);n&&(r.keepalive=!0),b&&(r.credentials="include"),e.headers&&Object(u.B)(e.headers).length>0&&(r.headers=e.headers),fetch(e.urlString,r).then((function(e){var n={},i="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),Z(t,e.status,n,i),de(i)})).catch((function(e){Z(t,0,{})}))}function Y(e,t,n){function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var i=t.getResponseHeader(n);i&&(e[n]=Object(u.H)(i))}return e}function o(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(Object(u.u)(e)){var n=Object(u.H)(e).split(/[\r\n]+/);Object(u.a)(n,(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var i=Object(u.H)(e.substring(0,n)).toLowerCase(),r=Object(u.H)(e.substring(n+1));t[i]=r}else t[Object(u.H)(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=i(t,e,U),t=i(t,e,D),t=i(t,e,F)),t}function a(e,n){Z(t,e.status,o(e),n)}var c=Object(r.p)(_,e.urlString,b,!0,n);Object(u.z)(e.headers,(function(e,t){c.setRequestHeader(e,t)})),c.onload=function(){var e=V(c);a(c,e),de(e)},c.onerror=function(){a(c)},c.ontimeout=function(){a(c)},c.send(e.data)}function Z(e,t,n,i){try{e(t,n,i)}catch(e){f.diagLog().throwInternal(l.a.WARNING,c.d.SendPostOnCompleteFailure,Object(a.a)(e))}}function ee(e,t,n){var i=200,r=e._thePayload;try{var o=Object(a.i)();if(!o.sendBeacon(e.urlString,e.data))if(r){var c=[];Object(u.a)(r.batches,(function(t){if(c&&t&&t.count()>0){for(var n=t.events(),i=0;i<n.length;i++)if(!o.sendBeacon(e.urlString,G.getEventBlob(n[i]))){c.push(t.split(i));break}}else c.push(t.split(0))})),ve(c,8003,r.sendType,!0)}else i=0}catch(e){f.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e),i=0}finally{Z(t,i,{},"")}}function te(e){return 2===e||3===e}function ne(e){return X&&te(e)&&(e=2),e}function ie(){return!m&&C<n}function re(){var e=P;return P=[],e}function oe(e,t,n){var i=!1;return e&&e.length>0&&!m&&d[t]&&G&&(i=0!==t||ie()&&(n>0||O.allowRequestSending())),i}function ae(e){var t={};return e&&Object(u.a)(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function ce(e,n,i,u,s){if(e&&0!==e.length)if(m)ve(e,1,u);else{u=ne(u);try{var g=e,b=0!==u;Object(o.b)(v,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var c=[],l=null,f=Object(r.k)(),v=d[u]||(b?d[1]:d[0]),g=(X||te(u)||v&&3===v._transport)&&!x&&j&&Object(a.m)();oe(e,u,n);){var h=e.shift();h&&h.count()>0&&(y.isTenantKilled(h.iKey())?c.push(h):(l=l||G.createPayload(n,i,b,g,s,u),G.appendPayload(l,h,t)?null!==l.overflow&&(e=[l.overflow].concat(e),l.overflow=null,le(l,f,Object(r.k)(),s),f=Object(r.k)(),l=null):(le(l,f,Object(r.k)(),s),f=Object(r.k)(),e=[h].concat(e),l=null)))}l&&le(l,f,Object(r.k)(),s),e.length>0&&(P=e.concat(P)),ve(c,8004,u)}),(function(){return{batches:ae(g),retryCount:n,isTeardown:i,isSynchronous:b,sendReason:s,useSendBeacon:te(u),sendType:u}}),!b)}catch(e){f.diagLog().throwInternal(l.a.WARNING,c.d.CannotSerializeObject,"Unexpected Exception sending batch: "+Object(a.a)(e))}}}function ue(e){var t=p,n="";Object(u.a)(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),n.length>0&&(t+="&apikey="+n),t+="&upload-time="+Object(u.f)().toString();var i=function(e){for(var t=0;t<e.batches.length;t++)for(var n=e.batches[t].events(),i=0;i<n.length;i++){var o=(n[i].ext||{}).intweb||{};if(Object(r.n)(o.msfpc))return encodeURIComponent(o.msfpc)}return""}(e);if(Object(r.n)(i)&&(t=t+"&ext.intweb.msfpc="+i),O.shouldAddClockSkewHeaders()&&(t+="&time-delta-to-apply-millis="+O.getClockSkewHeaderValue()),v.getWParam){var o=v.getWParam();o>=0&&(t+="&w="+o)}for(var a=0;a<w.length;a++)t+="&"+w[a].name+"="+w[a].value;return t}function se(e,t,n){e[t]=e[t]||{},e[t][f.identifier]=n}function le(t,n,c,s){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=ue(t),b=Object(r.k)();Object(o.b)(v,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var h=0;h<t.batches.length;h++)for(var p=t.batches[h].events(),m=0;m<p.length;m++){var j=p[m];if(J){var T=j.timings=j.timings||{};se(T,"sendEventStart",b),se(T,"serializationStart",n),se(T,"serializationCompleted",c)}j.sendAttempt>0?j.sendAttempt++:j.sendAttempt=1}ve(t.batches,1e3+(s||0),t.sendType,!0);var w={data:t.payloadBlob,urlString:l,headers:Object(r.f)({},I),_thePayload:t,_sendReason:s};W(w.headers,B)||(w.headers[B]=z),W(w.headers,q)||(w.headers[q]=A);var P=null,k=!!e.sendHook,N=d[t.sendType];!te(t.sendType)&&t.isBeacon&&2===t.sendReason&&(N=d[2]||d[3]||N),N&&(P=function(n){O.firstRequestSent();var o=function(n,o){!function(t,n,o,a){var c=9e3,s=null,l=!1,d=!1;try{var v=!0;if(typeof t!==g.l){if(n){O.setClockSkew(n[U]);var b=n[D]||n["kill-duration-seconds"];Object(u.a)(y.setKillSwitchTenants(n[H],b),(function(e){Object(u.a)(o.batches,(function(t){if(t.iKey()===e){s=s||[];var n=t.split(0);o.numEvents-=n.count(),s.push(n)}}))}))}if(200==t)return void(c=200);(!S.shouldRetryForStatus(t)||o.numEvents<=0)&&(v=!1),c=9e3+t%1e3}if(v){c=100;var h=o.retryCnt;0===o.sendType&&(h<i?(l=!0,fe((function(){0===o.sendType&&C--,ce(o.batches,h+1,o.isTeardown,X?2:o.sendType,5)}),X,S.getMillisToBackoffForRetry(h))):d=!0)}}finally{l||(O.setClockSkew(),function(t,n,i,o){try{o&&f._backOffTransmission(),200===n&&(o||t.isSync||f._clearBackOff(),function(e){if(J){var t=Object(r.k)();Object(u.a)(e,(function(e){var n,i;e&&e.count()>0&&(n=e.events(),i=t,J&&Object(u.a)(n,(function(e){se(e.timings=e.timings||{},"sendEventCompleted",i)})))}))}}(t.batches)),ve(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(C--,5!==i&&e.sendQueuedRequests(t.sendType,i))}}(o,c,a,d)),ve(s,8004,o.sendType)}}(n,o,t,s)},c=t.isTeardown||t.isSync;try{N.sendPOST(n,o,c),e.sendListener&&e.sendListener(w,n,c,t.isBeacon)}catch(e){f.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+Object(a.a)(e)),Z(o,0,{})}}),Object(o.b)(v,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(P)if(0===t.sendType&&C++,k&&!t.isBeacon&&3!==N._transport){var n={data:w.data,urlString:w.urlString,headers:Object(r.f)({},w.headers)},i=!1;Object(o.b)(v,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){i=!0,x||e._thePayload||(e._thePayload=e._thePayload||w._thePayload,e._sendReason=e._sendReason||w._sendReason),P(e)}),t.isSync||t.isTeardown)}catch(e){i||P(w)}}))}else P(w)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:c,sendReason:s}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&ve(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&ve(t.failedEvts,8002,t.sendType)}function fe(e,t,n){t?e():f._setTimeoutOverride(e,n)}function de(t){var n=e._responseHandlers;try{for(var i=0;i<n.length;i++)try{n[i](t)}catch(e){f.diagLog().throwInternal(l.a.CRITICAL,c.d.PostResponseHandler,"Response handler failed: "+e)}if(t){var o=JSON.parse(t);Object(r.n)(o.webResult)&&Object(r.n)(o.webResult.msfpc)&&h.set("MSFPC",o.webResult.msfpc,31536e3)}}catch(e){}}function ve(e,t,n,i){if(e&&e.length>0&&s){var a=s[(d=t,g=Q[d],Object(r.n)(g)||(g=K,d>=9e3&&d<=9999?g=L:d>=8e3&&d<=8999?g=E:d>=1e3&&d<=1999&&(g=M)),g)];if(a){var u=0!==n;Object(o.b)(v,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){fe((function(){try{a.call(s,e,t,u,n)}catch(e){f.diagLog().throwInternal(l.a.CRITICAL,c.d.NotificationException,"send request notification failed: "+e)}}),i||u,0)}),(function(){return{batches:ae(e),reason:t,isSync:u,sendSync:i,sendType:n}}),!u)}}var d,g}e.initialize=function(e,t,n,i,r){var o;r||(r={}),p=e+p,v=t,h=t.getCookieMgr(),J=!v.config.disableEventTimings;var c=!!v.config.enableCompoundKey;f=n;var s=r.valueSanitizer,l=r.stringifyObjects;Object(u.x)(r.enableCompoundKey)||(c=!!r.enableCompoundKey),j=!Object(a.p)(),G=new T(v,s,l,c);var g=i;if(!i){x=!1;var y=Object(a.g)();y&&y.protocol&&"file:"===y.protocol.toLowerCase()&&(b=!1);var m=[];m=Object(a.p)()?[2,1]:[1,2,3];var O=r.transports;O&&(Object(u.s)(O)?m=[O].concat(m):Object(u.k)(O)&&(m=O.concat(m))),i=k(m,!1),g=k(m,!0),i||f.diagLog().warnToConsole("No available transport to send events")}(o={})[0]=i,o[1]=g||k([1,2,3],!0),o[2]=k([3,2,1],!0)||g,o[3]=k([2,3,1],!0)||g,d=o},e._getDbgPlgTargets=function(){return[d[0],y,G,d]},e.addQueryStringParameter=function(e,t){for(var n=0;n<w.length;n++)if(w[n].name===e)return void(w[n].value=t);w.push({name:e,value:t})},e.addHeader=function(e,t){I[e]=t},e.canSendRequest=function(){return ie()&&O.allowRequestSending()},e.sendQueuedRequests=function(e,t){Object(u.x)(e)&&(e=0),X&&(e=ne(e),t=2),oe(P,e,0)&&ce(re(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!m&&0===C&&0===P.length},e.setUnloading=function(e){X=e},e.addBatch=function(e){if(e&&e.count()>0){if(y.isTenantKilled(e.iKey()))return!1;P.push(e)}return!0},e.teardown=function(){P.length>0&&ce(re(),0,!0,2,2)},e.pause=function(){m=!0},e.resume=function(){m=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(Object(u.r)(t)&&(t=1),X&&(t=ne(t),n=2),ce([e],0,!1,t,n||0))}}))},J=.25,X=500,$=20,Y=6,Z=4,ee=r.o?window:void 0,te=2,ne=1,ie="eventsDiscarded",re="overrideInstrumentationKey",oe=function(e){function t(){var n,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.1.7";var f,g,h,p,y,m=!1,O=[],j=null,C=!1,x=0,T=500,w=0,I=1e4,P={},k=d.c,N=null,_=null,R=0,E=0,M={},L=-1,K=!0,z=!1;return Object(b.a)(t,i,(function(e,t){function i(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=c.a.Normal),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,K&&(e.ext=Object(u.C)(e.ext),e.baseData&&(e.baseData=Object(u.C)(e.baseData)),e.data&&(e.data=Object(u.C)(e.data))),e.sync)if(R||C)e.latency=c.a.RealTime,e.sync=!1;else if(g)return K&&(e=Object(u.C)(e)),void g.sendSynchronousBatch(v.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,i=w,r=I;n===c.a.Immediate&&(i=x,r=T);var o=!1;if(i<r)o=!Q(e,t);else{var a=c.a.Normal,l=$;n===c.a.Immediate&&(a=c.a.Immediate,l=1),o=!0,function(e,t,n,i){for(;n<=t;){var r=F(e,t,!0);if(r&&r.count()>0){var o=r.split(0,i),a=o.count();if(a>0)return n===c.a.Immediate?x-=a:w-=a,ue(ie,[o],s.a.QueueFull),!0}n++}return V(),!1}(e.iKey,e.latency,a,l)&&(o=!Q(e,t))}o&&ce(ie,[e],s.a.QueueFull)}function b(e,t,n){var i=W(e,t,n);return g.sendQueuedRequests(t,n),i}function A(){return w>0}function B(){if(L>=0&&W(L,0,y)&&g.sendQueuedRequests(0,y),x>0&&!_&&!C){var e=P[k][2];e>=0&&(_=q((function(){_=null,b(c.a.Immediate,0,1),B()}),e))}var t=P[k][1];!N&&!j&&t>=0&&!C&&(A()?N=q((function(){N=null,b(0===E?c.a.RealTime:c.a.Normal,0,1),E++,E%=2,B()}),t):E=0)}function q(t,n){0===n&&R&&(n=1);var i=1e3;return R&&(i=S.getMillisToBackoffForRetry(R-1)),e._setTimeoutOverride(t,n*i)}function H(){null!==N&&(e._clearTimeoutOverride(N),N=null,E=0)}function D(t,n){H(),j&&(e._clearTimeoutOverride(j),j=null),C||b(c.a.Normal,t,n)}function F(e,t,n){var i=M[t];i||(t=c.a.Normal,i=M[t]);var r=i.iKeyMap[e];return!r&&n&&(r=v.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function U(t,n){g.canSendRequest()&&!R&&(h>0&&w>h&&(n=!0),n&&null==j&&e.flush(t,null,20))}function Q(e,t){K&&(e=Object(u.C)(e));var n=e.latency,i=F(e.iKey,n,!0);return!!i.addEvents([e],t)&&(n!==c.a.Immediate?(w++,t&&0===e.sendAttempt&&U(!e.sync,p>0&&i.count()>=p)):x++,!0)}function V(){for(var e=0,t=0,n=function(n){var i=M[n];i&&i.batches&&Object(u.a)(i.batches,(function(i){n===c.a.Immediate?e+=i.count():t+=i.count()}))},i=c.a.Normal;i<=c.a.Immediate;i++)n(i);w=t,x=e}function W(t,n,i){var r=!1,a=0===n;return!a||g.canSendRequest()?Object(o.b)(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=c.a.Immediate;n>=t;){var i=M[n];i&&i.batches&&i.batches.length>0&&(Object(u.a)(i.batches,(function(t){g.addBatch(t)?r=r||t&&t.count()>0:e=e.concat(t.events()),n===c.a.Immediate?x-=t.count():w-=t.count()})),i.batches=[],i.iKeyMap={}),n--}e.length>0&&ce(ie,e,s.a.KillSwitch),r&&L>=t&&(L=-1,y=0)}),(function(){return{latency:t,sendType:n,sendReason:i}}),!a):(L=L>=0?Math.min(L,t):t,y=Math.max(y,i)),r}function oe(){(P={})[d.c]=[2,1,0],P[d.b]=[6,3,0],P[d.a]=[18,9,0]}function ae(t,n){var i=e._notificationManager||{},r=i[t];if(r)try{r.apply(i,n)}catch(n){e.diagLog().throwInternal(l.a.CRITICAL,c.d.NotificationException,t+" notification failed: "+n)}}function ce(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&ae(e,[t].concat(n))}function ue(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&Object(u.a)(t,(function(t){t&&t.count()>0&&ae(e,[t.events()].concat(n))}))}function se(){p=n&&n.disableAutoBatchFlushLimit?0:Math.max(X*(te+1),I/6)}oe(),M[c.a.Immediate]={batches:[],iKeyMap:{}},M[c.a.RealTime]={batches:[],iKeyMap:{}},M[c.a.CostDeferred]={batches:[],iKeyMap:{}},M[c.a.Normal]={batches:[],iKeyMap:{}},se(),g=new G(X,te,ne,{requeue:function(t,n){var o=[];Object(u.a)(t,(function(t){t&&t.count()>0&&Object(u.a)(t.events(),(function(t){t&&(t.sync&&(t.latency=c.a.Immediate,t.sync=!1),t.sendAttempt<Y?(Object(r.r)(t,e.identifier),i(t,!1)):o.push(t))}))})),o.length>0&&ce(ie,o,s.a.NonRetryableStatus);z&&D(2,2)},send:function(e,t,n){e&&e.length>0&&ae("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){ue("eventsSent",e,t),B()},drop:function(e,t){ue(ie,e,t>=8e3&&t<=8999?t-8e3:s.a.Unknown)},rspFail:function(e){ue(ie,e,s.a.NonRetryableStatus),B()},oth:function(e,t){ue(ie,e,s.a.Unknown),B()}}),e._getDbgPlgTargets=function(){return[g]},e.initialize=function(i,c,u){Object(o.b)(c,(function(){return"PostChannel:initialize"}),(function(){var o=c;t.initialize(i,c,u),e.setInitialized(!1);var s=e._getTelCtx();i.extensionConfig[e.identifier]=i.extensionConfig[e.identifier]||{},n=s.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(ee),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(ee),K=!n.disableOptimizeObj&&Object(r.l)();var l=o.getWParam;o.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|l()},n.eventsLimitInMem>0&&(I=n.eventsLimitInMem),n.immediateEventLimit>0&&(T=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(h=n.autoFlushEventsLimit),se(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(f=n.httpXHROverride),Object(r.n)(i.anonCookieName)&&g.addQueryStringParameter("anoncknm",i.anonCookieName),g.sendHook=n.payloadPreprocessor,g.sendListener=n.payloadListener;var d=n.overrideEndpointUrl?n.overrideEndpointUrl:i.endpointUrl;function v(e){"beforeunload"!==(e||Object(a.k)().event).type&&(z=!0,g.setUnloading(z)),D(2,2)}e._notificationManager=i.extensionConfig.NotificationManager,g.initialize(d,e.core,e,f,n),Object(r.d)(v),Object(r.b)(v),Object(r.c)((function(e){z=!1,g.setUnloading(z)})),e.setInitialized(!0)}),(function(){return{coreConfig:i,core:c,extensions:u}}))},e.processTelemetry=function(t,o){Object(r.r)(t,e.identifier);var a=(o=e._getTelCtx(o)).getExtCfg(e.identifier),c=!!n.disableTelemetry;a&&(c=c||!!a.disableTelemetry);var u=t;c||m||(n[re]&&(u.iKey=n[re]),a&&a[re]&&(u.iKey=a[re]),i(u,!0),z?D(2,2):B()),e.processNext(u,o)},e.setEventQueueLimits=function(e,t){I=e>0?e:1e4,h=t>0?t:0,se();var n=w>e;if(!n&&p>0)for(var i=c.a.Normal;!n&&i<=c.a.RealTime;i++){var r=M[i];r&&r.batches&&Object(u.a)(r.batches,(function(e){e&&e.count()>=p&&(n=!0)}))}U(!0,n)},e.teardown=function(){D(2,2),m=!0,g.teardown()},e.pause=function(){H(),C=!0,g.pause()},e.resume=function(){C=!1,g.resume(),B()},e.addResponseHandler=function(e){g._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){H(),oe(),k=d.c,B(),Object(u.z)(e,(function(e,t){var n=t.length;if(n>=2){var i=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var r=t[0]/t[1];t[0]=Math.ceil(r)*t[1]}i>=0&&t[1]>=0&&i>t[1]&&(i=t[1]),t.push(i),P[e]=t}}))},e.flush=function(e,t,n){void 0===e&&(e=!0),C||(H(),n=n||1,e?(W(c.a.Normal,0,n),V(),null==j?j=q((function(){!function e(t,n){b(c.a.Normal,0,n),function e(t){g.isCompletelyIdle()?t():j=q((function(){e(t)}),J)}((function(){t&&t(),O.length>0?j=q((function(){return e(O.shift(),n)}),0):(j=null,A()&&B())}))}(t,n)}),0):O.push(t)):(b(c.a.Normal,1,n),null!=t&&t()))},e.setMsaAuthTicket=function(e){g.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=A,e._setTransmitProfile=function(e){k!==e&&void 0!==P[e]&&(H(),k=e,B())},e._backOffTransmission=function(){R<Z&&(R++,H(),B())},e._clearBackOff=function(){R&&(R=0,H(),B())}})),i}return Object(i.b)(t,e),t}(f.a);t.a=oe},19366:function(e,t,n){"use strict";var i=n(18790),r=n(9180),o=n(4136),a=n(9181),c=n(13059),u=n(2359),s=n(13064),l=n(11204),f="processTelemetry",d="priority",v="setNextPlugin",g="isInitialized";function b(e,t){for(var n=[],i=null,r=e.getNext();r;){var a=r.getPlugin();a&&(i&&Object(o.o)(i[v])&&Object(o.o)(a[f])&&i[v](a),Object(o.o)(a[g])&&a[g]()||n.push(a),i=a,r=r.getNext())}Object(o.a)(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function h(e){return e.sort((function(e,t){var n=0,i=Object(o.o)(t[f]);return Object(o.o)(e[f])?n=i?e[d]-t[d]:1:i&&(n=-1),n}))}var p=500,y="Channel has invalid priority",m=function(e){function t(){var n,i=e.call(this)||this;function r(e){e&&e.length>0&&(function(e){Object(o.a)(e,(function(e){e.priority<p&&Object(o.I)(y+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),n.push(e))}return i.identifier="ChannelControllerPlugin",i.priority=p,Object(u.a)(t,i,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){n&&Object(o.a)(n,(function(n){n.length>0&&i._getTelCtx(t).createNew(n).processNext(e)}))},e.getChannelControls=function(){return n},e.initialize=function(i,a,c){e.isInitialized()||(t.initialize(i,a,c),function(e,t){n=[],e&&Object(o.a)(e,(function(e){return r(e)}));if(t){var i=[];Object(o.a)(t,(function(e){e.priority>p&&i.push(e)})),r(i)}}((i||{}).channels,c),Object(o.a)(n,(function(e){return b(new l.a(e,i,a),c)})))}})),i}var n;return Object(i.b)(t,e),t._staticInit=(n=t.prototype,Object(o.y)(n,"ChannelControls",n.getChannelControls),void Object(o.y)(n,"channelQueue",n.getChannelControls)),t}(s.a),O=n(11338),j=n(11340),C="Extensions must provide callback to initialize",x="_notificationManager";function T(e,t){return new r.a(t)}var w=function e(){var t,n,a,s,f,d=!1;Object(u.a)(e,this,(function(e){e._extensions=new Array,n=new m,e.logger=Object(c.b)({throwInternal:function(e,t,n,i,r){void 0===r&&(r=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),t=[],e.isInitialized=function(){return d},e.initialize=function(t,r,c,u){e.isInitialized()&&Object(o.I)("Core should not be initialized more than once"),t&&!Object(o.r)(t.instrumentationKey)||Object(o.I)("Please provide instrumentation key"),a=u,e[x]=u,e.config=t||{},e.config.enablePerfMgr&&Object(o.D)(e.config,"createPerfMgr",T),t.extensions=Object(o.r)(t.extensions)?[]:t.extensions,Object(o.i)(t,j.a).NotificationManager=u,c&&(e.logger=c);var s=[];s.push.apply(s,Object(i.c)(Object(i.c)([],r,!1),t.extensions,!1)),s=h(s);var f=[],v=[],g={};Object(o.a)(s,(function(e){(Object(o.r)(e)||Object(o.r)(e.initialize))&&Object(o.I)(C);var t=e.priority,i=e.identifier;e&&t&&(Object(o.r)(g[t])?g[t]=i:c.warnToConsole("Two extensions have same priority #"+t+" - "+g[t]+", "+i)),!t||t<n.priority?f.push(e):v.push(e)})),s.push(n),f.push(n),s=h(s),e._extensions=s,b(new l.a([n],t,e),s),b(new l.a(f,t,e),s),e._extensions=f,0===e.getTransmissionControls().length&&Object(o.I)("No channels available"),d=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){Object(o.D)(n,j.b,e.config.instrumentationKey,null,o.q),Object(o.D)(n,"time",Object(o.J)(new Date),null,o.q),Object(o.D)(n,"ver","4.0",null,o.r),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,i=t;return t&&0!==t.length||(i=[n]),new l.a(i,e.config,e)},e.getNotifyMgr=function(){return a||(a=Object(c.b)({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e[x]=a),a},e.getCookieMgr=function(){return f||(f=Object(O.c)(e.config,e.logger)),f},e.setCookieMgr=function(e){f=e},e.getPerfMgr=function(){return s||e.config&&e.config.enablePerfMgr&&Object(o.o)(e.config.createPerfMgr)&&(s=e.config.createPerfMgr(e,e.getNotifyMgr())),s||Object(r.c)()},e.setPerfMgr=function(e){s=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Object(o.a)(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))},I=n(13063),S=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;Object(u.a)(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Object(o.b)(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Object(o.b)(e.listeners,t)},e.eventsSent=function(t){Object(o.a)(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,n){Object(o.a)(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,n)}),0)}))},e.eventsSendRequest=function(t,n){Object(o.a)(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(n)setTimeout((function(){return e.eventsSendRequest(t,n)}),0);else try{e.eventsSendRequest(t,n)}catch(e){}}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||Object(o.a)(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))},P=n(11339),k=function(e){function t(){var n=e.call(this)||this;return Object(u.a)(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],I.a.InvalidEvent)}e.initialize=function(e,n,i,r){t.initialize(e,n,i||new P.a(e),r||new S(e))},e.track=function(i){Object(r.b)(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),Object(o.I)("Invalid telemetry item")),function(e){if(Object(o.r)(e.name))throw n(e),Error("telemetry name required")}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];Object(o.a)(n,(function(n){var i={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:Object(o.J)(new Date),baseType:P.b.dataType,baseData:{message:n.message}};e.track(i)})),n.length=0}),n)}})),n}return Object(i.b)(t,e),t}(w),N=n(11337),_=n(13060),R="version",E="properties",M=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",Object(u.a)(t,n,(function(e,t){e.initialize=function(n,i,c,u){Object(r.b)(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var r=n.propertyStorageOverride;if(r&&(!r.getProperty||!r.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&Object(o.a)(n.channels,(function(t){t&&Object(o.a)(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},i&&Object(o.a)(i,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,i,c,u)}catch(t){e.logger.throwInternal(a.a.CRITICAL,N.d.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:n,extensions:i,logger:c,notificationManager:u}}))},e.track=function(n){Object(r.b)(e,(function(){return"AppInsightsCore.track"}),(function(){var i=n;if(i){i.timings=i.timings||{},i.timings.trackStart=Object(_.k)(),Object(_.m)(i.latency)||(i.latency=N.a.Normal);var r=i.ext=i.ext||{};r.sdk=r.sdk||{},r.sdk.ver=_.a;var o=i.baseData=i.baseData||{};o[E]||(o[E]={});var a=o[E];a[R]||(a[R]=""),""!==e.pluginVersionString&&(a[R]=e.pluginVersionString)}t.track(i)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(i.b)(t,e),t}(k);t.a=M},2359:function(e,t,n){"use strict";
/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var i="constructor",r="prototype",o="function",a="_dynInstFuncs",c="_isDynProxy",u="_dynClass",s="_dynCls$",l="_dynInstChk",f=l,d="_dfOpts",v="_unknown_",g="__proto__",b="useBaseInst",h="setInstFuncs",p=Object,y=p.getPrototypeOf,m=0;function O(e,t){return e&&p[r].hasOwnProperty.call(e,t)}function j(e){return e&&(e===p[r]||e===Array[r])}function C(e){return j(e)||e===Function[r]}function x(e){if(e){if(y)return y(e);var t=e[g]||e[r]||(e[i]?e[i][r]:null);if(t)return t}return null}function T(e,t){var n=[],i=p.getOwnPropertyNames;if(i)n=i(e);else for(var r in e)"string"==typeof r&&O(e,r)&&n.push(r);if(n&&n.length>0)for(var o=0;o<n.length;o++)t(n[o])}function w(e,t,n){return t!==i&&typeof e[t]===o&&(n||O(e,t))}function I(e){throw new TypeError("DynamicProto: "+e)}function S(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function P(e,t,n,i){var r=null;if(e&&O(n,u)){var c=e[a]||{};if((r=(c[n[u]]||{})[t])||I("Missing ["+t+"] "+o),!r[l]&&!1!==c[f]){for(var s=!O(e,t),d=x(e),v=[];s&&d&&!C(d)&&!S(v,d);){var g=d[t];if(g){s=g===i;break}v.push(d),d=x(d)}try{s&&(e[t]=r),r[l]=1}catch(e){c[f]=!1}}}return r}function k(e,t,n){var i=t[e];return i===n&&(i=x(t)[e]),typeof i!==o&&I("["+e+"] is not a "+o),i}function N(e,t,n,i,r){if(!j(e)){var o=n[a]=n[a]||{},u=o[t]=o[t]||{};!1!==o[f]&&(o[f]=!!r),T(n,(function(t){w(n,t,!1)&&n[t]!==i[t]&&(u[t]=n[t],delete n[t],(!O(e,t)||e[t]&&!e[t][c])&&(e[t]=function(e,t){var n=function(){var i=P(this,t,e,n)||k(t,e,n);return i.apply(this,arguments)};return n[c]=1,n}(e,t)))}))}}function _(e,t){return O(e,r)?e.name||t||v:((e||{})[i]||{}).name||t||v}function R(e,t,n,i){O(e,r)||I("theClass is an invalid class definition.");var o=e[r];(function(e,t){if(y)for(var n=[],i=x(t);i&&!C(i)&&!S(n,i);){if(i===e)return!0;n.push(i),i=x(i)}return!1})(o,t)||I("["+_(e)+"] is not in class hierarchy of ["+_(t)+"]");var l=null;O(o,u)?l=o[u]:(l=s+_(e,"_")+"$"+m,m++,o[u]=l);var v=R[d],g=!!v[b];g&&i&&void 0!==i[b]&&(g=!!i[b]);var p=function(e){var t={};return T(e,(function(n){!t[n]&&w(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,i){function r(e,t,n){var r=t[n];if(r[c]&&i){var o=e[a]||{};!1!==o[f]&&(r=(o[t[u]]||{})[n]||r)}return function(){return r.apply(e,arguments)}}var o={};T(n,(function(e){o[e]=r(t,n,e)}));for(var s=x(e),l=[];s&&!C(s)&&!S(l,s);)T(s,(function(e){!o[e]&&w(s,e,!y)&&(o[e]=r(t,s,e))})),l.push(s),s=x(s);return o}(o,t,p,g));var j=!!y&&!!v[h];j&&i&&(j=!!i[h]),N(o,l,t,p,!1!==j)}R[d]={setInstFuncs:!0,useBaseInst:!0},t.a=R},9180:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return f}));var i=n(2359),r=n(4136),o="ctx",a=null,c=function(){function e(t,n,i){var a,c=this,u=!1;(c.start=Object(r.f)(),c.name=t,c.isAsync=i,c.isChildEvt=function(){return!1},Object(r.o)(n))&&(u=Object(r.y)(c,"payload",(function(){return!a&&Object(r.o)(n)&&(a=n(),n=null),a})));c.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?c[t]:(c[o]||{})[t]:null},c.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)c[t]||(c.isChildEvt=function(){return!0}),c[t]=n;else if(t===e.ChildrenContextKey)c[t]=n;else{(c[o]=c[o]||{})[t]=n}},c.complete=function(){var t=0,i=c.getCtx(e.ChildrenContextKey);if(Object(r.k)(i))for(var o=0;o<i.length;o++){var a=i[o];a&&(t+=a.time)}c.time=Object(r.f)()-c.start,c.exTime=c.time-t,c.complete=function(){},!u&&Object(r.o)(n)&&(c.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),u=function e(t){this.ctx={},Object(i.a)(e,this,(function(e){e.create=function(e,t,n){return new c(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&Object(r.o)(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e[o]=e[o]||{})[t]=n)},e.getCtx=function(t){return(e[o]||{})[t]}}))},s="CoreUtils.doPerf";function l(e,t,n,i,o){if(e){var a=e;if(Object(r.o)(a.getPerfMgr)&&(a=a.getPerfMgr()),a){var u=void 0,l=a.getCtx(s);try{if(u=a.create(t(),i,o)){if(l&&u.setCtx&&(u.setCtx(c.ParentContextKey,l),l.getCtx&&l.setCtx)){var f=l.getCtx(c.ChildrenContextKey);f||(f=[],l.setCtx(c.ChildrenContextKey,f)),f.push(u)}return a.setCtx(s,u),n(u)}}catch(e){u&&u.setCtx&&u.setCtx("exception",e)}finally{u&&a.fire(u),a.setCtx(s,l)}}}return n()}function f(){return a}}}]);
//# sourceMappingURL=owa.118.js.map
self.scriptsLoaded['owa.118.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.118.js'] = (new Date()).getTime();