self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.130.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[130],{10869:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var i=r(12),s=r(49),n=r(2),a=r(81),o=r(12337),c=r(8088);class d{constructor(e){this.properties={};const t=Object(s.g)().SessionSettings||{};this.properties.eventName=e,this.properties.clientType=o.a,this.properties.clientVersion=Object(c.a)(),this.properties["UserInfo.Id"]=t.UserPuid,this.properties["UserInfo.PrimaryIdentityHash"]=t.ExternalDirectoryUserGuid,this.properties.clientId=Object(n.t)(),this.properties.tenantGuid=t.ExternalDirectoryTenantGuid,this.properties.sessionId=Object(n.M)(),this.properties.physicalRing=Object(i.g)(),this.properties.correlationVector=Object(a.b)()}setProperty(e,t){this.properties[e]=t}getProperties(e){if(e)for(const e of Object.keys(this.properties)){const t=this.properties[e];"string"==typeof t&&(this.properties[e]=Object(n.T)(t))}return this.properties}}d.type="DataPoint.Aria"},10870:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(40),s=r(2),n=r(8868);class a extends n.a{constructor(e,t,r,i,s){super(e,t,r,i),this.setHttpActionProperties(r,s)}setHttpActionProperties(e,t){var r;if(this.setProperty("forest",Object(s.y)()),null===(r=null==e?void 0:e.card)||void 0===r?void 0:r.messageCardContext)try{const t="string"==typeof e.card.messageCardContext?e.card.messageCardContext:JSON.stringify(e.card.messageCardContext);this.setProperty("messageCardContext",t)}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardContext: ${e}`)}if(null==e?void 0:e.messageCardExtensionContext)try{const t="string"==typeof e.messageCardExtensionContext?e.messageCardExtensionContext:JSON.stringify(e.messageCardExtensionContext);this.setProperty("messageCardExtensionContext",t)}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardExtensionContext: ${e}`)}if(t)try{this.setProperty("actionContext","string"==typeof t?t:JSON.stringify(t))}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify actionContext: ${e}`)}}}a.type="DataPoint.HttpAction"},10871:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(10869);class s extends i.a{constructor(e,t){super(e),this.setSessionProperties(t)}setSessionProperties(e){const t=JSON.stringify(e);this.setProperty("genericInfo",t)}}s.type="DataPoint.Session"},11175:function(e,t,r){"use strict";var i=r(8333);var s=e=>{let t="[";return Object.keys(e).forEach((r,i)=>{0!==i&&(t+=", "),t+=`"${r}": "${e[r]}"`}),t+="]",t},n=r(7);function a(e){return 0===Object.keys(e).length}r.d(t,"a",(function(){return o}));class o extends i.a{constructor(e,t,r,i){super(e,t,r),this.setRenderProperties(i)}setRenderProperties(e){if(e){const t=function(e){const t=[],r=e.previousCardCheckpoints&&!a(e.previousCardCheckpoints)?e.previousCardCheckpoints:e.currentCardCheckpoints;let i=null;e.previousCardCheckpoints&&!a(e.previousCardCheckpoints)&&(i=e.currentCardCheckpoints);const o=Object(n.w)(r.cardCreateEnd,r.cardCreateStart);t.ICPT=o;const c=Object(n.w)(r.cardRenderEnd,r.cardRenderStart);t.ICRT=c;const d=Object(n.w)(r.themeResolveEnd,r.themeResolveStart);t.ICTT=d;const p=r.totalFetchTime;t.ICFT=p;const l=Object(n.w)(r.cardLibraryRenderEnd,r.cardLibraryRenderStart);t.ICHT=l;const C=Object(n.w)(r.prepareCardEnd,r.prepareCardStart);if(t.IPPT=C,i){const e=Object(n.w)(i.cardCreateEnd,i.cardCreateStart);t.FCPT=e;const r=Object(n.w)(i.cardRenderEnd,i.cardRenderStart);t.FCRT=r;const s=Object(n.w)(i.themeResolveEnd,i.themeResolveStart);if(t.FCTT=s,i.totalFetchTime){const e=i.totalFetchTime;t.FCFT=e}const a=Object(n.w)(i.cardLibraryRenderEnd,i.cardLibraryRenderStart);t.FCHT=a;const o=Object(n.w)(i.prepareCardEnd,i.prepareCardStart);t.FPPT=o}if(e.autoInvokeActionStart&&e.autoInvokeActionEnd){const r=Object(n.w)(e.autoInvokeActionEnd,e.autoInvokeActionStart);t.AIT=r}const u=Object(n.w)(i?i.cardRenderEnd:r.cardRenderEnd,e.loadStart);return t.TCRT=u,s(t)}(e);this.setProperty("genericInfo",t)}}}o.type="DataPoint.Render"},12337:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));const i="WAC_Outlook_React",s="20000101001"},12338:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(7118),s=r(10869);class n extends s.a{constructor(e,t=i.a.Standard,r,s){super(e),this.setErrorProperties(t,r,s)}setErrorProperties(e,t,r){this.setProperty("eventType",e),void 0!==t&&this.setProperty("errorMessage",t),void 0!==r&&this.setProperty("stackTrace",r)}}n.type="DataPoint.Error"},7117:function(e,t,r){"use strict";var i;!function(e){e.ActionCardExpanded="ActionCardExpanded",e.ActionCardCollapsed="ActionCardCollapsed",e.MessageCardHidden="MessageCardHidden",e.MessageCardRemoved="MessageCardRemoved",e.MessageCardViewActionClicked="MessageCardViewActionClicked",e.AutoDFailure="AutoDFailure",e.PrefetchError="PrefetchError",e.CardLoadTimeout="CardLoadTimeout",e.FailedToValidateSignature="FailedToValidateSignature",e.ToggleVisibilityActionClick="ToggleVisibilityActionClick",e.DisplayAppointmentFormClicked="DisplayAppointmentFormClicked",e.DisplayMessageFormClicked="DisplayMessageFormClicked",e.MessageCardPinAddinCommandClicked="MessageCardPinAddinCommandClicked",e.MessageCardInvokeAddinCommandClicked="MessageCardInvokeAddinCommandClicked",e.ActionCardHttpPostActionClicked="ActionCardHttpPostActionClicked",e.SingleClickHttpPostActionClicked="SingleClickHttpPostActionClicked",e.AutoInvokeActionClicked="AutoInvokeActionClicked",e.HttpPostActionExecuted="HttpPostActionExecuted",e.MessageCardRendered="MessageCardRendered",e.SessionDetails="SessionDetails"}(i||(i={})),t.a=i},7118:function(e,t,r){"use strict";var i;!function(e){e.Standard="Standard",e.Critical="Critical"}(i||(i={})),t.a=i},8086:function(e,t,r){"use strict";var i;!function(e){e.ClientEvent="client_event",e.ClientError="client_error"}(i||(i={})),t.a=i},8088:function(e,t,r){"use strict";var i=r(2),s=r(12337);t.a=()=>{let e=s.b;const t=Object(i.u)();return t&&(e=t),e=e.replace(/[^\d]/g,""),e=`16.${e.substr(0,4)}.${e.substr(4,4)}.${e.substr(8)}`,e}},8089:function(e,t,r){"use strict";var i=r(7117),s=r(8333),n=r(8868),a=r(10870),o=r(11175),c=r(12338),d=r(10871);const p={[s.a.type]:[i.a.ActionCardExpanded,i.a.ActionCardCollapsed,i.a.MessageCardHidden,i.a.MessageCardRemoved],[c.a.type]:[i.a.AutoDFailure,i.a.PrefetchError,i.a.CardLoadTimeout,i.a.FailedToValidateSignature],[n.a.type]:[i.a.MessageCardViewActionClicked,i.a.ToggleVisibilityActionClick,i.a.DisplayAppointmentFormClicked,i.a.DisplayMessageFormClicked,i.a.MessageCardPinAddinCommandClicked,i.a.MessageCardInvokeAddinCommandClicked,i.a.HttpPostActionExecuted],[a.a.type]:[i.a.ActionCardHttpPostActionClicked,i.a.SingleClickHttpPostActionClicked,i.a.AutoInvokeActionClicked],[o.a.type]:[i.a.MessageCardRendered],[d.a.type]:[i.a.SessionDetails]};t.a=e=>{let t;return t=p[d.a.type].includes(e)?d.a.type:p[o.a.type].includes(e)?o.a.type:p[a.a.type].includes(e)?a.a.type:p[n.a.type].includes(e)?n.a.type:p[c.a.type].includes(e)?c.a.type:s.a.type,t}},8090:function(e,t,r){"use strict";var i=r(6),s=r(2);t.a=()=>Object(i.a)()||Object(s.R)()},8329:function(e,t,r){"use strict";var i=r(61),s=r(8086),n=r(8090),a=r(12338),o=r(8089);var c=(e,t,r,i)=>{if(void 0===e)return;let s;switch(Object(o.a)(e)){case a.a.type:s=new a.a(e,t,r,i)}return null==s?void 0:s.getProperties(!0)};t.a=async(e,t,r,a)=>{if(Object(n.a)())return;const o=c(e,t,r,a);if(!o)return;const d=await Object(i.g)(),p={name:s.a.ClientError,properties:o};d.logEvent(p)}},8333:function(e,t,r){"use strict";var i,s=r(2561);!function(e){e.ExplicitMessageCard="explicitMessageCard",e.AdaptiveCard="adaptiveCard",e.AdaptiveCardV2="adaptiveCardV2"}(i||(i={}));var n=i,a=r(10869);r.d(t,"a",(function(){return o}));class o extends a.a{constructor(e,t,r){super(e),this.setCardProperties(t,r)}isACv2Card(e){let t=!1;if(e){const r=new s.SerializationContext,i=s.Version.parse(e,r),n=s.Version.parse("1.4",r);try{t=i.compareTo(n)>=0}catch(e){}}return t}setCardProperties(e,t){var r,i,s,a;(null==e?void 0:e.itemId)&&this.setProperty("messageId",e.itemId),(null==e?void 0:e.conversationId)&&this.setProperty("conversationId",e.conversationId),(null==e?void 0:e.isGroupEscalationMessage)&&this.setProperty("isGroupEscalationMessage",e.isGroupEscalationMessage),(null===(r=null==e?void 0:e.mailboxInfo)||void 0===r?void 0:r.type)&&this.setProperty("mailboxType",e.mailboxInfo.type),this.setProperty("messageType",t.isAdaptiveCard?this.isACv2Card(null===(i=null==t?void 0:t.card)||void 0===i?void 0:i.version)?n.AdaptiveCardV2:n.AdaptiveCard:n.ExplicitMessageCard),(null==t?void 0:t.connectorSenderGuid)&&this.setProperty("connectorSenderGuid",t.connectorSenderGuid),(null===(a=null===(s=null==t?void 0:t.card)||void 0===s?void 0:s.messageCardContext)||void 0===a?void 0:a.oamAppName)&&this.setProperty("oamAppName",t.card.messageCardContext.oamAppName)}}o.type="DataPoint.Card"},8868:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(8333);class s extends i.a{constructor(e,t,r,i,s){super(e,t,r),this.setActionProperties(i,s)}setActionProperties(e,t){if((null==e?void 0:e.id)&&this.setProperty("actionId",e.id),t)try{this.setProperty("genericInfo",JSON.stringify(t))}catch(e){}}}s.type="DataPoint.Action"}}]);
//# sourceMappingURL=owa.130.js.map
self.scriptsLoaded['owa.130.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.130.js'] = (new Date()).getTime();