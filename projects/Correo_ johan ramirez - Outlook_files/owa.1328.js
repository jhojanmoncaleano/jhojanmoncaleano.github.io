self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1328.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1328],{19369:function(e,n,t){"use strict";t.r(n);var o=t(1862),r=t(5),a=t(701),l=t(312),c=t(40);let i="ows/v1.0/CalendarIcons/?AssetType=svg&Lang=",s=2,u=null;var d=t(699);function f(e){let n={IconId:e.iconId,Name:e.name,LocalizedName:e.locName,SvgFile:e.svgFile,Keywords:[],IsInDefaultSet:e.isInDefaultSet,SvgHtmlText:""};if(null!=e.keywords)for(var t of e.keywords)n.Keywords.push(t);return n}var m=Object(d.action)("setCharmInfoInMap")((function(e,n={charmStore:o.a}){var t=n.charmStore;return new Promise(n=>{if(null==t||null==t.charmInfoMap||null==e||null==e.icons)return n();for(var o of e.icons){let e=f(o);t.charmInfoMap.set(o.iconId.toString(),e)}return n()})}));var h=Object(d.action)("setCharmKeywordsInMap")((function(e={charmStore:o.a}){var n=e.charmStore;return new Promise(e=>{if(null==n||null==n.keywordsMap||null==n.charmInfoMapMaxId)return e();if(n.keywordsMap.size>3)return e();for(var t=0;t<=n.charmInfoMapMaxId;t++){var o=n.charmInfoMap.get(t.toString());if(null!=o)for(var r of o.Keywords)if(!n.keywordsMap.has(r)){let e={Keyword:r,IconId:o.IconId};n.keywordsMap.set(r.toLocaleLowerCase(),e)}}return e()})}));let I=void 0;var v=Object(d.action)("loadCharmsCatalog")((function(e={charmStore:o.a}){var n=e.charmStore;return I||(I=new Promise(e=>{let t=function(){if(null!=u)return u;let e="";if(Object(a.a)(Object(r.e)())||(e=Object(r.e)().toLowerCase()),e.length<s)return c.d(`[getCalendarIconsFromService] Failed to get locale, got: ${e}.`),null;let n=i+e;return u=new Promise(t=>{Object(l.b)(n).then(n=>null!=n?(c.h.info(`[getCalendarIconsFromService] Got response for locale: ${e}.`),t(n)):(c.d(`[getCalendarIconsFromService] Failed to get response for locale: ${e}.`),t(null)))}),u}();null!=t&&t.then(e=>null!=e&&null!=e.icons&&e.icons.length>0?(m(e),n.charmInfoMapMaxId=function(e){let n=0;for(var t of e)n<t.iconId&&(n=t.iconId);return n}(e.icons),h(),void c.h.info("[loadCharmsCatalog] Loaded charms catalog into the charms store.")):(I=void 0,void c.h.info("[loadCharmsCatalog] Failed to load charms from service. Continuing without charms."))).then(()=>e())}),I)}));var p=t(9950),w=t(3);const g=Object(w.mutatorAction)("setSvgHtmlText",(e,n)=>{e.SvgHtmlText=n}),S=Object(w.mutatorAction)("addCharmInfo",e=>{o.a.charmInfoMap.set(e.IconId.toString(),e)});var C=async function(e){if(null==e||null==o.a||null==o.a.charmInfoMapMaxId)return;let n=o.a.charmInfoMap.get(e.toString());null==n||null!=n.SvgHtmlText&&""!=n.SvgHtmlText||(await Object(p.a)(n.SvgFile).then((function(e){g(n,e)})),c.h.info("[setCharmInfoWithUpdatedSvgText] complete, iconId: "+n.IconId),S(n))};t.d(n,"loadCharmsCatalog",(function(){return v})),t.d(n,"loadCharmSvgTextInMap",(function(){return C}))},9950:function(e,n,t){"use strict";n.a=function(e){if(null==e||""==e)return Promise.resolve("");let n=new Request(e);return n.headers.append("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.headers.append("Accept","application/x-www-form-urlencoded; charset=UTF-8"),fetch(n).then((function(e){return e.text()}))}}}]);
//# sourceMappingURL=owa.1328.js.map
self.scriptsLoaded['owa.1328.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1328.js'] = (new Date()).getTime();