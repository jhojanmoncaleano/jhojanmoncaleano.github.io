self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.135.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[135],{18686:function(e,t,n){"use strict";var r,i,a,s,o,c,u,d,v,f,p=n(4623);i=r||(r={}),a="Office.System.Result",i.getFields=function(e,t){var n=[];return n.push(Object(p.c)(e+".Code",t.code)),void 0!==t.type&&n.push(Object(p.d)(e+".Type",t.type)),void 0!==t.tag&&n.push(Object(p.c)(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(Object(p.a)(e+".IsExpected",t.isExpected)),n.push(Object(p.d)("zC.Activity.Result",a)),n},(o=s||(s={})).contractName="Office.System.Activity",o.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(Object(p.d)("Activity.CV",e.cV)),t.push(Object(p.c)("Activity.Duration",e.duration)),t.push(Object(p.c)("Activity.Count",e.count)),t.push(Object(p.c)("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(Object(p.a)("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,r.getFields("Activity.Result",e.result)),t.push(Object(p.d)("zC.Activity",o.contractName)),t},(c||(c={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(p.d)(e+".Id",t.id)),void 0!==t.version&&n.push(Object(p.d)(e+".Version",t.version)),void 0!==t.sessionId&&n.push(Object(p.d)(e+".SessionId",t.sessionId)),n},(u||(u={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(Object(p.d)(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(Object(p.d)(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(Object(p.d)(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(Object(p.d)(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(Object(p.d)(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(Object(p.a)(e+".IsAnonymous",t.isAnonymous)),n},(d||(d={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(Object(p.d)(e+".Name",t.name)),void 0!==t.state&&n.push(Object(p.d)(e+".State",t.state)),n},(v||(v={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(p.c)(e+".Id",t.id)),void 0!==t.name&&n.push(Object(p.d)(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(Object(p.d)(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(Object(p.d)(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(Object(p.d)(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Object(p.c)(e+".TimeOffsetMs",t.timeOffsetMs)),n},function(e){e.getFields=function(e,t){var n=[];return n.push(Object(p.d)(e+".ErrorGroup",t.errorGroup)),n.push(Object(p.c)(e+".Tag",t.tag)),void 0!==t.code&&n.push(Object(p.c)(e+".Code",t.code)),void 0!==t.id&&n.push(Object(p.c)(e+".Id",t.id)),void 0!==t.count&&n.push(Object(p.c)(e+".Count",t.count)),n}}(f||(f={})),n.d(t,"a",(function(){return l}));var l,m=s,h=r,y=f,b=d,T=c,O=v,g=u;!function(e){!function(e){!function(e){e.Activity=m,e.Result=h,e.Error=y,e.Funnel=b,e.Host=T,e.User=g,e.UserAction=O}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(l||(l={}))},4623:function(e,t,n){"use strict";function r(e,t){return{name:e,dataType:1,value:t,classification:4}}function i(e,t){return{name:e,dataType:2,value:t,classification:4}}function a(e,t){return{name:e,dataType:3,value:t,classification:4}}function s(e,t){return{name:e,dataType:0,value:t,classification:4}}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return s}))},5168:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(5537),i="Data.",a="zC.",s="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",o="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function c(e,t,n){t&&t.forEach((function(t){if(!t.classification||4===t.classification||1===t.classification||n.customerContentEnabled&&32===t.classification){var r,s;switch(r=n.prependDataToken?t.name.substr(0,3)===a?a+i+t.name.substr(3):i+t.name:t.name,t.dataType){case 3:s=6;break;case 2:s=4;break;case 4:s=8;break;case 0:return void(e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case 1:default:return void(e[r]=t.value)}var o={value:t.value,propertyType:s};e[r]=o}}))}function u(e,t){try{return e()}catch(e){return Object(r.a)(1,"1DS Sink",e),t}}},5537:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r,i=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function a(){return i}function s(e,t,n){i.fireEvent({level:e,category:t,message:n})}function o(e,t,n){s(0,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}},8668:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),i=n(5537),a=n(9044),s=n(5168),o=n(13060),c=1,u=function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var u=[],d=!1,v={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return d||10===t||110===t||120===t}},f={},p=Object(o.e)(),l=(new Date).getTime().toString(),m=function(e,t){if(1===t.eventType)return s.b;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},h=function(e,t){var o,c=Object(a.c)(e);if(function(e){for(var t=function(t){var n=u[t];if(!n.processEvent(e))return Object(i.b)(2,1,(function(){return e.eventName+" suppressed by "+n.name})),{value:!1}},n=0;n<u.length;n++){var r=t(n);if("object"==typeof r)return r.value}return!0}(c)){n.eventsProcessed++;var d=((o=c.timestamp)?new Date(o):new Date).toISOString(),v={"Event.Sequence":{value:n.eventsProcessed,propertyType:4},"Event.Name":c.eventName,"Event.Source":"OTelJS","Event.Time":{value:d,propertyType:9}};Object(s.c)(v,c.dataFields,{prependDataToken:!0,customerContentEnabled:1===t.eventType}),v["Event.Id"]=p+"."+n.eventsProcessed;var h="custom";c.eventContract&&(c.eventContract.name&&(v["Event.Contract"]=c.eventContract.name,h+="."+c.eventContract.name.toLowerCase().replace(/\./g,"_")),Object(s.c)(v,c.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===t.eventType}));var y={iKey:m(c,t),name:c.eventName,data:v,time:d,baseType:h,ext:{sdk:{seq:n.eventsProcessed,epoch:l}}};return n.usePartAPlugin||(y.data=Object(r.__assign)(Object(r.__assign)({},y.data),f)),y}};this.getOneDSTelemetryEvent=function(e){return h(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=c&&1===e.telemetryProperties.customerContentType)return h(e,{eventType:1})},this.addPreprocessor=function(e){u.push(e)},this.addPersistentDataFields=function(e){Object(s.c)(f,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){d=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(d=!0),this.addPersistentDataFields(e),this.addPreprocessor(v)}},9044:function(e,t,n){"use strict";var r,i=n(1),a=n(5537),s=".",o={};!function(e){var t=9007199254740991,n=-t,r=98,i=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,a=/^[a-zA-Z0-9_\.]{1,95}$/;function s(e){return a.test(e)}function o(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!s(e.name))throw new Error("Invalid dataField name");2===e.dataType&&c(e.value)}))}function c(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<n||e>t)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>r)return!1;return i.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!s(t.name))throw new Error("Invalid eventContract");o(t.dataFields)}o(e.dataFields)},e.validateInt=c}(r||(r={}));var c=n(4623);n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return v}));var u=-1;function d(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(i.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var v=function(){function e(e,t,n){var r,a;this.telemetrySinks=[],this.persistentDataFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=Object(i.__assign)(Object(i.__assign)({},e.getConfig()),this.config)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.sendTelemetryEvent=function(e){var t=d(e),n=t.telemetryProperties;if(n.customerContentVersion||n.customerContentType)Object(a.b)(0,0,(function(){return"Customer content"}));else{if(!n.ariaTenantToken||!n.nexusTenantToken){var r=function(e){for(var t=e.length;t>0;){var n=e.substr(0,t);if(o[n])return o[n];t=e.lastIndexOf(s,t-1)}}(t.eventName);if(!r)return void Object(a.b)(0,0,(function(){return"No tenant token: "+e.eventName}));n.ariaTenantToken=r.ariaTenantToken,n.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(t)}},e.prototype.sendCustomerContent=function(e){var t=d(e),n=t.telemetryProperties;return(!n.customerContentVersion||n.customerContentVersion>1)&&(n.customerContentVersion=1),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,t.dataFields.push(Object(c.c)("EventContent.Type",2)),this.sendTelemetryEventInternal(t)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):Object(a.b)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void Object(a.a)(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(t){var n=e.telemetryProperties;n.customerContentVersion&&n.customerContentType?t.sendCustomerContent&&t.sendCustomerContent(e):t.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t,n;e.dataFields&&(null===(n=e.dataFields)||void 0===n||n.unshift(Object(c.d)("OTelJS.Version","4.3.10")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.config.disableValidation||r.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,t=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&t.forEach((function(t){e.sendTelemetryEventInternal(t)}))},e.prototype.setTenantToken=function(e,t,n){!function(e,t){e.substring(0,7)==="Office"+s&&e[e.length-1]!==s?o[e]=t:Object(a.b)(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.cloneEvent=function(e){return d(e)},e.prototype.getConfig=function(){return this.config},e}()}}]);
//# sourceMappingURL=owa.135.js.map
self.scriptsLoaded['owa.135.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.135.js'] = (new Date()).getTime();