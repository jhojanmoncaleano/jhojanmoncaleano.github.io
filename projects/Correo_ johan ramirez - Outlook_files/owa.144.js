self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.144.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[144],{1898:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(3);const i={bulkActionInformationMap:new(n(14).ObservableMap)},o=Object(r.createStore)("bulkActionStore",i),a=o();t.a=a},1920:function(e,t){e.exports=function(e){return e instanceof Date}},1999:function(e,t,n){var r=n(1920),i=36e5,o=6e4,a=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,p=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,O=/^-?W(\d{2})-?(\d{1})$/,T=/^(\d{2}([.,]\d*)?)$/,I=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,A=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/([Z+-].*)$/,g=/^(Z)$/,D=/^([+-])(\d{2})$/,C=/^([+-])(\d{2}):?(\d{2})$/;function j(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?a:Number(n);var E=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=w.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),R=function(e,t){var n,r=l[t],i=f[t];if(n=d.exec(e)||i.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=s.exec(e)||r.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(E.date,n),h=R.year,S=function(e,t){if(null===t)return null;var n,r,i,o;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=b.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=p.exec(e)){r=new Date(0);var a=parseInt(n[1],10);return r.setUTCFullYear(t,0,a),r}if(n=m.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,i,c),r}if(n=v.exec(e))return o=parseInt(n[1],10)-1,j(t,o);if(n=O.exec(e)){o=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return j(t,o,u)}return null}(R.restDateString,h);if(S){var y,x=S.getTime(),_=0;return E.time&&(_=function(e){var t,n,r;if(t=T.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=I.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*o;if(t=A.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var a=parseFloat(t[3].replace(",","."));return n%24*i+r*o+1e3*a}return null}(E.time)),E.timezone?y=function(e){var t,n;if(t=g.exec(e))return 0;if(t=D.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=C.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(E.timezone):(y=new Date(x+_).getTimezoneOffset(),y=new Date(x+_+y*o).getTimezoneOffset()),new Date(x+_+y*o)}return new Date(e)}},2040:function(e,t,n){"use strict";var r=n(20),i=n(1898),o=n(2682),a=n(40);function c(e){const t=i.a.bulkActionInformationMap.get(e);return!!t&&(!(t.customData&&!function(e){let t;try{t=JSON.parse(e)}catch(e){return a.d("Failed to parse bulkActionInfo.customData"),!1}return null!==t&&null!==t.Scenario}(t.customData))&&!Object(o.a)(t,e))}function u(e,t){const n=i.a.bulkActionInformationMap.get(e);return c(e)&&n.state==t}function s(e){return(u(e,l.b.Uninitialized)||u(e,l.b.Running))&&c(e)}var l=n(2088);n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"f",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l.b})),n.d(t,"l",(function(){return i.a}));const d=new r.c(()=>Promise.all([n.e(1),n.e(293),n.e(1035)]).then(n.bind(null,12755))),f=Object(r.d)(d,e=>e.BulkActionSpinner);let b=new r.a(d,e=>e.subscribeToBulkActionNotification),p=new r.a(d,e=>e.onBulkActionSubmitted),m=new r.a(d,e=>e.findBulkActionItemAction),v=new r.a(d,e=>e.onBulkActionCancel),O=new r.a(d,e=>e.onBulkActionHierarchyNotification),T=new r.a(d,e=>e.onBulkActionDismiss)},2042:function(e,t,n){"use strict";var r=n(3);const i=Object(r.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null});var o=i(),a=n(2041),c=n(61),u=n(2891),s=n(2545);let l;n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m}));const d=Object(r.mutatorAction)("setUndoableAction",(e,t)=>{const n=i();n.hasUndoableAction=e,n.undoableActionFolderId=t});function f(e,t){null!==e&&(l=e,d(!0,t))}function b(){l=null,d(!1,null)}function p(){return i().hasUndoableAction}function m(e){const t=new c.b("TnS_Undo");t.addCustomData([e]),o.undoableActionFolderId?a.a.clearMapForFolder(o.undoableActionFolderId):a.a.removeAll();return null!==l&&(l().then(()=>{Object(u.a)()||Object(s.a)()}),b()),t.end(),Promise.resolve()}},2088:function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return i})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout",e[e.Cancelling=6]="Cancelling"}(r||(r={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout"}(i||(i={})),t.b=r},2108:function(e,t,n){"use strict";var r=n(20),i=n(2042),o=n(1679),a=n(1692),c=n(1685),u=n(1683),s=n(44);function l(e,t){return!(!e||Object(o.y)()||!t||!("UserMailbox"===t.type||Object(s.j)("grp-loadFolders")&&"GroupMailbox"===t.type)||Object(a.m)(e)||e==Object(c.a)("recoverableitemsdeletions")||Object(u.C)(e,"SharedMailbox"))}n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return i.b})),n.d(t,"d",(function(){return i.c})),n.d(t,"c",(function(){return l}));const d=new r.c(()=>n.e(2070).then(n.bind(null,18900)));let f=new r.a(d,e=>e.undo)},2316:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"SortResults:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2465:function(e,t,n){"use strict";function r(e){let t="";return e.graphQLErrors&&e.graphQLErrors.forEach(e=>{var n;(null===(n=e.extensions)||void 0===n?void 0:n.responseCode)&&(t=e.extensions.responseCode)}),t}n.d(t,"a",(function(){return r}))},2545:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("RESTORE_ROW_FAIL")},2546:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1679);function i(e,t,n={tableViews:r.Z.tableViews}){const{tableViews:i}=n,o=[];return i.forEach(n=>{if(n.tableQuery.folderId===e||n.serverFolderId===e||t&&1===n.tableQuery.type)o.push(n);else if(t){const e=n.tableQuery.scenarioType;"category"!==e&&"persona"!==e&&"privatedistributionlist"!==e||o.push(n)}}),o}},2645:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("GET_FOLDER_DATA",e=>({folderId:e}))},2682:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2751),i=n.n(r),o=n(2088),a=n(1898);function c(e,t){const n=new Date,r=new Date(e.sendTime),c=i()(n,r),u=isNaN(c),s=c>7.5,l=Object(a.b)().bulkActionInformationMap.get(t);return!(!u&&!s)||!!l&&[o.b.Cancelled,o.b.Failed,o.b.Complete].indexOf(l.state)>-1}},2683:function(e,t,n){var r=n(1999);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()-i.getTime()}},2751:function(e,t,n){var r=n(2683),i=36e5;e.exports=function(e,t){var n=r(e,t)/i;return n>0?Math.floor(n):Math.ceil(n)}},2891:function(e,t,n){"use strict";let r;function i(){r=!0}function o(){return r}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))},2929:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1986),i=n(1679),o=n(452),a=n(1705),c=n(2316),u=n(1685);function s(e){const t=e.sortBy;let n,s;switch(t.sortColumn){case 1:Object(r.l)(e)?n="ReceivedOrRenewTime":Object(u.a)("drafts")==e.folderId&&(n="ItemLastModifiedTime");break;case 3:s=!0,n=Object(o.a)({PropertyTag:"0x0042",PropertyType:"String"});break;case 7:n="Size";break;case 5:n="Importance";break;case 8:n="Subject";break;default:throw new Error("getMailItemSortByProperty: sort column not supported"+t.sortColumn)}const l=[];if(n){let e=n;s||(e=Object(a.a)({FieldURI:n})),l.push(Object(c.a)({Order:t.sortDirection,Path:e}))}const d=1==e.sortBy.sortColumn?e.sortBy.sortDirection:i.c.DESCENDING_SORT_DIR;return l.push(Object(c.a)({Order:d,Path:Object(a.a)({FieldURI:"DateTimeReceived"})})),l}},3159:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_CONVERSATIONS_PINNED_STORE_UPDATE",(e,t,n)=>({rowKeys:e,tableViewId:t,shouldMarkAsPinned:n}))},3160:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ITEMS_PINNED_STORE_UPDATE",(e,t,n)=>({rowKeys:e,tableViewId:t,shouldMarkAsPinned:n}))},3308:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",e=>({tableView:e}))},3546:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("CONVERSATION_CATEGORIES_STORE_UPDATE",(e,t,n,r,i)=>({conversationRowKeys:e,tableViewId:t,categoriesToAdd:n,categoriesToRemove:r,clearCategories:i}))},3547:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ITEMS_CATEGORIES_STORE_UPDATE",(e,t,n,r)=>({itemIds:e,categoriesToAdd:t,categoriesToRemove:n,clearCategories:r}))}}]);
//# sourceMappingURL=owa.144.js.map
self.scriptsLoaded['owa.144.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.144.js'] = (new Date()).getTime();