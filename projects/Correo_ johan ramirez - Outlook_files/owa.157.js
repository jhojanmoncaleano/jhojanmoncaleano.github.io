self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.157.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[157],{11126:function(e,t,n){"use strict";var a=n(11151),o=n(9408),i=n(6256),r=n(5012),c=n(3730),s=n(4020),u=n(2931),d=n(61),l=n(699),f=n(1690),m=n(2322),b=n(5896),g=n(4021);const I=5,O=3;var v=Object(l.action)("markConversationCollapsedItemsRollUp")((function(e,t,n){Object(b.b)(e,g.a.CalendarCard)?function(e,t){const{length:n}=t,a=[],o=Object(u.a)()?0:n-1,i=Object(u.a)()?1:-1;for(let e=o;e<=n-1&&e>=0&&!t[e].isExpanded;e+=i)p(t[e])&&a.push(t[e].conversationNodeId);a.length>1&&(e.conversationNodeIdsInCollapsedItemsRollUp=a)}(e,t):function(e,t,n){const{length:a}=t;if(a<I)return;const o=[];let i=Object(u.a)()?1:a-2;const r=Object(u.a)()?1:-1;n&&(i-=r);for(let e=i;e<=a-1&&e>=0&&!t[e].isExpanded;e+=r)o.push(t[e].conversationNodeId);if(o.length>=O){if(o.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=o,!n){const n=Object(u.a)()?0:a-1;e.nodeIdBundledWithSeeMoreMessages=t[n].conversationNodeId}Object(d.o)("RPCountRenderCollItemsRollUp",[Object(c.b)(Object(s.a)(e))])}}(e,t,n)}));function p(e){let t=f.a.items.get(e.itemId);return!(!t||!Object(m.b)(t))&&t.IsOutOfDate}var j=n(11540),h=n(9409),S=n(4334),C=n(1902),w=n(9410),P=n(1679);var A=n(5);var R=n(6257),M=n(2690),E=n(2803),x=n(2926);function y(e,t,n,a){const c=[],{itemPartsMap:s,itemIdToScrollTo:u}=t;let d=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach(t=>{let[n]=Object(r.a)({mailboxInfo:e.conversationId.mailboxInfo,Id:t});n&&s.set(t,n)}),Object(E.a)()&&Object(h.a)(t),Object(j.a)(s,n,e.conversationNodeIds,!1);let l=!1;e.conversationNodeIds.forEach(e=>{const t=s.get(e);if(t&&!t.isInRollUp){c.push(t);const e=a.get(t.itemId);(function(e){const t=Object(P.I)();if(null==t?void 0:t.highlightTerms){const n=Object(w.a)(e.RightsManagementLicenseData,e.UniqueBody),a=document.createElement("div");return a.innerHTML=n,t.highlightTerms.some((function(e){return a.innerText.toLowerCase().indexOf(e)>=0}))}return!1})(e)&&(t.isExpanded=!0),l=l||t.isExpanded&&!e.IsDraft}});const I="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,a){const o=n.length;if(0==o||t)return;let i=null;const r=e?o-1:0;let c=r;const s=e?-1:1,u=e=>{const t=a.get(e);return Object(x.a)(t)[1]};for(;c>=0&&c<o;){const e=n[c],t=e.oofRollUpViewState.oofReplyNodeIds.some(u);if(!e.isExpanded&&(e.isLocal||t)){i=e;break}c+=s}i||(i=n[r]),i.isExpanded=!0,i.isFossilizedTextExpanded=!0}(I,l,c,n),d=function(e,t){const n=e.length;for(let a=0;a<n;a++){const n=e[a],o=n.itemId;if(t){if(o==t)return n.isExpanded=!0,{itemPart:n,focusedItemArea:S.a.Item}}else{if(n.isExpanded)return{itemPart:n,focusedItemArea:S.a.Item};if(n.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:n,focusedItemArea:S.a.Oof}}}return null}(c,u),c.forEach(e=>{e.isExpanded&&Object(i.a)(e)}),Object(o.a)(t,c),Object(b.b)(t,g.a.CalendarCard)&&function(e){var t;const n=e.length;if(0!=n)for(let a=0;a<n;a++){const n=e[a],o=n?n.itemId:null,i=f.a.items.get(o),r=Object(P.I)();if(i&&Object(m.b)(i)&&(null==r||!r.highlightTerms))if(i.IsRead||i.IsOutOfDate)n.isExpanded=!1,n.isFossilizedTextExpanded=!1;else if(Object(m.f)(i.ItemClass)){const e=i;"NewMeetingRequest"==e.MeetingRequestType&&!Object(A.k)(e.Preview)||(null===(t=e.ChangeHighlights)||void 0===t?void 0:t.HasBodyChanged)?n.isExpanded=!0:(n.isExpanded=!1,n.isFossilizedTextExpanded=!1)}else!Object(m.g)(i.ItemClass)&&!Object(m.a)(i.ItemClass)||Object(A.k)(i.Preview)?(n.isExpanded=!1,n.isFossilizedTextExpanded=!1):n.isExpanded=!0}}(c),c.length){const n=I?0:e.conversationNodeIds.length-1,a=e.conversationNodeIds[n],o=s.has(a);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=a),Object(M.a)(t.conversationId.Id)||v(t,c,e.canLoadMore&&!o)}}return d}t.a=Object(l.action)("firstLoadConversationReadingPane")((function(e,t={loadedConversation:f.a.conversations.get(e),conversationNodes:f.a.conversationNodes,conversationReadingPaneState:Object(C.a)(e),items:f.a.items}){if(t.conversationReadingPaneState.conversationId.Id!=e)return;const n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){const o=Object(R.c)(e);if(n.unsupportedItemId=o,!o){const e=y(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=e,Object(a.a)(n,!0)}}}))},11151:function(e,t,n){"use strict";var a=n(9107),o=n(1690);var i=n(7343),r=n(44);function c(e,t){const n=Object(i.a)(e.conversationId.Id);if(null==n?void 0:n.hasSharepointLink)return!0;if(e.itemPartsMap.size>0){if(function(e){if(!e)return!1;const t=o.a.conversations.get(e.conversationId.Id);return null==t?void 0:t.canLoadMore}(e))return!0;const n=[...e.itemPartsMap.keys()];for(let a=0;a<n.length;a++){const o=e.itemPartsMap.get(n[a]);if(!o)continue;const i=t.get(o.itemId);if(i&&(i.Attachments||Object(r.j)("doc-linkDiscovery-useNewProperty")&&i.HasProcessedSharepointLink))return!0}}return!1}var s=n(2931),u=n(1910),d=n(2821),l=n(3);async function f(e,t){const n=Object(o.b)().items;if(c(e,n)){if(!(null==e?void 0:e.attachmentWell)){const[t,n,a]=await d.c.importAndExecute(e.conversationId),o=await u.l.import();m(e,o(n,a)),await u.n.importAndExecute(t,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)}const o=[...e.itemPartsMap.keys()];for(let i=0;i<o.length;i++){const r=e.itemPartsMap.get(o[i]);if(!r)continue;const c=n.get(r.itemId);c&&(await Object(a.a)(r,c,t),await u.o.importAndExecute(r.attachmentWell,e.attachmentWell,Object.assign(Object.assign({},c.ItemId),{mailboxInfo:c.MailboxInfo}),c.DateTimeReceived))}await u.r.importAndExecute(e.attachmentWell,Object(s.a)())}}n.d(t,"a",(function(){return f}));const m=Object(l.mutatorAction)("setAttachmentWellForConversation",(e,t)=>{e.attachmentWell=t})},11540:function(e,t,n){"use strict";var a=n(11541),o=n(699);t.a=Object(o.action)("tryAddOofNodesInRollUp")((function(e,t,n,o){o&&e.forEach(e=>{e.oofRollUpViewState.oofReplyNodeIds=[]}),n.forEach(n=>{const o=e.get(n);if(!o||!o.oofRollUpViewState.isOofItem)return;o.isInRollUp=!1;const i=Object(a.a)(n,e,t);i&&!i.isInRollUp&&(o.isInRollUp=!0,i.oofRollUpViewState.oofReplyNodeIds.push(n))})}))},11541:function(e,t,n){"use strict";function a(e,t,n){const a=n.get(e);return a?t.get(a.parentInternetMessageId):null}n.d(t,"a",(function(){return a}))},11542:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(13339),o=n(5);function i(e){let t;if((null==e?void 0:e.RightsManagedMessageDecryptionStatus)&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(o.c)(Object(o.b)(a.d),r());break;case-2147160010:t=Object(o.b)(a.a);break;case-2147168507:t=Object(o.c)(Object(o.b)(a.l),r());break;case-2147160014:t=Object(o.b)(a.j);break;case-2147160054:case-2147160055:t=Object(o.b)(a.h);break;case-2147160064:case-2147160013:t=Object(o.b)(a.g);break;case-2147160051:t=Object(o.b)(a.c);break;case-2147160060:t=Object(o.b)(a.k);break;case-2147160009:default:t=Object(o.c)(Object(o.b)(a.i),e.RightsManagedMessageDecryptionStatus)}return t}function r(){const e=Object(o.c)('<a href="{0}" target="_blank">{1}</a>',Object(o.b)(a.f),Object(o.b)(a.e));return Object(o.c)(Object(o.b)(a.b),e)}},13339:function(e){e.exports=JSON.parse('{"d":"Pba","a":"Qba","l":"Rba","j":"Sba","h":"Tba","g":"Uba","c":"Vba","k":"Wba","i":"Xba","f":"Yba","e":"Zba","b":"_ba"}')},1751:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return c}));const a="FileAttachment:#Exchange",o="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",r="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1754:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(316);function o(e){var t;return null===(t=Object(a.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1788:function(e,t,n){"use strict";var a,o,i;n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(a||(a={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},1822:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1751);function o(e){return(e.__type||e.OwsTypeName)===a.e}},1866:function(e,t,n){"use strict";var a=n(2318),o=n(699);const i=Object(o.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=[...e.infoBarIds];const o=e.infoBarHostKey;n&&(a.b[o]||(a.b[o]={}),a.b[o][t]=n)}}));t.a=i},1910:function(e,t,n){"use strict";n.d(t,"n",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"t",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return g})),n.d(t,"j",(function(){return I})),n.d(t,"i",(function(){return O})),n.d(t,"l",(function(){return v})),n.d(t,"k",(function(){return p})),n.d(t,"c",(function(){return j})),n.d(t,"o",(function(){return h})),n.d(t,"r",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"m",(function(){return w})),n.d(t,"h",(function(){return P})),n.d(t,"s",(function(){return A}));var a=n(20),o=n(2046);n.d(t,"u",(function(){return o.a}));var i=n(2047);n.d(t,"v",(function(){return i.a}));const r=new a.c(()=>Promise.all([n.e(0),n.e(9),n.e(10),n.e(12),n.e(13),n.e(24),n.e(26),n.e(34),n.e(47),n.e(50),n.e(54),n.e(103),n.e(168),n.e(269),n.e(652),n.e(555)]).then(n.bind(null,3072))),c=new a.a(r,e=>e.initializeAttachments),s=new a.a(r,e=>e.reinitializeAttachments),u=(new a.a(r,e=>e.setInlineAttachmentStatus),new a.a(r,e=>e.addAttachmentIntoWellBeforeUpload)),d=new a.b(r,e=>e.refreshSharingTipsAttachmentWell),l=new a.b(r,e=>e.createAttachmentsViaQueueManager),f=new a.b(r,e=>e.createAttachmentsFromRecentAttachments),m=new a.a(r,e=>e.deleteAttachmentViaQueueManager),b=new a.b(r,e=>e.createAttachmentFullViewStateAndStoreBackingModel),g=new a.b(r,e=>e.createAttachmentFullViewState),I=new a.b(r,e=>e.getAttachmentWellInitialValue),O=new a.b(r,e=>e.getAttachmentWellForCompose),v=new a.b(r,e=>e.getConversationAttachmentWellInitialValue),p=(new a.b(r,e=>e.getMaxClassicAttachmentsSize),new a.b(r,e=>e.getAvailableLocalAttachmentSize)),j=new a.b(r,e=>e.createAttachmentFileFromExistingMailboxAttachment),h=new a.a(r,e=>e.mergeToConversationAttachmentWell),S=new a.a(r,e=>e.sortConversationAttachmentWell),C=new a.a(r,e=>e.convertImageViewAttachmentToInlineAttachment),w=new a.b(r,e=>e.getLastCloudyAttachmentsSharingIssueForBlockOnSend),P=new a.b(r,e=>e.getAllValidAttachments),A=new a.b(r,e=>e.uploadLocalFile)},1974:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(266);function o(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(a.a)(e)}}},2046:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("ON_ATTACHMENT_CREATED",(e,t,n,a=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:a}))},2047:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("ON_ATTACHMENT_DELETED",(e,t,n,a=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:a}))},2125:function(e,t,n){"use strict";var a=n(1754);function o(){const e=Object(a.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(1974),r=n(1822);function c(){return o()}function s(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(r.a)(e)}(e))}(e)?o():[]).map(i.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}))},2130:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(3),o=n(3415);const i=Object(a.createStore)("protection",Object(o.a)()),r=i()},2318:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));const a={};function o(e,t){var n;const o=e.infoBarHostKey;return null===(n=a[o])||void 0===n?void 0:n[t]}},2324:function(e,t,n){"use strict";var a=n(20);const o=[0,1];var i=n(2449),r=n(2415),c=n(5),s=n(266),u=n(1788);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(r.a),messageParts:[Object(c.b)(r.a),l()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(i.b),messageParts:[Object(c.b)(i.b),l()],color:u.a.Red};default:return Object(s.a)(e)}}function l(){return{text:Object(c.b)(i.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2125),m=n(1974),b=n(44),g=n(1754);function I(){const e=Object(g.a)();if(Object(b.j)("fwk-devTools")){if(Object(b.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(b.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){const e=I();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return p})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return m.a})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return I}));const v=new a.c(()=>n.e(2036).then(n.bind(null,18919))),p=new a.b(v,e=>e.getAccessIssuesForAttachments)},2334:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return r})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"n",(function(){return g})),n.d(t,"r",(function(){return I})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return v})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return j})),n.d(t,"i",(function(){return h})),n.d(t,"a",(function(){return S}));var a=n(20);const o=new a.c(()=>Promise.all([n.e(0),n.e(9),n.e(10),n.e(12),n.e(13),n.e(17),n.e(20),n.e(24),n.e(25),n.e(26),n.e(47),n.e(50),n.e(54),n.e(103),n.e(339),n.e(500)]).then(n.bind(null,4099))),i=new a.a(o,e=>e.onSmimeItemAttachmentOpened),r=new a.a(o,e=>e.mergeSmimeDecodedMessageProperties),c=(new a.b(o,e=>e.fetchAndDecodeSmimeMessage),new a.b(o,e=>e.setSmimePropertiesInDraftMessage)),s=new a.b(o,e=>e.trySetSmimeProperties),u=new a.b(o,e=>e.tryAddSmimeProperties),d=new a.b(o,e=>e.createMailResponseBodyContent),l=new a.b(o,e=>e.downloadSmimeAttachment),f=new a.b(o,e=>e.getMergedSmimeViewState),m=new a.b(o,e=>e.getMergedSmimeViewStateForDraft),b=new a.b(o,e=>e.isSmimeItemDecoding),g=new a.b(o,e=>e.previewSmimeAttachment),I=new a.b(o,e=>e.updateSmimeAttachmentIds),O=new a.b(o,e=>e.createSmimeAttachmentsFromFiles),v=new a.b(o,e=>e.createSmimeAttachmentsViaSmimeQueueManager),p=new a.b(o,e=>e.initializeAttachmentStateForSmimeAttachments),j=new a.b(o,e=>e.getAttachmentsForSmimeResponse),h=new a.b(o,e=>e.getSmimeAttachmentsForRequest),S=Object(a.d)(o,e=>e.SignatureDetails)},2415:function(e){e.exports=JSON.parse('{"a":"kca"}')},2449:function(e){e.exports=JSON.parse('{"a":"eca","b":"fca"}')},2614:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var a=n(3);const o=Object(a.createStore)("SmimeStore",{installationStatus:0,isBrowserSupportActiveX:!1,version:""}),i=o();t.a=i},2653:function(e,t,n){"use strict";n.d(t,"n",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return I})),n.d(t,"g",(function(){return O})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"l",(function(){return S})),n.d(t,"b",(function(){return C}));var a=n(3108),o=n(96),i=n(1897),r=n(2023),c=n(2687),s=n(121);function u(){return Object(o.d)()||Object(o.e)()}function d(e){return function(e){if(e.length<2)return!1;const t=e[0]-parseInt(i.b),n=e[1]-parseInt(i.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map(e=>parseInt(e)):[])}function l(e){const t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=i.b}function f(){return Object(a.a)()&&Object(s.a)("smimeExtension")}function m(e){return 0!==e}function b(e){const t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);const n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function g(e){let t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function I(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function O(e,t){const n=Object(c.a)().ClearSign;return t||e&&!n?r.a:i.e}function v(e){return btoa(unescape(encodeURIComponent(e)))}function p(e,t){const n=Object(c.a)();return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function j(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function h(e){return i.k+(e||j()+j()+j()+j())}function S(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function C(){return i.d+j()+"@"+j()+"."+j()}},2687:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(57);function o(){var e;return null===(e=a.a.userConfiguration)||void 0===e?void 0:e.SmimeAdminSettings}},2690:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(797),o=n(246),i=n(929),r=n(266);function c(e,t=0,n,c){const l=function(e){switch(e){case 0:return s;case 1:return u;case 2:return d;default:return Object(r.a)(e)}}(t),f=Object(i.c)();for(const t of Object(o.a)().tabs)if(t.type==a.a.MailCompose&&0==t.state){const a=f.viewStates.get(t.data);if((null==a?void 0:a.isInlineCompose)&&l(a,e)&&(0==a.asyncSendState||n&&6==a.asyncSendState)&&(!c&&!t.projectionRPTabId||t.projectionRPTabId==c))return a}return null}function s(e,t){return e.conversationId===t}function u(e,t){return e.referenceItemId.Id===t}function d(e,t){return!1}},2760:function(e,t,n){"use strict";function a(e,t,n,a){const i=o(e,t,n,a);return i?i.Value:null}function o(e,t,n,a){if(!e||!e.ExtendedProperty)return null;for(let o=0;o<e.ExtendedProperty.length;o++){const i=e.ExtendedProperty[o];let r=null,c=null,s=null;if((null==i?void 0:i.ExtendedFieldURI)&&(r=i.ExtendedFieldURI.PropertyTag,c=i.ExtendedFieldURI.PropertyName,s=i.ExtendedFieldURI.PropertyId),t&&r==t)return i;if(n&&c==n)return i;if(a&&s==a)return i}return null}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}))},2803:function(e,t,n){"use strict";var a=n(44),o=n(2130),i=n(283);t.a=function(){const{clpLabels:e}=o.b;return Object(a.j)("cmp-clp")&&e.length>0&&e.some(e=>e.isLabelEnabled)&&!Object(i.a)()}},2860:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var a=n(20);const o=new a.c(()=>Promise.all([n.e(4),n.e(8),n.e(9),n.e(10),n.e(12),n.e(13),n.e(17),n.e(324),n.e(549)]).then(n.bind(null,5234))),i=new a.a(o,e=>e.loadCLPUserLabels),r=(new a.a(o,e=>e.addAuditActionToViewState),new a.b(o,e=>e.showJustificationModal)),c=new a.a(o,e=>e.loadItemCLPInfo),s=new a.b(o,e=>e.updateItemCLPInfo),u=new a.b(o,e=>e.logReadCLPLabel),d=new a.b(o,e=>e.triggerCLPAutoLabeling),l=(new a.b(o,e=>e.constructCLPAuditAction),Object(a.d)(o,e=>e.CLPSubjectHeaderLabel)),f=Object(a.d)(o,e=>e.CLPMandatoryLabelModal)},2861:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(20);const o=new a.c(()=>n.e(641).then(n.bind(null,5724))),i=new a.b(o,e=>e.SmimeAdapter)},2895:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2614);function o(){const e=Object(a.b)();return 9==e.installationStatus||6==e.installationStatus}},2931:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(29);function o(){const e=Object(a.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},3108:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(96),o=n(1897);function i(){return Object(a.d)()&&Object(a.m)([o.f])||Object(a.e)()&&Object(a.m)([o.g])}},3171:function(e,t,n){"use strict";n.d(t,"l",(function(){return r})),n.d(t,"m",(function(){return c})),n.d(t,"p",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return I})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return v})),n.d(t,"o",(function(){return p})),n.d(t,"n",(function(){return j}));var a=n(20),o=n(3729);n.d(t,"k",(function(){return o.a}));const i=new a.c(()=>Promise.all([n.e(0),n.e(5),n.e(9),n.e(10),n.e(12),n.e(11),n.e(13),n.e(14),n.e(35),n.e(40),n.e(51),n.e(64),n.e(71),n.e(74),n.e(329),n.e(334),n.e(493)]).then(n.bind(null,8184))),r=new a.a(i,e=>e.addItemToCalendar),c=new a.a(i,e=>e.initializeMeetingRequestViewStateAction),s=new a.a(i,e=>e.removeCancelledMeetingFromCalendar),u=Object(a.d)(i,e=>e.MeetingMessageInfo),d=(Object(a.d)(i,e=>e.MeetingRequestActions),Object(a.d)(i,e=>e.MeetingCancellationAction),Object(a.d)(i,e=>e.MeetingActionButton),Object(a.d)(i,e=>e.MeetingDetailsTime),Object(a.d)(i,e=>e.MeetingDetailsLocation),Object(a.d)(i,e=>e.MeetingRequestInfo)),l=Object(a.d)(i,e=>e.MeetingRequestResponseEditor),f=Object(a.d)(i,e=>e.MeetingDetails),m=Object(a.d)(i,e=>e.MeetingRequestConflicts),b=(Object(a.d)(i,e=>e.EditEventLink),Object(a.d)(i,e=>e.MeetingMessageSummary)),g=Object(a.d)(i,e=>e.PreviewSummary),I=Object(a.d)(i,e=>e.SenderSummary),O=Object(a.d)(i,e=>e.CollapsedMeetingMessage),v=Object(a.d)(i,e=>e.MeetingIcon),p=new a.a(i,e=>e.logMeetingMessageActionForInvite),j=new a.a(i,e=>e.logMeetingMessageActionForEvent)},3415:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(14);function o(){return{clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new a.ObservableMap,messageClassifications:new a.ObservableMap}}},3729:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("deleteMeetingMessage",(e,t)=>({item:e,issueDeleteItemCall:t}))},3730:function(e,t,n){"use strict";function a(e){return Math.min(Math.floor(e/2),24)}n.d(t,"b",(function(){return a})),t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:(e,t,n)=>[n?1:0,!e.isExpanded]},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:(e,t,n)=>[t,n]},PrintItem:{name:"PrintItem",actionSource:(e,t,n)=>t},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:(e,t,n)=>n}}},3894:function(e,t,n){"use strict";t.a=e=>{var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},3895:function(e,t,n){"use strict";t.a=(e,t=!0)=>{const n=t?23:24;return e>=n?n:e}},4020:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return c}));var a=n(1690);function o(e){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function i(e){const t=a.a.conversations.get(e.conversationId.Id);return o(e)||(null==t?void 0:t.canLoadMore)}function r(e,t){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function c(e){if(!o(e))return 0;const{conversationNodeIdsInCollapsedItemsRollUp:t,itemPartsMap:n}=e;let a=t.length;return t.forEach(e=>{const t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(a+=t.oofRollUpViewState.oofReplyNodeIds.length)}),a}},4021:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.TXP=0]="TXP",e[e.CalendarCard=1]="CalendarCard",e[e.MeetingPoll=2]="MeetingPoll",e[e.Voting=3]="Voting",e[e.Yammer=4]="Yammer",e[e.SharePointPage=5]="SharePointPage"}(a||(a={}))},4164:function(e,t,n){"use strict";function a(e,t){return{infoBarIds:t||[],infoBarHostKey:e||"0"}}n.d(t,"a",(function(){return a}))},4334:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.SeeMore=3]="SeeMore"}(a||(a={}))},4678:function(e,t,n){"use strict";var a=n(2648),o=n(6256),i=n(5382),r=n(3730),c=n(8423),s=n(5383),u=n(8424),d=n(1793),l=n(2195),f=n(8425),m=n(8426),b=n(6257),g=n(44),I=n(4164),O=n(8427),v=n(1726),p=n(2860),j=n(9092),h=n(2203),S=n(1690),C=n(2334),w=n(2861),P=n(2614),A=n(5384),R=n(2895),M=n(6750),E=n(6260);var x=e=>{var t;return(null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.ErrorState)||0},y=n(4544),L=n(3894),V=n(1983),N=n(40),k=n(3),F=n(61);const D=(e,t)=>{N.h.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(R.a)());const n=new F.b("RPProcessSmimeItem",{isCore:!0});return C.q.import().then(t=>t(e)).then(()=>{q(e,n,t)}).catch(()=>{q(e,n,t)})};function T(e,t,n,i,r,c){if(e.itemId!=t.Id)return;const s=(null==t?void 0:t.Id)&&Object(S.b)().items.get(t.Id);U(e,t,s,n),s&&(i.addCustomData(Object(f.b)(s,c,r)),p.h.import().then(e=>{e(s)}),Object(b.d)(s)?B(e):(Object(o.a)(e.itemViewState,!1,{item:s}),Object(a.a)(e,s)))}const U=Object(k.mutatorAction)("setReadpingPaneItemState",(e,t,n,a)=>{e.itemViewState=function(e,t){return Object.assign(Object.assign({},Object(I.a)(e.Id,Object(c.a)())),{itemId:e.Id,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,ampViewState:Object(O.a)(t),hasMeetingPoll:Object(m.a)(t),omeMessageState:Object(j.a)(t)})}(t,n),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!n,e.instrumentationContext=a}),B=Object(k.mutatorAction)("setReadpingPaneUnuspportedItem",e=>{e.isUnsupportedItem=!0}),W=(e,t,n,a,o,i)=>a?a(e):h.f.importAndExecute(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(R.a)(),o),_=(e,t,n,a,o)=>{if(Object(V.a)(n)){let i;return w.a.import().then(()=>Object(R.a)()&&Object(M.a)(n)?(i=!0,W(e,t,a,o,null)):n).then(()=>D(e,i))}return Promise.resolve()};function q(e,t,n){const a=Object(S.b)().items.get(null==e?void 0:e.Id);t.addCustomData({smimeInstallationStatus:P.a.installationStatus,smimeType:Object(y.a)(a),numAttachments:z(a),wasReloaded:n}),Object(L.a)(a)?t.end():t.endWithError("ClientError",new Error(x(a).toString()))}function z(e){var t;return null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length}const H=Object(k.mutatorAction)("setItemReadingPaneOnError",e=>{e&&(e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0)});t.a=Object(F.r)(r.a.RPPerfLoadItemReadingPane,(function(e,t,n,a,o){let c=function(e,t,n,a){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(v.b)(),isUnsupportedItem:!1,instrumentationContext:null,extendedCardViewState:null,isReadonly:n}}(e,null==a?void 0:a.isPrint,!!(null==a?void 0:a.isReadOnly),null==a||a.isProjection);(null==a?void 0:a.isProjection)&&Object(u.a)(e.Id),Object(s.c)(),Object(i.a)(c),(null==a?void 0:a.isPrint)?(n&&n(c),c=Object(d.b)().itemPrintPaneViewState):(c=Object(l.a)(e.Id),n&&n(c));const f=Object(F.q)(e=>e.eventName==r.a.RPPerfLoadItemReadingPane.name),m=Object(S.b)().items.get(e.Id),b=!(null==a?void 0:a.isPrint)&&!(null==a?void 0:a.isPreviewPane);Object(g.j)("ring-dogfood")&&b&&Object(F.o)("RPMailStoreItemsCount",{count:Object(S.b)().items.size});const I=Object(M.a)(m),O=Object(V.a)(m);if(O&&m.Smime&&!Object(L.a)(m)&&(m.Smime.ErrorState=0),m&&(m.NormalizedBody&&!I||Object(E.a)(m))){if(O&&!Object(L.a)(m)){return new F.b("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),D(e,!1).then(()=>{var n,o;return null===(o=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===o||o.call(n,"LIRP_SMIME"),T(c,e,t,f,null==a?void 0:a.isPrint,null==a?void 0:a.isPreviewPane)})}return T(c,e,t,f,null==a?void 0:a.isPrint,null==a?void 0:a.isPreviewPane),Promise.resolve()}return new Promise(e=>O&&I&&!Object(A.a)()?w.a.import().then(e):e(void 0)).then(()=>{var n,i;return null===(i=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===i||i.call(n,"LIRP_THEN"),function(e,t,n,a,o,i){return W(t,a,null==o?void 0:o.isPreviewPane,i,null==o?void 0:o.isDiscovery).then(e=>{var r,c;return null===(c=null===(r=null==n?void 0:n.dp)||void 0===r?void 0:r.addCheckpoint)||void 0===c||c.call(r,"LI_THEN"),_(t,a,e,null==o?void 0:o.isPreviewPane,i)}).then(()=>{var i,r;return null===(r=null===(i=null==n?void 0:n.dp)||void 0===i?void 0:i.addCheckpoint)||void 0===r||r.call(i,"LI_SMIME_THEN"),T(e,t,n,a,null==o?void 0:o.isPrint,null==o?void 0:o.isPreviewPane)}).catch(t=>(H(e),Promise.reject(t)))}(c,e,t,f,a,o)})}))},5012:function(e,t,n){"use strict";var a=n(11126),o=n(3730),i=n(8423),r=n(9407),c=n(8425),s=n(8426),u=n(7524),d=n(5410);var l=n(14),f=n(61),m=n(44),b=n(4164),g=n(8427),I=n(1945),O=n(1690);function v(e){const t=I.a.conversationItems.get(e);if(t){const n=function(e){const t={unreadItemCount:0,totalItemCount:0},n=O.a.conversations.get(e);for(const e of n.conversationNodeIds){const n=O.a.conversationNodes.get(e);if(!n){t.totalItemCount=0;break}t.totalItemCount+=n.itemIds.length;for(const e of n.itemIds){const n=O.a.items.get(e);if(!n){t.totalItemCount=0;break}t.unreadItemCount+=n.IsRead?0:1}}return t}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var p=n(1726),j=n(1692),h=n(2203),S=n(2926);n.d(t,"a",(function(){return w}));const C=[];let w=function(e){if(!e||!e.Id)return[null,null];const t=j.u.conversationNodes.get(e.Id),[n,a,o]=Object(S.a)(t);if(!Object(S.c)(n,o,a))return[null,null];const r={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},c=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(n,a,o),u={mailboxInfo:e.mailboxInfo,Id:n.ItemId.Id};var l;return[Object.assign(Object.assign({},Object(b.a)(u.Id,Object(i.a)())),{conversationNodeId:e.Id,itemId:u.Id,isConversationItemPart:!0,isExpanded:c,isLocal:a,isDeleted:o,attachmentWell:null,quotedBodyViewState:r,isFossilizedTextExpanded:c,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,oofRollUpViewState:(l=n.ItemClass,{isOofItem:d.a.test(l),oofReplyNodeIds:[],isOofRollUpExpanded:!1}),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},ampViewState:Object(g.a)(n),hasMeetingPoll:Object(s.a)(n),omeMessageState:null}),n]};t.b=Object(f.r)(o.a.RPPerfLoadConversationReadingPane,(function(e,t,n,i,s){let d,b=Promise.resolve(),g=function(e,t,n,a,o){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:o,itemPartsMap:new l.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(p.b)(),unsupportedItemId:null,instrumentationContext:a,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,extendedCardViewState:null}}(e,n,i,t,s);const I=Object(j.q)(e.Id),O=Object(f.q)(e=>e.eventName==o.a.RPPerfLoadConversationReadingPane.name);if(Object(m.j)("ring-dogfood")){let t=!1;C.includes(e.Id)?t=!0:C.push(e.Id),Object(f.o)("RPCacheStatus",{hasValidConversationCache:I,hasOpened:t,OpenedCount:C.length})}return Object(r.c)(),I&&(d="Valid",j.c.getAndTouch(e.Id),Object(u.a)(e.Id)||(Object(r.a)(g),Object(a.a)(e.Id))),I&&!v(e.Id)||(Object(r.a)(g),d=I?"Stale":"Not",b=h.e.importAndExecute(e,"LoadConversationReadingPane",O)),b.then(()=>{var n,a;null===(a=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===a||a.call(n,"LCRP_POST"),O&&O.addCustomData(Object(c.a)(e.Id,d))})}))},5382:function(e,t,n){"use strict";var a=n(5383),o=n(699);t.a=Object(o.action)("setItemReadingPaneViewState")((function(e){Object(a.a)(e)}))},5383:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(1793),o=n(3),i=n(797),r=n(2606);const c=Object(o.mutatorAction)("addLoadedItemReadingPaneViewState",(function(e){const t=e.itemId,{loadedItemReadingPaneViewStates:n}=Object(a.b)();n.has(t)||n.set(t,e)})),s=Object(o.mutatorAction)("releaseOrphanedLoadedItemViewStates",(function(){const{loadedItemReadingPaneViewStates:e,loadingProjectionIds:t,itemPreviewPaneViewState:n,itemPrintPaneViewState:o}=Object(a.b)();e.forEach((a,c)=>{c==Object(r.a)()||Object(i.r)(c)||-1!=(null==t?void 0:t.indexOf(c))||c==(null==n?void 0:n.itemId)||c==(null==o?void 0:o.itemId)||e.delete(c)})})),u=Object(o.mutatorAction)("releaseLoadedItemViewState",(function(e){Object(a.b)().loadedItemReadingPaneViewStates.delete(e)}))},5384:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2614),o=n(2653);function i(){const e=Object(a.b)();return Object(o.k)(e.installationStatus)}},5410:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=/ipm.note.rules.ooftemplate.microsoft/i},5896:function(e,t,n){"use strict";function a(e,t){return(null==e?void 0:e.extendedCardViewState)&&e.extendedCardViewState.cardType==t}function o(e){var t;return null===(t=null==e?void 0:e.extendedCardViewState)||void 0===t?void 0:t.coverOriginalContent}function i(e,t){return a(e,t)?e.extendedCardViewState.cardViewState:null}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}))},6256:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(9107),o=n(1690),i=n(3171),r=n(2322);async function c(e,t=!1,n={item:o.a.items.get(e.itemId)}){await Object(a.a)(e,n.item,t),n.item&&Object(r.f)(n.item.ItemClass)&&i.m.importAndExecute(e)}},6257:function(e,t,n){"use strict";n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return O}));var a=n(1683),o=n(1690),i=n(1685);const r="IPM.Appointment",c="IPM.Contact",s="IPM.DistList",u="IPM.Task",d="calendar",l="contacts",f="tasks",m="inbox";function b(e){return e&&(v(e.ItemClass)||p(e.ItemClass)||j(e.ItemClass)||h(e.ItemClass))}function g(e){const t=o.a.conversations.get(e),n=o.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){const e=n.itemIds[0];if(b(o.a.items.get(e)))return e}return null}function I(e){const t=o.a.items.get(e);return v(t.ItemClass)?Object(i.a)(d):p(t.ItemClass)||j(t.ItemClass)?Object(i.a)(l):h(t.ItemClass)?Object(i.a)(f):Object(i.a)(m)}function O(e){let t="";const n=a.d.folderTable.get(e);return n&&(t=Object(a.h)(n)),t}function v(e){return 0==e.indexOf(r)}function p(e){return 0==e.indexOf(c)}function j(e){return 0==e.indexOf(s)}function h(e){return 0==e.indexOf(u)}},6258:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1693),o=n(44),i=n(283);function r(){const e=Object(a.g)(a.d.AmpDeveloper);return Object(i.a)()&&Object(o.j)("rp-amp")&&e.enabled}},6259:function(e,t,n){"use strict";var a,o;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),function(e){e[e.None=0]="None",e[e.Revocable=1]="Revocable",e[e.Expirable=2]="Expirable"}(a||(a={})),function(e){e[e.None=0]="None",e[e.SuccessOrNoChange=1]="SuccessOrNoChange",e[e.FailedOrMessageNotFound=2]="FailedOrMessageNotFound",e[e.PartialFailed=3]="PartialFailed"}(o||(o={}))},6260:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1897);function o(e){return(null==e?void 0:e.ItemId)&&0===e.ItemId.Id.indexOf(a.k)}},6750:function(e,t,n){"use strict";var a=n(3045),o=n(3894),i=n(1983),r=n(5384),c=n(2895);var s=()=>!!Object(r.a)()&&!Object(c.a)();t.a=e=>!Object(o.a)(e)&&!s()&&Object(i.a)(e)&&!Object(a.a)(e)},7449:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(40);let o=null;const i={register:e=>{o=e},available:()=>!!o,run:(e,t)=>o?o(e,t):(a.d("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}},7450:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.None="none",e.AmpDisabled="ampDisabled",e.MessageUnsafe="messageUnsafe",e.SenderNotAllowed="sendNotAllowed",e.BrowserNotSupported="browserNotSupported",e.AmpNotValidated="ampNotValidated",e.AmpValidationFailed="ampValidationFailed",e.AmpValidated="ampValidated"}(a||(a={}))},7524:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1793);function o(e){return Object(a.b)().loadedConversationReadingPaneViewStates.has(e)}},8423:function(e,t,n){"use strict";function a(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","nudgeFeedback","infoMessageClassification","infoCLPLabel","infoRevocation","externalMessage","spotlight","spotlightFeedback"]}n.d(t,"a",(function(){return a}))},8424:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(1793),o=n(3);const i=Object(o.mutatorAction)("addLoadingProjectionMutatorId",(function(e){const{loadingProjectionIds:t}=Object(a.b)();t.push(e)})),r=Object(o.mutatorAction)("removeLoadingProjectionMutatorId",(function(e){const{loadingProjectionIds:t}=Object(a.b)();t.remove(e)}))},8425:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m}));var a=n(2931),o=n(1902),i=n(1690),r=n(3895),c=n(2322),s=n(29),u=n(1983);const d="Meeting",l="Message";function f(e,t){let n=0,s=0,u=0,d=0,l=0;const f=Object(o.a)(e);if(f){const e=f.itemPartsMap;e.forEach(e=>{e.isExpanded&&d++;const t=i.a.items.get(e.itemId);t&&(t.IsRead||n++,t.IsDraft&&s++,Object(c.b)(t)&&u++)}),l=e.size}return{owa_1:g(),owa_2:Object(a.a)(),owa_3:Object(r.a)(l),owa_4:Object(r.a)(d),owa_5:Object(r.a)(n),owa_6:Object(r.a)(u),owa_7:Object(r.a)(s),owa_8:t}}function m(e,t,n){return{owa_1:g(),owa_2:b(e),owa_3:t,owa_4:n,owa_5:Object(u.a)(e)}}function b(e){return Object(c.b)(e)?d:l}function g(){return Object(s.a)().UserOptions.GlobalReadingPanePositionReact}},8426:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(5),o=n(44);const i="findtime/vote?getrequesturl=";function r(e){if(!Object(o.j)("cal-mf-meetingPollCard")||!e)return!1;let t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(a.k)(t)&&t.indexOf(i)>-1}},8427:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(9059);function o(e){return{preferAmp:!0,ampAvailability:Object(a.a)(e)}}},8428:function(e,t,n){"use strict";function a(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.EmailAddress:null}n.d(t,"a",(function(){return a}))},8429:function(e,t,n){"use strict";var a=n(3);const o=Object(a.createStore)("ampstore",{allowedSenders:[]});t.a=o()},9059:function(e,t,n){"use strict";var a=n(5);var o=n(8428),i=n(6258),r=n(7450),c=n(8429),s=n(1693);function u(e){if(!function(e){return e&&!Object(a.k)(e.AmpHtmlBody)}(e))return r.a.None;if(!Object(i.a)())return r.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return r.a.MessageUnsafe;const t=Object(o.a)(e);return null==t||!function(e){const t=Object(s.g)(s.d.AmpDeveloper);return t.enabled&&t.allowedSender.some(t=>d(t,e))}(t)&&!function(e){return c.a.allowedSenders&&c.a.allowedSenders.some(t=>d(t,e))}(t)?r.a.SenderNotAllowed:r.a.AmpNotValidated}function d(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",(function(){return u}))},9092:function(e,t,n){"use strict";var a=n(6259),o=n(7);var i=n(2760),r=n(1685);n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));const c="x-ms-exchange-organization-ome-messagestate",s="sentitems";function u(e){if((null==e?void 0:e.ParentFolderId)&&e.ParentFolderId.Id!==Object(r.a)(s))return null;return function(e){if(e){let t={permissions:a.b.None,revoked:!1,expired:!1,revocationDate:null,revokedBy:null,responseState:a.a.None};try{const n=JSON.parse(e);if(1==n.Permissions&&(t.permissions=a.b.Revocable),2==n.Permissions&&(t.permissions=a.b.Expirable),t.revoked=n.IsRevoked,t.expired=n.IsExpired,n.RevocationDate){const e=Object(o.Vb)("UTC",n.RevocationDate);t.revocationDate=new Date(Object(o.Cb)(e))}t.revokedBy=n.RevokedBy}catch(e){return null}return t}return null}(Object(i.a)(e,null,c))}},9107:function(e,t,n){"use strict";var a=n(2324),o=n(1910),i=n(3045),r=n(3894),c=n(1983),s=n(3),u=n(1902),d=n(1690),l=n(7449);function f(e,t){var n;const a=d.a.items.get(t);if(a){const t=a.InternetMessageId,o=null===(n=Object(u.a)(e))||void 0===n?void 0:n.itemPartsMap.get(t);return o?o.attachmentWell:null}return null}var m=n(1866);async function b(e,t,n=!1){if(!t||Object(c.a)(t)&&!function(e,t){if(!Object(i.a)(t))return!0;if(!e.isConversationItemPart&&Object(r.a)(t))return!0;return!1}(e,t)||!t.Attachments)return;if(!e.attachmentWell){const t=await o.j.import();g(e,t(!0,!1,""))}l.a.register(f),n?await o.q.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,null,null,!!t.RightsManagementLicenseData,Object(c.a)(t),I(t.ItemClass)):await o.n.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1,null,null,!!t.RightsManagementLicenseData,Object(c.a)(t),I(t.ItemClass)),(await a.g.import())(t.Attachments).forEach(t=>Object(m.a)(e,t))}n.d(t,"a",(function(){return b}));const g=Object(s.mutatorAction)("setAttachmentWellForItem",(e,t)=>{e.attachmentWell=t});function I(e){switch(e){case"IPM.Note.rpmsg.Microsoft.Voicemail.UM.CA":case"IPM.Note.rpmsg.Microsoft.Voicemail.UM":return!0;default:return!1}}},9407:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(1793),o=n(3),i=n(797),r=n(2606);const c=Object(o.mutatorAction)("addLoadedConversationReadingPaneViewState",(function(e){const t=e.conversationId.Id,{loadedConversationReadingPaneViewStates:n}=Object(a.b)();n.has(t)||n.set(t,e)})),s=Object(o.mutatorAction)("releaseOrphanedLoadedConversationViewStates",(function(){const{loadedConversationReadingPaneViewStates:e}=Object(a.b)();e.forEach((t,n)=>{Object(i.r)(n)||n==Object(r.a)()||e.delete(n)})})),u=Object(o.mutatorAction)("releaseLoadedConversationViewState",(function(e){Object(a.b)().loadedConversationReadingPaneViewStates.delete(e)}))},9408:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("initializeExtendedCardForConversationReadingPane",(e,t)=>({conversationViewState:e,loadedItemParts:t}))},9409:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("tryInitializeShouldShowCLPLabel",e=>({conversationViewState:e}))},9410:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(11542);function o(e,t){const n=t?t.Value:"",o=Object(a.a)(e);return o||n}}}]);
//# sourceMappingURL=owa.157.js.map
self.scriptsLoaded['owa.157.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.157.js'] = (new Date()).getTime();