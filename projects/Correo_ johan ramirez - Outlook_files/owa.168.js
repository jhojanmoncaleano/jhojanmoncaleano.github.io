self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.168.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[168],{1682:function(e,t,n){"use strict";var r=n(1821),i=n(1784),o=n(3);const c=Object(o.action)("INITIALIZE_SCENARIO_STORE",(e,t)=>({scenarioId:e,isUsing3S:t}));Object(o.mutator)(c,e=>{const t=Object(r.a)(e.scenarioId);Object(i.b)().scenarioStores.get(t)||(Object(i.b)().scenarioStores.set(t,Object.assign({},Object(i.a)())),Object(i.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)});var a=n(1842),u=n(1966);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return r.a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u.a}))},1691:function(e,t,n){"use strict";var r=n(3);const i=Object(r.action)("ADD_SUGGESTION_PILL",(e,t,n)=>({suggestionPill:e,suggestionSelected:t,scenarioId:n})),o=Object(r.action)("ADD_SUGGESTION_PILL_INTERNAL",(e,t)=>({suggestionPill:e,scenarioId:t})),c=Object(r.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",(e,t,n)=>({indexToSelect:e,suggestionToSelect:t,scenarioId:n}));var a=n(2068);const u=Object(r.action)("DOWNLOAD_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n})),s=Object(r.action)("END_SEARCH_CONVERSATION",e=>({scenarioId:e}));var d=n(2069);const l=Object(r.action)("EXIT_SEARCH",(e,t,n=!1)=>({actionSource:e,scenarioId:t,forceExit:n})),f=Object(r.action)("GET_FILE_SUGGESTION_IMMERSIVE_VIEW",e=>({suggestion:e}));var S=n(1956),m=n(1682);const g=Object(r.mutatorAction)("OVERWRITE_EXISTING_SUGGESTION_PILL",(e,t,n)=>{const r=Object(m.d)(n),i=e.ReferenceId;r.suggestionPills.delete(t),r.suggestionPills.set(i,e);const o=r.suggestionPillIds.indexOf(t);r.suggestionPillIds[o]=i});var I=n(2070),b=n(2071);const O=Object(r.action)("ON_ENTER_PRESSED_SEARCH_INPUT",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t})),h=Object(r.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",e=>({scenarioId:e})),p=Object(r.action)("ON_KEY_DOWN_SEARCH_INPUT",(e,t)=>({evtKeyCode:e,scenarioId:t}));var E=n(2072);const T=Object(r.action)("ON_RESIZE_SUGGESTIONSCALLOUT",(e,t)=>({searchBoxWidth:e,scenarioId:t})),_=Object(r.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}));var y=n(71);const j=Object(r.action)("ON_SEARCH_INPUT_FOCUSED",e=>Object(y.b)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e}));var v=n(2096),P=n(2097);const C=Object(r.action)("onSearchScopeUiDismissed",e=>({searchScenarioType:e})),w=Object(r.action)("ON_SEARCH_TEXT_CHANGED",(e,t)=>({searchText:e,scenarioId:t})),R=Object(r.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",e=>({scenarioId:e})),D=Object(r.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",e=>({scenarioId:e}));var A=n(2073);const N=Object(r.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",(e,t)=>({scenarioId:e,callback:t}));var k=n(2074);const L=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",(e,t,n)=>({suggestionPillId:e,suggestionPillIndex:t,scenarioId:n})),M=Object(r.action)("RESET_CURRENT_SUGGESTIONS",e=>({scenarioId:e}));var U=n(2033);const x=Object(r.action)("SEARCH_BOX_BLURRED",e=>({scenarioId:e})),F=Object(r.action)("SEARCH_SESSION_ENDED",(e,t,n,r)=>({searchSessionGuid:e,scenarioId:t,latestTraceId:n,actionSource:r}));var G=n(1921);const H=Object(r.action)("SET_CURRENT_SUGGESTIONS",(e,t,n=null)=>({suggestionSet:e,scenarioId:t,qfRequestId:n})),B=Object(r.action)("SET_DISPLAYED_QF_REQUEST_TIME",(e,t)=>({displayedQFRequestTime:e,scenarioId:t}));var q=n(2075);const z=Object(r.action)("SET_LATEST_TRACE_ID",(e,t,n)=>({latestTraceId:e,scenarioId:t,isQFTraceId:n})),$=Object(r.action)("SET_SEARCH_TEXT",(e,t)=>({searchText:e,scenarioId:t})),V=Object(r.action)("SET_SELECTED_PILL_INDEX",(e,t)=>({selectedPillIndex:e,scenarioId:t})),W=Object(r.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",(e,t)=>({searchTextForSuggestion:e,scenarioId:t})),K=Object(r.action)("SET_SELECTED_SUGGESTION_INDEX",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t}));var Q=n(2076);const X=Object(r.action)("SET_SUGGESTION_PILL_IDS",(e,t)=>({suggestionPillIds:e,scenarioId:t})),Y=Object(r.action)("SET_SUGGESTION_PILLS",(e,t)=>({suggestionPills:e,scenarioId:t})),Z=Object(r.action)("SHARE_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n}));var J=n(1919);const ee=Object(r.action)("START_SEARCH_SESSION",(e,t,n)=>({actionSource:e,shouldStartSearch:t,scenarioId:n})),te=Object(r.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",(e,t,n,r,i,o)=>({suggestion:e,suggestionIndex:t,actionSource:n,scenarioId:r,suggestionSetTraceId:i,entityActionTakenType:o})),ne=Object(r.action)("SUGGESTION_SELECTED",(e,t,n,r,i)=>({suggestion:e,actionSource:t,scenarioId:n,suggestionSetTraceId:r,index:i}));var re=n(2077);const ie=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",(e,t)=>({isComplete:e,scenarioId:t})),oe=Object(r.action)("COMPLETE_GHOST_TEXT",(e,t)=>({scenarioId:e,evt:t})),ce=Object(r.action)("CLEAR_GHOST_TEXT",e=>({scenarioId:e})),ae=Object(r.action)("SET_GHOST_TEXT",(e,t)=>({scenarioId:e,ghostText:t}));var ue=n(1707);n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return a.a})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d.a})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return S.a})),n.d(t,"L",(function(){return g})),n.d(t,"v",(function(){return I.a})),n.d(t,"w",(function(){return b.a})),n.d(t,"x",(function(){return O})),n.d(t,"y",(function(){return h})),n.d(t,"z",(function(){return p})),n.d(t,"A",(function(){return E.a})),n.d(t,"B",(function(){return T})),n.d(t,"C",(function(){return _})),n.d(t,"D",(function(){return j})),n.d(t,"E",(function(){return v.a})),n.d(t,"F",(function(){return P.a})),n.d(t,"G",(function(){return C})),n.d(t,"H",(function(){return w})),n.d(t,"I",(function(){return R})),n.d(t,"J",(function(){return D})),n.d(t,"K",(function(){return A.a})),n.d(t,"M",(function(){return N})),n.d(t,"N",(function(){return k.a})),n.d(t,"O",(function(){return L})),n.d(t,"P",(function(){return M})),n.d(t,"Q",(function(){return U.a})),n.d(t,"R",(function(){return x})),n.d(t,"S",(function(){return F})),n.d(t,"T",(function(){return G.a})),n.d(t,"U",(function(){return H})),n.d(t,"V",(function(){return B})),n.d(t,"X",(function(){return q.a})),n.d(t,"Y",(function(){return z})),n.d(t,"Z",(function(){return $})),n.d(t,"bb",(function(){return V})),n.d(t,"ab",(function(){return W})),n.d(t,"cb",(function(){return K})),n.d(t,"db",(function(){return Q.a})),n.d(t,"eb",(function(){return X})),n.d(t,"fb",(function(){return Y})),n.d(t,"gb",(function(){return Z})),n.d(t,"hb",(function(){return J.a})),n.d(t,"ib",(function(){return ee})),n.d(t,"jb",(function(){return te})),n.d(t,"kb",(function(){return ne})),n.d(t,"lb",(function(){return re.a})),n.d(t,"mb",(function(){return ie})),n.d(t,"f",(function(){return oe})),n.d(t,"d",(function(){return ce})),n.d(t,"W",(function(){return ae})),n.d(t,"m",(function(){return ue.a})),n.d(t,"n",(function(){return ue.b})),n.d(t,"o",(function(){return ue.c})),n.d(t,"p",(function(){return ue.d})),n.d(t,"q",(function(){return ue.e})),n.d(t,"r",(function(){return ue.f})),n.d(t,"s",(function(){return ue.g})),n.d(t,"t",(function(){return ue.h})),n.d(t,"u",(function(){return ue.j}))},1867:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function i(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},1891:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(o||(o={}))},1892:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return c})),n.d(t,"v",(function(){return a})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return S})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return I})),n.d(t,"f",(function(){return b})),n.d(t,"k",(function(){return O})),n.d(t,"m",(function(){return h})),n.d(t,"p",(function(){return p})),n.d(t,"q",(function(){return E})),n.d(t,"n",(function(){return T})),n.d(t,"u",(function(){return _})),n.d(t,"a",(function(){return y})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return v}));var r=n(20);const i=new r.c(()=>n.e(1204).then(n.bind(null,2783)));let o=new r.a(i,e=>e.logEntityClicked);const c=new r.a(i,e=>e.logResponseReceived);let a=new r.a(i,e=>e.logSessionEnd),u=new r.a(i,e=>e.logResponseRendered);const s=new r.a(i,e=>e.logSearchBoxStateChanged);let d=new r.a(i,e=>e.logSearchResultInteraction),l=new r.a(i,e=>e.logResponseNeverRendered);const f=new r.a(i,e=>e.flushNonRenderedResponseReceivedItemsFromCache),S=new r.a(i,e=>e.logCachedContentRendered);let m=new r.a(i,e=>e.logFeedback);const g=new r.a(i,e=>e.logClientLayout),I=new r.a(i,e=>e.logClientDataSource),b=new r.a(i,e=>e.logEntitiesFromFilePicker),O=new r.a(i,e=>e.logResponseRecievedV2),h=new r.a(i,e=>e.logResultsRendered),p=new r.a(i,e=>e.logSearchEntityActions),E=new r.a(i,e=>e.logSearchFeedbackActions),T=new r.a(i,e=>e.logSearchActions);let _=new r.a(i,e=>e.logSecondaryEntityActionClicked);const y=new r.a(i,e=>e.clearProcessedTraceIds),j=new r.a(i,e=>e.logSearchSuggestionsClientLayoutEvent),v=new r.a(i,e=>e.logSearchSuggestionsResultsRenderedEvent)},1930:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},1946:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return a}))},1958:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2033:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("RESET_SEARCH_STORE",e=>({scenarioId:e}))},2050:function(e,t,n){"use strict";var r=n(1825),i=n(598);function o(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var a=n(1958),u=n(1703);var s=n(1685),d=n(1946),l=n(1688),f=n(1965);n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return T}));const S={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(d.b)({folderId:Object(s.a)(l.k),kind:"PrimaryMailbox"}));const t=Object(f.b)("UserMailbox");for(let n of t)e.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),[(o={FolderScope:c({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},o))];var o}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(d.a)({folderId:Object(s.a)(l.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(s.a)(l.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(a={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},a))]:[o({FolderScope:c({BaseFolderId:n})})];var a}},g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},I={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(a.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},b={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},O={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},h=e=>{switch(e.kind){case"PrimaryMailbox":return S;case"ArchiveMailbox":return m;case"SharedFolders":return g;case"Group":return I;case"Calendar":return b;case"PublicFolder":return O;default:throw new Error("Unregistered search scope")}},p=e=>h(e).getKey(e),E=e=>h(e).getSearchScopeList(),T=e=>h(e).getSearchScopeType(e)},2068:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("CLEAR_SEARCH_BOX",e=>({scenarioId:e}))},2069:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("END_SEARCH_SESSION",(e,t)=>({scenarioId:e,actionSource:t}))},2070:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2071:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2072:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2073:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2074:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",(e,t,n)=>({suggestionPillId:e,scenarioId:t,actionSource:n}))},2075:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",(e,t)=>({isSuggestionsDropdownVisible:e,scenarioId:t}))},2076:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("setShowSearchBoxInCompactMode",(function(e,t){return{scenarioId:e,showSearchBoxInCompactMode:t}}))},2077:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",(e,t)=>({isComplete:e,scenarioId:t}))},2096:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),i=n(71);const o=Object(r.action)("onSearchScopeButtonClicked",(e,t)=>Object(i.b)({name:"Search_ScopeButtonClicked",customData:{isFolderScopeVisible:e,searchScenarioType:t}},{isScopeVisible:e,searchScenarioType:t}))},2097:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("onSearchScopeOptionSelected",(e,t)=>({selectedSearchScope:e,searchScenarioType:t}))},2145:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(0),n.e(34),n.e(783)]).then(n.bind(null,3288)));let o=new r.a(i,e=>e.logLocalContentDataSource),c=new r.a(i,e=>e.logLocalContentLayout),a=new r.a(i,e=>e.clearLocalContentInstrumentationCache),u=new r.b(i,e=>e.getLocalContentId);const s=new r.b(i,e=>e.substrateSearchInitOperation),d=(new r.b(i,e=>e.substrateSearchPostSuggestionsService),new r.b(i,e=>e.deleteSubstrateSearchHistoryService)),l=new r.b(i,e=>e.exportSubstrateSearchHistoryService)},2225:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2050);function i(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},2611:function(e,t,n){"use strict";var r=n(1682),i=n(3);t.a=Object(i.mutatorAction)("setNextSearchQueryId",(e,t)=>{Object(r.d)(t).nextSearchQueryId=e})},3178:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(e,t)=>({jsEndToEndTime:e,jsRenderingTime:t}))},3954:function(e,t,n){"use strict";var r=n(3178),i=n(20);const o=new i.c(()=>Promise.all([n.e(17),n.e(21),n.e(23),n.e(62),n.e(78),n.e(138),n.e(158),n.e(982)]).then(n.bind(null,19595))),c=new i.b(o,e=>e.addSearchRequestInstrumentation),a=new i.b(o,e=>e.addResourceTimingEntry),u=new i.b(o,e=>e.searchDiagnostics),s=()=>{const e=u.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return a}))},5114:function(e,t,n){"use strict";var r=n(3),i=n(1682);t.a=Object(r.mutatorAction)("setCurrentSearchQueryId",(e,t)=>{Object(i.d)(t).currentSearchQueryId=e})},5719:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"AttachmentItemsPagingDetails:#Exchange"},e)}var i=n(1876),o=n(32);function c(e){return Object.assign({__type:"SearchAttachmentDataProviderItemsRequest:#Exchange"},e)}var a=n(40);function u(e,t,n,r){return e?n(e):(a.h.warn(null==t?void 0:t.statusText),404===(null==t?void 0:t.status)?r(4):401===(null==t?void 0:t.status)||403===(null==t?void 0:t.status)?r(2):r(1))}const s=Object.freeze({SortColumn:2,SortOrder:1}),d="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",l="GDriveDataProviderItem:#Exchange",f="FacebookDataProviderItem:#Exchange",S="FileAttachmentDataProviderItem:#Exchange",m="FolderAttachmentDataProviderItem:#Exchange",g="OneDriveProScope:#Exchange",I="OneDriveItemSkipTokenPagingMetadata:#Client",b="OneDriveConsumerScope:#Exchange",O="oneNote",h="application/onenote";var p=n(2781);function E(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map(e=>t(e))}}function T(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}const _="application/vnd.google-apps.folder";function y(e){return{__type:l,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===_?1:0}}function j(e){return Object.assign(Object.assign({},E(e.files,y)),{NextPageToken:e.nextPageToken})}function v(e){return Object.assign(Object.assign({},T(e)),{NextPageToken:null})}async function P(e,t=!1){const{errorResponse:n,result:r}=await Object(p.m)(e,t);return r?u(r,null,j,v):u(null,n,j,v)}var C=n(5114),w=n(2611);function R(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function D(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:R(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}const A=e=>E(e,D);var N=n(311),k=n(245),L=n(1691),M=n(1682),U=n(3954),x=n(1835),F=n(1892);const G=200;async function H(e){if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");const t=Object(M.d)(M.a.FilesPicker);Object(C.a)(t.nextSearchQueryId,M.a.FilesPicker),Object(w.a)(Object(N.a)(),M.a.FilesPicker);const n=Object(k.b)(),r={Cvid:Object(N.a)(),Scenario:{Name:x.c.MailEmailAttachmentPicker},TimeZone:Object(x.B)(n),TextDecorations:"Off",EntityRequests:B(e)},i=new Date,o=await Object(x.K)(r,t.searchSessionGuid);if(!o||2!=o.length){return a.h.warn("3S Response for search mail messages failed"),u(null,{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null},A,T)}const c=o[0].status==G,s=c?null:o[0].statusText,d=function(e,t,n,r,i,o,c){if(!e||2!=e.length)return null;const a=Object(x.f)(e[0],t,n,"SubstrateSearch",r,new Date,i.currentSearchQueryId,new Headers(e[1]),0,x.c.MailEmailAttachmentPicker);return a.ClientJSPreRequestTime=o,a.ClientJSRequestThreadTime=c,Object(L.Y)(a.SearchTraceID,M.a.FilesPicker,!1),U.d.import().then(e=>e(a)),F.j.importAndExecute(a.SearchTraceID,a.ClientNetworkTime,a.ClientHttpStatus,new Date),a}(o,e,s,i,t,0,0);if(c){const e=await o[0].json(),t=function(e,t){if(e&&e.Results&&0!==e.Results.length){const n=[],r=e.Results;for(const e of r){const r=Object(x.n)(e.Source,t);r.InstanceKey=e.ReferenceId,n.push(r)}return n}return[]}(Object(x.y)(e),r);return F.l.importAndExecute(d.SearchTraceID,new Date,x.c.MailEmailAttachmentPicker),u(t,null,A,T)}{a.h.warn(`3S Response for search mail messages failed with ${s}`);const e={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:s,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null};return F.i.importAndExecute(d.SearchTraceID,x.c.MailEmailAttachmentPicker),u(null,e,A,T)}}function B(e){return[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:e},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}]}function q(e,t,n,a,u,l=null,f){if(5===e)return async function(e,t=""){let n=`${d}&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '${e}'`;return t&&(n=`${n} and '${t}' in parents`),P(n)}(n,u);if(10===e)return H(n);const S=c({AttachmentDataProviderId:t,Query:n,Paging:r({Sort:f||(m=s,Object.assign({__type:"AttachmentItemsSort:#Exchange"},m)),FolderId:a,Location:u,RequestedData:Object(i.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:l})});var m,g,I;return void 0===(g={request:S}).request||g.request.__type||(g.request=c(g.request)),Object(o.a)("SearchAttachmentDataProviderItems",g,I)}var z=n(61),$=n(3909),V=n(44),W=n(5);function K(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"GetAttachmentDataProviderItemsRequest:#Exchange"},n))),Object(o.a)("GetAttachmentDataProviderItems",e,t)}var Q=n(3949);function X(e){return null!==e&&e.__type===g}function Y(e){return e&&e.__type===I}function Z(e,t){return 1===e&&t&&function(e){return null!==e&&e.__type===b}(t)?t.Type:null}function J(e,t){return 0===e&&t&&X(t)?t.Type:null}async function ee(e,t){const n=[e];try{const r=await Object(Q.c)(e,!1,t);return!Object(W.k)(r)||(Object(z.o)("FPAccessTokenUnavailable",n),!1)}catch(e){return Object(z.o)("FPAccessTokenUnavailable",n),!1}}async function te(e,t,n){switch(e){case 3:case 2:case 6:return ee(e,void 0);case 5:case 10:return!0;case 0:return(0===J(e,n)||4===J(e,n))&&ee(e,t);case 1:return 4===Z(e,n)||Object(V.j)("doc-odcgetitems");default:return!1}}function ne(e){return e.__type===m||1===e.Type}function re(e){const t=e.filter(ne),n=e.filter(e=>!ne(e));return t.concat(n)}var ie=n(266);function oe(e,t,n){let r=null,i=null;switch(e){case"asc":[r,i]=[t,n];break;case"desc":[r,i]=[n,t];break;default:Object(ie.a)(e)}return r<i?-1:r>i?1:0}function ce(e,t,n){switch(t){case 2:e.sort((e,t)=>{const r=e.Modified,i=t.Modified,o=r?new Date(r):new Date(0),c=i?new Date(i):new Date(0);return oe(0===n?"asc":"desc",o,c)});break;case 1:e.sort((e,t)=>{const r=e.Size||0,i=t.Size||0;return 0===n?r-i:i-r});break;default:e.sort((e,t)=>{const r=e.Name.toLowerCase(),i=t.Name.toLowerCase();return oe(0===n?"asc":"desc",r,i)})}}function ae(e){return{__type:Object(p.s)(e)?m:S,Id:e.id,AttachmentProviderId:null,Location:`${t=e.path_collection,`/${(t.entries||[]).map(e=>e.name).join("/")}`}/${e.name}`,Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(p.s)(e)?1:0};var t}const ue=e=>E(e,ae);function se(e){return{__type:Object(p.v)(e)?m:S,Id:Object(p.t)(e)?null:e.id,AttachmentProviderId:null,Location:Object(p.t)(e)?"":e.path_lower,Modified:Object(p.u)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(p.u)(e)?e.size:0,Type:Object(p.v)(e)?1:0}}const de=e=>E(e,se);function le(e){return Object.assign({__type:"AttachmentThumbnailInfo:#Exchange"},e)}const fe=150,Se=200;function me(e){const t=function(e){const[t]=[...e].reverse().filter(e=>e.width>=Se&&e.height>=fe);return t||e[0]}(e.images);return le({Url:t.source,Height:t.height,Width:t.width})}function ge(e){const t=me(e),n=e.images[0],r=le({Url:n.source,Height:n.height,Width:n.width});return{__type:f,Id:e.id,Name:`Photo ${e.id}.jpg`,AttachmentProviderId:null,ProviderType:6,Location:n.source,DownloadUrl:`${n.source}&dl=1`,Thumbnail:t,Preview:r,From:e.from?e.from.name:null,PlaceName:e.place?e.place.name:null,AlbumName:e.album?e.album.name:null,CreatedTime:e.created_time||null,PostUrl:e.link,Type:0}}const Ie=e=>E(e,ge);function be(e){return e?function(e){switch(e){case 1:return p.c.Uploaded;case 0:return p.c.Tagged;default:return Object(ie.a)(e)}}(e.Type):p.c.Tagged}function Oe(e){return e.file?e.file.mimeType:e.package&&e.package.type===O?h:null}function he(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function pe(e,t){return 1===t?e.parentReference?`${e.parentReference.path}/${e.name}`:null:e.webDavUrl}function Ee(e,t,n,r,i,o){let c=void 0;if(i)switch(r){case 0:c=Te(e,i,o);break;case 1:if(Object(V.j)("doc-odcgetitems")){c=Te(e,i,o);break}throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(ie.a)(r)}let a=e.length;return i&&c?a=c.totalItemsFetched+1:c&&(a=c.totalItemsFetched),{TotalItemCount:a,ResultCode:0,Items:e.map(e=>(function(e,t,n,r){var i,o,c;const[a,u,s,d,l]=e.folder?[m,null,e.folder.childCount,1,0]:[S,Oe(e),0,0,e.size];return{__type:a,Id:e.id,Name:e.name,Size:l,Thumbnail:{Url:(null===(o=null===(i=e.thumbnails)||void 0===i?void 0:i[0])||void 0===o?void 0:o.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(c=e.lastModifiedBy)||void 0===c?void 0:c.user)?e.lastModifiedBy.user.displayName:null,MimeType:u,Location:pe(e,r),ProviderEndpointUrl:t,ChildCount:s,AttachmentProviderId:n,ProviderType:r,Type:d}})(e,t,n,r)),PagingMetadata:c}}function Te(e,t,n){const r=n?n.totalItemsFetched+e.length:e.length;return i={skipToken:t,totalItemsFetched:r},Object.assign(Object.assign({},i),{__type:"OneDriveItemSkipTokenPagingMetadata:#Client"});var i}async function _e(e,t,n,r,i,o,c,a=null){const s=a?{maxEntries:a.maxEntries,skipToken:a.metadata?a.metadata.skipToken:null}:null,{errorResponse:d,result:{items:l,skipToken:f}}=await Object(p.o)(t,n,i,o,c,void 0,s);return function(e,t,n,r,i,o,c){return t?u(t,null,e=>Ee(e,n,r,i,o,c),he):u(null,e,e=>Ee(e,n,r,i,o,c),he)}(d,l,e,r,n,f,a?a.metadata:null)}const ye="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";var je=n(1699),ve=n(283);async function Pe(e,t,n,r=!1){const{errorResponse:i,result:o}=await Object(p.p)(e,n,r);return o?u(o.value,null,r=>Ce(r,e,t,n),he):u(null,i,r=>Ce(r,e,t,n),he)}function Ce(e,t,n,r){const i=function(e,t,n,r){const i=[];return e.forEach(e=>{const o=function(e,t,n,r){var i,o,c;if(!Object(ve.a)()&&".fluid"===Object(je.a)(e.name))return null;return{__type:S,Id:e.remoteItem.id?e.remoteItem.id:e.id,Name:e.name,Size:e.remoteItem.size,Modified:null===(i=e.remoteItem.fileSystemInfo)||void 0===i?void 0:i.lastAccessedDateTime,ModifiedBy:null===(c=null===(o=e.remoteItem.lastModifiedBy)||void 0===o?void 0:o.user)||void 0===c?void 0:c.displayName,MimeType:we(e),Location:e.remoteItem.webDavUrl,ProviderEndpointUrl:Ae(e)?null:t,ChildCount:0,AttachmentProviderId:n,ProviderType:r,Type:0}}(e,t,n,r);o&&i.push(o)}),i}(e,t,n,r);return{TotalItemCount:i.length,ResultCode:0,Items:i,PagingMetadata:null}}function we(e){var t;return e.remoteItem.file?e.remoteItem.file.mimeType:(null===(t=e.package)||void 0===t?void 0:t.type)===O?h:null}const Re=(e,t)=>e.substring(0,t.length)===t,De="https://";function Ae(e){return!!e.remoteItem.webDavUrl&&!!Re(e.remoteItem.webDavUrl.toLowerCase(),De)}const Ne=(ke={Type:0,DisplayName:"Files",AriaLabel:"Files"},Object.assign({__type:"OneDriveProScope:#Exchange"},ke));var ke;async function Le(e,t,n,o,c=null,d=null,l,f,S=null,m,g=null,I=!1){try{const a=await te(e,d,c);let b,O=!1;if(a)if(1===e){if(4===Z(e,c)){O=!0;try{b=await Pe(d,t,e)}catch(e){Object(z.o)("OneDriveConsumerMRUError",{info:e.message})}}else if(Object(V.j)("doc-odcgetitems")&&0===Z(e,c)){if(S&&!Y(S))throw new Error("The paging metadata is not of type OneDriveItemsSkipTokenPagingMetadata");O=a;try{b=await async function(e,t,n,r,i=null){return _e(p.e,p.e,1,e,t,n,r,i)}(t,m?m.SortColumn:s.SortColumn,m?m.SortOrder:s.SortOrder,l,{metadata:S,maxEntries:100})}catch(e){}}}else if(5===e)O=!0,b=await P(function(e,t){let n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");const r=t&&0===t.SortOrder?"asc":"desc";return`${ye}&orderBy=folder,${n} ${r}&q=mimeType!="application/octet-stream" and trashed=false and "${e||"root"}" in parents`}(f,m));else if(2===e){const e=m?m.SortColumn:s.SortColumn,t=m?m.SortOrder:s.SortOrder;O=!0;try{b=await async function(e,t,n){const{errorResponse:r,result:i}=await Object(p.j)({path:e});if(i){const e=u(i,null,de,T);return ce(e.Items,t,n),e.Items=re(e.Items),e}return u(null,r,de,T)}(f,e,t)}catch(e){}}else if(3===e){const e=m?m.SortColumn:s.SortColumn,t=m?m.SortOrder:s.SortOrder;O=!0;try{b=await async function(e,t,n){const{errorResponse:r,result:i}=await Object(p.h)(e);if(i){const e=u(i,null,ue,T);return ce(e.Items,t,n),e.Items=re(e.Items),e}return u(null,r,ue,T)}(l,e,t)}catch(e){}}else if(6===e){O=!0;try{b=await async function(e){const t=be(e),{errorResponse:n,result:r}=await Object(p.k)(t);return r?u(r,null,Ie,T):u(null,n,Ie,T)}(c)}catch(e){}}else 10===e&&(O=!0,b=await async function(e,t){const{errorResponse:n,result:r}=await Object(p.n)(e,t);return r?u(r,null,A,T):u(null,n,A,T)}(l,n));if(0===J(e,c)){if(S&&!Y(S))throw new Error("The paging metadata is not of type OneDriveItemsSkipTokenPagingMetadata");O=a;try{b=await async function(e,t,n,r,i,o=null){const c=new URL(e);return _e(e,`${c.protocol}//${c.host}`,0,t,n,r,i,o)}(d,t,m?m.SortColumn:s.SortColumn,m?m.SortOrder:s.SortOrder,l,{metadata:S,maxEntries:100})}catch(e){}}if(4===J(e,c)){O=!0;try{b=await Pe(d,t,e,I)}catch(e){Object(z.o)("OneDriveProMRUError",{info:e.message})}}if(b&&0===b.ResultCode)return Object(z.o)("FPgetItemsClientCall",[!0,e]),b;O&&Object(z.o)("FPgetItemsClientCall",[!1,e]);let h=null,E=function(e,t){if(4===J(e,t)||4===Z(e,t)){const e=new z.b("getOneDriveMRUItemsDataProvider");return e.addCustomData({IsViaServer:!0}),e}return null}(e,c);try{return h=await async function e(t,n,o,c,a,u,d,l,f,S){const m={AttachmentDataProviderId:t,Paging:r({Sort:S||s,FolderId:a||"",Location:d||"",ItemsEndpointUrl:u||"",FilterBy:o,RequestedData:Object(i.a)({BasePoint:"Beginning",Offset:n,MaxEntriesReturned:100}),PagingMetadata:f}),Scope:null==l?Ne:l};let g=await K({request:m});if(Object(V.j)("doc-authContext")&&!c&&g&&!Object(W.k)(g.ClaimsChallenge)){try{const e=await $.a.import();await e(g.ClaimsChallenge)}catch(e){return g}g=await e(t,n,o,!0,a,u,d,l,f,S);const r=g&&Object(W.k)(g.ClaimsChallenge);return Object(z.o)("getFileProviderItemsAfterReAuth",{isSuccess:r}),g}return g}(t,n,o,I,l,g,f,c,S,m),E&&E.end(),h}catch(e){throw E&&E.endWithError("ClientError"),e}}catch(e){throw a.h.warn("FilePicker: getFileProviderItems got error: "+e.message),e}}n.d(t,"f",(function(){return q})),n.d(t,"b",(function(){return Le})),n.d(t,"a",(function(){return te})),n.d(t,"e",(function(){return X})),n.d(t,"d",(function(){return Y})),n.d(t,"c",(function(){return Oe}))}}]);
//# sourceMappingURL=owa.168.js.map
self.scriptsLoaded['owa.168.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.168.js'] = (new Date()).getTime();