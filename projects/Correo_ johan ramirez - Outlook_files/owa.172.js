self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.172.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[172],{1066:function(e,t,n){"use strict";var r=n(813),a=n(1279),o=n(1287),i=n(829),s=r.sum32,c=r.sum32_4,d=r.sum32_5,u=o.ch32,l=o.maj32,h=o.s0_256,p=o.s1_256,f=o.g0_256,g=o.g1_256,v=a.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function m(){if(!(this instanceof m))return new m;v.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}r.inherits(m,v),e.exports=m,m.blockSize=512,m.outSize=256,m.hmacStrength=192,m.padLength=64,m.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=c(g(n[r-2]),n[r-7],f(n[r-15]),n[r-16]);var a=this.h[0],o=this.h[1],v=this.h[2],b=this.h[3],m=this.h[4],C=this.h[5],A=this.h[6],S=this.h[7];for(i(this.k.length===n.length),r=0;r<n.length;r++){var y=d(S,p(m),u(m,C,A),this.k[r],n[r]),k=s(h(a),l(a,o,v));S=A,A=C,C=m,m=s(b,y),b=v,v=o,o=a,a=s(y,k)}this.h[0]=s(this.h[0],a),this.h[1]=s(this.h[1],o),this.h[2]=s(this.h[2],v),this.h[3]=s(this.h[3],b),this.h[4]=s(this.h[4],m),this.h[5]=s(this.h[5],C),this.h[6]=s(this.h[6],A),this.h[7]=s(this.h[7],S)},m.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},1100:function(e,t,n){"use strict";var r=n(1308);function a(e){this.message=e}a.prototype=new Error,a.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new a("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(r(e.split(".")[n]))}catch(e){throw new a("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=a},1279:function(e,t,n){"use strict";var r=n(813),a=n(829);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=o,o.prototype.update=function(e,t){if(e=r.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=r.join32(e,0,e.length-n,this.endian);for(var a=0;a<e.length;a+=this._delta32)this._update(e,a,a+this._delta32)}return this},o.prototype.digest=function(e){return this.update(this._pad()),a(null===this.pending),this._digest(e)},o.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var a=1;a<n;a++)r[a]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)r[a++]=0;r[a++]=0,r[a++]=0,r[a++]=0,r[a++]=0,r[a++]=e>>>24&255,r[a++]=e>>>16&255,r[a++]=e>>>8&255,r[a++]=255&e}else for(r[a++]=255&e,r[a++]=e>>>8&255,r[a++]=e>>>16&255,r[a++]=e>>>24&255,r[a++]=0,r[a++]=0,r[a++]=0,r[a++]=0,o=8;o<this.padLength;o++)r[a++]=0;return r}},1286:function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},1287:function(e,t,n){"use strict";var r=n(813).rotr32;function a(e,t,n){return e&t^~e&n}function o(e,t,n){return e&t^e&n^t&n}function i(e,t,n){return e^t^n}t.ft_1=function(e,t,n,r){return 0===e?a(t,n,r):1===e||3===e?i(t,n,r):2===e?o(t,n,r):void 0},t.ch32=a,t.maj32=o,t.p32=i,t.s0_256=function(e){return r(e,2)^r(e,13)^r(e,22)},t.s1_256=function(e){return r(e,6)^r(e,11)^r(e,25)},t.g0_256=function(e){return r(e,7)^r(e,18)^e>>>3},t.g1_256=function(e){return r(e,17)^r(e,19)^e>>>10}},1308:function(e,t,n){var r=n(1309);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return r(t)}}},1309:function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(e){this.message=e}r.prototype=new Error,r.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,o,i=0,s=0,c="";o=t.charAt(s++);~o&&(a=i%4?64*a+o:o,i++%4)?c+=String.fromCharCode(255&a>>(-2*i&6)):0)o=n.indexOf(o);return c}},17475:function(e,t,n){var r=n(17476);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(66)(r,a);r.locals&&(e.exports=r.locals)},17476:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,"._25Un94GIU9iwJI_fbgP-cb{-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] ._25Un94GIU9iwJI_fbgP-cb{border-width:1px;border-style:dashed;border-color:var(--themePrimary)}",""]),t.locals={imagePlaceholder:"_25Un94GIU9iwJI_fbgP-cb"}},3491:function(e,t,n){"use strict";var r=n(3835),a=n(40),o=n(3),i=n(6027);Object(o.mutator)(i.a,e=>{r.a.cards.set(e.cardId,{autoInvokeActionAlreadyRan:!1})}),Object(o.mutator)(i.b,e=>{r.a.cards.delete(e.cardId)}),Object(o.mutator)(i.c,e=>{const t=r.a.cards.get(e.cardId);t?t.autoInvokeActionAlreadyRan=e.autoInvokeActionAlreadyRan:a.h.warn(`[ActionableMessageDebug] setAutoInvokeActionAlreadyRanMutator: card is undefined for cardId ${e.cardId}`)});var s=n(20),c=n(7),d=n(5574);class u{constructor(e,t,n){this.perfCheckpoints={currentCardCheckpoints:{},previousCardCheckpoints:{}},this.telemetryProvider=e,this.messageContext=t,this.perfData=n}stampPerfCheckpoint(e,t){!function(e,t,n){const r=n||Object(c.Vb)();switch(t){case d.a.LoadStart:e.loadStart=r;break;case d.a.AutoInvokeActionStart:e.autoInvokeActionStart=r;break;case d.a.AutoInvokeActionEnd:e.autoInvokeActionEnd=r;break;case d.a.CardRenderStart:e.currentCardCheckpoints.cardRenderStart=r;break;case d.a.CardRenderEnd:e.currentCardCheckpoints.cardRenderEnd=r;break;case d.a.ThemeResolveStart:e.currentCardCheckpoints.themeResolveStart=r;break;case d.a.ThemeResolveEnd:e.currentCardCheckpoints.themeResolveEnd=r;break;case d.a.CardCreateStart:e.currentCardCheckpoints.cardCreateStart=r;break;case d.a.CardCreateEnd:e.currentCardCheckpoints.cardCreateEnd=r;break;case d.a.CardLibraryRenderStart:e.currentCardCheckpoints.cardLibraryRenderStart=r;break;case d.a.CardLibraryRenderEnd:e.currentCardCheckpoints.cardLibraryRenderEnd=r;break;case d.a.PrepareCardStart:e.currentCardCheckpoints.prepareCardStart=r;break;case d.a.PrepareCardEnd:e.currentCardCheckpoints.prepareCardEnd=r;break;default:a.h.info("Actionable Message Card: markPerfCheckpointMutator called with unespected PerfMarker")}}(this.perfCheckpoints,e,t)}logTelemetryProvider(e,t,n,r,a){let o=this.getTelemetryDetailsForEvent(e,t,n,r,a);this.telemetryProvider.logTelemetry(o)}setTotalFetchTimeForCard(){this.perfCheckpoints&&this.perfCheckpoints.currentCardCheckpoints&&(this.perfCheckpoints.currentCardCheckpoints.totalFetchTime=Object(c.w)(this.perfData.fetchEndTime,this.perfData.fetchStartTime))}getTelemetryDetailsForEvent(e,t,n,r,a){return{messageContext:this.messageContext,cardDetails:e,eventName:t,actionContext:n,elementDetails:r,perfCheckpoints:this.perfCheckpoints,actionExecGenericInfo:a}}updatePerfCheckpointsBeforeUpdatingAutoInvokeResponse(){this.perfCheckpoints&&(this.perfCheckpoints.previousCardCheckpoints=this.perfCheckpoints.currentCardCheckpoints,this.perfCheckpoints.currentCardCheckpoints={})}}var l,h,p=n(311);function f(e,t,n,r,a){return Object.assign(Object.assign({},e),{isAdaptiveCard:void 0===r?"AdaptiveCard"===t.type:r,cardSignature:n,card:t,cardHash:void 0,cardId:a||Object(p.a)()})}!function(e){e[e.NotLoaded=0]="NotLoaded",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(l||(l={})),function(e){e[e.ActionExecStart=0]="ActionExecStart",e[e.ActionExecEnd=1]="ActionExecEnd",e[e.ServerRequestStart=2]="ServerRequestStart",e[e.ServerRequestEnd=3]="ServerRequestEnd",e[e.TokenFetchStart=4]="TokenFetchStart",e[e.TokenFetchEnd=5]="TokenFetchEnd"}(h||(h={}));var g=n(6028),v=Object(o.mutatorAction)("setThemeLoadStatus",(function(e){r.a.themeStore.loadStatus=e}));var b=e=>{if(e){const t=e[0];Object.keys(t).forEach(e=>{Object(g.a)(e,t[e])});const n=e[1];Object.keys(n).forEach(e=>{Object(g.a)(e,n[e])}),v(1)}else a.h.info("Error in getting theme definitions: null value returned"),v(2)};n.d(t,"b",(function(){return C})),n.d(t,"e",(function(){return A})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return h})),n.d(t,"g",(function(){return b}));const m=new s.c(()=>Promise.all([n.e(0),n.e(5),n.e(6),n.e(7),n.e(8),n.e(9),n.e(10),n.e(11),n.e(14),n.e(17),n.e(22),n.e(24),n.e(27),n.e(32),n.e(37),n.e(44),n.e(116),n.e(134),n.e(189),n.e(577)]).then(n.bind(null,19089))),C=Object(s.d)(m,e=>e.ActionableMessageCardWrapper),A=new s.b(m,e=>e.parseCardFromStringOrObject)},3835:function(e,t,n){"use strict";var r=n(14),a=n(3);const o={themeStore:{loadStatus:0,themeMapping:{},themeMappingDarkMode:{}},cards:new r.ObservableMap},i=Object(a.createStore)("ActionableMessageV2",o);t.a=i()},5006:function(e,t,n){"use strict";var r=n(61),a=n(8086),o=n(8333),i=n(8868),s=n(10870),c=n(11175),d=n(8089);var u=(e,t=!0)=>{const{eventName:n,messageContext:r,cardDetails:a,elementDetails:u,actionContext:l,perfCheckpoints:h,actionExecGenericInfo:p}=e;if(void 0===n)return;let f;switch(Object(d.a)(n)){case o.a.type:f=new o.a(n,r,a);break;case i.a.type:f=new i.a(n,r,a,u,p);break;case s.a.type:f=new s.a(n,r,a,u,l);break;case c.a.type:f=new c.a(n,r,a,h)}return null==f?void 0:f.getProperties(t)},l=n(8090);var h=async e=>{if(Object(l.a)())return;const t=u(e);if(!t)return;const n=await Object(r.g)(),o={name:a.a.ClientEvent,properties:t};n.logEvent(o)},p=n(8329),f=n(10871);var g=(e,t)=>{if(void 0===e)return;let n;switch(Object(d.a)(e)){case f.a.type:n=new f.a(e,t)}return null==n?void 0:n.getProperties(!0)};var v=async(e,t)=>{if(Object(l.a)())return;const n=g(e,t);if(!n)return;const o=await Object(r.g)(),i={name:a.a.ClientEvent,properties:n};o.logEvent(i)},b=n(8088),m=n(7117),C=n(7118);n.d(t,"g",(function(){return A})),n.d(t,"e",(function(){return p.a})),n.d(t,"f",(function(){return v})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return b.a})),n.d(t,"b",(function(){return m.a})),n.d(t,"a",(function(){return C.a}));const A={logTelemetry:h}},5231:function(e,t,n){"use strict";var r=n(44),a=n(40),o=n(2432);class i extends o.HttpAction{constructor(e){super(),this.preserveBody=e}internalPrepareForExecution(e){const t=this.body;super.internalPrepareForExecution(e),this.preserveBody&&(this.body=t)}parse(e){super.parse(e),this.isPrimary=e.isPrimary}}var s,c,d=n(3);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(s||(s={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(c||(c={}));const u={cache:{data:null,state:c.Empty,time:null},requestState:s.UnResolved};var l=Object(d.createStore)("amClientConfigurationStore",u)();var h=()=>{var e,t;let n=null;return(null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)&&(n=l.cache.data.clientTimeouts.default),n},p=n(3491),f=n(61),g=n(2883),v=n(5),b=n(7114),m=n(8866),C=n(50),A=n(81),S=n(29);const y=Object.freeze({evt:"ActionCardHttpPostActionClicked",tel:"ShowCardClick"}),k=Object.freeze({evt:"SingleClickHttpPostActionClicked",tel:"SingleClick"}),O=Object.freeze({evt:"AutoInvokeActionClicked",tel:"AutoInvoke"}),w="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var E,j,T=n(5006),x=n(11);!function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(E||(E={})),function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(j||(j={}));const I={cache:{data:{Url:(()=>Object(r.j)("rp-actionableMessages-action-endpoint-b2")?"/actionsb2":"/actions")()},state:E.Empty,time:null},requestState:j.UnResolved};var R=Object(d.createStore)("amActionEndpointStore",I)();var M=()=>!!Object(x.c)(window)&&!!Object(x.a)(window,"ActionableMessages.ActionEndpoint");const P=()=>(()=>R.cache.data)().Url;var _=n(7);function D(e,t,n,r){const o=r||Object(_.Vb)();switch(n){case p.a.ActionExecStart:e.httpOrExecuteActionStart=o,t.TAT=-1;break;case p.a.ActionExecEnd:e.httpOrExecuteActionEnd=o,e.httpOrExecuteActionStart&&(t.TAT=Object(_.w)(e.httpOrExecuteActionEnd,e.httpOrExecuteActionStart));break;case p.a.TokenFetchStart:e.tokenFetchStart=o,t.TFT=-1;break;case p.a.TokenFetchEnd:e.tokenFetchEnd=o,e.tokenFetchStart&&(t.TFT=Object(_.w)(e.tokenFetchEnd,e.tokenFetchStart));break;case p.a.ServerRequestStart:e.serverRequestStart=o,t.SRT=-1;break;case p.a.ServerRequestEnd:e.serverRequestEnd=o,e.serverRequestStart&&(t.SRT=Object(_.w)(e.serverRequestEnd,e.serverRequestStart));break;default:a.h.info("Actionable Message Card: markPerfCheckpointMutator called with unespected PerfMarker")}}var L=(e,t,n,a,i)=>{const s=e["@id"]?e["@id"]:e.id,c={actionType:"undefined",TAT:-2,TFT:-2,SRT:-2};if(!a.mailboxInfo)return Promise.resolve({success:!1,displayMessage:Object(v.b)(b.a),actionExecGenericInfo:c});const d={};D(d,c,p.a.ActionExecStart);let u={"@type":"HttpPOST",name:e.title,target:e.url,body:e.body,"@id":s,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(u.headers=e.headers);const l=Object(S.a)(),h=[];if(t)for(let e=0;e<t.length;e++){const n=t[e],r=new o.ValidationResults;if(n.internalValidateProperties(r),r.failures.length>0)return Promise.resolve({success:!1,displayMessage:r.failures[0].errors[0].message});if(!n)continue;let a;a="Input.Date"===n.getJsonTypeName()?{id:n.id,value:n.value,usertimezone:l.UserOptions.TimeZone}:{id:n.id,value:n.value},h.push(a)}const f={type:o.HttpAction.JsonTypeName,url:e.url,body:e.body,method:e.method,id:e.id,headers:e.headers},g=Object(v.e)();let m;const C={type:e.getJsonTypeName(),id:e.id},A=U(e,i);c.actionType=A.tel;const y={eventName:A.evt,messageContext:a,cardDetails:n,elementDetails:C,actionContext:e.actionContext},k=Object(T.d)(y,!1);if(k.messageCardContext)try{k.messageCardContext=JSON.parse(k.messageCardContext)}catch(e){}if(k.messageCardExtensionContext)try{k.messageCardExtensionContext=JSON.parse(k.messageCardExtensionContext)}catch(e){}if(k.actionContext)try{k.actionContext=JSON.parse(k.actionContext)}catch(e){}n.isAdaptiveCard?m={httpAction:f,inputParameters:h,connectorSenderGuid:n.connectorSenderGuid,SmtpAddressesSerialized:n.smtpAddressesSerialized,adaptiveCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:k,adaptiveCardHash:n.cardHash}:(u=Object.assign(Object.assign({},e.originalJsonPayload),u),m={inputParameters:h,connectorSenderGuid:n.connectorSenderGuid,potentialAction:JSON.stringify(u),SmtpAddressesSerialized:n.smtpAddressesSerialized,messageCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:k,tenantObjectId:l.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:n.cardHash,culture:g,uiCulture:g}),Object(r.j)("rp-actionableMessagesSenderAddress")&&(m.senderAddress=a.senderAddress);const O=a.mailboxInfo.mailboxSmtpAddress;return H(q(a,g,n.isAdaptiveCard),JSON.stringify(m),"HttpAction",O,c,d,null,z(n),i)};const U=(e,t)=>t?O:e.parent&&(e=>{for(;e.parent;){if(e instanceof o.AdaptiveCard)return!0;e=e.parent}return!1})(e.parent)?y:k,q=(e,t,n)=>{const r="UserMailbox"===e.mailboxInfo.type?"userid":e.mailboxInfo.mailboxSmtpAddress,a=e.odataItemId,o=e.odataConversationId,i=P();switch(e.mailboxInfo.type){case"UserMailbox":return n?Object(v.c)("{0}/{1}/messages/{2}/adaptiveCard/executeAction?culture={3}",i,r,a,t):Object(v.c)("{0}/{1}/messages/{2}/executeAction?culture={3}",i,r,a,t);case"GroupMailbox":case"TeamsMailbox":return n?Object(v.c)("{0}/{1}/threads/{2}/posts/{3}/adaptiveCard/executeAction?culture={4}",i,r,o,a,t):Object(v.c)("{0}/{1}/threads/{2}/posts/{3}/executeAction?culture={4}",i,r,o,a,t);case"PublicMailbox":case"SharedMailbox":case"ArchiveMailbox":default:return null}},H=async(e,t,n,r,o,i,s,c,d=!1)=>{const u=s||Object(A.b)(),l={correlationVector:u,cardCorrelationId:c,requestType:n};let h;try{if(D(i,o,p.a.TokenFetchStart),h=await Object(g.a)(),h||(a.h.warn("[ActionableMessageDebug] makePostRequest: Unable to get the client Auth token possibly AAD token"),h=await Object(g.b)()),D(i,o,p.a.TokenFetchEnd),!h)throw new Error(`Token is empty: ${h}`)}catch(e){return a.h.warn(`[ActionableMessageDebug] makePostRequest: Error while getting token, error: ${e}`),l.err=e.message,Object(f.o)("ActionableMessageConnectorsPostRequestErrorGettingToken",l,{isCore:!0}),D(i,o,p.a.ActionExecEnd),{success:!1,displayMessage:Object(v.b)(b.a),actionExecGenericInfo:o}}return D(i,o,p.a.ServerRequestStart),F(e,h,t,r,o,i,d,u,l)},F=(e,t,n,r,a,o,i,s,c)=>new Promise(d=>{const u=new XMLHttpRequest;u.onreadystatechange=function(){4===u.readyState&&(D(o,a,p.a.ServerRequestEnd),d(N(200===u.status,u.responseText,a,o)))},u.ontimeout=function(){D(o,a,p.a.ActionExecEnd),d({success:!1,displayMessage:Object(v.b)(b.a),actionExecGenericInfo:a}),Object(f.o)("ActionableMessageConnectorsPostRequestTimeout",c,{isCore:!0})},u.open("POST",e,!0),u.timeout=(e=>{let t=e?6e3:1e4;const n=h();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t})(i),u.setRequestHeader("MS-CV",s),u.setRequestHeader("X-OWA-CANARY",Object(C.a)()),u.setRequestHeader("X-RoutingParameter-SessionKey",r),u.setRequestHeader("X-AnchorMailbox",r),u.setRequestHeader("Authorization",`Bearer ${t}`),u.send(n)}),N=(e,t,n,r)=>{try{const a=JSON.parse(t),o=!!e&&J(a.status);return D(r,n,p.a.ActionExecEnd),{success:o,status:a.status,displayMessage:a.displayMessage?a.displayMessage:o?Object(v.b)(m.a):Object(v.b)(b.a),performedAt:a.performedAt,newCardPayload:a.refreshCardSerialized,newCardSignature:a.refreshCardSignature,removeCard:a.removeCard,showOriginalCard:a.showOriginalCard,hideCard:a.hideCard,authenticationUrl:a.authenticationUrl,cardUpdates:a.cardUpdates,errors:a.errors,actionExecGenericInfo:n}}catch(e){return D(r,n,p.a.ActionExecEnd),{success:!1,displayMessage:Object(v.b)(b.a),actionExecGenericInfo:n}}},J=e=>e&&"completed"===e.toLowerCase(),z=e=>{try{return e.card.messageCardContext.correlationId}catch(e){return""}};var G=n(1100),$=n.n(G),B=n(1066),V=n.n(B);var X=(e,t,n,r)=>{try{const t=e.displayMessage;if(!n||e.success||!t||-1===t.indexOf("Failed to validate the signature of the actionable message card"))return;const a=n.cardHash;let o="",i="";if(n.cardSignature)try{const e=$()(n.cardSignature);o=e.messagecardhash,i=e.senderaddress}catch(e){}let s="";try{const e=JSON.stringify(n.card),t=V()().update(e).digest();s=btoa(String.fromCharCode.apply(null,new Uint8Array(t)))}catch(e){}const c={originator:n.connectorSenderGuid,vals:{ch:a,sch:o,cch:s,csa:i===r.senderAddress}};a!==o&&Object(T.e)(T.b.FailedToValidateSignature,T.a.Critical,JSON.stringify(c))}catch(e){}};function K(e){const t=new i(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach(e=>{t.headers.push(new o.HttpHeader(e.name,e.value))})),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}const W="HttpPOST";var Q=n(283);var Y=Object(d.mutatorAction)("setClientConfiguration",e=>{l.cache=e});var Z=Object(d.mutatorAction)("updateRequestState",e=>{l.requestState=e});var ee=()=>l.cache;var te=()=>{var e,t,n,r;const a=ee(),o=null===(t=null===(e=null==a?void 0:a.data)||void 0===e?void 0:e.themeMappings)||void 0===t?void 0:t.connectors,i=null===(r=null===(n=null==a?void 0:a.data)||void 0===n?void 0:n.themeMappingsDarkMode)||void 0===r?void 0:r.connectors;if(!o&&!i)return null;let s={};o&&Object.keys(o).forEach(e=>{const t={themeConfigUrl:o[e],hostConfig:null,stylesheetUrl:null,isResolved:!1,isDarkModeTheme:!1};s[e]=t});let c={};return i&&Object.keys(i).forEach(e=>{const t={themeConfigUrl:i[e],hostConfig:null,stylesheetUrl:null,isResolved:!1,isDarkModeTheme:!0};c[e]=t}),[s,c]};var ne=()=>!!Object(x.c)(window)&&!!Object(x.a)(window,"ActionableMessages.ClientConfiguration");var re=()=>ne()?JSON.parse(Object(x.a)(window,"ActionableMessages.ClientConfiguration")):null;var ae=()=>l.cache.state!==c.Empty;var oe=()=>{const e=Date.now()-l.cache.time;return l.cache.state===c.Success&&e>=432e6||l.cache.state===c.Error&&e>=864e5||(()=>{var e,t;const n=null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.themeMappings)||void 0===t?void 0:t.connectors;return l.cache.state===c.Success&&null===n})()},ie=n(209),se=n(49);const ce=e=>{var t,n;const r=Object(se.g)(),a=null===(t=r.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,o=null===(n=r.SessionSettings)||void 0===n?void 0:n.UserEmailAddress,i=a||o;return e.set("X-RoutingParameter-SessionKey",i),e.set("X-AnchorMailbox",i),e.set(A.a,Object(A.b)()),e};var de=(e,t,n=9e4)=>new Promise((r,a)=>{let o;"AbortController"in window&&(o=new AbortController,t.signal=o.signal);const i=window.setTimeout(()=>{o?o.abort():a()},n);fetch(e,t).then(e=>{window.clearTimeout(i),r(e)}).catch(e=>{window.clearTimeout(i),a(e)})});var ue=async()=>{try{const e=(()=>{const e=Object(ie.c)(),t=Object(T.c)();return`${P()}/v1.0/${e}/clientConfigs/WAC_Outlook_React?clientVersion=${t}&clientColorScheme=default&$expand=providerConfigs`})(),t={method:"GET",headers:await(async()=>{const e=ce(new Headers),t=await Object(g.a)();return e.set("Authorization",(e=>`Bearer ${e}`)(t)),e})()},n=await de(e,t);if(n.ok)return await n.json();throw n}catch(e){throw e}};const le=(e,t=null)=>{const n={data:t,state:e,time:Date.now()};if(null===t){const e=ee();n.data=e.data}return n},he=Object(d.action)("loadClientConfiguration");Object(d.orchestrator)(he,async()=>{Z(s.InProgress);let e=null;try{const t=await ue();e=le(c.Success,t)}catch(t){e=le(c.Error)}finally{Y(e),(e=>{if(Object(x.c)(window))try{Object(x.e)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){a.h.info("[ActionableMessageDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}})(e),Object(p.g)(te()),Z(s.Resolved)}});var pe=he;var fe=()=>{l.requestState!==s.InProgress&&pe()};var ge=()=>R.cache.state!==E.Empty;var ve=()=>{const e=Date.now()-R.cache.time;return R.cache.state===E.Success&&e>=432e6||R.cache.state===E.Error&&e>=864e5};var be=Object(d.mutatorAction)("updateActionEndpointRequestState",e=>{R.requestState=e});var me=async()=>{try{const e=`https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/${Object(ie.c)()}?Protocol=Actions`,t={method:"GET",headers:ce(new Headers)},n=await de(e,t);if(n.ok)return await n.json();throw n}catch(e){try{if(e instanceof Response){const t=await e.text();Object(T.e)(T.b.AutoDFailure,T.a.Standard,t)}else{let t;(e.name||e.message)&&(t=`${e.name}: ${e.message}`),Object(T.e)(T.b.AutoDFailure,T.a.Standard,t,e.stack)}}catch(e){}throw e}};var Ce=Object(d.mutatorAction)("setActionEndpoint",e=>{R.cache=e});var Ae=()=>l.cache.state;const Se=(e,t=null)=>{let n=P();return(null==t?void 0:t.Url)?n="/"+t.Url.split("/").pop():e=E.Error,{data:{Url:n},state:e,time:Date.now()}},ye=Object(d.action)("loadActionEndpoint");Object(d.orchestrator)(ye,async()=>{be(j.InProgress);let e=null;try{const t=await me();e=Se(E.Success,t)}catch(t){e=Se(E.Error)}finally{if(Ce(e),(e=>{if(Object(x.c)(window))try{Object(x.e)(window,"ActionableMessages.ActionEndpoint",JSON.stringify(e))}catch(e){a.h.info("[ActionableMessageDebug] owa-actionable-message-connectors loadActionEndpoint setActionEndpointInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}})(e),be(j.Resolved),Object(r.j)("rp-actionableMessagesDebug")){const t={AutoD:{model:e.data.Url,status:e.state},ConfigAPI:{status:Ae()}};Object(T.f)(T.b.SessionDetails,t)}}});var ke=ye;var Oe=()=>{R.requestState!==j.InProgress&&ke()};var we=()=>{ge()?ve()&&Oe():M()?(Ce((()=>M()?JSON.parse(Object(x.a)(window,"ActionableMessages.ActionEndpoint")):null)()),be(j.Resolved),ve()&&Oe()):Oe()};const Ee=()=>R.cache.state,je=()=>{return null!==ee().data};var Te=()=>{if(we(),ae())return oe()&&fe(),je();if(ne()){if(Y(re()),Object(p.g)(te()),Z(s.Resolved),oe()&&fe(),Object(r.j)("rp-actionableMessagesDebug")){const e={AutoD:{model:P(),status:Ee()},ConfigAPI:{status:Ae()}};Object(T.f)(T.b.SessionDetails,e)}return je()}return fe(),!1};var xe=()=>{var e,t;let n=!1;if(Te()){const r=ee();(null===(t=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(n=!0)}return n};const Ie=(e,t)=>{let n=!1;for(const r of e)if(r.originator===t){n=!0;break}return n};var Re=(e,t)=>{var n,r;let a=!1;if(Te()){const o=ee();!t&&(null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.providerConfigs)?a=Ie(o.data.providerConfigs,e):t&&(null===(r=null==o?void 0:o.data)||void 0===r?void 0:r.providerConfigsDarkMode)&&(a=Ie(o.data.providerConfigsDarkMode,e))}return a},Me=n(17475),Pe=n.n(Me);const _e="data:",De="blob:";function Le(e,t,n){const r=e.querySelectorAll('img:not([src^="cid:"])');if(r)for(let e=0;e<r.length;e++)0!==r[e].src.indexOf(_e)&&0!==r[e].src.indexOf(De)&&Ue(r[e],t.mailboxSmtpAddress,n)}async function Ue(e,t,n){try{const r=e.src,a=`${P()}/${t}/th?u=${encodeURIComponent(r)}`;e.src=w,e.setAttribute("originalSrc",r),e.classList.add(Pe.a.imagePlaceholder);const o=await async function(e,t,n){return new Promise(async(r,a)=>{const o=await Object(g.b)();if(o){const i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.setRequestHeader("Authorization",`Bearer ${o}`),i.setRequestHeader("X-RoutingParameter-SessionKey",t),i.setRequestHeader("X-AnchorMailbox",t),n&&i.setRequestHeader("X-OriginatorId",n),i.onreadystatechange=function(){if(4===i.readyState)try{let e=function(e){try{if(200==e.status){const t=e.response,n=e.getResponseHeader("Content-Type");if(n&&0===n.toLowerCase().indexOf("image")&&t instanceof Blob)return URL.createObjectURL(t)}}catch(e){throw e}return null}(i);r(e)}catch(e){a(e)}},i.send()}else a(new Error("token not generated"))})}(a,t,n);e.src=o,e.classList.remove(Pe.a.imagePlaceholder)}catch(e){a.h.warn("[ActionableMessageDebug] fixSrcForExternalImage: Error setting src value. Exception: "+e.message)}}var qe=e=>{return["https://outlook.office365.com","https://outlook.office.com","https://outlook-sdf.office.com","https://outlook-sdf.office365.com","https://emea.mail.microsoft.com","https://outlook-sdf.live.com","https://outlook.live.com"].includes(e)};var He=e=>{var t,n;const r=P(),a="UserMailbox"!==(null===(t=e.mailboxInfo)||void 0===t?void 0:t.type)?null===(n=e.mailboxInfo)||void 0===n?void 0:n.mailboxSmtpAddress:"userid",o=e.odataItemId;return Object(v.c)("{0}/{1}/messages/{2}/adaptiveCardV2/action",r,a,o)};var Fe=()=>{var e,t,n;let r=null;return(null===(n=null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)||void 0===n?void 0:n.SnackBarTimeoutInMsec)&&(r=l.cache.data.clientTimeouts.default.SnackBarTimeoutInMsec),null!==r?r:8e3};var Ne=()=>{var e,t,n;let r=null;return(null===(n=null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeoutsACv2)||void 0===t?void 0:t.default)||void 0===n?void 0:n.SnackBarTimeoutInMsec)&&(r=l.cache.data.clientTimeoutsACv2.default.SnackBarTimeoutInMsec),null!==r?r:8e3};var Je=()=>{var e,t;let n=null;return(null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeoutsACv2)||void 0===t?void 0:t.default)&&(n=l.cache.data.clientTimeoutsACv2.default),n};n.d(t,"b",(function(){return ze})),n.d(t,"d",(function(){return xe})),n.d(t,"l",(function(){return Re})),n.d(t,"f",(function(){return Le})),n.d(t,"m",(function(){return qe})),n.d(t,"h",(function(){return He})),n.d(t,"n",(function(){return D})),n.d(t,"e",(function(){return de})),n.d(t,"c",(function(){return ce})),n.d(t,"i",(function(){return Fe})),n.d(t,"k",(function(){return Ne})),n.d(t,"j",(function(){return Je})),n.d(t,"g",(function(){return P})),n.d(t,"a",(function(){return w}));const ze={registerActions:function(){o.AdaptiveCard.actionTypeRegistry.unregisterType(o.SubmitAction.JsonTypeName),o.AdaptiveCard.actionTypeRegistry.registerType(o.HttpAction.JsonTypeName,()=>new i(!1))},executeAction:function(e,t,n,o,s,c,d){return e instanceof i&&(L(e,n,t,s,d).then(n=>{a.h.info("[ActionableMessageDebug] onExecuteAction: executeHttpAction response: "+n),Object(r.j)("rp-actionableMessagesFailDebug")&&d&&X(n,e,t,s),o(n)}),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return K(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===o.HttpAction.JsonTypeName||e["@type"]===W){let n;return t.isAdaptiveCard?(n=new i(!1),n.parse(e),n.hideCardOnInvoke=e.hideCardOnInvoke):n=K(e),n}return null},registerHostCapabilities:function(e){Object(r.j)("rp-actionableMessages-aad-token")&&!Object(Q.a)()&&(e.AADAuthentication="*")}}},5574:function(e,t,n){"use strict";var r;!function(e){e[e.LoadStart=0]="LoadStart",e[e.AutoInvokeActionStart=1]="AutoInvokeActionStart",e[e.AutoInvokeActionEnd=2]="AutoInvokeActionEnd",e[e.CardRenderStart=3]="CardRenderStart",e[e.CardRenderEnd=4]="CardRenderEnd",e[e.ThemeLoadTotalStart=5]="ThemeLoadTotalStart",e[e.ThemeLoadTotalEnd=6]="ThemeLoadTotalEnd",e[e.ThemeDefinitionsLoadStart=7]="ThemeDefinitionsLoadStart",e[e.ThemeDefinitionsLoadEnd=8]="ThemeDefinitionsLoadEnd",e[e.ThemeResolveStart=9]="ThemeResolveStart",e[e.ThemeResolveEnd=10]="ThemeResolveEnd",e[e.CardCreateStart=11]="CardCreateStart",e[e.CardCreateEnd=12]="CardCreateEnd",e[e.CardLibraryRenderStart=13]="CardLibraryRenderStart",e[e.CardLibraryRenderEnd=14]="CardLibraryRenderEnd",e[e.PrepareCardStart=15]="PrepareCardStart",e[e.PrepareCardEnd=16]="PrepareCardEnd"}(r||(r={})),t.a=r},6027:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r=n(3);const a=Object(r.action)("addCard",e=>({cardId:e})),o=Object(r.action)("removeCard",e=>({cardId:e})),i=Object(r.action)("setAutoInvokeActionAlreadyRan",(e,t)=>({cardId:e,autoInvokeActionAlreadyRan:t}))},6028:function(e,t,n){"use strict";var r=n(3835),a=n(3);t.a=Object(a.mutatorAction)("setThemeForKey",(function(e,t){t.isDarkModeTheme?r.a.themeStore.themeMappingDarkMode[e]=t:r.a.themeStore.themeMapping[e]=t}))},7114:function(e){e.exports=JSON.parse('{"a":"Krb"}')},813:function(e,t,n){"use strict";var r=n(829),a=n(1286);function o(e,t){return 55296==(64512&e.charCodeAt(t))&&(!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1)))}function i(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function s(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=a,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),a=0;a<e.length;a+=2)n.push(parseInt(e[a]+e[a+1],16))}else for(var r=0,a=0;a<e.length;a++){var i=e.charCodeAt(a);i<128?n[r++]=i:i<2048?(n[r++]=i>>6|192,n[r++]=63&i|128):o(e,a)?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++a)),n[r++]=i>>18|240,n[r++]=i>>12&63|128,n[r++]=i>>6&63|128,n[r++]=63&i|128):(n[r++]=i>>12|224,n[r++]=i>>6&63|128,n[r++]=63&i|128)}else for(a=0;a<e.length;a++)n[a]=0|e[a];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=s(e[n].toString(16));return t},t.htonl=i,t.toHex32=function(e,t){for(var n="",r=0;r<e.length;r++){var a=e[r];"little"===t&&(a=i(a)),n+=c(a.toString(16))}return n},t.zero2=s,t.zero8=c,t.join32=function(e,t,n,a){var o=n-t;r(o%4==0);for(var i=new Array(o/4),s=0,c=t;s<i.length;s++,c+=4){var d;d="big"===a?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],i[s]=d>>>0}return i},t.split32=function(e,t){for(var n=new Array(4*e.length),r=0,a=0;r<e.length;r++,a+=4){var o=e[r];"big"===t?(n[a]=o>>>24,n[a+1]=o>>>16&255,n[a+2]=o>>>8&255,n[a+3]=255&o):(n[a+3]=o>>>24,n[a+2]=o>>>16&255,n[a+1]=o>>>8&255,n[a]=255&o)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,r){return e+t+n+r>>>0},t.sum32_5=function(e,t,n,r,a){return e+t+n+r+a>>>0},t.sum64=function(e,t,n,r){var a=e[t],o=r+e[t+1]>>>0,i=(o<r?1:0)+n+a;e[t]=i>>>0,e[t+1]=o},t.sum64_hi=function(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,r){return t+r>>>0},t.sum64_4_hi=function(e,t,n,r,a,o,i,s){var c=0,d=t;return c+=(d=d+r>>>0)<t?1:0,c+=(d=d+o>>>0)<o?1:0,e+n+a+i+(c+=(d=d+s>>>0)<s?1:0)>>>0},t.sum64_4_lo=function(e,t,n,r,a,o,i,s){return t+r+o+s>>>0},t.sum64_5_hi=function(e,t,n,r,a,o,i,s,c,d){var u=0,l=t;return u+=(l=l+r>>>0)<t?1:0,u+=(l=l+o>>>0)<o?1:0,u+=(l=l+s>>>0)<s?1:0,e+n+a+i+c+(u+=(l=l+d>>>0)<d?1:0)>>>0},t.sum64_5_lo=function(e,t,n,r,a,o,i,s,c,d){return t+r+o+s+d>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},829:function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=n,n.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},8866:function(e){e.exports=JSON.parse('{"a":"Jrb"}')}}]);
//# sourceMappingURL=owa.172.js.map
self.scriptsLoaded['owa.172.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.172.js'] = (new Date()).getTime();