self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.208.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[208],{10637:function(t,e,n){"use strict";e.a={OnClick:{name:"AttachmentOnClick",customData:t=>[t]}}},10638:function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return s}));var a=n(12129),o=n(5155),c=n(5156);const i={};let r=null;function d(t,e){i[t.attachmentId.Id]&&(clearTimeout(i[t.attachmentId.Id]),i[t.attachmentId.Id]=null),r=t.attachmentId.Id,Object(a.a)(t,!0),e&&!Object(c.a)(t)&&Object(o.a)(t,!0)}function l(t,e){i[t.attachmentId.Id]&&clearTimeout(i[t.attachmentId.Id]),i[t.attachmentId.Id]=setTimeout(()=>{Object(a.a)(t,!1),e&&!Object(c.a)(t)&&Object(o.a)(t,!1),t.attachmentId.Id===r&&(r=null),i[t.attachmentId.Id]=null},40)}function u(t,e){Object(a.a)(t,!0),e&&!Object(c.a)(t)&&Object(o.a)(t,!0)}function s(t,e){t.attachmentId.Id!==r&&(Object(a.a)(t,!1),e&&!Object(c.a)(t)&&Object(o.a)(t,!1))}},10639:function(t){t.exports=JSON.parse('{"a":"NXb"}')},10640:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n(634),o=n(44);function c(){return Object(o.j)("woven-newTabExperiment")&&Object(a.d)()}},10641:function(t,e,n){"use strict";var a=n(1692);e.a=function(t){var e,n;const o=t&&Object(a.v)(t);return null===(n=null===(e=(null==o?void 0:o.From)||(null==o?void 0:o.Sender))||void 0===e?void 0:e.Mailbox)||void 0===n?void 0:n.EmailAddress}},11117:function(t,e,n){"use strict";var a=n(20),o=n(10637),c=n(6656),i=n(21),r=n(1269),d=n(42),l=n(1859),u=n(40),s=n(0),m=n(10638),b=n(266),h=n(5),f=n(10639),v=n(8843),O=n(17039),p=n(12130);var j=n(12131),w=n(61),A=n(2697),I=n(1975),S=n(12133),C=n(12134),y=n(1738),g=n(3325),_=n(4227),x=n(311),T=n(4208),E=n(957),k=n(36);const P="/"+["mail",...Object(E.a)().split("/").slice(1)].join("/")+"deeplink/saveAndEdit/";var R=n(10641);function N(t,e,n,a){const o=Object(l.k)(a);switch(t){case c.a.addToCalendar:Object(C.a)(e,S.a.SurfaceAction);break;case c.a.download:!async function(t,e){var n,a;const o=Object(y.a)(t.attachmentId);if(!o)return void u.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null");await Object(_.a)(t.attachmentId,t.isCloudy,document.body);const c=Object(g.a)(o);Object(w.o)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:t.isCloudy,isCompose:!t.isReadOnly},{cosmosOnlyData:JSON.stringify({size:o.model.Size,fileType:c,attachmentId:null===(n=o.model.AttachmentId)||void 0===n?void 0:n.Id}),isCore:!0});const i=null==e?void 0:e.Id;A.a.importAndExecute("SavedAttachment",{itemId:i&&await Object(T.a)(i),customProperties:{FileId:null===(a=o.model.AttachmentId)||void 0===a?void 0:a.Id,FileType:c,Destination:"Local",Sender:Object(R.a)(i)}})}(e,n);break;case c.a.saveToCloud:!function(t,e,n){var a;const o=Object(y.a)(t.attachmentId);if(!o)return void u.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(w.o)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:o.model.Size,fileType:Object(g.a)(o),attachmentId:null===(a=o.model.AttachmentId)||void 0===a?void 0:a.Id}),isCore:!0}),Object(I.B)(Object(I.p)(t.attachmentId),.1,e=>{Object(I.x)(t,e)},t.attachmentId),Object(I.u)(t,e=>{Object(I.C)(t.attachmentId,e)},"SurfaceAction",e,Object(R.a)(null==e?void 0:e.Id),n)}(e,n,o);break;case c.a.editAndReply:!async function(t,e,n){const a=await _.c.import();Object(w.o)("WovenEditAndReplyFromSurface",{},{isCore:!0});const o={viewState:t,attachmentSelectionSource:l.b.ReadingPane,parentItemId:e,isDraft:!1,isEdit:!0,onBeforePreview:()=>null,createImageGallery:()=>null,instrumentationContext:null,targetWindow:window};a(o)}(e,n);break;case c.a.openNewTabAndSaveToCloud:!function(t,e,n){const a=Object(x.a)();!function(t,e,n){let a=`${P}`;a+=`${encodeURIComponent(null==n?void 0:n.Id)}/${encodeURIComponent(t)}/${encodeURIComponent(e)}/${Object(k.b)().search}`,window.open(a,"_blank")}(t.attachmentId.Id,a,e);const o=new w.b("WovenNewTabSaveToCloud",{isCore:!0});Object(I.B)(4*Object(I.p)(t.attachmentId),.1,e=>{Object(I.x)(t,e)},t.attachmentId),Object(I.D)(t,e=>{Object(I.C)(t.attachmentId,e),e?o.end():o.endWithError("ServerError")},"PencilExperiment",e,a,Object(R.a)(null==e?void 0:e.Id),n)}(e,n,o);break;case c.a.openAndEdit:!function(t){const e=Object(y.a)(t.attachmentId).model.AttachmentOriginalUrl,n=-1===e.indexOf("?")?"?":"&";window.open(e+n+"web=1","_blank"),Object(w.o)("WovenOpenAndEditFromSurface",{},{isCore:!0})}(e);break;default:Object(b.a)(t)}}var B=n(1882),D=n(17040),X=n.n(D),W=n(147);const H=n.n(W).a.bind(X.a);var J=Object(i.a)((function(t){const e=s.useContext(B.a),n=n=>{n.keyCode!==d.a.enter&&n.keyCode!==d.a.space||(u.h.info("AttachmentSurfaceActionButton.keyDown enter|space"),n.stopPropagation(),N(t.action,t.attachmentViewState,t.parentItemId,e))},a=n=>{u.h.info("AttachmentSurfaceActionButton.onclick"),n.stopPropagation(),N(t.action,t.attachmentViewState,t.parentItemId,e)},o=()=>Object(m.b)(t.attachmentViewState,t.isForImageView),i=()=>{t.shouldNotHandleOnBlur||Object(m.a)(t.attachmentViewState,t.isForImageView)},{action:w,attachmentViewState:A,customClassName:I,isForImageView:S,previewState:C}=t;if(Object(j.a)(w,A))return null;{let t;const e=function(t){switch(t){case l.a.Edit:return X.a.edit;case l.a.NotSelectedAndSaving:return X.a.notSelectedAndSaving;case l.a.OtherSaving:return X.a.attachmentView;case l.a.Selected:return X.a.selected;case l.a.SelectedAndPending:return X.a.selectedAndPending;case l.a.SelectedAndSaving:return X.a.selectedAndSaving;default:return X.a.default}}(C);if(S){const e={extraRightPadding:Y(w,A)};t=H([X.a.actionButton,X.a.actionButtonForImageView,I,e])}else t=A.isReadOnly?H([X.a.actionButton,e,I]):H([X.a.actionButton,e,X.a.actionButtonForDocViewInCompose,I]);const d=function(t,e){switch(t){case c.a.addToCalendar:return"AddEvent";case c.a.download:return"Download";case c.a.saveToCloud:return"CloudUpload";case c.a.openNewTabAndSaveToCloud:return"Edit";case c.a.editAndReply:return"PencilReply";case c.a.openAndEdit:return Object(p.a)(e)?"CloudEdit":"Cloud";default:return Object(b.a)(t)}}(w,A.attachmentId),u=function(t,e){switch(t){case c.a.addToCalendar:return Object(h.b)(f.a);case c.a.download:return Object(h.b)(v.a);case c.a.saveToCloud:return Object(h.b)(O.d);case c.a.openNewTabAndSaveToCloud:return Object(h.b)(O.c);case c.a.editAndReply:return Object(h.b)(O.a);case c.a.openAndEdit:return Object(p.a)(e)?Object(h.b)(O.b):Object(h.b)(O.e);default:return Object(b.a)(t)}}(w,A.attachmentId);return s.createElement(r.a,{onFocus:o,onBlur:i,onKeyDown:n,ariaLabel:u,title:u,onClick:a,className:t,iconProps:{iconName:d,styles:{root:X.a.icon}}})}}));function Y(t,e){return(t===c.a.saveToCloud||t===c.a.editAndReply||t===c.a.openNewTabAndSaveToCloud||t===c.a.openAndEdit)&&!Object(j.a)(c.a.download,e)}var F=n(8844),M=n(4637);n.d(e,"c",(function(){return Z})),n.d(e,"h",(function(){return U})),n.d(e,"g",(function(){return o.a})),n.d(e,"f",(function(){return c.a})),n.d(e,"b",(function(){return J})),n.d(e,"a",(function(){return F.a})),n.d(e,"d",(function(){return M.c})),n.d(e,"e",(function(){return M.g}));const V=new a.c(()=>Promise.all([n.e(29),n.e(298),n.e(327),n.e(666)]).then(n.bind(null,19140))),Z=Object(a.d)(V,t=>t.AttachmentView),U=new a.b(V,t=>t.getContextMenus)},12129:function(t,e,n){"use strict";var a=n(699);e.a=Object(a.action)("setShouldShowActionsContainer")((function(t,e){t.shouldShowActionsContainer=e}))},12130:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(1738),o=n(1724),c=n(5578);function i(t){const e=Object(a.a)(t),n=Object(o.c)(e.model.Name||"");return""!==Object(c.a)(n)&&"Visio"!==Object(c.a)(n)}},12131:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var a=n(266),o=n(1975),c=n(12132),i=n(44),r=n(283),d=n(6656),l=n(3410),u=n(12130),s=n(10640);function m(t,e){if(0!==e.ongoingAction||!e.strategy.showActionsMenu)return!0;switch(t){case d.a.addToCalendar:return!1;case d.a.download:return!Object(l.a)(o.a.Download,e)||!Object(c.a)(e);case d.a.saveToCloud:case d.a.openNewTabAndSaveToCloud:return!e.isReadOnly||!function(t,e){var n;const a=Object(r.a)()&&"GroupMailbox"===(null===(n=t.attachmentId.mailboxInfo)||void 0===n?void 0:n.type);let c=!1;c=e===d.a.openNewTabAndSaveToCloud?Object(s.a)()&&Object(u.a)(t.attachmentId):Object(i.j)("woven-saveToCloud2-viewInOneDrive")||Object(i.j)("woven-saveToCloud2-editInOneDrive")||Object(i.j)("woven-saveToCloud2-editInApp")||Object(i.j)("woven-saveToCloud2-editOnline")||Object(i.j)("woven-saveToCloud2-openFolder")||Object(s.a)();return c&&Object(l.a)(o.a.SaveToCloud,t)&&Object(o.t)(t)&&!a}(e,t);case d.a.editAndReply:return!e.isReadOnly||!Object(u.a)(e.attachmentId);case d.a.openAndEdit:return!e.isReadOnly||2!==e.actionMessage&&3!==e.actionMessage;default:return Object(a.a)(t)}}},12132:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(1829),o=n(1738),c=n(6575);function i(t){var e;const n=Object(o.a)(t.attachmentId);return!!n&&(!!Object(a.c)(n.model)||n.download.url&&(null===(e=n.info)||void 0===e?void 0:e.allowDownload)&&!Object(c.a)(t.attachmentId))}},12133:function(t,e,n){"use strict";e.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},12134:function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return h}));var a=n(10639),o=n(5),c=n(61),i=n(1975),r=n(5980),d=n(2354),l=n(12133),u=n(1738),s=n(3325),m=n(3410);function b(t,e){const n=Object(u.a)(t.attachmentId),a=Object(s.a)(n);Object(c.o)("AddToCalendar",[e],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:a})}),n.model.Size>10485760||!t.attachmentId||!t.attachmentId.Id?Object(d.a)(t,0,15):(Object(i.B)(Object(i.j)(n.model.Size),.1,e=>{Object(i.x)(t,e)},t.attachmentId),Object(r.a)(t,0))}function h(t){const e=Object(u.a)(t.attachmentId);return Object(m.a)(i.a.ImportCalendarEventAttachment,t)&&e&&13===e.attachmentClass?{name:Object(o.b)(a.a),key:"AddToCalendar",iconProps:{iconName:"AddEvent"},onClick:()=>{b(t,l.a.ContextMenu)}}:null}},17039:function(t){t.exports=JSON.parse('{"a":"oYb","c":"pYb","d":"qYb","b":"rYb","e":"sYb"}')},17040:function(t,e,n){var a=n(17041);"string"==typeof a&&(a=[[t.i,a,""]]);var o={transform:void 0};n(66)(a,o);a.locals&&(t.exports=a.locals)},17041:function(t,e,n){(e=t.exports=n(65)(!1)).push([t.i,"._1nM9lHOADRhr_c6SVOADHO{font-size:14px;color:var(--neutralSecondary);height:25px;width:28px}html[dir] ._1nM9lHOADRhr_c6SVOADHO{padding:4px;text-align:center}._1nM9lHOADRhr_c6SVOADHO:focus,._1nM9lHOADRhr_c6SVOADHO:hover{color:var(--neutralSecondary)}.SyP9uy9POMtEKSqcjz56r{display:block;color:var(--neutralSecondary)}._2PEQBliXdsvC09cN2WpJ7R{bottom:0;position:absolute;color:var(--white)}html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R{right:28px}html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R{left:28px}._2PEQBliXdsvC09cN2WpJ7R:focus,._2PEQBliXdsvC09cN2WpJ7R:hover{color:var(--white)}html[dir] ._2PEQBliXdsvC09cN2WpJ7R:focus,html[dir] ._2PEQBliXdsvC09cN2WpJ7R:hover{background:var(--blackTranslucent40)}html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R:focus,html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R:hover{border-bottom-right-radius:2px}html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R:focus,html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R:hover{border-bottom-left-radius:2px}html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R._3pwyFskFhtIASENu2YzJ6F{right:56px}html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R._3pwyFskFhtIASENu2YzJ6F{left:56px}._2XToIfXPoECB97QGfA0s1Q{font-size:14px}html[dir] ._2XToIfXPoECB97QGfA0s1Q{margin:0}html[dir] ._2kScRvSuNbnd5hCZYWqYip:focus,html[dir] ._2kScRvSuNbnd5hCZYWqYip:hover{background:var(--neutralTertiaryAlt)}html[dir] ._3HS9-955Oq1kGT8wyRH6Ir,html[dir] ._3t4jrRbyvuBZ1rgucJZBiu,html[dir] .SsUJhwmZuhmKa45ZUDwCn,html[dir] .aMt_ivi_4A4j3WUs2Hwux,html[dir] ._2-fi4WdfG0r2tX1K4MuHZd,html[dir] .lOPdU79axYwebv9-YKmI8{margin:0;background-color:var(--themeLight)}html[dir] ._3HS9-955Oq1kGT8wyRH6Ir:focus,html[dir] ._3HS9-955Oq1kGT8wyRH6Ir:hover,html[dir] ._3t4jrRbyvuBZ1rgucJZBiu:focus,html[dir] ._3t4jrRbyvuBZ1rgucJZBiu:hover,html[dir] .SsUJhwmZuhmKa45ZUDwCn:focus,html[dir] .SsUJhwmZuhmKa45ZUDwCn:hover,html[dir] .aMt_ivi_4A4j3WUs2Hwux:focus,html[dir] .aMt_ivi_4A4j3WUs2Hwux:hover,html[dir] ._2-fi4WdfG0r2tX1K4MuHZd:focus,html[dir] ._2-fi4WdfG0r2tX1K4MuHZd:hover,html[dir] .lOPdU79axYwebv9-YKmI8:focus,html[dir] .lOPdU79axYwebv9-YKmI8:hover{background:var(--themeTertiary)}html[dir] ._3HS9-955Oq1kGT8wyRH6Ir{background-color:var(--themeLighterAlt)}",""]),e.locals={actionButton:"_1nM9lHOADRhr_c6SVOADHO",actionButtonForDocViewInCompose:"SyP9uy9POMtEKSqcjz56r",actionButtonForImageView:"_2PEQBliXdsvC09cN2WpJ7R",extraRightPadding:"_3pwyFskFhtIASENu2YzJ6F",icon:"_2XToIfXPoECB97QGfA0s1Q",default:"_2kScRvSuNbnd5hCZYWqYip",edit:"_3HS9-955Oq1kGT8wyRH6Ir",notSelectedAndSaving:"_3t4jrRbyvuBZ1rgucJZBiu",selected:"SsUJhwmZuhmKa45ZUDwCn",selectedAndPending:"aMt_ivi_4A4j3WUs2Hwux",selectedAndSaving:"_2-fi4WdfG0r2tX1K4MuHZd",thematic:"lOPdU79axYwebv9-YKmI8"}},17042:function(t,e,n){var a=n(17043);"string"==typeof a&&(a=[[t.i,a,""]]);var o={transform:void 0};n(66)(a,o);a.locals&&(t.exports=a.locals)},17043:function(t,e,n){(e=t.exports=n(65)(!1)).push([t.i,"._2YdUjL_vLVrfkSyZPlmHA8{color:var(--themePrimary);min-height:1px;max-height:36px;font-size:16px;width:16px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0}html[dir] ._2YdUjL_vLVrfkSyZPlmHA8{margin:0 4px}._2WFO1wEm7Y9bzzhpYArO5m{vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}html[dir] ._2WFO1wEm7Y9bzzhpYArO5m{margin:0 4px}html[dir=ltr] ._1i9P9-sdCflkDykV4qfBhd{margin:0 0 0 12px;float:right}html[dir=rtl] ._1i9P9-sdCflkDykV4qfBhd{margin:0 12px 0 0;float:left}",""]),e.locals={menuIcon:"_2YdUjL_vLVrfkSyZPlmHA8",menuText:"_2WFO1wEm7Y9bzzhpYArO5m",icon:"_1i9P9-sdCflkDykV4qfBhd"}},3051:function(t,e,n){"use strict";function a(t,e){(e||window).open(t,"_blank")}n.d(e,"a",(function(){return a}))},3166:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(3051),o=n(61);const c=t=>{t.stopPropagation()};function i(t,e,n,i){var r;if(Object(o.o)("downloadFileFromUrl",{urlLength:t.length}),e)Object(a.a)(t);else{const e=document.createElement("a");e.style.display="none",e.href=t,e.download=i||"",e.referrerPolicy="origin",n||(n=(null===(r=document.activeElement)||void 0===r?void 0:r.parentElement)||document.body),n.appendChild(e),e.addEventListener("click",c),e.click(),e.removeEventListener("click",c),n.removeChild(e)}}},3410:function(t,e,n){"use strict";function a(t,e){return-1!==e.strategy.supportedMenuActions.indexOf(t)}n.d(e,"a",(function(){return a}))},4084:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var a=n(3166),o=n(707),c=n(1829),i=n(3460),r=n(1738),d=n(2334);async function l(t,e,n){const l=Object(r.a)(t);if(l)if(Object(o.b)()&&Object(i.a)(l.id,!0,!0),Object(c.c)(l.model))(await d.e.import())(l.model);else{const t=l.download.url;t&&Object(a.a)(t,e,n)}}},4227:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r}));var a=n(20),o=n(4084);n.d(e,"a",(function(){return o.a}));const c=new a.c(()=>n.e(899).then(n.bind(null,8306))),i=new a.a(c,t=>t.clickAttachment).importAndExecute,r=new a.a(c,t=>t.previewAttachment)},4637:function(t){t.exports=JSON.parse('{"h":"mXb","c":"nXb","g":"oXb","f":"pXb","e":"qXb","d":"rXb","i":"sXb","b":"tXb","a":"uXb","j":"vXb"}')},6575:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n(1738),o=n(2065);function c(t){const e=Object(a.a)(t),n=Object(o.a)(null==e?void 0:e.model);return 3===n}},6656:function(t,e,n){"use strict";var a;n.d(e,"a",(function(){return a})),function(t){t[t.saveToCloud=0]="saveToCloud",t[t.download=1]="download",t[t.addToCalendar=2]="addToCalendar",t[t.editAndReply=3]="editAndReply",t[t.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud",t[t.openAndEdit=5]="openAndEdit"}(a||(a={}))},8843:function(t){t.exports=JSON.parse('{"a":"GXb"}')},8844:function(t,e,n){"use strict";var a=n(0),o=n(686),c=n(320),i=n(1571),r=n(21),d=n(4637),l=n(5),u=n(17042),s=n.n(u),m=n(147);const b=n.n(m).a.bind(s.a);e.a=Object(r.a)((function(t){const e=t.isAlreadySaved?Object(l.b)(d.j):Object(l.b)(d.a);return a.createElement(a.Fragment,null,a.createElement(o.a,{className:s.a.menuIcon,imageProps:t.iconProps}),a.createElement("span",{className:s.a.menuText},t.itemText),a.createElement(i.a,{content:t.shouldShowDiamond?null:e},a.createElement(c.a,{className:b(s.a.menuIcon,s.a.icon),iconName:t.shouldShowDiamond?"Diamond":"Info"})))}))}}]);
//# sourceMappingURL=owa.208.js.map
self.scriptsLoaded['owa.208.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.208.js'] = (new Date()).getTime();