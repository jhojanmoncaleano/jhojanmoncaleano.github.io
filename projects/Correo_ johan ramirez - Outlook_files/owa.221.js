self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.221.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[221],{1801:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return i}));var r,o=n(3);const u=Object(o.createStore)("webPushStore",{currentView:0,webPushPermission:null===(r=window.Notification)||void 0===r?void 0:r.permission})(),c=Object(o.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,mailEnabled:null,reminderEnabled:null,vipMailEnabled:null,lastCheckboxUnchecked:null,promptCount:0,lastPromptDate:null})();function i(){return c}},1912:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"i",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return b})),n.d(t,"h",(function(){return f}));var r=n(61);const o="WebPushSetup";function u(e){m("vipMailEnabled",e)}function c(e){m("mailOption",e)}function i(e){m("reminderOption",e)}function s(e){m("enabled",e)}function a(e,t){m("disabled",e),m("allClients",t)}function d(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(m("result",e),O())}function l(){m("lightning","ignored"),O()}function b(e){m("permission",e)}function f(e){m("roaming",e)}function O(){Object(r.o)(o,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function m(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1962:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return d}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(16),n.e(22),n.e(55),n.e(534)]).then(n.bind(null,4656)));let u=new r.a(o,e=>e.bootStrapWebPushService);const c=new r.b(o,e=>e.userInitiatedWebPushSetupWorkflow),i=new r.b(o,e=>e.userInitiatedWebPushDisableWorkflow),s=new r.b(o,e=>e.unsubscribe),a=new r.b(o,e=>e.loadWebPushOptions),d=Object(r.d)(o,e=>e.WebPushDiscovery)},2138:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a}));var r=n(1801),o=n(2618),u=n(2140);const c=function(e={store:r.b}){return null!=e.store&&null==e.store.enabled&&e.store.uniqueDaysSessionCount>=u.b&&e.store.lastPromptDate!=Object(o.a)().toDateString()&&e.store.promptCount<=u.a},i=function(e={store:r.b}){return e.store.mailEnabled||e.store.reminderEnabled},s=function(e={store:r.b}){var t,n,o;return{newMail:null!==(t=e.store.mailEnabled)&&void 0!==t&&t,reminder:null!==(n=e.store.reminderEnabled)&&void 0!==n&&n,vipMailOnly:null!==(o=e.store.vipMailEnabled)&&void 0!==o&&o}},a=function(e={store:r.b}){return e.store.reminderEnabled&&e.store.enabled}},2140:function(e,t,n){"use strict";var r=n(1801),o=n(2618),u=n(699),c=n(11);const i="WebPushUserSettings",s=5;function a(e,t){let n=d(e),r=-1;for(let e=0;e<n.length;++e)if(n[e].userPreferenceIdentifier==t.userPreferenceIdentifier){r=e;break}if(r>=0)n[r]=t;else{if(r=n.length,n.length>=s){r=0;let e=new Date(n[0].lastSessionDate);for(let t=1;t<n.length;++t){let o=new Date(n[t].lastSessionDate);o.getTime()<e.getTime()&&(e=o,r=t)}}n[r]=t}!function(e,t){if(t.length>0){let n=JSON.stringify(t);Object(c.e)(e,i,n)}else Object(c.d)(e,i)}(e,n)}function d(e){let t=Object(c.a)(e,i),n=new Array;try{let e=JSON.parse(t);null!=e&&(n=e)}catch(t){Object(c.d)(e,i)}return n}var l=n(2138),b=n(44);n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return O})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return S})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return w}));const f=4,O=3,m=Object(u.action)("loadLocalWebPushUserSetting")((function(e,t,n={store:r.b}){let o=function(e,t){let n=d(e),r=null;for(let e=0;e<n.length;++e)if(n[e].userPreferenceIdentifier==t){r=n[e];break}return r}(e,t);if(null!=o)Object.keys(o).forEach(e=>{n.store[e]=o[e]}),w(e);else{let r=function(e,t){let n=d(e),r=null;for(let e=0;e<n.length;++e)n[e].userPreferenceIdentifier<t&&(r?n[e].userPreferenceIdentifier>r.userPreferenceIdentifier&&(r=n[e]):r=n[e]);return r}(e,t);r&&(n.store.lastCheckboxUnchecked=r.lastCheckboxUnchecked,n.store.mailEnabled=r.mailEnabled,n.store.reminderEnabled=r.reminderEnabled,n.store.vipMailEnabled=r.vipMailEnabled),n.store.userPreferenceIdentifier=t,a(e,n.store)}})),h=Object(u.action)("incrementUniqueDaysSessionCount")((function(e,t={store:r.b}){let n=Object(o.a)().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<f&&t.store.uniqueDaysSessionCount++,a(e,t.store))})),j=Object(u.action)("resetLocalWebpushUserSetting")((function(e,t,n={store:r.b}){n.store.userPreferenceIdentifier=t,n.store.enabled=!1,n.store.promptCount=0,n.store.lastPromptDate=null,n.store.uniqueDaysSessionCount=0,a(e,n.store)})),S=Object(u.action)("updateLocalWebPushEnabledStatus")((function(e,t,n,o={store:r.b}){o.store.enabled=t,o.store.userPreferenceIdentifier=n,t&&w(e),a(e,o.store)})),p=Object(u.action)("incrementLocalWebPushPromptCount")((function(e,t={store:r.b}){t.store.promptCount++,t.store.lastPromptDate=Object(o.a)().toDateString(),a(e,t.store)})),g=Object(u.action)("resetLocalWebPushPromptCount")((function(e,t={store:r.b}){t.store.promptCount=0,t.store.lastPromptDate=null,a(e,t.store)})),w=Object(u.action)("validateAndUpdateCheckboxOptions")((function(e,t={store:r.b}){if(t.store.enabled){if(!Object(l.b)())if(t.store.lastCheckboxUnchecked){switch(t.store.lastCheckboxUnchecked){case"NewMail":t.store.mailEnabled=!0;break;case"Reminder":t.store.reminderEnabled=!0}t.store.lastCheckboxUnchecked=null}else t.store.mailEnabled=!0,t.store.reminderEnabled=!0;1!=t.store.mailEnabled||null!=t.store.reminderEnabled&&null!=t.store.reminderEnabled||(t.store.reminderEnabled=!0)}Object(b.j)("auth-scheduleTimerForReminderWebPush")||(t.store.reminderEnabled=null,t.store.lastCheckboxUnchecked=null),a(e,t.store)}))},231:function(e,t,n){"use strict";var r=n(20),o=n(3),u=Object(o.action)("ADD_ACCOUNT",e=>({accountSource:e})),c=Object(o.action)("SET_LOAD_STATE",e=>({loadState:e})),i=(Object(o.action)("ON_SELECTED_ACCOUNT_CHANGED",(e,t)=>({selectedAccountSourceId:e,selectedEmailAddress:t})),Object(o.action)("UPDATE_ACCOUNT",e=>({accountSource:e}))),s=n(40),a=n(268);function d(e){const t=Object(a.a)().sources.filter(t=>t.sourceId===e);return t.length>1&&Object(s.e)("DuplicateSourceIdFoundInStore"),t[0]}function l(){return d(Object(a.a)().selectedSourceId)}function b(){return Object(a.a)().sources.filter(e=>e.characteristics.supportsMail)}var f=n(507);Object(o.mutator)(u,e=>{const t=Object(a.a)();if(d(e.accountSource.sourceId))throw new Error("Found duplicated account in the store.");t.sources.push(e.accountSource),t.selectedSourceId||(t.selectedSourceId=e.accountSource.sourceId),t.globalSettingsSourceId||(t.globalSettingsSourceId=e.accountSource.sourceId)}),Object(o.mutator)(c,e=>{Object(a.a)().loadState=e.loadState}),Object(o.mutator)(i,e=>{const t=Object(a.a)();t.sources=t.sources.map(t=>t.sourceId===e.accountSource.sourceId?e.accountSource:t)});n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return h})),n.d(t,"e",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"m",(function(){return i})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return a.a})),n.d(t,"h",(function(){return b})),n.d(t,"a",(function(){return f.a})),n.d(t,"b",(function(){return f.b})),n.d(t,"c",(function(){return f.c})),n.d(t,"d",(function(){return f.d}));const O=new r.c(()=>n.e(2030).then(n.bind(null,19310))),m=new r.b(O,e=>e.removeAccountById),h=(new r.b(O,e=>e.setGlobalSettingsAccount),new r.b(O,e=>e.setSelectedAccount))},2526:function(e,t,n){"use strict";function r(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",(function(){return r}))},2580:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(44),o=n(96),u=n(1700),c=n(5);const i=e=>!(!Object(r.j)("fwk-webPushNotification")&&!Object(r.j)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(o.d)()||Object(o.f)()||Object(r.j)("fwk-webPushNotificationExtended")&&(Object(o.e)()||Object(o.h)()))&&!Object(c.i)()&&(1==Object(u.c)()||2==Object(u.c)())))},2618:function(e,t,n){"use strict";function r(){return new Date}n.d(t,"a",(function(){return r}))},268:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(3);const o={loadState:n(507).b.Loading,selectedSourceId:"",globalSettingsSourceId:"",sources:[]},u=Object(r.createStore)("AccountSourceList",o);t.a=u},2817:function(e,t,n){"use strict";var r=n(1912),o=n(2526),u=n(1801),c=n(2140),i=n(2138),s=n(2580),a=n(1962),d=n(3),l=Object(d.mutatorAction)("updateEnabled",e=>{Object(u.a)().enabled=e}),b=Object(d.mutatorAction)("updateMailEnabled",e=>{Object(u.a)().mailEnabled=e}),f=Object(d.mutatorAction)("updateVipMailEnabled",e=>{Object(u.a)().vipMailEnabled=e}),O=Object(d.mutatorAction)("updateReminderEnabled",e=>{Object(u.a)().reminderEnabled=e}),m=Object(d.mutatorAction)("updateLastCheckboxUnchecked",e=>{Object(u.a)().lastCheckboxUnchecked=e});n.d(t,"n",(function(){return r.b})),n.d(t,"m",(function(){return r.a})),n.d(t,"r",(function(){return r.i})),n.d(t,"o",(function(){return r.d})),n.d(t,"q",(function(){return r.g})),n.d(t,"p",(function(){return r.f})),n.d(t,"b",(function(){return o.a})),n.d(t,"a",(function(){return u.a})),n.d(t,"l",(function(){return u.b})),n.d(t,"k",(function(){return c.e})),n.d(t,"x",(function(){return c.i})),n.d(t,"c",(function(){return i.b})),n.d(t,"d",(function(){return i.c})),n.d(t,"e",(function(){return s.a})),n.d(t,"j",(function(){return a.f})),n.d(t,"i",(function(){return a.e})),n.d(t,"h",(function(){return a.d})),n.d(t,"g",(function(){return a.c})),n.d(t,"f",(function(){return a.b})),n.d(t,"s",(function(){return l})),n.d(t,"u",(function(){return b})),n.d(t,"w",(function(){return f})),n.d(t,"v",(function(){return O})),n.d(t,"t",(function(){return m}))},507:function(e,t,n){"use strict";var r,o,u,c;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return c})),function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Error=2]="Error"}(r||(r={})),function(e){e[e.AAD=0]="AAD",e[e.MSA=1]="MSA"}(o||(o={})),function(e){e.UserMailbox="UserMailbox",e.GroupMailbox="GroupMailbox",e.TeamsMailbox="TeamsMailbox",e.PublicMailbox="PublicMailbox",e.SharedMailbox="SharedMailbox",e.ArchiveMailbox="ArchiveMailbox"}(u||(u={})),function(e){e.Office365="Office365",e.OutlookDotCom="Outlook",e.Goolge="Google",e.ICloud="ICloud",e.Yahoo="Yahoo"}(c||(c={}))},516:function(e,t,n){"use strict";n(707);var r=n(231),o=n(40);function u(e){if(e){const t=Object(r.g)().sources.filter(t=>{var n;return(null===(n=null==t?void 0:t.m365mailbox)||void 0===n?void 0:n.userIdentity)===e});return 0===t.length&&Object(o.e)("SourceIdNotFoundForUserIdentity"),t[0].sourceId}const t=Object(r.i)();return t||Object(o.e)("NoSelectedAccountForDefaultUserIdentity"),t.sourceId}n(12);let c={};function i(e){c=Object.assign(Object.assign({},c),e)}async function s(e){return c.addM365Account||Object(o.e)("NoPluggableMethodAddM365Account"),c.addM365Account(e)}async function a(e){return c.addOutlookDotComAccount||Object(o.e)("NoPluggableMethodAddOutlookDotComAccount"),c.addOutlookDotComAccount(e)}async function d(e){return c.removeAccount||Object(o.e)("NoPluggableMethodRemoveAccount"),c.removeAccount(e)}function l(){let e=Object(r.i)();return e||Object(o.e)("NoAccountSelected"),e.sourceId}async function b(e){Object(r.f)(e)||Object(o.e)("SelectedAccountNotFound"),await async function(e){if(c.preSelectAccount)return c.preSelectAccount(e)}(e),(await r.k.import())(e)}var f,O,m,h;!function(e){e.Mailbox="MAILBOX"}(f||(f={})),function(e){e.Microsoft365="MICROSOFT365",e.OutlookDotCom="OUTLOOKDOTCOM"}(O||(O={})),function(e){e.GetAuthTokenFailed="INVALIDCREDENTIALS",e.CouldNotConnect="CONNECTFAILED",e.DuplicateAccount="DUPLICATE"}(m||(m={})),function(e){e.AccountNotFound="NOT_FOUND"}(h||(h={}));const j="main",S="m365",p=":";function g(e,t,n){return e+p+t+p+n}function w(e){const t=Object(r.f)(e);return t?{type:t.m365mailbox.type,userIdentity:t.m365mailbox.userIdentity,mailboxSmtpAddress:t.m365mailbox.emailAddress}:void 0}function A(e,t){const n=Object.assign(Object.assign({},t.characteristics),{isMicrosoft365Hosted:!0}),o=t.mailbox?Object.assign(Object.assign({},t.mailbox),{type:r.d.UserMailbox,logonEmailAddress:t.mailbox.loginAddress,authProviderType:t.authProviderType===O.Microsoft365?r.c.AAD:r.c.MSA}):void 0;return{sourceId:e,sourceType:t.authProviderType===O.Microsoft365?r.a.Office365:r.a.OutlookDotCom,displayName:t.displayName,characteristics:n,m365mailbox:o}}function P(e){const t=g(j,S,e.mailbox.userIdentity);return Object(r.f)(t)||Object(r.e)(A(t,e)),t}function E(e){const t=g(j,S,e.mailbox.userIdentity);return Object(r.f)(t)&&Object(r.m)(A(t,e)),t}n.d(t,"j",(function(){return u})),n.d(t,"n",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return a})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"l",(function(){return b})),n.d(t,"e",(function(){return P})),n.d(t,"h",(function(){return w})),n.d(t,"m",(function(){return E})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return O}))},5492:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(32);function o(e){return Object(r.a)("GetMailboxJunkEmailConfiguration",{},e)}},9142:function(e,t,n){"use strict";var r=n(20),o=n(9831),u=n(1689),c=n(44),i=new r.c(()=>Promise.all([n.e(92),n.e(1069)]).then(n.bind(null,19519)));var s=Object(u.b)({key:"SuggestedReplies",titleStringKey:o.a,searchTermsStringKey:o.a,isHidden:()=>!Object(c.j)("mc-smartReply")},i,e=>e.default);n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return s}));const a=new r.c(()=>n.e(1205).then(n.bind(null,19627)));let d=new r.b(a,e=>e.turnSuggestedRepliesOnOff)},9831:function(e){e.exports=JSON.parse('{"a":"m7a"}')}}]);
//# sourceMappingURL=owa.221.js.map
self.scriptsLoaded['owa.221.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.221.js'] = (new Date()).getTime();