self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.253.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[253],{1038:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(32),i=n(972);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,t)}},1040:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FindItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},164:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var c={value:n,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),a&&a(t,n)}.bind(this),i)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var a=e[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&t++,a.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(o)if(e[a])continue;var u=r[a],c=u.expire-i;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,u.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},1685:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e){if(!e)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(e)}},1688:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return p}));const r=["journal","outbox","syncissues"],i="archivemsgfolderroot",o="msgfolderroot",a="archivedeleteditems",u="deleteditems",c="archiverecoverableitemsdeletions",s="recoverableitemsdeletions",d="msgfolderroot",l="sharedFolderTree",f="primaryFolderTree",b="archiveFolderTree",m="favorites",p="groups"},1690:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(14),i=n(3);const o={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}};let a=Object(i.createStore)("mail",o);const u=a();t.a=u},1692:function(e,t,n){"use strict";var r=n(20),i=n(1690),o=n(1827),a=n(1760),u=n(1752);const c="ChronologicalNewestOnBottom";function s(e,t){return e[t==c?0:e.length-1]}var d=n(705),l=n(1705);function f(e){return Object(u.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(l.a)({FieldURI:"TailoredXpEntities"}),Object(l.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(l.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(l.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then(e=>{if(e&&!(e instanceof Error)){const{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}=e;return{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}}return{}})}var b=n(1838),m=n(29);function p(e){const t=i.a.conversations.get(e);if(t){const e=Object(m.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==e}return!1}var h=n(1797),v=n(1683);function g(e,t={folderTable:v.d.folderTable}){return!!t.folderTable.get(e)}var O=n(1688);function w(e,t){const n=v.d.folderTable.get(e);return!!n&&(Object(v.H)(n,O.d,t)||n.distinguishedFolderType===O.b)}function I(e){return w(e)||function(e){const t=v.d.folderTable.get(e);return t&&t.distinguishedFolderType===O.d}(e)}function j(e,t,n={folderTable:v.d.folderTable}){return Object(v.H)(e,t,n)}var y=n(1839),x=n(1812);function T(e){return e&&(Object(x.a)(e,O.i)||Object(x.a)(e,O.b))}function S(e){return e&&(j(e,O.h)||j(e,O.a))}var C=n(1809);function E(e,t){try{return P(e,t)}catch(e){return null}}function P(e,t){if(!e||!t)return null;const n=Object(v.m)().get(e).PermissionSet.Permissions.filter(e=>e.UserId.PrimarySmtpAddress===t);return null==n?void 0:n[0]}var k=n(283);const A="OneOff",R="Unknown";function D(e,t,n){return!Object(k.a)()&&(n==A||n==R)&&(null==e?void 0:e.indexOf(t))<0}var F=n(3),M=Object(F.mutatorAction)("setIsDraftQueuedForSubmission",(e,t)=>{const n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}),L=n(1741);n.d(t,"s",(function(){return U})),n.d(t,"u",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"e",(function(){return u.a})),n.d(t,"d",(function(){return s})),n.d(t,"t",(function(){return f})),n.d(t,"v",(function(){return b.a})),n.d(t,"q",(function(){return p})),n.d(t,"c",(function(){return h.a})),n.d(t,"r",(function(){return g})),n.d(t,"m",(function(){return w})),n.d(t,"l",(function(){return I})),n.d(t,"n",(function(){return j})),n.d(t,"j",(function(){return y.a})),n.d(t,"k",(function(){return T})),n.d(t,"p",(function(){return S})),n.d(t,"f",(function(){return C.a})),n.d(t,"h",(function(){return E})),n.d(t,"i",(function(){return P})),n.d(t,"o",(function(){return D})),n.d(t,"w",(function(){return M})),n.d(t,"x",(function(){return L.a}));const N=new r.c(()=>n.e(2067).then(n.bind(null,19538))),U=new r.a(N,e=>e.setTriageActionAnnouncement)},1699:function(e,t,n){"use strict";function r(e){if(!e)return null;const t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){const t=r(e);return t?t.replace(".",""):null}function o(e){var t;return(null===(t=i(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}))},1702:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1705:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"PropertyUri:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1724:function(e,t,n){"use strict";var r=n(1699),i=n(1959),o=n(5);function a(e){let t;return e>=1073741824?(e/=1073741824,t=Object(o.b)(i.b)):e>=1048576?(e/=1048576,t=Object(o.b)(i.d)):e>=1024?(e/=1024,t=Object(o.b)(i.c)):t=Object(o.b)(i.a),Object(o.c)(t,Math.round(e))}var u=n(1799),c=n(44);const s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(e){if(!Object(c.j)("doc-attachment-documentThumbnail"))return!1;const t=Object(r.a)(e);return!!t&&s.indexOf(t.toLowerCase())>=0}var l;function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return l.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return l.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return l.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(l||(l={}));var b=n(1762);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return l}))},1726:function(e,t,n){"use strict";var r=n(3);let i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}});var o=i();function a(){return o.selectedNode}function u(){const e=a();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o}))},1727:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(3),i=n(14);const o=Object(r.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxFolderTreeData:new i.ObservableMap}),a=o();t.a=o},1729:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1857);function i(e,t){const n=Object(r.a)(t),i=n&&n.get(e);return null==i?void 0:i.rootFolder}},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1940);function i(e){if(!e)return null;return Object(r.a)().attachments.get(e.Id)}},1741:function(e,t,n){"use strict";var r=n(44),i=n(121),o=n(49),a=n(20);const u=new a.c(()=>n.e(1160).then(n.bind(null,19563))),c=new a.b(u,e=>e.isReadingPaneConversationEnabled);function s(){var e,t;if(Object(r.j)("mon-rp-unstackedConversation")){return 0==(null===(t=null===(e=Object(o.g)())||void 0===e?void 0:e.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)&&!function(){var e,t;let n=null;const r=c.tryImportForRender();if(r)n=r();else{const r=Object(i.a)("useNativeConversationOptions");let a=null===(e=Object(o.g)())||void 0===e?void 0:e.PrimeSettings;if(null==a?void 0:a.Items)for(let e of a.Items)if("ReadingPaneConversationOptions"===e.Id&&e.Value){const i=null===(t=e.Value.options)||void 0===t?void 0:t[0];n=r?null==i?void 0:i.conversationEnabledNativeHost:null==i?void 0:i.conversationEnabled;break}null==n&&(n=!r)}return n}()}return!1}n.d(t,"a",(function(){return s}))},1752:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1977),i=n(44);const o=new(n(4).d)(()=>Promise.all([n.e(9),n.e(10),n.e(12),n.e(13),n.e(291),n.e(2068)]).then(n.bind(null,2508)));function a(e,t,n,a,u,c,s,d,l){if(Object(i.j)("mon-rp-loadItemViaGql")){if(!e&&!d)throw new Error("getItem passed a null or undefined id");return o.import().then(r=>r.getItemViaGraphQL(e,t,n,a,u,c,s,d,l))}return Object(r.a)(e,t,n,a,c,s,d)}},1754:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(316);function i(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1760:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1762:function(e,t,n){"use strict";function r(e){return function(e){const t=o.exec(e);return t&&t.length>1&&i[t[1].toLowerCase()]}(e||"")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){let t="";return Object.entries(i).forEach(n=>{n[1]===e&&(t=n[0])}),t}},1765:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1777),i=n(1774);function o(e){if(!e)return Promise.reject(Object(r.a)("500","Server returned a null response!",null));const t=Array.isArray(e)?e:[e];for(const e of t)if(e&&!Object(i.a)(e))return Promise.reject(Object(r.a)(e.ResponseCode,e.StackTrace,e.MessageText));return Promise.resolve()}},1774:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r="Success";function i(e){return e&&e.ResponseClass==r}},1777:function(e,t,n){"use strict";function r(e,t,n){let r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);const i=new Error(r);return i.responseCode=e,i.fetchErrorType="ServerFailure",n&&(i.diagnosticInfo="MessageText= "+n),i}n.d(t,"a",(function(){return r}))},1788:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},1791:function(e,t,n){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){let t=null;const n=r.exec(e);if(n){const e=n[1],r=n[2];let i=null;try{i=atob(r)}catch(e){}if(i){const n=new ArrayBuffer(i.length),r=new Uint8Array(n);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);t=new File([n],"image.png",{type:e})}}return t}var o=n(1702),a=n(1724);function u(e){return e.map(e=>({fileType:o.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}))}var c=n(40);function s(e,t,n){if(e.length!=t.length)return c.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let i=0;i<e.length;i++){const a={fileType:o.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};r.push(a)}return r}function d(e,t,n){const r=[],i={fileType:o.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(i),r}function l(e){if(!e)return null;let t=[];for(var n=0;n<e.length;n++){const r=e[n],i={fileType:o.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}function f(e){if(!e)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function b(e){var t,n;if(null===e)return null;return{fileType:o.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function m(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:o.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p=n(1865);function h(e){switch(e?e.toLowerCase():null){case p.d.ONE_DRIVE_PRO.toLowerCase():return 0;case p.d.GDRIVE.toLowerCase():return 5;case p.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.d.DROPBOX.toLowerCase():return 2;case p.d.BOX.toLowerCase():return 3;case p.d.WOPI_BOX.toLowerCase():return 7;case p.d.WOPI_EGNYTE.toLowerCase():return 8;case p.d.MAILBOX.toLowerCase():return 4;case p.d.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return i})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return o.a}))},1797:function(e,t,n){"use strict";const r=new(n(939).a)(50);t.a=r},1799:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(1699),i=n(1762),o=n(169);const a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],u=[".tiff",".tif"];function c(e,t,n=!0){return s(Object(r.a)(e)||Object(i.a)(t),n)}function s(e,t=!0){return!!e&&(a.indexOf(e.toLowerCase())>=0||t&&u.indexOf(e.toLowerCase())>=0&&(Object(o.c)()||Object(o.f)()))}},1809:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1683),i=n(1726);function o(){const e=Object(i.c)();let t=null;return t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id,null==t?null:r.d.folderTable.get(t)}},1810:function(e,t,n){"use strict";var r=n(20);var i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return i}));const o=new r.c(()=>Promise.all([n.e(0),n.e(663)]).then(n.bind(null,19157))),a=new r.a(o,e=>e.subscribe),u=new r.a(o,e=>e.unsubscribe),c=new r.b(o,e=>e.getChannelId),s=new r.a(o,e=>e.getChannelReady),d=new r.a(o,e=>e.retryDisconnectionWithMinimumReconnectInterval),l=new r.a(o,e=>e.setup),f=new r.a(o,e=>e.handleNotification),b=new r.a(o,e=>e.NotificationManager.stopConnection),m=new r.a(o,e=>e.initializeNotificationManager),p=new r.b(o,e=>e.getNotificationEmitter)},1812:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},1827:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1838:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1690);function i(e){return r.a.items.get(e)}},1839:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1812),i=n(1688);function o(e){return e&&(Object(r.a)(e,i.h)||Object(r.a)(e,i.a))}},1845:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1727);function i(){return Object(r.a)().folderTable}},1857:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(1727),i=n(49);function o(e){return a(e).folderTreeTable}function a(e){return e||(e=Object(i.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},1860:function(e,t,n){"use strict";var r=n(49),i=n(44);function o(e){var t;const n=Object(r.g)().SegmentationSettings,o=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(i.j)("cal-stickyNotesFolder")&&!o}var a=n(283);function u(){const e=Object(a.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(i.j)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}))},1865:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"d",(function(){return m}));const r="Box",i="Dropbox",o="Facebook",a="GDrive",u="Mailbox",c="MailMessage",s="OneDriveConsumer",d="OneDrivePro",l="WopiBox",f="WopiDropbox",b="WopiEgnyte",m={BOX:r,DROPBOX:i,FACEBOOK:o,GDRIVE:a,MAILBOX:u,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:l,WOPI_EGNYTE:b}},1876:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1889:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1729),i=n(1688);function o(e){return Object(r.a)(i.k,e)}},1890:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1729),i=n(1688);function o(e){return Object(r.a)(i.d,e)}},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1729);function i(e){return Object(r.a)(e)}},1917:function(e,t,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1920:function(e,t){e.exports=function(e){return e instanceof Date}},1959:function(e){e.exports=JSON.parse('{"b":"Mda","d":"Nda","c":"Oda","a":"Pda"}')},1965:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b}));var r=n(1685),i=n(1703),o=n(1727),a=n(1889),u=n(1845),c=n(1890),s=n(1896),d=n(1860);function l(e,t){const n=Object(u.a)();if(t){return[...n.values()].filter(n=>n.distinguishedFolderType===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function f(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(c.a)(t);break;case"SharedMailbox":n=Object(s.a)(t);break;default:n=Object(a.a)(t)}const u=Object(d.a)();if("UserMailbox"==e&&n.distinguishedFolderType==Object(a.a)(t).distinguishedFolderType&&n.id){const e=u.map(e=>l(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.id):e.map(e=>e.id)}const f=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>o.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.id)}(n,t);for(let e=0;e<f.length;e++)-1==u.indexOf(Object(i.a)(f[e]))&&r.push(f[e]);return r}function b(e,t){const n=Object(u.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},1974:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(266);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1977:function(e,t,n){"use strict";var r=n(954),i=n(910);var o=n(955),a=n(245),u=n(40),c=n(1765);function s(e,t,n,s,d,l,f){const b=Object(a.b)();var m;return s&&(b.RequestServerVersion=s),l&&(b.ManagementRole=(m={UserRoles:["MailboxSearch"]},Object.assign({__type:"ManagementRoleType:#Exchange"},m))),Object(o.a)({Header:b,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map(e=>Object(i.a)({Id:e})):e?[Object(i.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:f})},d).then(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}).then(e=>Object(c.a)(e).then(()=>e)).then(t=>{if(!(null==t?void 0:t.length))return null;let n=[];return t.forEach(e=>{n=n.concat(e.Items)}),n.length?Array.isArray(e)||void 0!==f?n:n[0]:null}).catch(e=>(u.h.warn("GetItem:"+e.message),e))}n.d(t,"a",(function(){return s}))},1999:function(e,t,n){var r=n(1920),i=36e5,o=6e4,a=2,u=/[T ]/,c=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,m=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,v=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/([Z+-].*)$/,j=/^(Z)$/,y=/^([+-])(\d{2})$/,x=/^([+-])(\d{2}):?(\d{2})$/;function T(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?a:Number(n);var S=function(e){var t,n={},r=e.split(u);c.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=I.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),C=function(e,t){var n,r=d[t],i=f[t];if(n=l.exec(e)||i.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=s.exec(e)||r.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(S.date,n),E=C.year,P=function(e,t){if(null===t)return null;var n,r,i,o;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=b.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=m.exec(e)){r=new Date(0);var a=parseInt(n[1],10);return r.setUTCFullYear(t,0,a),r}if(n=p.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var u=parseInt(n[2],10);return r.setUTCFullYear(t,i,u),r}if(n=h.exec(e))return o=parseInt(n[1],10)-1,T(t,o);if(n=v.exec(e)){o=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return T(t,o,c)}return null}(C.restDateString,E);if(P){var k,A=P.getTime(),R=0;return S.time&&(R=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=O.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*o;if(t=w.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var a=parseFloat(t[3].replace(",","."));return n%24*i+r*o+1e3*a}return null}(S.time)),S.timezone?k=function(e){var t,n;if(t=j.exec(e))return 0;if(t=y.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=x.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(S.timezone):(k=new Date(A+R).getTimezoneOffset(),k=new Date(A+R+k*o).getTimezoneOffset()),new Date(A+R+k*o)}return new Date(e)}},2036:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(5),i=n(283),o=n(50),a=n(2199),u=n(96),c=n(2),s=n(30),d=n(2039),l=n(2037);function f(e,t,n,f=!1,b=null){if(!e||!e.Id||!e.mailboxInfo)return null;const m=Object(d.b)(e.mailboxInfo),p=null==m?void 0:m.downloadUrlBase,h=Object(l.a)(e.mailboxInfo);if(b=b||Object(r.c)(t,encodeURIComponent(e.Id)),!p||f&&"Firefox"===Object(u.a)().browser){const e=a.e+b+"&X-OWA-CANARY="+Object(o.a)();return Object(s.a)(e)}let v="{0}{1}/{2}";Object(i.a)()&&(v+="&isc=1");let g=Object(r.c)(v,p,h,b);return n&&(g+="&token="+(null==m?void 0:m.downloadToken),g+="&X-OWA-CANARY="+Object(o.a)()),g+="&owa="+window.location.hostname,g+="&scriptVer="+Object(c.u)()||!1,g}},2037:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(209),i=n(272);function o(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const t=e.userIdentity&&Object(i.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2039:function(e,t,n){"use strict";var r=n(272);const i={};function o(e){return i[e]}function a(e,t){const n=i[e];i[e]=Object.assign(Object.assign({},n),t)}var u=n(49),c=n(707),s=n(61),d=n(914),l=n(807),f=n(32);var b=n(40),m=n(1718),p=n(1715);const h=Object(l.b)({timeBetweenRetryInMS:()=>3e4});async function v(e){const t=async()=>{try{let t={};return Object(c.b)()?t={sourceId:Object(d.a)(null==e?void 0:e.userIdentity)}:Object(r.r)(e.userIdentity)&&(t=await async function(e){let t={};t.headers=new Headers;const n=await Object(m.a)(e);return Object(p.b)(t.headers,n),t}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(t)}catch(e){throw b.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},n=o(e.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){a(e.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:r}=h(async()=>{n++;const r=await t();b.h.info("update new token"),a(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),i=new s.c("AttachmentRefreshDownloadToken");try{await r(),i.addCustomData([n]),i.end()}catch(t){b.h.warn(`Retry to refresh token failed: ${t}`),i.addCustomData([n]),i.endWithError("ServerError",t),a(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function g(e){const t=Object(r.r)(e.userIdentity)?Object(u.h)(e.userIdentity):Object(u.g)(),n=null==t?void 0:t.ApplicationSettings;if(n){const t=n.DownloadUrlBase;a(e.userIdentity,{downloadUrlBase:t,downloadToken:n.FirstDownloadToken}),t&&function(e,t){t=t<1?1:t,Object(c.b)()&&v(e),setInterval(()=>{v(e)},6e4*t)}(e,n.DownloadTokenRefreshMinutes)}}var O=n(266);function w(e){const t=Object(r.j)(null==e?void 0:e.userIdentity),n=o(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Office365":case"Outlook":g(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(O.a)(t)}const i=o(e.userIdentity);return i||(Object(s.o)("FilesUrlDataNotFound",{accountProviderType:t}),b.h.warn("Unable to get the url data")),i}function I(e){if(!e)return null;const t=w(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return I}))},2081:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},2101:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},2102:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2125:function(e,t,n){"use strict";var r=n(1754);function i(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var o=n(1974),a=n(1822);function u(){return i()}function c(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(a.a)(e)}(e))}(e)?i():[]).map(o.a)}n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}))},2199:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return d}));const r="/owa/",i="service.svc/s/GetFileAttachment?id={0}",o="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",a="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",c="service.svc/s/GetAttachmentThumbnail?id={0}",s="pdfprint.aspx?id={0}",d="pdfprint.aspx?id={0}&location={1}"},2244:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},2247:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"l",(function(){return v}));var r=n(20),i=n(2101);n.d(t,"n",(function(){return i.a}));var o=n(2081);n.d(t,"a",(function(){return o.a}));var a=n(1917);n.d(t,"d",(function(){return a.b})),n.d(t,"c",(function(){return a.a}));var u=n(2102);n.d(t,"b",(function(){return u.a}));const c=new r.c(()=>Promise.all([n.e(0),n.e(26),n.e(94),n.e(735)]).then(n.bind(null,3285))),s=new r.b(c,e=>e.getSharingInformation),d=new r.b(c,e=>e.getSharingIssuesForSharingData),l=new r.b(c,e=>e.getInfoBarCreator),f=new r.b(c,e=>e.hasLargeDLRecipient),b=new r.b(c,e=>e.hasRecipientExpansionFailure),m=new r.b(c,e=>e.getGroupsAndSmallDLs),p=new r.b(c,e=>e.getInvididualRecipients),h=new r.b(c,e=>e.hasGetRecipientPermissionFailed),v=new r.b(c,e=>e.logSharingTipChangesForLinkRemoval)},2251:function(e,t,n){"use strict";var r=n(266),i=n(5),o=n(50),a=n(2199);const u=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var c=n(2036),s=n(30);function d(e,t,n,d,l=0,f=0,b=!0,m=null,p=null){let h;switch(n){case 0:h=a.f;break;case 3:h=a.h;break;case 1:if(!function(e){if(!e)return!1;let t=null;const n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&u.indexOf(t.toLowerCase())>=0}(m))return null;h=a.g;break;default:Object(r.a)(n)}let v=d?f:l;!v&&l&&(v=l);let g=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(h,encodeURIComponent(e.Id),encodeURIComponent(t)),v);const O=Object(c.a)(e,h,!0,3===n,g);if(O)return O;let w=Object(i.c)("{0}{1}{2}",a.e,p,g);if(b){w=`${w}&X-OWA-CANARY=${Object(o.a)()}`}return Object(s.a)(w)}function l(e,t,n=!1,o=!0){let u;switch(t){case 0:u=a.a;break;case 1:u=a.b;break;case 2:u=a.d;break;case 3:u=a.c;break;default:return Object(r.a)(t)}if(!Object(i.k)(u)){const r=Object(c.a)(e,u,o,3===t);return Object(i.c)("{0}{1}{2}",r,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}))},2292:function(e,t,n){"use strict";n.d(t,"u",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return v})),n.d(t,"o",(function(){return g})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return w})),n.d(t,"r",(function(){return I})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return y})),n.d(t,"v",(function(){return x})),n.d(t,"h",(function(){return T}));var r=n(20),i=n(3671);n.d(t,"a",(function(){return i.a}));var o=n(3066);n.d(t,"b",(function(){return o.a})),n.d(t,"e",(function(){return o.d}));var a=n(3167);n.d(t,"f",(function(){return a.a}));var u=n(3262);n.d(t,"d",(function(){return u.a}));var c=n(3672);n.d(t,"c",(function(){return c.a}));const s=new r.c(()=>n.e(1202).then(n.bind(null,7181))),d=new r.b(s,e=>e),l=new r.b(s,e=>e.resetPreviewPane),f=(new r.b(s,e=>e.setAudioPreviewState),new r.b(s,e=>e.setBlankPreviewState),new r.b(s,e=>e.setCustomPreviewState),new r.b(s,e=>e.setIframePreviewState)),b=(new r.b(s,e=>e.setImageGalleryItems),new r.b(s,e=>e.setImagePreviewLoaded)),m=new r.b(s,e=>e.setImagePreviewState),p=new r.b(s,e=>e.setImagePreviewStateFromImageGalleryItem),h=(new r.b(s,e=>e.setNativePdfPreviewState),new r.b(s,e=>e.setPanesSize)),v=(new r.b(s,e=>e.setPdfJsPreviewState),new r.b(s,e=>e.setPdfJsPreviewStateByData),new r.b(s,e=>e.setPreviewError)),g=new r.b(s,e=>e.setPreviewLoading),O=new r.b(s,e=>e.setRightPaneDisplayAndUpdateSize),w=new r.b(s,e=>e.setSaveStatusText),I=new r.b(s,e=>e.setTextPreviewState),j=(new r.b(s,e=>e.setVideoPreviewState),new r.b(s,e=>e.setWacPreviewState)),y=new r.b(s,e=>e.setWacReadOnly),x=new r.b(s,e=>e.updatePanesSize),T=new r.b(s,e=>e.saveHideReadingPaneOption);new r.b(s,e=>e.saveDefaultEditCommandOption)},2315:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},2322:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(e,t)=>({status:e,sxsId:t})),o=n(2315),a=n(2244);function u(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}function c(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}function s(e){const t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}function d(e){const t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function l(e){return!!e.RecurrenceId}n.d(t,"h",(function(){return i})),n.d(t,"b",(function(){return o.a})),n.d(t,"f",(function(){return a.a})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l}))},2324:function(e,t,n){"use strict";var r=n(20);const i=[0,1];var o=n(2449),a=n(2415),u=n(5),c=n(266),s=n(1788);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(a.a),messageParts:[Object(u.b)(a.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(o.b),messageParts:[Object(u.b)(o.b),l()],color:s.a.Red};default:return Object(c.a)(e)}}function l(){return{text:Object(u.b)(o.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2125),b=n(1974),m=n(44),p=n(1754);function h(){const e=Object(p.a)();if(Object(m.j)("fwk-devTools")){if(Object(m.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(m.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function v(){const e=h();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return O})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return b.a})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return h}));const g=new r.c(()=>n.e(2036).then(n.bind(null,18919))),O=new r.b(g,e=>e.getAccessIssuesForAttachments)},2377:function(e,t,n){"use strict";var r=n(266),i=n(2532),o=n(50),a=n(2686);function u(e,t,n,o,u=!0){var c;const{Name:s,OriginalPermissionType:d,PermissionType:l}=t,f=Object(a.a)(t),b="GroupMailbox"===(null===(c=null==e?void 0:e.mailboxInfo)||void 0===c?void 0:c.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(e,f,n,o,l,d,u,s,b);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(e,f,1,o,l,d,u,s,b);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function c(e,t,n=!1,r=!0){return i.a(e,t,n,r)}function s(e,t,n,r,a=!1){const s=n?u(e,t,1,r,!1):c(e,1,a,!1);if(n)return{url:s,init:{credentials:"include",headers:new Headers}};{const t=i.c(e.mailboxInfo),n=new Headers;return n.set("X-Token",t),n.set("X-OWA-CANARY",Object(o.a)()),{url:s,init:{headers:n}}}}function d(e,t,n,r,i,o=!1){return r?u(e,t,n,i):c(e,n,o)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}))},2396:function(e,t,n){"use strict";var r=n(274),i=n(949),o=n(2581),a=n(61),u=n(699),c=n(950);t.a=Object(u.action)("activateTab")((function(e,t){const n=new a.b("TabViewActivateTab",{isVerbose:!0});switch(n.addCustomData([e.type,t]),Object(o.a)(e,!0),e.type){case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.MailCompose:if(2!=e.state){const t=Object(i.a)();if(t){t.state=1;const e=Object(c.a)(t.type);(null==e?void 0:e.onDeactivate)&&e.onDeactivate(t)}if(e){e.state=2,e.blink=!1;const t=Object(c.a)(e.type);(null==t?void 0:t.onActivate)&&t.onActivate(e)}}}n.end()}))},2415:function(e){e.exports=JSON.parse('{"a":"kca"}')},2449:function(e){e.exports=JSON.parse('{"a":"eca","b":"fca"}')},2532:function(e,t,n){"use strict";var r=n(2251);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(2039);n.d(t,"c",(function(){return i.a}));var o=n(2037);n.d(t,"e",(function(){return o.a}));var a=n(2036);n.d(t,"d",(function(){return a.a}))},2581:function(e,t,n){"use strict";var r=n(2396),i=n(699),o=n(246);t.a=Object(i.action)("setTabIsShown")((function(e,t){switch(e.state){case 0:t&&(e.state=1,e.blink=!0);break;case 1:case 2:case 3:if(!t){const t=2==e.state&&function(e){const t=Object(o.a)().tabs,n=Math.max(t.indexOf(e),0),r=t.filter(t=>t.id==e.parentTabId&&1==t.state)[0];if(r)return r;for(let e=n;e<t.length;e++)if(1==t[e].state)return t[e];for(let e=n-1;e>=0;e--)if(1==t[e].state)return t[e];return null}(e);t&&Object(r.a)(t),e.state=0}}}))},2657:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(32);function i(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},267:function(e,t,n){"use strict";var r=n(912);n.d(t,"a",(function(){return r.a}))},2686:function(e,t,n){"use strict";function r(e){let t=null;return t=e.AttachLongPathName,t||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},2697:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4);const i=new r.d(()=>n.e(1346).then(n.bind(null,4123))),o=new r.a(i,e=>e.logSigsDatapoint)},276:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(117),i=n(97),o=n(2);let a;function u(e){a=e}async function c(e){var t,n;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const u=a&&await a(void 0,e);if(u&&u.length>0){if("bearer"===(null===(t=null==u?void 0:u.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return u.split(" ")[1];if("msauth1.0"===(null===(n=null==u?void 0:u.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return u}}},3066:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c}));const r=600,i=600,o=650,a=1/2.89*100,u=420,c=420/1300*100},3205:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function o(e,t){e.addCustomProperty("ErrorInformation",t)}function a(e,t){let n="";n=t?"Empty response from server":"Null response from server",o(e,n)}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a}))},3260:function(e){e.exports=JSON.parse('{"a":"aka"}')},3671:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="autoHideEmail"},3672:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},417:function(e,t,n){"use strict";class r{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return r}))},5578:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},5757:function(e,t,n){"use strict";var r={TabViewAddTab:{name:"TabViewAddTab",customData:(e,t,n,r)=>[e,t,n]},TabViewCloseTab:{name:"TabViewCloseTab",customData:(e,t)=>[e.type,1==e.state||2==e.state,2==e.state,t,e.startTime?(new Date).getTime()-e.startTime:0]}},i=n(2581),o=n(61),a=n(3),u=n(950),c=n(246);t.a=Object(o.r)(r.TabViewCloseTab,(async function(e,t){let n=!0;const r=Object(u.a)(e.type);if(!t&&r&&r.canClose&&(n=await r.canClose(e)),n){Object(i.a)(e,!1);const t=Object(c.a)().tabs.indexOf(e);t>=0&&s(t)}}));const s=Object(a.mutatorAction)("spliceTabs",e=>{Object(c.a)().tabs.splice(e,1)})},598:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},700:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},705:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemResponseShape:#Exchange"},e)}n.d(t,"a",(function(){return r}))},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(121),i=n(12);function o(){return Object(r.a)("acctmonaccounts")&&Object(i.i)("acctmonaccounts")}function a(){return o()||!Object(r.a)("acctmonaccounts")&&Object(i.i)("accountsapi")}},7924:function(e){e.exports=JSON.parse('{"a":"dca"}')},807:function(e,t,n){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:t,timeBetweenRetryInMS:n}=e;return e=>{let r=0,i=!1;const o=(a,u)=>{i?u(new Error("The function retry was cancelled")):(r++,e().then(e=>a(e)).catch(e=>{t&&r>=t?u(e):setTimeout(()=>o(a,u),n(r))}))};return{retriableFunc:()=>new Promise((e,t)=>o(e,t)),cancel:()=>i=!0}}}function i(e){return t=>Math.pow(2,t)*e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},8771:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1932),i=n(1738),o=n(3325),a=n(1724),u=n(5578),c=n(2209);function s(e){var t,n;const s=Object(c.a)(e),d=s.extendedViewState.attachmentId,l=d&&Object(i.a)(d),f=l&&Object(o.a)(l)||(null===(n=null===(t=s.viewState)||void 0===t?void 0:t.previewPane)||void 0===n?void 0:n.fileName)&&Object(a.c)(s.viewState.previewPane.fileName);return{customData:{entryPoint:"SxSCommandBar",isCloudy:void 0!==s.extendedViewState.isCloudy&&s.extendedViewState.isCloudy,isCompose:null!==s.composeId,PreviewMethod:r.b[s.extendedViewState.previewMode],PreviewSource:r.c[s.extendedViewState.selectionSource],officeFileType:Object(u.a)(f),isLink:!s.extendedViewState.attachmentId},cosmosOnlyData:{size:l&&l.model.Size,attachmentId:null==d?void 0:d.Id,fileType:(null==f?void 0:f.substring(0,4))||""}}}},910:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},912:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},939:function(e,t,n){"use strict";var r=n(699);class i{constructor(e){this.maxSize=e,this.references=[],this.mruList=[]}initialize(e,t){if(!this.store){this.store=e,this.deleteCallback=t;for(let t of e.keys())this.mruList.push(t)}}add(e,t){Object(r.action)("MruCache_add")(()=>{this.store.set(e,t),this.mruList.indexOf(e)>=0?this.touch(e):(this.mruList.push(e),this.purgeIfNecessary())})()}get(e){return this.store.get(e)}getAndTouch(e){const t=this.store.get(e);return t&&this.touch(e),t}has(e){return this.store.has(e)}remove(e){Object(r.action)("MruCache_remove")(()=>{if(this.store.has(e)&&!this.isReferenced(e))return this.removeItemAtIndex(this.mruList.indexOf(e))})()}registerReference(e){this.references.push(e)}clear(){Object(r.action)("MruCache_clear")(()=>{this.purgeTillSize(0)})()}getItemIds(){return new Array(...this.mruList)}touch(e){let t=this.mruList.indexOf(e);if(t<0)throw new Error(`Item with key '${e}' does not exist in the cache.`);this.mruList.splice(t,1),this.mruList.push(e)}purgeIfNecessary(){this.purgeTillSize(this.maxSize)}purgeTillSize(e){let t=0;for(;this.mruList.length>e&&t<this.mruList.length;){let e=this.mruList[t];this.isReferenced(e)?t++:this.removeItemAtIndex(t)}}removeItemAtIndex(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);let t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)}isReferenced(e){for(let t=0;t<this.references.length;t++){const n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1}}n.d(t,"a",(function(){return i}))},954:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},955:function(e,t,n){"use strict";var r=n(32);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return i}))},972:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FindItemJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.253.js.map
self.scriptsLoaded['owa.253.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.253.js'] = (new Date()).getTime();