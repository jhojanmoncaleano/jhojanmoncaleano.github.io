self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.26.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[26],{11115:function(e,t,n){"use strict";function r(e,t,n,r,o,s){let a=!1;return{task:()=>new Promise((i,c)=>{let u=0,l=0,d=0;const f=()=>{a&&i(1),u<n&&d<t.length&&((n=>{const{start:a,end:i}=t[n],c=e.slice(a,i);return r(c,s(n),o)})(d).then(()=>(e=>{u-=1,l+=1,l===t.length&&i(0),f()})()).catch(c),d+=1,u+=1)};for(let e=0;e<n;e++)f()}),cancelTask:()=>a=!0}}const o=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function s(e,t,n=o){!function(e){e.sliceSize=e.sliceSize||o.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||o.numberOfSlicesToParallelize}(n);const{sliceSize:s,numberOfSlicesToParallelize:c}=n,u=Math.ceil(e.size/s),l=function(e,t,n){const r=[];let o=0;for(let s=0;s<e;s++){const e=Math.min(o+t,n);r.push({start:o,end:e}),o=e}return r}(u,s,e.size),d=r(e,[l[0]],1,t,u,()=>0),f=l.length>2?r(e,l.slice(1,l.length-1),c,t,u,e=>e+1):i(),p=l.length>1?r(e,[l[l.length-1]],1,t,u,()=>l.length-1):i();return{onCompletePromise:d.task().then(a(f.task)).then(a(p.task)),cancel:()=>{d.cancelTask(),f.cancelTask(),p.cancelTask()}}}function a(e){return t=>0===t?e():Promise.resolve(t)}function i(){let e=!1;return{task:()=>e?Promise.resolve(1):Promise.resolve(0),cancelTask:()=>e=!0}}n.d(t,"a",(function(){return s}))},2705:function(e,t,n){"use strict";var r=n(4039),o=n(6893);function s(e){let t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r.d})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"e",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"f",(function(){return o.a})),n.d(t,"g",(function(){return s}))},2781:function(e,t,n){"use strict";const r="https://www.googleapis.com/drive/v3/files";var o=n(3949);async function s(e,t,n={forceTokenRefresh:!1,requestInit:{}}){const r=n.forceTokenRefresh,s=n.requestInit||{},a=await Object(o.d)(t,r,e);return s.headers||(s.headers=new Headers),s.headers.set("Authorization",a),await fetch(e,s)}async function a(e,t=!1){const n=`${r}?${e}`,o=await s(n,5,{forceTokenRefresh:t});if(o.ok){const e=await o.text();return{errorResponse:null,result:JSON.parse(e)}}return{errorResponse:o,result:null}}async function i(e){const t=`${r}/${e}?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension`,n=await s(t,5);if(n.ok){const e=await n.text();return{errorResponse:null,result:JSON.parse(e)}}return{errorResponse:n,result:null}}var c=n(266),u=n(2705),l=n(279);const d=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function f(){return Object.keys(d).map(e=>d[e]).join(",")}const p="_api/v2.0",m="/v1.0",h="root";function b(e){switch(e){case 1:return m;case 0:return p;default:return Object(c.a)(e)}}function w(e){return`${b(e)}/drive`}function y(e){return`${b(e)}/shares`}function O(e){return`${w(e)}/items`}var v;async function k(e,t,n,r,o,s=v.None,a){o=o||h;let i=`expand=thumbnails(select=medium)&orderby=${function(e,t,n){switch(e){case 0:case 1:return`folder,${t} ${n}`;default:return Object(c.a)(e)}}(t,function(e){switch(e){case 0:return d.name;case 1:return d.size;default:return d.lastModifiedDateTime}}(n),function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(c.a)(e)}}(r))}`;0===t&&(i=`${i}&select=${f()}`),s!==v.None&&(i=`${i}&filter=${function(e){switch(e){case v.None:return"";case v.Folder:return`(${d.folder} ne null)`;default:return Object(c.a)(e)}}(s)}`),a&&(i=`${i}&$top=${a.maxEntries}`,a.skipToken&&(i=`${i}&$skiptoken=${a.skipToken}`));const p=`${e}/${O(t)}/${o}/children?${i}`,m=await Object(u.f)(t,encodeURI(p),p,{method:u.b,mode:u.a,datapointNamePrefix:"getOneDriveItems"},{Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"}),b=JSON.parse(m),w=b["@odata.nextLink"]?function(e){const t=Object(l.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(b["@odata.nextLink"])):null;return{errorResponse:null,result:{items:b.value,skipToken:w}}}async function S(e,t,n,r){r=r||h;const o=`expand=thumbnails(select=medium)&select=${f()}`,s=`${t}/${O(e)}/${r}/children?${o}`,a={name:n,folder:{}},i=new Headers;i.append("Content-Type","application/json"),i.append("Accept","application/json");try{const t=await Object(u.f)(e,encodeURI(s),s,{method:u.d,mode:u.a,body:JSON.stringify(a),datapointNamePrefix:"createNewFolder"},null);return{errorResponse:null,result:JSON.parse(t)}}catch(e){return{errorResponse:e,result:null}}}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(v||(v={}));var g=n(11115),T=n(6893),j=n(267);const R=Object.freeze({folderInfo:{type:0,identifier:h},sliceSize:10485760,conflictBehavior:"rename",onProgress:()=>{}});function $(e,t,n){let r=()=>Promise.resolve({errorResponse:null,result:null});return{uploadPromise:(async()=>{!function(e){Object.keys(R).forEach(t=>{e[t]=e[t]||R[t]})}(n);const{fileToUpload:{fileName:o,fileBlob:s},folderInfo:{type:a,identifier:i},conflictBehavior:l,sliceSize:d,onProgress:f}=n;let p;switch(a){case 0:p=`${t}/${O(e)}/${i}:/${encodeURI(o)}:/createUploadSession`;break;case 1:p=`${t}/${w(e)}/${i}:/${encodeURI(o)}:/createUploadSession`;break;default:Object(c.a)(a)}const m={item:{"@name.conflictBehavior":l}},h=await Object(T.a)(e,p,p,{method:u.d,mode:u.a,body:JSON.stringify(m),datapointNamePrefix:"createUploadSession"},null),{uploadPromise:b,cancel:y}=function(e,t,n,r){const{uploadUrl:o}=e,s=t.size;let a=null,i=null;const u=function(e,t,n,r,o,s){return async(a,i)=>{const c=function(e,t,n){const{rangeStart:r,rangeEnd:o}=P(e,t,n);return new Headers({"Content-Range":`bytes ${r}-${o}/${n}`,Accept:"application/json"})}(i,t,n),u=(e=>{const{rangeStart:o}=P(e,t,n);return e=>{const{loaded:t}=e;r({loaded:o+t,total:n})}})(i),l=await function(e,t,n={method:"POST"}){return new Promise(async(r,o)=>{const{method:s,body:a,headers:i}=n,c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&r({status:c.status,text:()=>Promise.resolve(c.responseText)})},c.ontimeout=()=>{o(new Error("Request timed out"))},c.onerror=()=>{o(new Error("Request failed"))},c.onabort=()=>{o(new Error("Request aborted"))},t&&(c.upload.onprogress=t),c.open(s,e,!0),new Headers(i).forEach((e,t)=>{c.setRequestHeader(t,e)}),a?c.send(a instanceof ReadableStream?(await a.getReader().read()).value:a):c.send()})}(e,u,{method:"PUT",body:a,headers:c});if(201===l.status||200===l.status){const e=await l.text(),t=JSON.parse(e);o(t)}if(!Object(j.a)(l.status))throw s(l),new Error("Unable to upload file")}}(o,n,s,r,e=>{a=e},e=>{i=e}),{onCompletePromise:l,cancel:d}=Object(g.a)(t,u,{sliceSize:n,numberOfSlicesToParallelize:1}),f=(async()=>{let e=null;try{e=await l}catch(e){return{errorResponse:i,result:null}}switch(e){case 0:return a?{errorResponse:null,result:a}:{errorResponse:i,result:null};case 1:throw new Error("Upload was cancelled");default:return Object(c.a)(e)}})();return{uploadPromise:f,cancel:async()=>{d();try{await f}finally{return async function(e){const t=await fetch(e,{method:"DELETE"});return Object(j.a)(t.status)?{errorResponse:null,result:null}:{errorResponse:t,result:null}}(o)}}}}(JSON.parse(h),s,d,f);return r=y,b})(),cancel:()=>r()}}function P(e,t,n){const r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}const x="https://api.dropboxapi.com/2/files";function N(e,t){switch(e){case 0:return t;case 1:return null;default:Object(c.a)(e)}return null}var A=n(7);async function D(e,t,n=!1){let r,o;switch(t){case 1:r="https://api.onedrive.com/v2.1/drive/recent?top=50";break;case 0:r=e+"/_api/v2.1/drive/recent?top=50";break;default:throw Error("OneDriveMRUItems only supports OneDrive providers!")}try{const e=await Object(u.f)(t,r,r,{method:u.b,mode:u.a,datapointNamePrefix:"getOneDriveMRUItems"},null,n);o=JSON.parse(e),o&&(o.value=o.value.sort((e,t)=>{var n,r,o,s;return Object(A.w)(Object(A.qc)(null===(r=null===(n=t.remoteItem)||void 0===n?void 0:n.fileSystemInfo)||void 0===r?void 0:r.lastAccessedDateTime),Object(A.qc)(null===(s=null===(o=e.remoteItem)||void 0===o?void 0:o.fileSystemInfo)||void 0===s?void 0:s.lastAccessedDateTime))}))}catch(e){}return o?{errorResponse:null,result:o}:{errorResponse:null,result:null}}function E(e){return"file"===e[".tag"]}function I(e){return"folder"===e[".tag"]}function z(e){return"deleted"===e[".tag"]}function C(e){return"folder"===e.type}async function U(e){e.path=e.path||"";const t=`${x}/list_folder`,n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},r=await s(t,2,{requestInit:n});if(r.ok){const e=await r.text();return{errorResponse:null,result:JSON.parse(e).entries}}return{errorResponse:r,result:null}}const F="https://api.box.com/2.0",J=2e3;async function M(e,t=J){const n=`${F}/folders/${e=e||"0"}/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit=${t}&offset=0`,r=await s(n,3);if(r.ok){const e=await r.text();return{errorResponse:null,result:JSON.parse(e).entries}}return{errorResponse:r,result:null}}var _;!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(_||(_={}));var q=_;const B="https://graph.facebook.com/v2.7",L=200;async function H(e,t=L){const n=`${B}/me/photos/?fields=id,name,images,from,link,album,place,created_time&type=${e.toString()}&limit=${t}`,r=await s(n,6);if(r.ok){const e=await r.text();return{errorResponse:null,result:JSON.parse(e).data}}return{errorResponse:r,result:null}}var G=n(1038),V=n(1040),W=n(598),X=n(1685),Q=n(1876),K=n(705),Y=n(245),Z=n(40);function ee(e,t){const n=function(e,t){return Object(V.a)({ParentFolderIds:[Object(W.a)({Id:e})],ItemShape:Object(K.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(G.a)({Header:Object(Y.b)(),Body:n})}async function te(e,t){const n=Object(Q.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100});e=e||Object(X.a)("inbox");const r=(await ee(e,n)).Body.ResponseMessages.Items[0];if(r&&"Success"===r.ResponseClass&&r.RootFolder.Items)return{errorResponse:null,result:r.RootFolder.Items};return Z.h.warn(`Find Item Response of get mail messages failed with ${r}`),{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null},result:null}}n.d(t,"m",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"o",(function(){return k})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return S})),n.d(t,"w",(function(){return $})),n.d(t,"i",(function(){return w})),n.d(t,"r",(function(){return y})),n.d(t,"e",(function(){return"https://api.onedrive.com"})),n.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"d",(function(){return r})),n.d(t,"q",(function(){return N})),n.d(t,"p",(function(){return D})),n.d(t,"u",(function(){return E})),n.d(t,"v",(function(){return I})),n.d(t,"t",(function(){return z})),n.d(t,"j",(function(){return U})),n.d(t,"s",(function(){return C})),n.d(t,"h",(function(){return M})),n.d(t,"a",(function(){return F})),n.d(t,"c",(function(){return q})),n.d(t,"k",(function(){return H})),n.d(t,"n",(function(){return te}))},3909:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(20);const o=new r.c(()=>n.e(1224).then(n.bind(null,12825))),s=(new r.b(o,e=>e.launchRemediateAuthDialogAndRefresh),new r.b(o,e=>e.remediateAuth))},3949:function(e,t,n){"use strict";var r=n(5454),o=n.n(r),s=n(5),a=n(283),i=n(391),c=n(32);function u(e){return Object.assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}async function l(e,t,n,r){const o=u({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1,ClaimsChallenge:r?atob(r):null});let s;s=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider";let a=new Headers;a.append("X-OWA-ActionName",s);const i={headers:a,datapoint:{customData:{actionSource:n},headersCustomData:e=>({tokenResultDetails:e.get("x-tokenresult")}),jsonCustomData:e=>({tokenStatus:e.TokenResultCode.toString()})},returnFullResponseOnSuccess:!0},l=await function(e,t){return void 0===e||e.__type||(e=u(e)),Object(c.a)("GetAccessTokenforDataProvider",e,t)}(o,i);return{token:await l.json(),response:l}}const d="onedrive_implicit.access",f="Bearer ";var p=n(44),m=n(61);const h=(e,t,n)=>Object.assign({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e),b=e=>"TokenRetrievalError"===e._typeSpec;let w=[];const y={},O=1,v=30,k="",S="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function g(e){y[e]=null}async function T(e,t,n,r){const o=await l(e,t,n,r);return function(e,t,n){w=w.filter(e=>e!==t);const r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){const t=`Access token request failed for token key ${e} with response code ${r.TokenResultCode}`,o=n.response.headers.get("x-tokenresult"),s=null!=o&&o.indexOf(S)>0;throw h(new Error(t),r.TokenResultCode,s)}{const n=y[e]||{};n[t]=r,y[e]=n}}(e,t,o),o.token}async function j(e,t,n,r){let o=k;if(0===e&&n){const e=new URL(n);o=Object(s.c)("{0}//{1}/",e.protocol,e.hostname)}return Object(p.j)("doc-attachment-testAuthFallback")?"":$(e,o,t,null,r)}async function R(e,t,n){return $(0,e,t,n)}async function $(e,t,n,r,a){if(0===e&&!Object(s.k)(t)){const e=await Object(i.getAccessTokenforResource)(t);if(e)return e;Object(m.o)("getFileProviderAccessTokenForResource_emptyTokenFrom_getAccessTokenforResource")}if(!n&&function(e,t){const n=y[e];if(!n)return!1;const r=n[t];if(!r||!r.AccessTokenExpiry)return!1;const s=new Date(r.AccessTokenExpiry),a=o()(new Date(Date.now()),O);return null!=s&&a<s}(e,t)){const n=y[e][t];return o()(new Date(Date.now()),v)>new Date(n.AccessTokenExpiry)&&-1===w.indexOf(t)&&(w.push(t),T(e,t,r)),n.AccessToken}return(await T(e,t,r,a)).AccessToken}async function P(e,t,n,r){let o;return o=Object(a.a)()&&1===e?await Object(i.getDelegationTokenForOwa)(d):await j(e,t,n,r),f+o}n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return j})),n.d(t,"e",(function(){return R})),n.d(t,"b",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return f}))},4039:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i}));const r="POST",o="cors",s="GET",a="PUT",i="PATCH"},4821:function(e,t,n){var r=n(1999);e.exports=function(e,t){var n=r(e).getTime(),o=Number(t);return new Date(n+o)}},5454:function(e,t,n){var r=n(4821),o=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*o)}},6893:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(61),o=n(3949),s=n(311),a=n(267),i=n(2321),c=n(2865),u=n(44),l=n(40),d=n(3909),f=n(4039);async function p(e,t,n,p,m,h=!1){let b;try{b=await Object(o.d)(e,!1,n)}catch(e){}if(Object(u.j)("doc-authContext")&&0===e&&(m?m["x-ms-cc"]="t":m={"x-ms-cc":"t"}),b&&b.split(o.a)[1])return Object(r.o)("fetchServiceViaDataProvider",[e]),l.h.info("fetchServiceViaDataProvider"),async function e(t,n,i,c,l,f,p){const m=l.datapointNamePrefix+"DataProvider",h=new r.b(m);h.addCustomData({dataProviderType:t});let b={Authorization:c,"Content-Type":"application/json",Accept:"application/json"};if(p){Object.keys(p).forEach(e=>{b[e]=p[e]})}if(0===t||1===t){const e=Object(s.a)();b["X-TransactionId"]=e,h.addCustomData({TransactionId:e}),0===t&&(b.SPResponseGuid=e)}const w=await fetch(n,{method:l.method,mode:l.mode,headers:b,body:l.body});if(Object(a.a)(w.status)){h.end();const e=await w.json();return JSON.stringify(e)}{const r=new Error(`${m} : Response status = ${w.status}, body = ${w.body}`);h.endWithError("ServerError",r);let s={datapointName:m,responseStatus:w.status,responseBody:w.body,headers:w.headers,claims:null};if(Object(u.j)("doc-authContext")&&0===t&&!f){const r=w.headers.get("www-authenticate");if(r){let a;try{const e=await d.a.import();a=await e(r)}catch(e){throw JSON.stringify(s)}try{c=await Object(o.d)(t,!0,i,a)}catch(e){}return e(t,n,i,c,l,!0,p)}}throw JSON.stringify(s)}}(e,t,n,b,p,h,m);if(Object(r.o)("fetchServiceFailedToGetToken",[e]),0===e)return Object(r.o)("fetchServiceViaOWAServer"),l.h.info("fetchServiceViaOWAServer"),async function(e,t,n,o){const s=n.datapointNamePrefix+"OWA",u=new r.b(s),l=Object(i.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(o),IsJsonPost:n.method===f.d}),d=await Object(c.a)(l);if(Object(a.a)(d.Status))return u.end(),d.Body;const p=new Error(`${s} : Response status = ${d.Status}, ServerTraceLog = ${d.ServerTraceLog}`);u.endWithError("ServerError",p);const m={datapointName:s,responseStatus:d.Status,responseServerTraceLog:d.ServerTraceLog};throw JSON.stringify(m)}(e,t,p,m);throw new Error("Fetch service has failed to retrieve client token.")}}}]);
//# sourceMappingURL=owa.26.js.map
self.scriptsLoaded['owa.26.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.26.js'] = (new Date()).getTime();