self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.296.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[296],{1688:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"k",(function(){return c})),n.d(e,"a",(function(){return i})),n.d(e,"h",(function(){return a})),n.d(e,"b",(function(){return u})),n.d(e,"i",(function(){return d})),n.d(e,"m",(function(){return s})),n.d(e,"l",(function(){return l})),n.d(e,"j",(function(){return f})),n.d(e,"c",(function(){return b})),n.d(e,"e",(function(){return v})),n.d(e,"g",(function(){return O}));const r=["journal","outbox","syncissues"],o="archivemsgfolderroot",c="msgfolderroot",i="archivedeleteditems",a="deleteditems",u="archiverecoverableitemsdeletions",d="recoverableitemsdeletions",s="msgfolderroot",l="sharedFolderTree",f="primaryFolderTree",b="archiveFolderTree",v="favorites",O="groups"},1703:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(57);function o(t){if(!t)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(t)||"none"}},1727:function(t,e,n){"use strict";n.d(e,"b",(function(){return i}));var r=n(3),o=n(14);const c=Object(r.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),i=c();e.a=c},1729:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1857);function o(t,e){const n=Object(r.a)(e),o=n&&n.get(t);return null==o?void 0:o.rootFolder}},1736:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("ON_SELECTED_ACCOUNT_CHANGED",(t,e,n)=>({selectedAccountSourceId:t,selectedEmailAddress:e,oldSourceId:n}))},1754:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(316);function o(t){var e;return null===(e=Object(r.a)(t))||void 0===e?void 0:e.AttachmentPolicy}},1843:function(t,e,n){"use strict";n.d(e,"l",(function(){return v})),n.d(e,"n",(function(){return O})),n.d(e,"k",(function(){return j})),n.d(e,"m",(function(){return h}));var r=n(20),o=n(2131);n.d(e,"b",(function(){return o.a}));var c=n(2090);n.d(e,"i",(function(){return c.a}));n(1872);var i=n(1877);n.d(e,"d",(function(){return i.a})),n.d(e,"e",(function(){return i.b})),n.d(e,"o",(function(){return i.c}));var a=n(2091);n.d(e,"a",(function(){return a.b}));var u=n(1943);n.d(e,"g",(function(){return u.a})),n.d(e,"h",(function(){return u.b}));var d=n(2080);n.d(e,"j",(function(){return d.a}));var s=n(1967);n.d(e,"c",(function(){return s.a}));var l=n(2064);n.d(e,"f",(function(){return l.b}));var f=n(1736);const b=new r.c(()=>Promise.all([n.e(0),n.e(823)]).then(n.bind(null,3371))),v=new r.b(b,t=>t.loadProviders),O=new r.b(b,t=>t.removeFileProvider),j=new r.b(b,t=>t.addFileProvider),h=new r.b(b,t=>t.removeAndAddFileProvider);Object(r.f)(f.a,b,t=>t.resetFileProviderStoreOrchestrator)},1845:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1727);function o(){return Object(r.a)().folderTable}},1857:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return i}));var r=n(1727),o=n(49);function c(t){return i(t).folderTreeTable}function i(t){return t||(t=Object(o.b)()),Object(r.a)().mailboxFolderTreeData.get(t)}},1860:function(t,e,n){"use strict";var r=n(49),o=n(44);function c(t){var e;const n=Object(r.g)().SegmentationSettings,c=null===(e=Object(r.g)().SessionSettings)||void 0===e?void 0:e.IsShadowMailbox;return"junkemail"===t?!!(null==n?void 0:n.JunkEMail):"notes"!==t||!!(null==n?void 0:n.StickyNotes)&&Object(o.j)("cal-stickyNotesFolder")&&!c}var i=n(283);function a(){const t=Object(i.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(o.j)("notes-folder-view")&&t.push("notes"),t}n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return a}))},1872:function(t,e,n){"use strict";var r=n(3),o=n(2418);const c=Object(r.createStore)("fileProviderStore",Object(o.a)());e.a=c},1877:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return i}));var r=n(3);const o=Object(r.action)("FILE_PROVIDER_ADDED",t=>({providerViewState:t})),c=Object(r.action)("FILE_PROVIDER_REMOVED",t=>({providerType:t})),i=Object(r.action)("PROVIDERS_LOADED",t=>({providers:t}))},1889:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1729),o=n(1688);function c(t){return Object(r.a)(o.k,t)}},1890:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1729),o=n(1688);function c(t){return Object(r.a)(o.d,t)}},1896:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1729);function o(t){return Object(r.a)(t)}},1943:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c}));var r=n(1872);const o=()=>[...Object(r.a)().providers.values()],c=t=>Object(r.a)().providers.get(t)||null},1965:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return b}));var r=n(1685),o=n(1703),c=n(1727),i=n(1889),a=n(1845),u=n(1890),d=n(1896),s=n(1860);function l(t,e){const n=Object(a.a)();if(e){return[...n.values()].filter(n=>n.distinguishedFolderType===t&&n.mailboxInfo.mailboxSmtpAddress===e)[0]}{const e=Object(r.a)(t);return e?n.get(e):void 0}}function f(t,e){if("SharedMailbox"===t&&!e)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(t){case"ArchiveMailbox":n=Object(u.a)(e);break;case"SharedMailbox":n=Object(d.a)(e);break;default:n=Object(i.a)(e)}const a=Object(s.a)();if("UserMailbox"==t&&n.distinguishedFolderType==Object(i.a)(e).distinguishedFolderType&&n.id){const t=a.map(t=>l(t,e)).filter(t=>(null==t?void 0:t.parentFolderId)===n.id);r=e?t.filter(t=>t.mailboxInfo.mailboxSmtpAddress===e).map(t=>t.id):t.map(t=>t.id)}const f=function(t,e){if(!(null==t?void 0:t.childFolderIds))return[];const n=t.childFolderIds.map(t=>c.b.folderTable.get(t));return(e?n.filter(t=>t.mailboxInfo.mailboxSmtpAddress===e):n).map(t=>t.id)}(n,e);for(let t=0;t<f.length;t++)-1==a.indexOf(Object(o.a)(f[t]))&&r.push(f[t]);return r}function b(t,e){const n=Object(a.a)().get(t);return(null==n?void 0:n.mailboxInfo.type)===e}},1967:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Loaded=0]="Loaded",t[t.Loading=1]="Loading",t[t.NotLoaded=2]="NotLoaded",t[t.Throttled=3]="Throttled"}(r||(r={}))},2064:function(t,e,n){"use strict";var r=n(32);function o(t){return Object.assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},t)}function c(t){const e=o({ProviderType:t});return void 0===(n=e)||n.__type||(n=o(n)),Object(r.a)("GetNewAttachmentDataProviderCreationInfo",n,c);var n,c}function i(t){return Object.assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},t)}function a(t){const e=i({ProviderType:t});return void 0===(n=e)||n.__type||(n=i(n)),Object(r.a)("GetAttachmentDataProviderCreator",n,o);var n,o}var u=n(2406),d=n(2369);n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return g}));const s="code",l="token",f=3e3,b=3;function v(t){return{state:t}}function O(t){return t.state}function j(t){return t.code}function h(t,e,n,r,o){const i={providerType:t,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:j};return async function t(e,n,r,o,i,d,s){try{let t;if(7===e||9===e||8===e){const n=await a(e);t=n.AttachmentDataProviderCreator.ProviderAppKey,r=n.AttachmentDataProviderCreator.AuthorizationUri}else{t=(await c(e)).ProviderAppKey}n.getAuthUrlInfo=Object(u.d)(e,r,o,t,i,d)}catch(c){s>0&&setTimeout(()=>t(e,n,r,o,i,d,--s),f)}}(t,i,e,n,r,o,b),i}let m=null;function p(){if(!m){if(m={},Object(d.a)(3)&&(m[3]=h(3,"https://app.box.com/api/oauth2/authorize",Object(u.c)(3),s,v)),Object(d.a)(2)&&(m[2]=h(2,"https://www.dropbox.com/oauth2/authorize",Object(u.b)(2),s,v)),Object(d.a)(6)){const t=h(6,"https://www.facebook.com/dialog/oauth",Object(u.b)(6),l,t=>({state:t,scope:"user_photos,email"}));t.getCSRFToken=O,t.getOAuthCode=t=>t.access_token,m[6]=t}if(Object(d.a)(5)){const t=h(5,"https://accounts.google.com/o/oauth2/auth",`${u.a}/ADPRedirect.aspx`,s,t=>{const e={state:t,provider:5..toString(),url:Object(u.b)()};return{state:JSON.stringify(e),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=t=>{return JSON.parse(t.state).state},m[5]=t}Object(d.a)(1)&&(m[1]=h(1,"https://login.live.com/oauth20_authorize.srf",Object(u.c)(1),s,t=>({state:t,scope:"wl.basic onedrive.readwrite wl.offline_access"}))),Object(d.a)(7)&&(m[7]=h(7,"",Object(u.c)(7),s,v)),Object(d.a)(8)&&(m[8]=h(8,"",Object(u.c)(8),s,v)),Object(d.a)(9)&&(m[9]=h(9,"",Object(u.c)(9),s,v))}return m}function g(t){const e=p();return t in e?e[t]:null}},2080:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1872);function o(){return Object(r.a)().loadState}},2090:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2450),o=n(2384),c=n(2417),i=n(5),a=n(266);function u(t,e=!1){if(e)return"";switch(t){case 0:return Object(i.b)(c.b);case 1:return Object(i.b)(c.a);case 2:case 9:return Object(i.b)(r.b);case 3:case 7:return Object(i.b)(r.a);case 5:return Object(i.b)(r.e);case 6:return Object(i.b)(r.d);case 4:return Object(i.b)(r.f);case 10:return Object(i.b)(o.b);case 8:return Object(i.b)(r.c);default:return Object(a.a)(t)}}},2091:function(t,e,n){"use strict";var r;n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return c})),function(t){t[t.Groups=1e4]="Groups"}(r||(r={}));const o=Object.freeze([1,3,2,6,5,7,8,9]),c=Object.freeze([...o,0,4,10])},2131:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Images=1]="Images"}(r||(r={})),e.a=r},2369:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1754),o=n(283),c=n(266),i=n(44);function a(t){const e=Object(r.a)();switch(t){case 5:return(null==e?void 0:e.GoogleDriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(i.j)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==e?void 0:e.BoxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(i.j)("doc-fileProvider-box");case 2:return(null==e?void 0:e.DropboxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(i.j)("doc-fileProvider-dropbox");case 6:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(i.j)("doc-fileProvider-facebook");case 1:return!!Object(o.a)()||(null==e?void 0:e.OnedriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled);case 10:return Object(i.j)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(i.j)("doc-fileProvider-wopiClient");default:return Object(c.a)(t)}}},2384:function(t){t.exports=JSON.parse('{"a":"Mma","b":"Nma"}')},2406:function(t,e,n){"use strict";var r=n(597),o=n(2);function c(t,e,n){if(!t||!e||!n)throw new Error("Key and Value parameters should not be null");return t.indexOf("?")>0?`${t}&${e}=${n}`:`${t}?${e}=${n}`}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return d}));const i=Object(o.R)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function a(t){const e=t?encodeURIComponent(`?provider=${t}`):"",n=t&&6===t?"AddFacebookFileProvider.html":"AddFileProvider.html";return`${Object(r.n)()}/mail/${n}${e}`}function u(t){const e=`${Object(r.n)()}/mail/AddFileProvider.html`,n=encodeURIComponent(`provider=${t}&url=${e}`);return`${i}/ADPRedirect.aspx?${n}`}function d(t,e,n,r,o,i){return()=>{const t=function(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),e=t.length-1,n=[];for(let r=0;r<16;r++)n.push(t[Math.round(Math.random()*e)]);return"owa_csrf_token_"+n.join("")}();let a=c(e,"client_id",r);if(a=c(a,"redirect_uri",n),a=c(a,"response_type",o),i){const e=i(t);a=Object.keys(e).reduce((t,n)=>c(t,n,e[n]),a)}return{authUrl:a,redirectUrl:n,csrfToken:t}}}},2417:function(t){t.exports=JSON.parse('{"b":"Oma","a":"Pma"}')},2418:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(14),o=n(1967);function c(){return{providers:new r.ObservableMap,loadState:o.a.NotLoaded,removalPending:new r.ObservableMap}}},2450:function(t){t.exports=JSON.parse('{"b":"Gma","a":"Hma","e":"Ima","d":"Jma","f":"Kma","c":"Lma"}')},267:function(t,e,n){"use strict";var r=n(912);n.d(e,"a",(function(){return r.a}))},3114:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1754),o=n(1843);function c(t){const e=Object(r.a)();return(null==e?void 0:e.AttachmentDataProviderAvailable)&&!i()||t&&(null==e?void 0:e.GroupsOneDriveDataProviderAvailable)}const i=()=>{Object(o.j)()===o.c.NotLoaded&&o.l.import().then(t=>t(t=>{}));const t=Object(o.g)((0).toString());return!!t&&!t.name}},3343:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return i}));var r=n(44),o=n(3114);function c(){return Object(r.j)("honeybee-sonora-file")&&Object(o.a)(!1)}function i(){return Object(r.j)("honeybee-sonora-mentions-files")&&Object(o.a)(!1)}},912:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.296.js.map
self.scriptsLoaded['owa.296.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.296.js'] = (new Date()).getTime();