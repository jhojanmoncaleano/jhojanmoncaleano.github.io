self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.299.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[299,2033],{164:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,c){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var a={value:n,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){o(t),c&&c(t,n)}.bind(this),i)),e[t]=a,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var c=e[o];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return i&&t++,c.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(o)if(e[c])continue;var u=r[c],a=u.expire-i;if(a<=0){this.del(c);continue}a=a>0?a:void 0,this.put(c,u.value,a)}return this.size()}}e.exports=new r,e.exports.Cache=r},1699:function(e,t,n){"use strict";function r(e){if(!e)return null;const t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){const t=r(e);return t?t.replace(".",""):null}function o(e){var t;return(null===(t=i(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}))},1702:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1724:function(e,t,n){"use strict";var r=n(1699),i=n(1959),o=n(5);function c(e){let t;return e>=1073741824?(e/=1073741824,t=Object(o.b)(i.b)):e>=1048576?(e/=1048576,t=Object(o.b)(i.d)):e>=1024?(e/=1024,t=Object(o.b)(i.c)):t=Object(o.b)(i.a),Object(o.c)(t,Math.round(e))}var u=n(1799),a=n(44);const s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(a.j)("doc-attachment-documentThumbnail"))return!1;const t=Object(r.a)(e);return!!t&&s.indexOf(t.toLowerCase())>=0}var d;function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return d.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return d.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return d.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(d||(d={}));var b=n(1762);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return d}))},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1940);function i(e){if(!e)return null;return Object(r.a)().attachments.get(e.Id)}},1754:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(316);function i(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1762:function(e,t,n){"use strict";function r(e){return function(e){const t=o.exec(e);return t&&t.length>1&&i[t[1].toLowerCase()]}(e||"")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function c(e){let t="";return Object.entries(i).forEach(n=>{n[1]===e&&(t=n[0])}),t}},1788:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},1791:function(e,t,n){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){let t=null;const n=r.exec(e);if(n){const e=n[1],r=n[2];let i=null;try{i=atob(r)}catch(e){}if(i){const n=new ArrayBuffer(i.length),r=new Uint8Array(n);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);t=new File([n],"image.png",{type:e})}}return t}var o=n(1702),c=n(1724);function u(e){return e.map(e=>({fileType:o.a.Uri,name:e.name,type:Object(c.b)(e.url)||"",size:0,uri:e.url}))}var a=n(40);function s(e,t,n){if(e.length!=t.length)return a.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let i=0;i<e.length;i++){const c={fileType:o.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};r.push(c)}return r}function l(e,t,n){const r=[],i={fileType:o.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(i),r}function d(e){if(!e)return null;let t=[];for(var n=0;n<e.length;n++){const r=e[n],i={fileType:o.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}function f(e){if(!e)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function b(e){var t,n;if(null===e)return null;return{fileType:o.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function m(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:o.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p=n(1865);function O(e){switch(e?e.toLowerCase():null){case p.d.ONE_DRIVE_PRO.toLowerCase():return 0;case p.d.GDRIVE.toLowerCase():return 5;case p.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.d.DROPBOX.toLowerCase():return 2;case p.d.BOX.toLowerCase():return 3;case p.d.WOPI_BOX.toLowerCase():return 7;case p.d.WOPI_EGNYTE.toLowerCase():return 8;case p.d.MAILBOX.toLowerCase():return 4;case p.d.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return i})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return o.a}))},1799:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(1699),i=n(1762),o=n(169);const c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],u=[".tiff",".tif"];function a(e,t,n=!0){return s(Object(r.a)(e)||Object(i.a)(t),n)}function s(e,t=!0){return!!e&&(c.indexOf(e.toLowerCase())>=0||t&&u.indexOf(e.toLowerCase())>=0&&(Object(o.c)()||Object(o.f)()))}},1822:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1751);function i(e){return(e.__type||e.OwsTypeName)===r.e}},1865:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"d",(function(){return m}));const r="Box",i="Dropbox",o="Facebook",c="GDrive",u="Mailbox",a="MailMessage",s="OneDriveConsumer",l="OneDrivePro",d="WopiBox",f="WopiDropbox",b="WopiEgnyte",m={BOX:r,DROPBOX:i,FACEBOOK:o,GDRIVE:c,MAILBOX:u,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:l,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:d,WOPI_EGNYTE:b}},1959:function(e){e.exports=JSON.parse('{"b":"Mda","d":"Nda","c":"Oda","a":"Pda"}')},1974:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(266);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},198:function(e,t,n){"use strict";var r=n(40);let i;function o(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}var c=n(108);const u=500,a=[],s=[],l=[];let d=!0;function f(e,t){Object(r.g)((e,t,n)=>{d&&(t==r.b.Error&&s.push({message:e,error:n}),a.push({message:e,level:t}))}),e(m),t(m),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(u):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(u))}function b(e){const t=Object(c.a)(e);return d=!1,{traces:a,errors:s,network:l,usage:t}}function m(){d&&l.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return c.b})),n.d(t,"c",(function(){return o}))},2036:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(5),i=n(283),o=n(50),c=n(2199),u=n(96),a=n(2),s=n(30),l=n(2039),d=n(2037);function f(e,t,n,f=!1,b=null){if(!e||!e.Id||!e.mailboxInfo)return null;const m=Object(l.b)(e.mailboxInfo),p=null==m?void 0:m.downloadUrlBase,O=Object(d.a)(e.mailboxInfo);if(b=b||Object(r.c)(t,encodeURIComponent(e.Id)),!p||f&&"Firefox"===Object(u.a)().browser){const e=c.e+b+"&X-OWA-CANARY="+Object(o.a)();return Object(s.a)(e)}let h="{0}{1}/{2}";Object(i.a)()&&(h+="&isc=1");let w=Object(r.c)(h,p,O,b);return n&&(w+="&token="+(null==m?void 0:m.downloadToken),w+="&X-OWA-CANARY="+Object(o.a)()),w+="&owa="+window.location.hostname,w+="&scriptVer="+Object(a.u)()||!1,w}},2037:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(209),i=n(272);function o(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const t=e.userIdentity&&Object(i.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2039:function(e,t,n){"use strict";var r=n(272);const i={};function o(e){return i[e]}function c(e,t){const n=i[e];i[e]=Object.assign(Object.assign({},n),t)}var u=n(49),a=n(707),s=n(61),l=n(914),d=n(807),f=n(32);var b=n(40),m=n(1718),p=n(1715);const O=Object(d.b)({timeBetweenRetryInMS:()=>3e4});async function h(e){const t=async()=>{try{let t={};return Object(a.b)()?t={sourceId:Object(l.a)(null==e?void 0:e.userIdentity)}:Object(r.r)(e.userIdentity)&&(t=await async function(e){let t={};t.headers=new Headers;const n=await Object(m.a)(e);return Object(p.b)(t.headers,n),t}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(t)}catch(e){throw b.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},n=o(e.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){c(e.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:r}=O(async()=>{n++;const r=await t();b.h.info("update new token"),c(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),i=new s.c("AttachmentRefreshDownloadToken");try{await r(),i.addCustomData([n]),i.end()}catch(t){b.h.warn(`Retry to refresh token failed: ${t}`),i.addCustomData([n]),i.endWithError("ServerError",t),c(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function w(e){const t=Object(r.r)(e.userIdentity)?Object(u.h)(e.userIdentity):Object(u.g)(),n=null==t?void 0:t.ApplicationSettings;if(n){const t=n.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:t,downloadToken:n.FirstDownloadToken}),t&&function(e,t){t=t<1?1:t,Object(a.b)()&&h(e),setInterval(()=>{h(e)},6e4*t)}(e,n.DownloadTokenRefreshMinutes)}}var v=n(266);function g(e){const t=Object(r.j)(null==e?void 0:e.userIdentity),n=o(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Office365":case"Outlook":w(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(v.a)(t)}const i=o(e.userIdentity);return i||(Object(s.o)("FilesUrlDataNotFound",{accountProviderType:t}),b.h.warn("Unable to get the url data")),i}function j(e){if(!e)return null;const t=g(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return j}))},2125:function(e,t,n){"use strict";var r=n(1754);function i(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var o=n(1974),c=n(1822);function u(){return i()}function a(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(c.a)(e)}(e))}(e)?i():[]).map(o.a)}n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return a}))},2199:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return l}));const r="/owa/",i="service.svc/s/GetFileAttachment?id={0}",o="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",c="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",a="service.svc/s/GetAttachmentThumbnail?id={0}",s="pdfprint.aspx?id={0}",l="pdfprint.aspx?id={0}&location={1}"},2251:function(e,t,n){"use strict";var r=n(266),i=n(5),o=n(50),c=n(2199);const u=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var a=n(2036),s=n(30);function l(e,t,n,l,d=0,f=0,b=!0,m=null,p=null){let O;switch(n){case 0:O=c.f;break;case 3:O=c.h;break;case 1:if(!function(e){if(!e)return!1;let t=null;const n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&u.indexOf(t.toLowerCase())>=0}(m))return null;O=c.g;break;default:Object(r.a)(n)}let h=l?f:d;!h&&d&&(h=d);let w=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(O,encodeURIComponent(e.Id),encodeURIComponent(t)),h);const v=Object(a.a)(e,O,!0,3===n,w);if(v)return v;let g=Object(i.c)("{0}{1}{2}",c.e,p,w);if(b){g=`${g}&X-OWA-CANARY=${Object(o.a)()}`}return Object(s.a)(g)}function d(e,t,n=!1,o=!0){let u;switch(t){case 0:u=c.a;break;case 1:u=c.b;break;case 2:u=c.d;break;case 3:u=c.c;break;default:return Object(r.a)(t)}if(!Object(i.k)(u)){const r=Object(a.a)(e,u,o,3===t);return Object(i.c)("{0}{1}{2}",r,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}))},2324:function(e,t,n){"use strict";var r=n(20);const i=[0,1];var o=n(2449),c=n(2415),u=n(5),a=n(266),s=n(1788);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(c.a),messageParts:[Object(u.b)(c.a),d()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(u.b)(o.b),messageParts:[Object(u.b)(o.b),d()],color:s.a.Red};default:return Object(a.a)(e)}}function d(){return{text:Object(u.b)(o.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2125),b=n(1974),m=n(44),p=n(1754);function O(){const e=Object(p.a)();if(Object(m.j)("fwk-devTools")){if(Object(m.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(m.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function h(){const e=O();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return v})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return b.a})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return O}));const w=new r.c(()=>n.e(2036).then(n.bind(null,18919))),v=new r.b(w,e=>e.getAccessIssuesForAttachments)},2377:function(e,t,n){"use strict";var r=n(266),i=n(2532),o=n(50),c=n(2686);function u(e,t,n,o,u=!0){var a;const{Name:s,OriginalPermissionType:l,PermissionType:d}=t,f=Object(c.a)(t),b="GroupMailbox"===(null===(a=null==e?void 0:e.mailboxInfo)||void 0===a?void 0:a.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(e,f,n,o,d,l,u,s,b);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(e,f,1,o,d,l,u,s,b);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function a(e,t,n=!1,r=!0){return i.a(e,t,n,r)}function s(e,t,n,r,c=!1){const s=n?u(e,t,1,r,!1):a(e,1,c,!1);if(n)return{url:s,init:{credentials:"include",headers:new Headers}};{const t=i.c(e.mailboxInfo),n=new Headers;return n.set("X-Token",t),n.set("X-OWA-CANARY",Object(o.a)()),{url:s,init:{headers:n}}}}function l(e,t,n,r,i,o=!1){return r?u(e,t,n,i):a(e,n,o)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}))},2415:function(e){e.exports=JSON.parse('{"a":"kca"}')},2449:function(e){e.exports=JSON.parse('{"a":"eca","b":"fca"}')},2532:function(e,t,n){"use strict";var r=n(2251);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(2039);n.d(t,"c",(function(){return i.a}));var o=n(2037);n.d(t,"e",(function(){return o.a}));var c=n(2036);n.d(t,"d",(function(){return c.a}))},267:function(e,t,n){"use strict";var r=n(912);n.d(t,"a",(function(){return r.a}))},2686:function(e,t,n){"use strict";function r(e){let t=null;return t=e.AttachLongPathName,t||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},276:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return a}));var r=n(117),i=n(97),o=n(2);let c;function u(e){c=e}async function a(e){var t,n;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const u=c&&await c(void 0,e);if(u&&u.length>0){if("bearer"===(null===(t=null==u?void 0:u.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return u.split(" ")[1];if("msauth1.0"===(null===(n=null==u?void 0:u.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return u}}},7234:function(e,t,n){"use strict";var r=n(1738),i=n(1865),o=n(4207),c=n(2206),u=n(3),a=Object(u.mutatorAction)("updateAttachmentThumbnailImageUrl",(e,t)=>{e.thumbnailImage.url=t}),s=n(2377);async function l(e,t,n=!1){const u=Object(r.a)(e);if(Object(c.b)(u.model))switch(u.model.ProviderType){case i.e:try{const e=await Object(o.a)(u.model);a(u,e)}catch(e){a(u,null)}break;case i.h:case i.i:if(!u.thumbnailImage.url){const e=u.model;e.AttachmentThumbnailUrl&&a(u,e.AttachmentThumbnailUrl)}}else{const r=Object(s.a)(e,u.model,2,Object(c.b)(u.model),t,n);a(u,r)}}n.d(t,"a",(function(){return l}))},807:function(e,t,n){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:t,timeBetweenRetryInMS:n}=e;return e=>{let r=0,i=!1;const o=(c,u)=>{i?u(new Error("The function retry was cancelled")):(r++,e().then(e=>c(e)).catch(e=>{t&&r>=t?u(e):setTimeout(()=>o(c,u),n(r))}))};return{retriableFunc:()=>new Promise((e,t)=>o(e,t)),cancel:()=>i=!0}}}function i(e){return t=>Math.pow(2,t)*e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},912:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.299.js.map
self.scriptsLoaded['owa.299.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.299.js'] = (new Date()).getTime();