self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.302.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[302],{10075:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(5),i=n(4055),o=n(1808),s=n(2108),r=n(1766),c=n(29),l=n(14784);function d(e,t){if(!Object(c.a)().UserOptions.ShowNotificationBar)return;const n=1===e?Object(a.b)(l.a):Object(a.c)(Object(a.b)(l.b),e),d=Object(o.h)();r.e.importAndExecute("deleteNotification","MailModuleNotificationBarHost",n,{icon:"Delete",primaryActionText:t?Object(a.b)(i.a):null,allowClear:!0,minWidth:d.minWidth,maxWidth:d.maxWidth,notificationCallback:e=>{e===r.a.PrimaryActionClicked&&s.e.importAndExecute("NotificationBar")}})}},11234:function(e,t,n){"use strict";var a=n(3211),i=n(11828),o=n(11829),s=n(8706),r=n(10075),c=n(9123),l=n(7833),d=n(61),u=n(71),b=n(702),m=n(1744),O=n(5),f=n(2928),v=n(2560),p=n(2194),j=n(929),y=n(1945),I=n(1814),k=n(3691),g=n(5553),S=n(2108),T=n(1685),N=n(3),D=n(1679),h=n(14785);const C={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return F}));const w=Object(N.action)("deleteConversationsWithoutConfirmDialog",(e,t,n,i,o)=>{const s=y.a.tableViews.get(t);return Object(u.b)({name:"TnS_DeleteConversation",options:{timeout:7e4},customData:[o,e.length,n,Object(a.b)(t),Object(D.n)(s),Object(D.Q)(s),Object(D.w)(s)],cosmosOnlyData:JSON.stringify({conversationIds:e.map(e=>e.conversationId)}),actionSource:o},{conversationActionContexts:e,originalTableViewId:t,disposalType:n,instrumentationContexts:i})});Object(N.orchestrator)(w,e=>{const{conversationActionContexts:t,originalTableViewId:n,disposalType:a,instrumentationContexts:i}=e,o=t.map(e=>e.conversationId),l=Object(y.b)().tableViews.get(n);Object(s.a)(l.tableQuery,!0)&&Object(p.a)(o,l,"Delete");const u=Object(d.q)(),b=Object(I.b)(l),m=S.c(l.tableQuery.folderId,b)&&"MoveToDeletedItems"===a;!m&&S.b();const O=Object(D.F)(o,l),f=Object(D.m)(l,!0),j=F.invokeDeleteConversationMutation(t,f,a,b,{timeoutMS:6e4});return m&&S.a(async()=>{return(await j).success&&await c.b.invokeUndoDeleteMutation(t,Object(T.a)("deleteditems")),Promise.resolve()},l.serverFolderId),Object(r.a)(t.length,m),Object(v.d)("Delete",i,{conversationIds:o}),u.markUserPerceivedTime(),Object(k.c)(j,O,l.serverFolderId,l,!0,!0)});function _(e,t,n,a,s){const r=y.a.tableViews.get(t),c=Object(m.e)(r.tableQuery),d={deleteNumberOfRowsTitle:Object(O.b)(l.c),deleteOneRowTitle:Object(O.b)(f.a),confirmDeleteRows:c?Object(O.b)(h.b):Object(O.b)(h.a)};return Object(i.a)(e,t,n,(e,n)=>{const i=Object(o.a)(e,t);w(i,t,n,a,s)},V,d,s)}function V(e){const t=j.a.primaryComposeId&&j.a.viewStates.get(j.a.primaryComposeId).conversationId;return t&&e.indexOf(t)>=0}const F={invokeDeleteConversationMutation:async function(e,t,n,a,i){var o;const s=e.map(e=>({id:e.conversationId,messagesAsOf:Object(g.a)(e.conversationLastSyncTimeStamp)})),r=Object(b.a)(),c=await r.mutate({variables:{conversations:s,disposalType:n,folderId:t,mailboxInfo:a},context:{requestOptions:i},mutation:C});return null===(o=null==c?void 0:c.data)||void 0===o?void 0:o.deleteConversation}}},11828:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var a=n(8705),i=n(6725),o=n(7833),s=n(548),r=n(1744),c=n(5),l=n(11361),d=n(1885),u=n(929),b=n(3025),m=n(9211),O=n(1945),f=n(2281),v=n(1692),p=n(7834),j=n(7012),y=n(1685),I=n(14783),k=n(1679),g=n(1683),S=n(1688),T=n(44),N=n(2458);function D(e,t,n,o,d,u,m,I={originalTableView:O.a.tableViews.get(t),folderTable:g.d.folderTable,searchStore:Object(f.g)()}){const T=I.originalTableView,N=T.tableQuery,D=N.folderId;let V,F;if(Object(a.a)(D,null))return null;const R=Object(r.e)(N),x=1==N.type,M=x&&0===T.selectedRowKeys.size&&"Hover"!==m,A=Object(g.G)(D),E=Object(k.S)(N)||Object(b.c)(N);if(R)V=!1;else if(x){const t=I.searchStore.staticSearchScope;V=e.map(e=>k.b.getParentFolderId(e,T)).every(e=>Object(v.j)(e))||("PrimaryMailbox"==t.kind||"ArchiveMailbox"==t.kind)&&Object(v.j)(t.folderId),F=Object(c.b)(l.a)}else if(!E&&!A){const e=I.folderTable.get(D);V=Object(v.j)(D)||Object(v.p)(e),F=Object(g.h)(e)}const Q=n||V||R||A,J=e.length,P=J>=j.b,U=Object(k.w)(T),B=C(J,u),H=w(u,E,M,Q,T,F),L=_(Q,P,E,M,U);return Object(s.b)(B,H,L,{delayCallbackAfterAnimation:!0}).then(t=>{if(t===s.a.ok){const t=e.filter(e=>{return T.rowKeys.indexOf(e)>=0});if(Object(g.C)(D,"SharedMailbox")){const n=Object(y.a)(S.h),a=Object(k.D)(e,T.id);return Object(i.a)(a,Object(p.a)(n),!0).then(()=>{t.length>0&&h(t,T,"HardDelete",o,d)})}const n=E?"HardDelete":Q?"SoftDelete":"MoveToDeletedItems";if(t.length>0)return h(t,T,n,o,d)}return Promise.resolve()})}async function h(e,t,n,a,i){const o=Object(k.D)(e,t.id);if(i(o)&&await d.d.importAndExecute(u.a.viewStates.get(u.a.primaryComposeId)),!i(o)){const i=e.filter(e=>t.rowKeys.indexOf(e)>=0);if(i.length>0){const t=()=>{a(i,n)};Object(T.j)("mon-tri-listViewAnimation")?!N.b.animationAction&&Object(N.c)("Delete",e,t):t()}}}const C=(e,t)=>e>1?Object(c.c)(t.deleteNumberOfRowsTitle,e):t.deleteOneRowTitle,w=(e,t,n,a,i,s)=>{if(n)return a?Object(c.b)(I.b):Object(c.b)(I.a);const r=Object(k.R)(i)?o.a:o.b;return a||t?e.confirmDeleteRows:Object(c.c)(Object(c.b)(r),Object(m.a)(i.tableQuery.type,i,s))},_=(e,t,n,a,i)=>!(i||e||t||n||a)},11829:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1679);function i(e,t){const n=[],i={};return e.forEach(e=>{const o=Object(a.j)(e,t);i[o.conversationId]||(i[o.conversationId]=!0,n.push(o))}),n}},11830:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(6558),i=n(245),o=n(8707),s=n(8708),r=n(910);function c(e){const t=function(e){return Object(o.a)({MessageAction:Object(s.a)({Action:"Restore"}),Ids:e.map(e=>Object(r.a)({Id:e}))})}(e);return Object(a.a)({Header:Object(i.b)(),Body:t}).then(e=>e.Body.ResponseMessages.Items[0])}},14782:function(e){e.exports=JSON.parse('{"a":"U7b","c":"V7b","b":"W7b","d":"X7b"}')},14783:function(e){e.exports=JSON.parse('{"b":"S7b","a":"T7b"}')},14784:function(e){e.exports=JSON.parse('{"a":"F7b","b":"G7b"}')},14785:function(e){e.exports=JSON.parse('{"b":"H7b","a":"I7b"}')},14786:function(e){e.exports=JSON.parse('{"b":"Y7b","a":"Z7b","c":"_7b","d":"$7b"}')},3211:function(e,t,n){"use strict";n.d(t,"b",(function(){return r}));var a=n(7),i=n(1703),o=n(40),s=n(1679);function r(e){const t=s.Z.tableViews.get(e);let n=null;if(t){n=0==t.tableQuery.type||2==t.tableQuery.type?Object(s.K)(t).sortColumn:null}return n}function c(e,t){const n=[];if(e)for(const a of e){const e=s.b.getItemIds(a,t);e&&n.push(...e)}return n}function l(e,t){const n=[];if(e)for(const a of e)n.push(s.b.getConversationId(a,t));return n}t.a={blockSendersFromTable:{name:"TnS_BlockSendersFromListView",customData:(e,t,n,a)=>[n,e.length,t.tableQuery.type]},setConversationsFlagState:{name:(e,t,n,a,i)=>{let s;switch(a.FlagStatus){case"Flagged":s="TnS_FlagConversation";break;case"NotFlagged":s="TnS_UnflagConversation";break;case"Complete":s="TnS_CompleteFlagConversation";break;default:o.d("Cannot log invalid flag type")}return s},customData:(e,t,n,a,i)=>{const o=s.Z.tableViews.get(n);return[Object(s.n)(o),Object(s.Q)(o),null==e?void 0:e.length]},cosmosOnlyData:(e,t,n,a,i)=>(function(e,t){const n=[],a=[],i=s.Z.tableViews.get(t);for(const t of e)n.push(s.b.getItemIds(t,i)[0]),a.push(s.b.getConversationId(t,i));return JSON.stringify({itemIds:n,conversationIds:a})})(e,n),actionSource:(e,t,n,a,i)=>i,options:{isCore:!0}},setItemsFlagState:{name:(e,t,n,a,i)=>{let s;switch(n.FlagStatus){case"Flagged":s="TnS_FlagItem";break;case"NotFlagged":s="TnS_UnflagItem";break;case"Complete":s="TnS_CompleteFlagItem";break;default:o.d("Cannot log invalid flag type")}return s},customData:(e,t,n,a,i)=>{const o=s.Z.tableViews.get(a);return[Object(s.n)(o),Object(s.Q)(o),null==e?void 0:e.length]},cosmosOnlyData:(e,t,n,a,i)=>JSON.stringify({itemIds:e}),actionSource:(e,t,n,a,i)=>i,options:{isCore:!0}},archiveMailListRows:{name:"TnS_Archive",customData:(e,t,n)=>[t.tableQuery.folderId?Object(i.a)(t.tableQuery.folderId):null,t.tableQuery.type,t.tableQuery.listViewType,e.length,Object(s.n)(t),Object(s.Q)(t)],cosmosOnlyData:(e,t,n)=>JSON.stringify({itemIds:c(e,t),conversationIds:l(e,t)}),options:{isCore:!0},actionSource:(e,t,n)=>n},markItemsJunkNotJunk:{name:(e,t,n,a,i,o)=>{let s="TnS_MarkAs";return s+=t?"Junk":"NotJunk",s},customData:(e,t,n,a,i,o)=>[e.length,Object(s.n)(a),Object(s.Q)(a)],cosmosOnlyData:(e,t,n,a,i,o)=>JSON.stringify({itemIds:e}),actionSource:(e,t,n,a,i,o)=>n},markItemsAsPhishing:{name:"TnS_MarkAsPhishing",customData:(e,t,n,a)=>[e.length,Object(s.n)(t)],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemIds:e}),actionSource:(e,t,n,a)=>n},moveConversation:{name:(e,t,n,a)=>{let i="TnS_MoveConversation";return i+=a?"":"Background",i},customData:(e,t,n,a)=>[n.tableQuery.type,n.tableQuery.folderId?Object(i.a)(n.tableQuery.folderId):null,Object(i.a)(t),e.length,Object(s.n)(n),Object(s.Q)(n)],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemIds:c(e,n),conversationIds:l(e,n)}),options:{isCore:!0},actionSource:(e,t,n,a)=>a},moveItems:{name:(e,t,n,a)=>{let i="TnS_MoveItem";return i+=a?"":"Background",i},customData:(e,t,n,a)=>[n.tableQuery.type,n.tableQuery.folderId?Object(i.a)(n.tableQuery.folderId):null,Object(i.a)(t),e.length,Object(s.n)(n),Object(s.Q)(n)],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemIds:e}),options:{isCore:!0},actionSource:(e,t,n,a)=>a},copyMailListRows:{name:"TnS_Copy",customData:(e,t,n,a,o)=>[t.tableQuery.type,t.tableQuery.folderId?Object(i.a)(a):null,Object(i.a)(n),e.length,Object(s.n)(t)],cosmosOnlyData:(e,t,n,a,i)=>JSON.stringify({itemIds:c(e,t),conversationIds:l(e,t)}),actionSource:(e,t,n,a,i)=>i},restoreConversation:{name:"TnS_RestoreConversation"},restoreItems:{name:"TnS_RestoreItem"},unsubscribe:{name:"TnS_Unsubscribe",customData:(e,t,n,a)=>[a,n,Object(s.n)(t)],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemId:e.ItemId.Id})},pinConversations:{name:(e,t,n,a)=>{let i="TnS_";return i+=n?"PinConversation":"UnpinConversation",i},customData:(e,t,n,a)=>[e.length,Object(s.n)(t),Object(s.Q)(t)],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemIds:c(e,t),conversationIds:l(e,t)}),actionSource:(e,t,n,a)=>a,options:{isCore:!0}},pinItems:{name:(e,t,n,a)=>{let i="TnS_";return i+=n?"PinItem":"UnpinItem",i},customData:(e,t,n,a)=>[e.length,Object(s.n)(t),Object(s.Q)(t)],cosmosOnlyData:(e,t,n,a)=>{const i=c(e,t);return JSON.stringify({itemIds:i})},actionSource:(e,t,n,a)=>a,options:{isCore:!0}},moveConversationToFocusedOrOther:{name:(e,t,n,a)=>0===n?"TnS_MoveConversationToFocused":"TnS_MoveConversationToOther",customData:(e,t,n,a)=>[e.length,Object(s.n)(s.Z.tableViews.get(t))],cosmosOnlyData:(e,t,n,a)=>{const i=s.Z.tableViews.get(t);return JSON.stringify({itemIds:c(e,i),conversationIds:l(e,i)})},options:{isCore:!0},actionSource:(e,t,n,a)=>a},moveItemToFocusedOrOther:{name:(e,t,n,a)=>0===n?"TnS_MoveItemToFocused":"TnS_MoveItemToOther",customData:(e,t,n,a)=>[e.length,Object(s.n)(s.Z.tableViews.get(t))],cosmosOnlyData:(e,t,n,a)=>{const i=s.Z.tableViews.get(t);return JSON.stringify({itemIds:c(e,i)})},options:{isCore:!0},actionSource:(e,t,n,a)=>a},alwaysMoveRowToFocusedOrOther:{name:(e,t,n,a)=>0===n?"TnS_AlwaysMoveToFocused":"TnS_AlwaysMoveToOther",customData:(e,t,n,a)=>[e.length,Object(s.n)(t),t.tableQuery.listViewType],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemIds:c(e,t),conversationIds:l(e,t)}),options:{isCore:!0},actionSource:(e,t,n,a)=>a},addCategories:{name:"TnS_AddCategory",customData:(e,t,n,a)=>[a,e.length,t.tableQuery.listViewType,Object(s.n)(t),Object(s.Q)(t)],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemIds:c(e,t),conversationIds:l(e,t)}),options:{isCore:!0}},removeCategories:{name:"TnS_RemoveCategory",customData:(e,t,n,a)=>[a,e.length,t.tableQuery.listViewType,Object(s.n)(t)],cosmosOnlyData:(e,t,n,a)=>JSON.stringify({itemIds:c(e,t),conversationIds:l(e,t)}),options:{isCore:!0}},clearCategories:{name:"TnS_ClearCategory",customData:(e,t,n)=>[n,e.length,t.tableQuery.listViewType,Object(s.n)(t)],cosmosOnlyData:(e,t,n)=>JSON.stringify({itemIds:c(e,t),conversationIds:l(e,t)}),options:{isCore:!0}},scheduleItems:{name:"TnS_ScheduleItem",customData:(e,t,n,i)=>[e.length,t.tableQuery.listViewType,Object(s.n)(t),i?Object(a.vb)(i):null],options:{isCore:!0},actionSource:(e,t,n)=>n}}},3344:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"DeleteItemJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return a}))},3447:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"DeleteItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return a}))},3448:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(32),i=n(3344);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(a.a)("DeleteItem",e,t)}},3915:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(3447),i=n(910),o=n(3448),s=n(245);function r(e,t){return Object(a.a)({ItemIds:e.map(e=>(function(e){return Object(i.a)({Id:e.Id,ChangeKey:e.ChangeKey})})(e)),DeleteType:t,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function c(e,t,n){const a=r(e,t);return Object(o.a)({Header:Object(s.b)(),Body:a},n).then(e=>e.Body.ResponseMessages.Items)}},4055:function(e){e.exports=JSON.parse('{"a":"R_a"}')},4628:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1679),i=n(1692);function o(e){return e.map(e=>{const t=i.u.items.get(e);let n;return n=!Object(a.X)(t)||t.IsRead,{itemId:e,itemConversationId:t.ConversationId,isRead:n,mailboxInfo:t.MailboxInfo}})}},6558:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(32),i=n(6559);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(a.a)("ApplyMessageAction",e,t)}},6559:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"ApplyMessageActionJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return a}))},6725:function(e,t,n){"use strict";var a=n(7011);var i=n(32);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"CopyItemJsonRequest:#Exchange"},n)),Object(i.a)("CopyItem",e,t)}var s=n(245);function r(e,t,n,i){const r=function(e,t,n){return i={ToFolderId:t,ItemIds:Object(a.a)(e),ReturnNewItemIds:!0,RemoteExecute:n},Object.assign({__type:"CopyItemRequest:#Exchange"},i);var i}(e,t,n);return o({Header:Object(s.b)(),Body:r},i).then(e=>e.Body)}n.d(t,"a",(function(){return r}))},7011:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(910);function i(e){return e.map(e=>Object(a.a)({Id:e}))}},7244:function(e,t,n){"use strict";var a=n(14786),i=n(7833),o=n(2928),s=n(5),r=n(2108),c=n(929),l=n(6725),d=n(4628),u=n(3211),b=n(3915),m=n(2089),O=n(11828),f=n(1685),v=n(7834),p=n(8705),j=n(1945),y=n(11830),I=n(10075),k=n(1692),g=n(548),S=n(1814),T=n(1679),N=n(1690),D=n(1802),h=n(61),C=n(2560),w=n(1683),_=n(1688),V=n(8706),F=n(3691),R=n(1765),x=n(71),M=n(3),A=n(700),E=n(5753),Q=n(3934);const J={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"itemIds"},value:{kind:"Variable",name:{kind:"Name",value:"itemIds"}}},{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var P=n(702),U=n(1703),B=n(2110),H=n(44),L=n(2458);function q(e){const t=c.a.primaryComposeId&&c.a.viewStates.get(c.a.primaryComposeId).itemId;return t&&e.indexOf(t.Id)>=0}n.d(t,"c",(function(){return K})),n.d(t,"a",(function(){return Z})),n.d(t,"b",(function(){return G}));const K=Object(M.action)("deleteItemsWithoutConfirmDialog",(e,t,n,a,i,o,s)=>Object(x.b)({name:"TnS_DeleteItem",options:{timeout:7e4},customData:[e.length,t],cosmosOnlyData:JSON.stringify({itemIds:e}),actionSource:a},{itemIds:e,disposalType:t,parentFolderId:n,actionSource:a,instrumentationContexts:i,requestInitOptions:o,allowUndoAction:s}));function Z(e,t,n,i,o,c){var d;const u=Object(N.b)().items.get(e[0]),b=null===(d=null==u?void 0:u.ParentFolderId)||void 0===d?void 0:d.Id;if(Object(p.a)(b,null))return Promise.resolve();const m=Object(w.C)(b,"SharedMailbox");if(1===e.length){const e=Object(T.I)(),t=[...e.selectedRowKeys.keys()][0];B.i.importAndExecute(t,e,!0)}const O=Object(A.a)(o)||null,j=o&&"GroupMailbox"==o.type,y=Object(k.j)(b),I="SoftDelete"==t&&y||j||Object(w.G)(b);return Object(g.b)(j?Object(s.b)(a.b):"",j?Object(s.b)(a.a):Object(s.b)(a.c),!I,{delayCallbackAfterAnimation:!0}).then(a=>{const s=r.c(b,o)&&"MoveToDeletedItems"===t;if(a==g.a.ok){if(m){const t=Object(f.a)(_.h);return Object(l.a)(e,Object(v.a)(t),!0).then(()=>K(e,"HardDelete",b,i,n,O,s))}{const a=()=>K(e,t,b,i,n,O,s);if(!Object(H.j)("mon-tri-listViewAnimation"))return a();if(!L.b.animationAction)return(async()=>Object(L.c)("Delete",e,a))()}c||D.b.importAndExecute()}return Promise.resolve()})}function G(e,t,n,c,l){const d=j.a.tableViews.get(t),b={deleteNumberOfRowsTitle:Object(s.b)(i.d),deleteOneRowTitle:Object(s.b)(o.a),confirmDeleteRows:Object(s.b)(a.d)},m=j.a.tableViews.get(t);return Object(h.o)("TnS_DeleteItemsFromTable",[l,e.length,Object(u.b)(t),Object(T.w)(m)]),Object(O.a)(e,t,n,(e,n)=>{const a=Object(T.D)(e,t);return K(a,n,d.tableQuery.folderId,l,c,Object(A.a)(Object(S.b)(d)),r.c(d.tableQuery.folderId,Object(S.b)(d))&&"MoveToDeletedItems"==n)},q,b,l)}Object(M.orchestrator)(K,async e=>{var t;let{itemIds:n,disposalType:a,parentFolderId:i,actionSource:o,instrumentationContexts:s,requestInitOptions:c,allowUndoAction:l}=e;const u=Object(T.I)();let O=null;var f=[];if(u&&(f=Object(T.F)(n,u),O=u.serverFolderId,Object(V.a)(u.tableQuery,!0))){const e=Object(d.a)(n);Object(m.a)(e,i,"Delete")}const v=Object(h.q)();if(!l&&r.b(),!Object(Q.a)()||!Object(k.x)()||"drafts"===Object(U.a)(i)||"junkemail"===Object(U.a)(i)){const e=n.map(e=>({Id:e}));c=c||{},c.timeoutMS=6e4;const t=Object(b.a)(e,a,c);return r.a(async()=>{const e=await t;if(l){const t=[];for(const n of e){const e=n;"Success"==e.ResponseClass&&t.push(e.MovedItemId.Id)}if(t.length>0)return Object(y.a)(t)}return Promise.resolve()},O),o&&Object(I.a)(n.length,l),Object(C.d)("Delete",s,{itemIds:n}),v.markUserPerceivedTime(),t.then(e=>(v.addCheckpoint("di_then"),Object(F.a)(f,i,!!u),Object(R.a)(e))).catch(e=>(v.addCheckpoint("di_catch"),"ErrorItemNotFound"==e.responseCode&&(e.fetchErrorType="Expected"),Object(F.a)(f,i,!!u),Object(F.b)(u),Promise.reject(e)))}{const e=await E.c.import(),i=null===(t=j.a.expandedConversationViewState)||void 0===t?void 0:t.forks,o=e(n,i);if(Object(E.d)(i,n),o.length>0){const e=o.map(e=>({Id:e}));Object(P.a)().mutate({variables:{itemIds:e,disposalType:a},mutation:J})}}})},7833:function(e){e.exports=JSON.parse('{"b":"J7b","a":"K7b","c":"L7b","d":"M7b","f":"N7b","e":"O7b"}')},7834:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(598),i=n(1776);function o(e){return e?Object(i.a)({BaseFolderId:Object(a.a)({Id:e})}):null}},8704:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(11234),i=n(7244),o=n(1945),s=n(2495),r=n(2110);function c(e,t,n,c){const l=o.a.tableViews.get(t),d=Object(s.a)(e,l);if(1===l.selectedRowKeys.size){const e=[...l.selectedRowKeys.keys()][0];r.i.importAndExecute(e,l,!0)}switch(l.tableQuery.listViewType){case 0:Object(a.a)(e,t,n,d,c);break;case 1:Object(i.b)(e,t,n,d,c)}}},8705:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(14782),i=n(5),o=n(548),s=n(1683),r=n(29);function c(e,t){var n,c;if(!Object(r.a)().SessionSettings.IsShadowMailbox)return!1;let l;const d=s.d.folderTable.get(e),u=s.d.folderTable.get(t),b=null===(n=d.remoteFolderInfo)||void 0===n?void 0:n.remoteDistinguishedFolderType;if("REMOTE_DISTINGUISHED_FOLDER_TYPE_IMPORTANT"==b)l=Object(i.b)(a.a);else if("REMOTE_DISTINGUISHED_FOLDER_TYPE_STARRED"==b)l=Object(i.b)(a.c);else if(null!=u){const e=null===(c=u.remoteFolderInfo)||void 0===c?void 0:c.remoteDistinguishedFolderType;"REMOTE_DISTINGUISHED_FOLDER_TYPE_IMPORTANT"==e?l=Object(i.b)(a.b):"REMOTE_DISTINGUISHED_FOLDER_TYPE_STARRED"==e&&(l=Object(i.b)(a.d))}return null!=l&&(Object(o.b)("",l,!1,{hideCancelButton:!0}),!0)}},8706:function(e,t,n){"use strict";function a(e,t){switch(0==e.type?e.scenarioType:""){case"persona":case"privatedistributionlist":return!1;case"category":return t;default:return!0}}n.d(t,"a",(function(){return a}))},8707:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"ApplyMessageActionRequest:#Exchange"},e)}n.d(t,"a",(function(){return a}))},8708:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"MessageAction:#Exchange"},e)}n.d(t,"a",(function(){return a}))},9123:function(e,t,n){"use strict";var a=n(3211),i=n(61),o=n(2194),s=n(1679),r=n(1945),c=n(9217),l=n(3691),d=n(702),u=n(5553);const b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoDeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoDeleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};n.d(t,"b",(function(){return m}));t.a=Object(i.r)(a.a.restoreConversation,(function(e,t){const n=Object(r.b)().tableViews.get(t),a=Object(c.a)(e,t,e=>!!e),i=Object(s.D)(a,t),d=a.map(e=>Object(s.j)(e,t));Object(o.a)(i,n,"Restore");const u=n.tableQuery.folderId,b=m.invokeUndoDeleteMutation(d,u);return Object(l.c)(b,a,n.serverFolderId,n,!1,!0)}));const m={invokeUndoDeleteMutation:async function(e,t){var n;const a=e.map(e=>({id:e.conversationId,messagesAsOf:Object(u.a)(e.conversationLastSyncTimeStamp)})),i=Object(d.a)(),o=await i.mutate({variables:{conversations:a,folderId:t},mutation:b});return null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.undoDeleteConversation}}}}]);
//# sourceMappingURL=owa.302.js.map
self.scriptsLoaded['owa.302.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.302.js'] = (new Date()).getTime();