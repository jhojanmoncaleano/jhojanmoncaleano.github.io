self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.33.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[33],{11506:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7507),o=n(5891),a=n(11508),u=n(11509),i=n(11510),l=n(11511),c=n(11512),f=n(11513),d=n(11514),s=n(1747),g=["font","text-decoration","color","background"],m="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),p=["href","src"],v=["TD","TH","TR","TABLE","TBODY","THEAD"];function b(e){var t=(0,s.toArray)(e.childNodes).map(b).every((function(e){return e})),n=(0,s.isBlockElement)(e),r=(0,s.getTagOfNode)(e);return r&&(m.indexOf(r)>=0||t&&!(0,s.isVoidHtmlElement)(e)&&v.indexOf(r)<0?(n&&!t&&(0,s.wrap)(e),(0,s.unwrap)(e)):function(e){for(var t=(0,s.safeInstanceOf)(e,"HTMLTableCellElement"),n=0,r=(0,s.toArray)(e.attributes);n<r.length;n++){var o=r[n];t&&"style"==o.name?y(e):p.indexOf(o.name.toLowerCase())<0&&0!=o.name.indexOf("data-")&&e.removeAttribute(o.name)}}(e)),n}function y(e){var t=(0,s.getStyles)(e),n={};return Object.keys(t).forEach((function(e){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])})),(0,s.setStyles)(e,t),n}function O(e){(0,r.default)(e,(function(t){var n=(0,s.getSelectedBlockElementsInRegion)(t),r=(0,s.collapseNodesInRegion)(t,n);if(e.contains(t.rootNode)){var o=y(t.rootNode);if(Object.keys(o).length>0){var a=(0,s.wrap)((0,s.toArray)(t.rootNode.childNodes));(0,s.setStyles)(a,o)}}for(;r.length>0&&(0,s.isNodeInRegion)(t,r[0].parentNode);)r=[(0,s.splitBalancedNodeRange)(r)];r.forEach(b)}))}function h(e,t){switch(void 0===t&&(t=0),t){case 0:!function(e){e.focus(),e.addUndoSnapshot((function(){(0,o.default)(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;if(e.queryElements("[style]",2,(function(e){g.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),!n){if(t.fontFamily&&(0,u.default)(e,t.fontFamily),t.fontSize&&(0,i.default)(e,t.fontSize),t.textColor){var r=e.queryElements("a *, a",1),s=r.length>0?function(e){return-1==r.indexOf(e)}:null;t.textColors?(0,l.default)(e,t.textColors,s):(0,l.default)(e,t.textColor,s)}t.backgroundColor&&(t.backgroundColors?(0,a.default)(e,t.backgroundColors):(0,a.default)(e,t.backgroundColor)),t.bold&&(0,c.default)(e),t.italic&&(0,f.default)(e),t.underline&&(0,d.default)(e)}}),"Format")}(e);break;case 1:O(e);break;default:!function(e){if(!function(e){var t=e.getSelectionTraverser();return!!t.currentBlockElement&&!!t.getNextBlockElement()}(e)&&e.getSelectionTraverser().currentInlineElement instanceof s.PartialInlineElement)return void h(e);O(e)}(e)}}t.default=h},11507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),o=n&&r.Position.getStart(n),a=n&&r.Position.getEnd(n);t.forEach((function(e){return e.commit()})),e.select(o,a)}}},11508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8440),o=n(1747);t.default=function(e,t){(0,r.default)(e,(function(n,r){(0,o.setColor)(n,r?"":t,!0,e.isDarkMode())}))}},11509:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9360);t.default=function(e,t){(0,r.default)(e,"font-family",(function(e,n){e.style.fontFamily=n?"":t}))}},11510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9360),o=n(1747);t.default=function(e,t){(0,r.default)(e,"font-size",(function(e,n){e.style.fontSize=n?"":t,"normal"!=(0,o.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")}))}},11511:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9360),o=n(1747);t.default=function(e,t,n){(0,r.default)(e,"color",(function(r,a){n&&!n(r)||(0,o.setColor)(r,a?"":t,!1,e.isDarkMode())}))}},11512:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5891);t.default=function(e){(0,r.default)(e,"bold")}},11513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5891);t.default=function(e){(0,r.default)(e,"italic")}},11514:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5891);t.default=function(e){(0,r.default)(e,"underline")}},11515:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e,t,n){void 0===n&&(n=1),e.addUndoSnapshot((function(){e.focus();var o=e.getSelectedRegions();if(o[0]){var a=(0,r.createVListFromRegion)(o[0],!1,t);a&&(a.split(t,n),a.writeBack())}}),"Format")}},11516:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7507),o=n(1747);t.default=function(e,t,n){(0,r.default)(e,(function(e){var n=(0,o.getSelectedBlockElementsInRegion)(e,!0),r=(0,o.collapseNodesInRegion)(e,n);if(r.length>0){if(1==r.length){var a=(0,o.getTagOfNode)(r[0]);"BR"==a?r=[(0,o.wrap)(r[0])]:"LI"!=a&&"TD"!=a||(r=(0,o.toArray)(r[0].childNodes))}for(;r[0]&&(0,o.isNodeInRegion)(e,r[0].parentNode)&&r.some((function(e){return"LI"==(0,o.getTagOfNode)(e)}));)r=[(0,o.splitBalancedNodeRange)(r)];t(r)}}),n)}},13268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewFontSize=t.FONT_SIZES=void 0;var r=n(8440),o=n(1747);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];var a=1,u=1e3;function i(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,a);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),u);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;o>=0;o--)if(e>n[o]){e=n[o];break}return e}t.default=function(e,n,a){void 0===a&&(a=t.FONT_SIZES);var u=0==n?1:-1;(0,r.default)(e,(function(e){var t=parseFloat((0,o.getComputedStyle)(e,"font-size"));e.style.fontSize=i(t,u,a)+"pt","normal"!=(0,o.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=i},13298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11506);t.default=function(e){(0,r.default)(e,1)}},13299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747),o=/^[a-zA-Z]+:/i,a=/^[\w.%+-]+@/i,u=/^ftp\./i;function i(e){return e.queryElements("a[href]",1)[0]}function l(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,c){e.focus();var f=(function(e){var t=new r.HtmlSanitizer,n=document.createElement("a");return n.href=e||"",t.sanitize(n),n.getAttribute("href")}(t)||"").trim();if(f){var d=(0,r.matchLink)(f),s=d?d.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(o)<0&&(t=0==e.search(a)?"mailto:":0==e.search(u)?"ftp://":"http://"),t+e}(f),g=d?d.originalUrl:f;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),r=null;return t&&t.collapsed?(r=i(e))?(r.href=s,l(r,c)):((r=e.getDocument().createElement("A")).textContent=c||g,r.href=s,e.insertNode(r)):(e.getDocument().execCommand("createLink",!1,s),l(r=i(e),c)),n&&r&&(r.title=n),r}),"CreateLink")}}},13300:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getElementBasedFormatState=void 0;var o=n(1747);function a(e,t){var n=(0,o.getTagOfNode)(e.getElementAtCursor("OL,UL",null,t)),r=(0,o.getTagOfNode)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:r&&parseInt(r[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}t.getElementBasedFormatState=a,t.default=function(e,t){return r(r(r(r({},e.getPendableFormatState(!1)),a(e,t)),e.getStyleBasedFormatState()),e.getUndoState())}},13301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e,t,n,o,a,u){var i=(0,r.wrap)(n,o?"DIV":"SPAN");if(!o&&a&&(i.style.display="inline-block"),(0,r.commitEntity)(i,t,a),!e.contains(i)){var l=void 0,c=void 0;if("number"==typeof u)c=u;else if(u){l=e.getSelectionRange();var f=u.normalize().node,d=f&&e.getElementAtCursor((0,r.getEntitySelector)(),f);d&&(u=new r.Position(d,-3)),e.select(u),c=3}else e.focus(),c=3;e.insertNode(i,{updateCursor:!1,insertOnNewLine:o,replaceSelection:!0,position:c}),3==c&&(l?e.select(l):o||e.select(i,-3))}if(o){var s=e.getDocument().createElement("BR");i.parentNode.insertBefore(s,i.nextSibling)}var g=(0,r.getEntityFromElement)(i);return e.triggerContentChangedEvent("InsertEntity",g),g}},13302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);function o(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),"Format")}t.default=function(e,t){"string"==typeof t?o(e,t):(0,r.readFile)(t,(function(t){t&&!e.isDisposed()&&o(e,t)}))}},13303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);function o(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,a){var u=e.getDocument(),i=u.createDocumentFragment(),l=u.createElement("table");i.appendChild(l),l.cellSpacing="0",l.cellPadding="1";for(var c=0;c<n;c++){var f=u.createElement("tr");l.appendChild(f);for(var d=0;d<t;d++){var s=u.createElement("td");f.appendChild(s),s.appendChild(u.createElement("br")),s.style.width=o(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new r.VTable(l);t.applyFormat(a||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(i),e.runAsync((function(e){return e.select(new r.Position(l,0).normalize())}))}),"Format")}},13304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(o,a){var u=new r.VTable(n);u.edit(t),u.writeBack(),e.focus();var i=function(e,t,n){var r=t,o=n;switch(e){case 0:o=0;break;case 1:r+=1,o=0;break;case 2:r=0;break;case 3:r=0,o+=1}return{newRow:r,newCol:o}}(t,u.row,u.col);e.select(u.getCell(i.newRow,i.newCol).td,0)}),"Format")}},13305:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(o,a){var u=new r.VTable(n);u.applyFormat(t),u.writeBack(),e.focus(),e.select(o,a)}),"Format")}},13306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",1,r.unwrap),e.select(t,n)}),"Format")}},13307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){if(!t||!n)return!1;var a;if(a="string"==typeof t?(o=o||e.getContentSearcherOfCursor())&&o.getRangeFromText(t,r):t){var u=e.getSelectionRange();return u.collapsed&&a.endContainer==u.startContainer&&a.endOffset==u.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:a}),!0}return!1}},13308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){t&&e.addUndoSnapshot((function(){t.style.transform="rotate("+n+"deg)"}),"Format")}},13309:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5891);t.default=function(e,t){var n="justifyLeft",o="left";1==t?(n="justifyCenter",o="center"):2==t&&(n="justifyRight",o="right"),e.addUndoSnapshot((function(){(0,r.default)(e,n),e.queryElements("[align]",1,(function(e){return e.style.textAlign=o}))}),"Format")}},13310:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13311);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,o){(0,r.default)(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),e.select(n,o)}),"Format")}},13311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);function o(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf((0,r.getTagOfNode)(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),r=n&&n.currentBlockElement,a=[];r;)o(r)||a.push(r),r=n.getNextBlockElement();a.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},13312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"Format")}},13313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7507),o=n(1747);function a(e,t){var n=(0,o.collapseNodesInRegion)(e,t);(0,o.wrap)(n,2)}function u(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=(0,o.findClosestElementAncestor)(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=(0,o.wrap)((0,o.toArray)(n.childNodes)));(0,o.isNodeInRegion)(e,n)&&"BLOCKQUOTE"!=(0,o.getTagOfNode)(n);)n=(0,o.splitBalancedNodeRange)(n);(0,o.isNodeInRegion)(e,n)&&(0,o.unwrap)(n)}}))}t.default=function(e,t){var n=0==t?a:u;(0,r.default)(e,(function(e,r,a){for(var u=(0,o.getSelectedBlockElementsInRegion)(e,!0),i=[[]],l=0;l<u.length;l++){var c=u[l].getStartNode(),f=(0,o.createVListFromRegion)(e,!0,c);if(f){for(i.push([]);u[l+1]&&f.contains(u[l+1].getStartNode());)l++;f.setIndentation(r,a,t),f.writeBack()}else i[i.length-1].push(u[l])}i.forEach((function(t){return n(e,t)}))}))}},13314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8440),o=n(1747);t.default=function(e,t,n){function a(e,n){switch(t){case"lowercase":return e.toLocaleLowerCase(n);case"uppercase":return e.toLocaleUpperCase(n);case"capitalize":for(var r=e.toLocaleLowerCase(n).split(" "),o=0;o<r.length;o++)r[o]=r[o].charAt(0).toLocaleUpperCase(n)+r[o].slice(1);return r.join(" ");case"sentence":var a=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(n).replace(a,(function(e){return e.toLocaleUpperCase(n)}))}}(0,r.default)(e,(function(e){for(var t=(0,o.getFirstLeafNode)(e);t;t=(0,o.getNextLeafSibling)(e,t))if(3==t.nodeType)try{t.textContent=a(t.textContent,n)}catch(e){t.textContent=a(t.textContent,void 0)}}))}},13315:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9361);t.default=function(e){(0,r.default)(e,2)}},13316:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9361);t.default=function(e,t){(0,r.default)(e,1,t)}},13317:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11516),o=n(1747),a="blockquote",u=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,o.wrap)(e,a);(t||u)(n)}),(function(){return 0==e.queryElements("blockquote",1,o.unwrap).length}))}},13318:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11516),o=n(1747),a="pre",u="code",i=a+">"+u;t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,o.wrap)(e,u),r=(0,o.wrap)(n,a);null==t||t(r)}),(function(){return 0==e.queryElements(i,1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;(0,o.unwrap)(e),(0,o.unwrap)(t)}})).length}))}},13319:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5891);t.default=function(e){(0,r.default)(e,"strikeThrough")}},13320:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5891);t.default=function(e){(0,r.default)(e,"subscript")}},13321:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5891);t.default=function(e){(0,r.default)(e,"superscript")}},13322:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var o=e.getDocument().createElement("div");(0,r.moveChildNodes)(o,t),e.replaceNode(t,o)})),t>0){for(var o=e.getSelectionTraverser(),a=o?o.currentBlockElement:null,u=new r.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});a;){var i=a.collapseToSingleElement();u.sanitize(i),a=o.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"Format")}},2524:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentCommitListChains=t.blockFormat=t.toggleListType=t.toggleHeader=t.toggleUnderline=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleCodeBlock=t.toggleBlockQuote=t.setOrderedListNumbering=t.toggleNumbering=t.toggleItalic=t.toggleBullet=t.toggleBold=t.changeCapitalization=t.setIndentation=t.setImageAltText=t.setFontSize=t.setFontName=t.setDirection=t.setTextColor=t.setBackgroundColor=t.setAlignment=t.rotateElement=t.replaceWithNode=t.removeLink=t.formatTable=t.editTable=t.insertTable=t.insertImage=t.insertEntity=t.getElementBasedFormatState=t.getFormatState=t.createLink=t.clearFormat=t.clearBlockFormat=t.FONT_SIZES=t.changeFontSize=void 0;var r=n(13268);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"FONT_SIZES",{enumerable:!0,get:function(){return r.FONT_SIZES}});var o=n(13298);Object.defineProperty(t,"clearBlockFormat",{enumerable:!0,get:function(){return o.default}});var a=n(11506);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return a.default}});var u=n(13299);Object.defineProperty(t,"createLink",{enumerable:!0,get:function(){return u.default}});var i=n(13300);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"getElementBasedFormatState",{enumerable:!0,get:function(){return i.getElementBasedFormatState}});var l=n(13301);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return l.default}});var c=n(13302);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return c.default}});var f=n(13303);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return f.default}});var d=n(13304);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return d.default}});var s=n(13305);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return s.default}});var g=n(13306);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return g.default}});var m=n(13307);Object.defineProperty(t,"replaceWithNode",{enumerable:!0,get:function(){return m.default}});var p=n(13308);Object.defineProperty(t,"rotateElement",{enumerable:!0,get:function(){return p.default}});var v=n(13309);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return v.default}});var b=n(11508);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return b.default}});var y=n(11511);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return y.default}});var O=n(13310);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return O.default}});var h=n(11509);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return h.default}});var S=n(11510);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return S.default}});var P=n(13312);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return P.default}});var E=n(13313);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return E.default}});var j=n(13314);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return j.default}});var _=n(11512);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return _.default}});var C=n(13315);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return C.default}});var N=n(11513);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return N.default}});var T=n(13316);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return T.default}});var F=n(11515);Object.defineProperty(t,"setOrderedListNumbering",{enumerable:!0,get:function(){return F.default}});var B=n(13317);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return B.default}});var k=n(13318);Object.defineProperty(t,"toggleCodeBlock",{enumerable:!0,get:function(){return k.default}});var M=n(13319);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return M.default}});var w=n(13320);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return w.default}});var L=n(13321);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return L.default}});var x=n(11514);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return x.default}});var A=n(13322);Object.defineProperty(t,"toggleHeader",{enumerable:!0,get:function(){return A.default}});var I=n(9361);Object.defineProperty(t,"toggleListType",{enumerable:!0,get:function(){return I.default}});var R=n(7507);Object.defineProperty(t,"blockFormat",{enumerable:!0,get:function(){return R.default}});var U=n(11507);Object.defineProperty(t,"experimentCommitListChains",{enumerable:!0,get:function(){return U.default}})},5891:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747);t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},o=e.getSelectionRange();if(o&&o.collapsed){e.addUndoSnapshot();var a=e.getPendableFormatState(!1);n();var u=Object.keys(r.PendableFormatCommandMap).filter((function(e){return r.PendableFormatCommandMap[e]==t}))[0];u&&(a[u]=!a[u],e.triggerPluginEvent(13,{formatState:a}))}else e.addUndoSnapshot(n,"Format")}},7507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11507),o=n(1747);t.default=function(e,t,n){e.focus(),e.addUndoSnapshot((function(a,u){if(!n||n()){var i=e.getSelectedRegions(),l=o.VListChain.createListChains(i,null==a?void 0:a.node);i.forEach((function(e){return t(e,a,u,l)})),(0,r.default)(e,l)}e.select(a,u)}),"Format")}},8440:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1747),o="​";t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var a=n.startContainer;if("SPAN"==(0,r.getTagOfNode)(a)&&(!a.firstChild||"BR"==(0,r.getTagOfNode)(a.firstChild)&&!a.firstChild.nextSibling))e.addUndoSnapshot(),t(a);else a&&3==a.nodeType&&a.nodeValue==o&&"SPAN"==(0,r.getTagOfNode)(a.parentNode)||(e.addUndoSnapshot(),a=e.getDocument().createTextNode(o),n.insertNode(a)),(0,r.applyTextStyle)(a,t),e.select(a,-1)}else e.addUndoSnapshot((function(){for(var n,r,o=e.getSelectionTraverser(),a=o&&o.currentInlineElement;a;){var u=o.getNextInlineElement();a.applyStyle((function(e,o){t(e,o),n=n||e,r=e})),a=u}n&&r&&e.select(n,-2,r,-3)}),"Format")}},9360:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8440),o=n(1747);t.default=function(e,t,n){var a=[];(0,r.default)(e,(function(t,r){n(t,r);var o=e.getElementAtCursor("LI",t);o&&-1===a.indexOf(o)&&a.push(o)})),function(e,t){e.forEach((function(e){(0,o.safeInstanceOf)(e,"HTMLLIElement")&&(0,o.setListItemStyle)(e,t)}))}(a,[t])}},9361:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7507),o=n(1747);t.default=function(e,t,n,a){void 0===a&&(a=!0),(0,r.default)(e,(function(e,r,u,i){var l,c=n>0&&i.filter((function(e){return e.canAppendAtCursor(n)}))[0],f=c&&r.equalTo(u)?c.createVListAtBlock(null===(l=(0,o.getBlockElementAtNode)(e.rootNode,r.node))||void 0===l?void 0:l.collapseToSingleElement(),n):(0,o.createVListFromRegion)(e,a);f&&(f.changeListType(r,u,t),f.writeBack())}))}}}]);
//# sourceMappingURL=owa.33.js.map
self.scriptsLoaded['owa.33.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.33.js'] = (new Date()).getTime();