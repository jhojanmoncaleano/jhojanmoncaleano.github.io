self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.331.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[331],{11796:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(5),r=n(1987),c=n(209),i=n(3240);const a="explicitlogon";function u(e,t){const n=Object(i.a)(e,a);return Object(o.k)(n)?Object(c.d)(t):Object(r.n)(n)}},1715:function(e,t,n){"use strict";function o(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function r(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}))},1718:function(e,t,n){"use strict";var o=n(1787),r=n(272),c=n(1686),i=n(61),a=n(7),u=n(40);const s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function b(e,t){const n={},b=Object(r.k)(e);if(t?(n[s]=t,n[f]=t):b&&(n[s]=b.anchorMailbox),Object(r.s)())return u.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(b){if(b.accountState==r.b.AccessRevoked)return null;if(b.accountState==r.b.AccountDeprovisioned||b.accountState==r.b.AccountNotFound)return Object(r.d)(b.accountState,b.accountProviderType),null}if(b){let t,r=b.token,s=Object(c.g)(b.tokenExpiry);!s&&r||(Object(i.o)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Ub)()),isTokenExpired_1:s,isTokenInvalid_2:!r},{isCore:!0}),r=await o.a.importAndExecute(b.accountId,e,r),u.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+r),r||(r="")),"Outlook"==b.accountProviderType?(t=`MSAuth1.0 usertoken="${r}", type="MSACT"`,n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType&&"Yahoo"!=b.accountProviderType||(t=`Bearer ${r}`,n[l]=2..toString()),n[d]=t}return n}var p=n(1715),O=n(914);async function h(e,t){var n;const o=Object(p.a)();if(o.headers=await async function(e,t){var n;const o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,r=await b(e.mailboxInfo.userIdentity,j(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(p.b)(o,r),o}(e,t),o.authNeededOnUnAuthorized=!1,o.datapoint=o.datapoint||{},Object(r.s)()){const t=Object(O.a)(null===(n=null==e?void 0:e.mailboxInfo)||void 0===n?void 0:n.userIdentity);u.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+t),o.sourceId=t,o.datapoint.mailbox="Connected"}else o.datapoint.mailbox="Connected";return o}function j(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&u.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return j}))},1721:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(3);const r=Object(o.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},1785:function(e,t,n){"use strict";var o=n(1715);function r(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function c(e,t,n){t&&(e||n)&&Object(o.b)(t,r(e,n))}function i(e,t){var n;const o=null!=t?t:{},r=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",c(e,r),Object.assign(Object.assign({},o),{headers:r})}var a=n(272),u=n(1718),s=n(56),d=n(294),l=n.n(d);async function f(e){return Object(s.b)().then(async t=>{if(e)if(Object(a.r)(e.userIdentity)){const n=await Object(u.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);l()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=r(e.mailboxSmtpAddress);l()(t,n)}return t})}function b(){return Object(s.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function p(e=null){return Object(a.r)(e)?b().then(t=>{return Object(u.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var O=n(50);function h(e,t,n,o){let r=new Headers;return n&&r.set("X-OWA-CANARY",Object(O.a)()),t&&r.set("X-OWA-ActionName",t),(e||o)&&(o?c(e,r,o):c(e,r)),r}n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return h}))},1787:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(20),r=n(1721);n.d(t,"b",(function(){return r.a}));const c=new o.c(()=>n.e(1045).then(n.bind(null,2021))),i=new o.a(c,e=>e.getAndUpdateAccessToken)},2036:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var o=n(5),r=n(283),c=n(50),i=n(2199),a=n(96),u=n(2),s=n(30),d=n(2039),l=n(2037);function f(e,t,n,f=!1,b=null){if(!e||!e.Id||!e.mailboxInfo)return null;const p=Object(d.b)(e.mailboxInfo),O=null==p?void 0:p.downloadUrlBase,h=Object(l.a)(e.mailboxInfo);if(b=b||Object(o.c)(t,encodeURIComponent(e.Id)),!O||f&&"Firefox"===Object(a.a)().browser){const e=i.e+b+"&X-OWA-CANARY="+Object(c.a)();return Object(s.a)(e)}let j="{0}{1}/{2}";Object(r.a)()&&(j+="&isc=1");let v=Object(o.c)(j,O,h,b);return n&&(v+="&token="+(null==p?void 0:p.downloadToken),v+="&X-OWA-CANARY="+Object(c.a)()),v+="&owa="+window.location.hostname,v+="&scriptVer="+Object(u.u)()||!1,v}},2037:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(209),r=n(272);function c(e){if("ArchiveMailbox"==e.type)return Object(o.a)();const t=e.userIdentity&&Object(r.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(o.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(o.a)():e.mailboxSmtpAddress}},2039:function(e,t,n){"use strict";var o=n(272);const r={};function c(e){return r[e]}function i(e,t){const n=r[e];r[e]=Object.assign(Object.assign({},n),t)}var a=n(49),u=n(707),s=n(61),d=n(914),l=n(807),f=n(32);var b=n(40),p=n(1718),O=n(1715);const h=Object(l.b)({timeBetweenRetryInMS:()=>3e4});async function j(e){const t=async()=>{try{let t={};return Object(u.b)()?t={sourceId:Object(d.a)(null==e?void 0:e.userIdentity)}:Object(o.r)(e.userIdentity)&&(t=await async function(e){let t={};t.headers=new Headers;const n=await Object(p.a)(e);return Object(O.b)(t.headers,n),t}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(t)}catch(e){throw b.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},n=c(e.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){i(e.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:o}=h(async()=>{n++;const o=await t();b.h.info("update new token"),i(e.userIdentity,{downloadToken:o,isRefreshingDownloadToken:!1})}),r=new s.c("AttachmentRefreshDownloadToken");try{await o(),r.addCustomData([n]),r.end()}catch(t){b.h.warn(`Retry to refresh token failed: ${t}`),r.addCustomData([n]),r.endWithError("ServerError",t),i(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function v(e){const t=Object(o.r)(e.userIdentity)?Object(a.h)(e.userIdentity):Object(a.g)(),n=null==t?void 0:t.ApplicationSettings;if(n){const t=n.DownloadUrlBase;i(e.userIdentity,{downloadUrlBase:t,downloadToken:n.FirstDownloadToken}),t&&function(e,t){t=t<1?1:t,Object(u.b)()&&j(e),setInterval(()=>{j(e)},6e4*t)}(e,n.DownloadTokenRefreshMinutes)}}var w=n(266);function m(e){const t=Object(o.j)(null==e?void 0:e.userIdentity),n=c(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Office365":case"Outlook":v(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(w.a)(t)}const r=c(e.userIdentity);return r||(Object(s.o)("FilesUrlDataNotFound",{accountProviderType:t}),b.h.warn("Unable to get the url data")),r}function y(e){if(!e)return null;const t=m(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return y}))},2199:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return d}));const o="/owa/",r="service.svc/s/GetFileAttachment?id={0}",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",i="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",a="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",u="service.svc/s/GetAttachmentThumbnail?id={0}",s="pdfprint.aspx?id={0}",d="pdfprint.aspx?id={0}&location={1}"},2251:function(e,t,n){"use strict";var o=n(266),r=n(5),c=n(50),i=n(2199);const a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var u=n(2036),s=n(30);function d(e,t,n,d,l=0,f=0,b=!0,p=null,O=null){let h;switch(n){case 0:h=i.f;break;case 3:h=i.h;break;case 1:if(!function(e){if(!e)return!1;let t=null;const n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&a.indexOf(t.toLowerCase())>=0}(p))return null;h=i.g;break;default:Object(o.a)(n)}let j=d?f:l;!j&&l&&(j=l);let v=Object(r.c)("{0}&permissionLevel={1}",Object(r.c)(h,encodeURIComponent(e.Id),encodeURIComponent(t)),j);const w=Object(u.a)(e,h,!0,3===n,v);if(w)return w;let m=Object(r.c)("{0}{1}{2}",i.e,O,v);if(b){m=`${m}&X-OWA-CANARY=${Object(c.a)()}`}return Object(s.a)(m)}function l(e,t,n=!1,c=!0){let a;switch(t){case 0:a=i.a;break;case 1:a=i.b;break;case 2:a=i.d;break;case 3:a=i.c;break;default:return Object(o.a)(t)}if(!Object(r.k)(a)){const o=Object(u.a)(e,a,c,3===t);return Object(r.c)("{0}{1}{2}",o,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}))},2532:function(e,t,n){"use strict";var o=n(2251);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b}));var r=n(2039);n.d(t,"c",(function(){return r.a}));var c=n(2037);n.d(t,"e",(function(){return c.a}));var i=n(2036);n.d(t,"d",(function(){return i.a}))},2710:function(e,t,n){var o,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(c){if(void 0===(r="function"==typeof(o=c)?o.call(t,n,t,e):o)||(e.exports=r),!0,e.exports=c(),!!0){var i=window.Cookies,a=window.Cookies=c();a.noConflict=function(){return window.Cookies=i,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function r(){}function c(t,n,c){if("undefined"!=typeof document){"number"==typeof(c=e({path:"/"},r.defaults,c)).expires&&(c.expires=new Date(1*new Date+864e5*c.expires)),c.expires=c.expires?c.expires.toUTCString():"";try{var i=JSON.stringify(n);/^[\{\[]/.test(i)&&(n=i)}catch(e){}n=o.write?o.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var u in c)c[u]&&(a+="; "+u,!0!==c[u]&&(a+="="+c[u].split(";")[0]));return document.cookie=t+"="+n+a}}function i(e,n){if("undefined"!=typeof document){for(var r={},c=document.cookie?document.cookie.split("; "):[],i=0;i<c.length;i++){var a=c[i].split("="),u=a.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var s=t(a[0]);if(u=(o.read||o)(u,s)||t(u),n)try{u=JSON.parse(u)}catch(e){}if(r[s]=u,e===s)break}catch(e){}}return e?r[e]:r}}return r.set=c,r.get=function(e){return i(e,!1)},r.getJSON=function(e){return i(e,!0)},r.remove=function(t,n){c(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))}))},2745:function(e,t,n){"use strict";function o(e){return Object.assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}n.d(t,"a",(function(){return o}))},2790:function(e,t,n){"use strict";var o=n(32);function r(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},n)),Object(o.a)("GetClientAccessToken",e,t)}n.d(t,"a",(function(){return r}))},2883:function(e,t,n){"use strict";var o=n(2710),r=n.n(o),c=n(61),i=n(2745),a=n(2790),u=n(245);const s=r.a,d="GetConnectorsLTITokenFailure",l="GetConnectorsLTITokenException",f="GetConnectorsLTITokenNull",b="ConnectorsLtiToken",p="40B852DF-9693-420D-AA7D-10072C9CE077",O=5;let h,j,v;async function w(){let e=function(){if(h){if(Date.now()-j<1e3*(h.TTL-O)*60)return h.TokenValue}return null}();return e||(e=await function(){v||(v=new Promise((e,t)=>{const n={Header:Object(u.b)(),Body:Object(i.a)({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:p,TokenType:"Connectors"}]})};Object(a.a)(n).then(n=>{v=null,n&&"Success"===n.Body.ResponseMessages.Items[0].ResponseClass?(h=n.Body.ResponseMessages.Items[0].Token,j=Date.now(),function(e){if(!e)throw m(f),new Error("getClientAuthToken null");s.set(b,e,{path:"/actions/"})}(h.TokenValue),e(h.TokenValue)):(m(d),t(new Error("getClientAuthToken failed")))}).catch(e=>{v=null,m(l),t(new Error("getClientAuthToken exception: "+e))})}));return v}()),e}function m(e){Object(c.o)(e),h=void 0}var y=n(44),k=n(283),g=n(391);const A="https://outlook.office365.com/connectors",x="User.Read";function I(){return Object(y.j)("rp-actionableMessages-aad-token")&&!Object(k.a)()?async function(){let[e,t]=Object(g.getAccessTokenforResourceAsLazy)(A,"OwaConnectors");e||(e=await t);return e}():Object(y.j)("rp-actionableMessages-msa-token")&&Object(k.a)()?async function(){return await Object(g.getDelegationTokenForOwa)(x)}():w()}n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return I}))},6994:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(61);const r="2d",c="canvas",i="image/png";function a(e){try{const t=document.createElement(c);let n=e.naturalWidth,a=e.naturalHeight;if(n>0&&a>0||(Object(o.o)("CreateDataURIMissingNaturalDimensions"),n=e.width,a=e.height),n>0&&a>0)return t.width=n,t.height=a,t.getContext(r).drawImage(e,0,0),t.toDataURL(i)}catch(e){}return null}}}]);
//# sourceMappingURL=owa.331.js.map
self.scriptsLoaded['owa.331.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.331.js'] = (new Date()).getTime();