self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.34.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[34],{1835:function(e,t,n){"use strict";var r=n(9322),i=n(5380),s=n(312),a=n(2825),u=n(40),o=n(597);function c(e,t,n,r,c,l,d,m){const f={cvid:n,query:e,textdecorations:"1",scenario:c,entityTypes:r};return d&&(f.logicalId=d),m&&(null==e?void 0:e.length)>0&&(f.setflight=m),t?Object(s.b)(Object(o.v)(Object(i.a)("suggestions"),Object(a.a)(f)),void 0,!0,l,void 0,!1).then(e=>e).catch(e=>(u.h.warn(e),null)):Promise.resolve(null)}var l=n(2225),d=n(2050),m=n(2145),f=n(6832);function I(e,t,n,r){const i=[];if(r===n){const n={Range:{[r]:{gte:t,lte:e}}};i.push(n)}else{const s={Range:{[r]:{gte:t}}};i.push(s);const a={Range:{[n]:{lte:e}}};i.push(a)}return i}var g=n(1685),h=n(1703),p=n(1688);function v(e,t,n,r=null){const i=[];0===e.length&&0===t.length&&null!=r&&e.push(Object(g.a)(r));for(const e of t)i.push({Term:{DistinguishedFolderName:e}});for(const t of e){if(t&&Object(h.a)(t)==p.d)return[];i.push({Term:{FolderId:t}})}n&&i.push({Term:{DistinguishedFolderName:"DeletedItems"}});const s=[],a={Or:i};return s.push(a),i.length>0?s:null}function b(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.TimeZoneContext)||void 0===t?void 0:t.TimeZoneDefinition)||void 0===n?void 0:n.Id)?e.TimeZoneContext.TimeZoneDefinition.Id:"UTC"}function S(e){var t,n,r;return(null===(r=null===(n=null===(t=null==e?void 0:e.EntitySets)||void 0===t?void 0:t[0])||void 0===n?void 0:n.ResultSets)||void 0===r?void 0:r[0])?e.EntitySets[0].ResultSets[0]:null}function C(e){return e?{Id:e.Id,ChangeKey:null}:null}function y(e,t){let n=null;if(null==t?void 0:t.TimeZone){n=new Date(e).toISOString()}return n}function T(e){return(null==e?void 0:e.EmailAddress)?{Mailbox:{EmailAddress:e.EmailAddress.Address,Name:e.EmailAddress.Name,RoutingType:"SMTP"}}:null}function O(e){return e?{__typename:"FolderId",Id:e.Id}:null}function R(e){switch(e){case"DateTime":return"DateTime";case"Hybrid":return"Hybrid";case"Relevance":return"Relevance";default:return null}}function j(e){if(null===e||0===e.length)return null;const t=[];for(let n=0;n<e.length;n++)t[n]=C(e[n]);return t}function D(e){var t;return(null===(t=null==e?void 0:e.QueryId)||void 0===t?void 0:t.Id)?{Id:e.QueryId.Id}:null}var E=n(29);const w="IPM.Appointment";function M(e){var t;const n=T(e.Organizer);return{CalendarItemType:e.CalendarItemType.toString(),Categories:e.Categories,CharmId:e.Charm,DisplayTo:e.DisplayTo,End:e.End,Start:e.Start,HasAttachments:e.HasAttachments,IsAllDayEvent:e.IsAllDayEvent,IsMeeting:e.IsMeeting,IsMeetingPollEvent:e.IsMeetingPollEvent,ItemClass:e.ItemClass?e.ItemClass:w,FreeBusyType:e.LegacyFreeBusyStatus?e.LegacyFreeBusyStatus.toString():null,Location:{DisplayName:e.Location},Sensitivity:e.Sensitivity,SeriesId:e.SeriesMasterItemId?e.SeriesMasterItemId.Id:null,Subject:e.Subject,Organizer:n,UID:e.UID,ItemId:C(e.ItemId),ParentFolderId:O(e.ParentFolderId),SerializedImmutableId:e.ImmutableId,SortOrderSource:R(e.SortOrderSource),Preview:e.Preview,IsOrganizer:e.IsOrganizer&&Object(E.a)().SessionSettings.UserEmailAddress===(null===(t=null==n?void 0:n.Mailbox)||void 0===t?void 0:t.EmailAddress),IsCancelled:e.IsCancelled,ResponseType:e.MyResponseType}}function x(e,t){return{__typename:"ConversationType",Categories:e.Categories,ConversationId:C(e.ConversationId),ConversationTopic:e.ConversationTopic,FlagStatus:e.FlagStatus,From:T(e.From),GlobalItemIds:j(e.GlobalItemIds),GlobalMessageCount:e.GlobalMessageCount,GlobalUnreadCount:e.GlobalUnreadCount,HasAttachments:e.HasAttachments,HasIrm:e.HasIrm,HasProcessedSharepointLink:e.HasProcessedSharepointLink,Importance:e.Importance,ItemClasses:e.ItemClasses,ItemIds:j(e.ItemIds),LastDeliveryOrRenewTime:y(e.LastDeliveryOrRenewTime,t),LastDeliveryTime:y(e.LastDeliveryTime,t),LastModifiedTime:y(e.LastModifiedTime,t),MessageCount:e.MessageCount,ParentFolderId:O(e.ParentFolderId),Preview:e.Preview,SortOrderSource:R(e.SortOrderSource),UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,UnreadCount:e.UnreadCount}}var P=n(44),F=n(1867);function U(e,t){var n;const r=function(e){if(!e)return e;const t=e.indexOf(":");return t>0&&t<6&&t+1<e.length?e.substring(t+1).trim():e}(e.Subject),i=Object(P.j)("fwk-immutable-ids")&&e.ImmutableId?{Id:Object(F.b)(e.ImmutableId),ChangeKey:null}:e.ItemId;return{Categories:e.Categories,ConversationId:C(e.ConversationId),ConversationIndex:e.ConversationIndex,ConversationThreadId:{Id:e.ConversationThreadId,ChangeKey:null},ConversationTopic:r,DateTimeReceived:y(e.DateTimeReceived,t),DateTimeSent:e.DateTimeSent&&y(e.DateTimeSent,t),LastModifiedTime:y(e.DateTimeLastModified,t),DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:(s=e.Flag,s?{FlagStatus:s.FlagStatus,CompleteDate:s.CompleteDate,DueDate:s.DueDate,StartDate:s.StartDate}:null),From:T(e.From),HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,IconIndex:e.IconIndex,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:i,MailboxGuids:e.MailboxGuids,ParentFolderId:O(e.ParentFolderId),Preview:e.Preview,Sender:T(e.Sender),SenderSMTPAddress:e.SenderSMTPAddress,Sensitivity:e.Sensitivity,SerializedImmutableId:e.ImmutableId,SortOrderSource:R(e.SortOrderSource),Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,ExtendedProperty:[{ExtendedFieldURI:{DistinguishedPropertySetId:"Common",PropertyId:3613,PropertyType:"String"},Value:r}]};var s}function A(e,t){var n,r,i,s,a,u,o,c,l;let d,m,f,I;if((null==t?void 0:t.length)>0){let e,n,r,i,s;t.sort((e,t)=>e.Timestamp&&t.Timestamp?t.Timestamp.localeCompare(e.Timestamp):0).forEach(t=>{"Modified"!=t.Type||n?"Created"!=t.Type||e?"Shared"!=t.Type||r?"Read"!=t.Type||i?"Trending"!=t.Type||s||(s=!0):i=!0:r=!0:(e=!0,d=t.User,m=t.Timestamp):(n=!0,f=t.User,I=t.Timestamp)})}const g=null!==(s=null!==(i=null!==(r=null!==(n=e.LinkingUrl)&&void 0!==n?n:e.ServerRedirectedURL)&&void 0!==r?r:e.OriginalPath)&&void 0!==i?i:e.ClassicAttachmentVisualizationUrl)&&void 0!==s?s:"";return{ItemId:null!==(o=null!==(u=null!==(a=e.UniqueId)&&void 0!==a?a:e.Id)&&void 0!==u?u:e.DocId)&&void 0!==o?o:"",FileName:null!==(c=e.FileName)&&void 0!==c?c:e.Filename,Title:e.Title,FileExtension:e.FileExtension,LinkingUrl:g,Author:(null==d?void 0:d.DisplayName)?[d.DisplayName]:e.Author,AuthorUpn:(null==d?void 0:d.Upn)||"",Created:null!=m?m:e.Created,ModifiedBy:null!==(l=null==f?void 0:f.DisplayName)&&void 0!==l?l:e.ModifiedBy,ModifiedByUpn:(null==f?void 0:f.Upn)||"",LastModifiedTime:null!=I?I:e.LastModifiedTime}}function N(e,t){return{content:e.Preview,id:e.InternetMessageId,composeTime:y(e.DateTimeSent,t),originalArrivalTime:y(e.DateTimeReceived,t),containerId:e.ClientConversationId,imDisplayName:e.Sender.EmailAddress.Name,senderProfile:{displayName:e.Sender.EmailAddress.Name,email:e.Sender.EmailAddress.Address},displayTo:e.DisplayTo}}function q(){return{SearchResults:{MoreResultsAvailable:!1,TotalResultsCount:0,SearchResultsCount:0,TDQueryId:D(null)}}}function k(e){return 0===(e?e.length:0)?null:e.map(e=>({RefinerString:e.RefinerQuery}))}function L(e){if(!e)return"MailItems";switch(e){case"CalendarItems":return"Event";case"MailConversations":return"Conversation";case"MessageItems":return"Email";case"Files":return"File";case"MailItems":default:return"Message"}}var B,H,_=n(1946),G=n(7446),J=n(7448);!function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(B||(B={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData"}(H||(H={}));var z=n(6833),Q=n(1930),V=n(1891);n.d(t,"K",(function(){return r.a})),n.d(t,"L",(function(){return c})),n.d(t,"g",(function(){return l.a})),n.d(t,"s",(function(){return d.a})),n.d(t,"z",(function(){return d.b})),n.d(t,"E",(function(){return m.e})),n.d(t,"F",(function(){return m.g})),n.d(t,"C",(function(){return m.b})),n.d(t,"D",(function(){return m.c})),n.d(t,"A",(function(){return i.a})),n.d(t,"x",(function(){return f.a})),n.d(t,"p",(function(){return I})),n.d(t,"r",(function(){return v})),n.d(t,"B",(function(){return b})),n.d(t,"y",(function(){return S})),n.d(t,"l",(function(){return M})),n.d(t,"k",(function(){return x})),n.d(t,"n",(function(){return U})),n.d(t,"m",(function(){return A})),n.d(t,"o",(function(){return N})),n.d(t,"j",(function(){return D})),n.d(t,"q",(function(){return q})),n.d(t,"h",(function(){return k})),n.d(t,"i",(function(){return L})),n.d(t,"G",(function(){return _.b})),n.d(t,"e",(function(){return _.a})),n.d(t,"I",(function(){return _.d})),n.d(t,"J",(function(){return _.e})),n.d(t,"H",(function(){return _.c})),n.d(t,"t",(function(){return G.a})),n.d(t,"v",(function(){return J.b})),n.d(t,"u",(function(){return J.a})),n.d(t,"w",(function(){return J.c})),n.d(t,"f",(function(){return z.a})),n.d(t,"c",(function(){return Q.b})),n.d(t,"b",(function(){return V.b})),n.d(t,"d",(function(){return V.c})),n.d(t,"a",(function(){return V.a}))},2825:function(e,t,n){"use strict";var r=n(121);var i=n(44),s=n(6);n.d(t,"a",(function(){return u}));const a="searchtesthook";function u(e={}){const t=function(e,...t){const n={};for(const r of t)for(const t of Object.keys(r))e.includes(t)&&n.hasOwnProperty(t)?n[t]=n[t]+","+r[t]:n[t]=r[t];return n}(["setflight"],e,function(){let e={};const t=Object(s.c)(a),n=decodeURIComponent(t||"").trim();if(Object(i.j)("sea-debugHook")&&n.length>0){e=n.split("&").reduce((e,t)=>{const[n,r]=t.split("=");return e[n]=r,e},{})}return e}(),Object(r.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(t).filter(e=>null!==t[e]).reduce((e,n)=>Object.assign(Object.assign({},e),{[n]:t[n]}),{})}},3411:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Constant:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3412:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FieldURIOrConstantType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3413:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"RestrictionType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},5380:function(e,t,n){"use strict";function r(e,t){return`search/api/${2===t?"v2":"v1"}/${e}`}n.d(t,"a",(function(){return r}))},6255:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"And:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6832:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(6255),i=n(3411),s=n(3412),a=n(9323),u=n(7447),o=n(1705),c=n(3413),l=n(7);const d="DateTimeReceived";function m(e,t,n,m){if(e||t){const f=[];f.push(Object(u.a)({FieldURIOrConstant:Object(s.a)({Item:Object(i.a)({Value:Object(l.ub)(t||l.b)})}),Item:Object(o.a)({FieldURI:n||d})})),f.push(Object(a.a)({FieldURIOrConstant:Object(s.a)({Item:Object(i.a)({Value:Object(l.ub)(e||l.d)})}),Item:Object(o.a)({FieldURI:m||d})}));const I=Object(r.a)({Items:f});return Object(c.a)({Item:I})}return null}},6833:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n(311),i=n(312),s=n(13),a=n(152),u=n(140),o=n(40),c=n(2);const l="ows/beta/substratesearch/query",d=2048;function m(e,t,n,r,i,s){return I(e,t,n,r,h,i,s)}function f(e,t,n,r,i,s){return I(e,t,n,r,g,i,s)}function I(e,t,n,r,i,s,u){return Object(a.a)().then(a=>{const o=a.headers;s&&o.append("X-OWA-ActionSource",s);const c=i("ExecuteSearch",t,e,n,a,u);let l=0,d=0;return r&&(l=r.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then(()=>{d=r.addCheckmark("ClientJSRequestThread")})),c?c.then(e=>{const t=e[0],n=e[1],r=[t,n,e[2]];return n.ClientJSPreRequestTime=l,n.ClientJSRequestThreadTime=d,r}):Promise.reject(new Error("Client-side issue prevented request from being sent"))})}function g(e,t,n,i,a,o){const l=JSON.stringify(n),m=encodeURIComponent(l);let f=!1;const I=a.headers;I.append("Content-Type","application/json; charset=utf-8"),a.returnFullResponseOnSuccess=!0,m.length>d?a.body=l:(f=!0,I.append("X-OWA-UrlPostData",m),a.body=null);const g=function(e,t){const n=Object(s.a)();let i=(n.baseUrl?`${n.baseUrl}/service.svc?action=`:"/owa/service.svc?action=")+e+`&app=${Object(c.m)()}`;t&&(i+="&EP=1");return i+="&id="+Object(r.a)(),i}(e,f),h=new Date;return Object(u.a)("ExecuteSearch",g,1,a).then(async e=>{const r=await e.json();return[r,p(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"ExecuteSearch",h,new Date,i,a.headers,t,o),e.url]})}function h(e,t,n,s,a,u){if(!s)return o.d("SearchQueryId must be specified when calling makeExecuteSearchRequest!"),null;const c={};a.headers.forEach((e,t)=>{c[t]=e}),c["X-Search-Griffin-Version"]="GWSv2";const d=new Date;return n.Body.SearchSessionId=s,n.Body.Scenario=u,Object(i.e)(l,n,Object(r.a)(),!0,c).then(async e=>{const r=await e.json();return[r,p(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"SubstrateSearch",d,new Date,s,a.headers,t,u),e.url]}).catch(e=>(o.h.warn(e),null))}const p=(e,t,n,r,i,s,a,u,o,l)=>{const d=e.headers||new Headers;return{ClientSearchProvider:r,PageNumber:o,ClientNetworkTime:s.getTime()-i.getTime(),ClientJSEndToEndTime:0,ClientJSPreRequestTime:0,ClientJSRequestThreadTime:0,ClientResponseProcessTime:0,ClientJSRenderingTime:0,SearchDateTime:d.get("date"),SearchBETarget:d.get("x-calculatedbetarget"),SearchFETarget:d.get("x-calculatedfetarget"),SearchBEHttpStatus:d.get("x-backendhttpstatus"),SearchMsEdgeRef:d.get("x-msedge-ref"),SearchErrorContent:n,SearchTraceID:d.get("request-id"),SearchQueryId:a,ClientBuildNumber:Object(c.u)(),ClientTimeSentUTC:i,ClientTimeFinishedUTC:s,ClientHttpStatus:e.status||-1,SearchClientRequestID:u.get("client-request-id"),SearchClientSessionID:Object(c.t)(),ClientName:l,DiagnosticsCheckpoints:d.get("x-ms-diagnostics-checkpoints"),ResourceTimingEntry:null,PIIData:{queryText:t}}}},7446:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7);function i(){return Object(r.qc)().toString()}},7447:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsLessThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))},7448:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a}));const r=[{resultRowOffset:0,resultRowCount:25,pageNumber:0},{resultRowOffset:25,resultRowCount:50,pageNumber:1},{resultRowOffset:75,resultRowCount:75,pageNumber:2},{resultRowOffset:150,resultRowCount:100,pageNumber:3},{resultRowOffset:250,resultRowCount:200,pageNumber:4},{resultRowOffset:450,resultRowCount:200,pageNumber:5},{resultRowOffset:650,resultRowCount:200,pageNumber:6},{resultRowOffset:850,resultRowCount:200,pageNumber:7}];let i=function(e,t={pageContexts:r}){if(e<0||e>=t.pageContexts.length)throw new Error("The pageNumber for execute search is invalid:"+e);return t.pageContexts[e]},s=function(e,t,n,s={pageContexts:r}){const a=e.pageNumber+1,u="PrimaryMailbox"===n?2:4;return t.MoreResultsAvailable&&a<u?i(a,s):null};const a=e=>{switch(e){case 74:return r[2];case 149:return r[3];case 249:return r[4];case 449:return r[5];case 649:return r[6];case 849:return r[7];default:return null}}},9322:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2825),i=n(7446),s=n(5380),a=n(311),u=n(312),o=n(56),c=n(5),l=n(40),d=n(597);function m(e,t,n,m,I,g){const h=function(e,t,n,r,s){const u=Object(o.b)().bestEffort;u["client-session-id"]=t,u["client-request-id"]=Object(a.a)(),u["x-client-localtime"]=Object(i.a)(),u["X-Search-Griffin-Version"]="GWSv2",u["Accept-Language"]=Object(c.e)(),r&&r.length>0&&(u["x-anchormailbox"]=r[0].mailboxSmtpAddress,u.authorization=r[0].tokenString);n&&(u["X-Client-Flights"]=n);u.scenariotag=function(e){const t=e.EntityRequests.length>1,n=e.EntityRequests[0],r=[];t&&r.push("ErrMER");0==n.From&&r.push("1stPg");const i=f[n.EntityType];return r.push(i||"Unknown"),r.join("_")}(e),s&&Object.keys(s).forEach(e=>{u[e]=s[e]});return u}(e,t,n,m,I);return Object(u.e)(Object(d.v)(Object(s.a)("query",g),Object(r.a)()),e,null,!0,h,void 0,void 0,!1).then(e=>[e,h]).catch(e=>(l.h.warn(e),[e]))}const f={Event:"ev",Conversation:"cv",Email:"em",Message:"mg",MailItems:"mi",CalendarItems:"ci",MailConversations:"mc",MessageItems:"gi"}},9323:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsGreaterThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.34.js.map
self.scriptsLoaded['owa.34.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.34.js'] = (new Date()).getTime();