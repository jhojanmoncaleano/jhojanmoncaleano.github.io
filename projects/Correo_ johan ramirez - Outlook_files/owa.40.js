self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.40.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[40],{129:function(n,e,r){"use strict";var t=r(143),a=r(1),d=r(3);const c=Object(d.action)("initializeCalendarsCacheInStore",(n,e,r,t)=>({defaultCalendarEntry:n,calendarEntries:e,calendarGroups:r,folderIdMapping:t})),o=Object(d.action)("addToCalendarsCache",(n,e=-1)=>({calendarEntry:n,indexToInsert:e})),u=Object(d.action)("addCalendarGroupToCalendarsCache",(n,e=-1)=>({calendarGroup:n,indexToInsert:e})),i=Object(d.action)("removeCalendarGroupFromCalendarsCache",n=>({calendarGroup:n})),l=Object(d.action)("updateCalendarEntry",(n,e)=>({id:n,calendarEntry:e})),s=Object(d.action)("updateCalendarFolder",(n,e)=>({calendar:n,calendarFolder:e})),f=Object(d.action)("markCalendarEntryAsValid",n=>({calendarEntry:n})),b=Object(d.action)("removeCalendarWithIDFromCalendarsCache",(n,e,r=!1)=>({calendarId:n,userId:e,shouldPersistCalendarEntry:r})),p=Object(d.action)("updateCalendarGroup",(n,e,r)=>({groupId:n,userIdentity:e,calendarGroup:r})),I=Object(d.action)("insertCalendarIdInOrderedList",(n,e)=>({index:n,idToAdd:e})),O=Object(d.action)("deleteCalendarIdFromOrderedList",n=>({calendarIdKey:n})),j=Object(d.action)("insertCalendarGroupInOrderedList",(n,e)=>({index:n,idToAdd:e})),y=Object(d.action)("deleteCalendarGroupFromOrderedList",n=>({groupKey:n})),m=Object(d.action)("removeCalendar",n=>({folderId:n}));var G=r(230);Object(d.mutator)(l,n=>{const{id:e,calendarEntry:r}=n,t=Object(G.f)(e),{calendarId:d}=r,c=Object(a.__rest)(r,["calendarId"]);t&&Object.keys(c).forEach(n=>{t[n]=c[n]})}),Object(d.mutator)(f,n=>{const{calendarEntry:e}=n;Object(t.a)().validEntryMapping.set(e.calendarId.id,!0)});const C=Object(d.mutatorAction)("setCalendarEntryMappingForId",(n,e)=>{Object(t.a)().calendarEntryMapping.set(n,e)});var x=r(397),g=r(223);Object(d.mutator)(s,n=>{const{calendar:e,calendarFolder:r}=n,t=Object(G.f)(e.calendarId.id);Object.keys(r).forEach(n=>{t[n]=r[n]})});const M=Object(d.mutatorAction)("setCalendarFolderIdToCalendarId",(n,e)=>{Object(t.a)().folderIdToCalendarId.set(n,e)});Object(d.mutator)(p,n=>{const{groupId:e,userIdentity:r,calendarGroup:d}=n,c=Object(t.a)(),o=Object(x.a)(r,e),u=c.calendarGroupsMapping.get(o),{calendarGroupId:i}=d,l=Object(a.__rest)(d,["calendarGroupId"]);u&&Object.keys(l).forEach(n=>{u[n]=l[n]})});const v=Object(d.mutatorAction)("setCalendarGroupMappingForKey",(n,e)=>{Object(t.a)().calendarGroupsMapping.set(n,e)});function E(n,e){Object.keys(e).forEach(r=>n.set(r,e[r]))}Object(d.mutator)(c,({defaultCalendarEntry:n})=>{n&&Object(t.a)().defaultCalendars.set(n.calendarId.mailboxInfo.userIdentity,n)}),Object(d.mutator)(c,({calendarEntries:n})=>{const e=Object(t.a)();E(e.calendarEntryMapping,n),e.calendarIdOrderedList=e.calendarIdOrderedList.concat(Object.keys(n))}),Object(d.mutator)(c,({folderIdMapping:n})=>{E(Object(t.a)().folderIdToCalendarId,n)}),Object(d.mutator)(c,({calendarGroups:n})=>{const e=Object(t.a)();E(e.calendarGroupsMapping,n),e.calendarGroupKeyOrderedList=e.calendarGroupKeyOrderedList.concat(Object.keys(n))}),Object(d.orchestrator)(o,n=>{const{calendarEntry:e,indexToInsert:r}=n;C(e.calendarId.id,e),I(r,e.calendarId.id);const t=Object(g.j)(e);t&&M(t.Id,{id:e.calendarId.id,changeKey:e.calendarId.changeKey,mailboxInfo:e.calendarId.mailboxInfo})}),Object(d.orchestrator)(u,n=>{const{calendarGroup:e,indexToInsert:r}=n,t=Object(x.a)(e.calendarGroupId.mailboxInfo.userIdentity,e.serverGroupId);v(t,e),j(r,t)}),Object(d.orchestrator)(i,n=>{const{calendarGroup:e}=n,r=Object(t.a)(),a=Object(x.a)(e.calendarGroupId.mailboxInfo.userIdentity,e.serverGroupId);r.calendarGroupsMapping.delete(a),y(a)}),Object(d.orchestrator)(b,n=>{const{calendarId:e,shouldPersistCalendarEntry:r}=n;!function(n,e,r){const a=Object(t.a)();O(n),r||(a.calendarEntryMapping.delete(n),a.validEntryMapping.delete(n));e&&a.folderIdToCalendarId.delete(e)}(e,Object(G.t)(e),r)});var h=r(616);Object(d.mutator)(I,({index:n,idToAdd:e})=>{const r=Object(t.a)();n>-1?r.calendarIdOrderedList.splice(n,0,e):r.calendarIdOrderedList.push(e),r.calendarIdOrderedList=L(r.calendarIdOrderedList)}),Object(d.mutator)(O,({calendarIdKey:n})=>{T(Object(t.a)().calendarIdOrderedList,n)}),Object(d.mutator)(j,({index:n,idToAdd:e})=>{const r=Object(t.a)();n>-1?r.calendarGroupKeyOrderedList.splice(n,0,e):r.calendarGroupKeyOrderedList.push(e),r.calendarGroupKeyOrderedList=L(r.calendarGroupKeyOrderedList)}),Object(d.mutator)(y,({groupKey:n})=>{T(Object(t.a)().calendarGroupKeyOrderedList,n)});function L(n){const e=[],r=new Map;return n.forEach(n=>{r.has(n)||(e.push(n),r.set(n,null))}),e}function T(n,e){const r=Object(h.a)(n,n=>n===e);r&&n.splice(r.index,1)}function w(n){const e=Object(G.o)(n);return e?e.mailboxInfo:null}function A(n){return n&&!n.IsReadOnly&&n.EffectiveRights&&n.EffectiveRights.CreateContents}var K=r(29);function F(n,e){var r;if(Object(g.l)(n)){let r=n;return!r.IsOwnerEmailAddressInvalid&&r.OwnerEmailAddress==e}return(null===(r=n.calendarId)||void 0===r?void 0:r.mailboxInfo)?e.indexOf(n.calendarId.mailboxInfo.mailboxSmtpAddress)>=0:Object(K.a)().SessionSettings.UserEmailAddress==e}function k(n){return n?n.map(G.f).filter(n=>!!n):null}function S(n){return!!n&&n.IsGroupMailboxCalendar}function P(n){const e=n;return null==e?void 0:e.IsSchoolCalendar}function N(n){return 4==(null==n?void 0:n.CalendarFolderType)}var R=r(272),_=r(49),z=r(44);function U(n){if(n.IsGroupMailboxCalendar){const e=n.OwnerEmailAddress,r=n.calendarId.mailboxInfo.userIdentity;return{MailboxId:Object(G.y)(n)&&Object(z.j)("cal-showAddTeamsCalendars")?Object(g.i)(e):e,MailboxType:Object(R.r)(r)?1:0}}const{FolderId:e}=n;if(e){const r=n.calendarId.mailboxInfo.userIdentity;return Object(_.s)(r)?{FolderId:e.Id}:Object(R.r)(r)?{FolderId:e.Id,MailboxId:r,MailboxType:Object(R.u)(r)?2:3}:null}return null}function $(n,e){return!!n&&n.calendarId.mailboxInfo.userIdentity===e}function q(n,e){return!!n&&n.ParentGroupId===e}function D(n,e){return n.CalendarName.localeCompare(e.CalendarName)}function V(n,e){const r=Object(G.s)(n),t=Object(G.e)().filter(t=>$(t,n)&&q(t,e)&&!function(n,e){return!!n&&!!e&&n.calendarId.id===e.calendarId.id}(t,r)).sort(D);return r&&q(r,e)&&t.unshift(r),t}function W(n){return Object(G.m)().filter(e=>(function(n,e){return!!n&&n.calendarGroupId.mailboxInfo.userIdentity===e})(e,n)).sort(B)}function B(n,e){const r=H[n.GroupType]-H[e.GroupType];if(0!==r)return r;const t=J[n.calendarGroupId.mailboxInfo.type]-J[e.calendarGroupId.mailboxInfo.type];return 0!==t?t:n.GroupName.localeCompare(e.GroupName)}const H={0:0,2:1,1:2,3:3},J={UserMailbox:0,TeamsMailbox:1,GroupMailbox:2,PublicMailbox:3,SharedMailbox:4,ArchiveMailbox:5};function Q(n){const e=[];return Object(G.e)().forEach(r=>{$(r,n)&&e.push(r.calendarId.id)}),e}var X=r(209);function Y(n){if(Q(Object(X.d)().userIdentity).includes(n))return Object(X.d)().userIdentity;const e=Object(R.i)();if(e){if(Q(e.userIdentity).includes(n))return e.userIdentity}return null}function Z(n){const e=new Map;return n.forEach(n=>{const r=Y(n);if(e.has(r)){const t=e.get(r);t.push(n),e.set(r,t)}else e.set(r,[n])}),e}r.d(e,"H",(function(){return c})),r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return u})),r.d(e,"X",(function(){return i})),r.d(e,"Z",(function(){return l})),r.d(e,"ab",(function(){return s})),r.d(e,"V",(function(){return f})),r.d(e,"Y",(function(){return b})),r.d(e,"bb",(function(){return p})),r.d(e,"J",(function(){return I})),r.d(e,"f",(function(){return O})),r.d(e,"I",(function(){return j})),r.d(e,"e",(function(){return y})),r.d(e,"W",(function(){return m})),r.d(e,"U",(function(){return G.A})),r.d(e,"z",(function(){return G.s})),r.d(e,"L",(function(){return G.v})),r.d(e,"k",(function(){return G.e})),r.d(e,"x",(function(){return G.q})),r.d(e,"w",(function(){return G.p})),r.d(e,"t",(function(){return G.m})),r.d(e,"q",(function(){return G.k})),r.d(e,"s",(function(){return G.l})),r.d(e,"p",(function(){return G.j})),r.d(e,"v",(function(){return G.o})),r.d(e,"l",(function(){return G.f})),r.d(e,"n",(function(){return G.h})),r.d(e,"o",(function(){return G.i})),r.d(e,"A",(function(){return G.t})),r.d(e,"i",(function(){return G.c})),r.d(e,"j",(function(){return G.d})),r.d(e,"d",(function(){return G.b})),r.d(e,"O",(function(){return G.w})),r.d(e,"P",(function(){return G.x})),r.d(e,"S",(function(){return G.z})),r.d(e,"c",(function(){return G.a})),r.d(e,"m",(function(){return G.g})),r.d(e,"R",(function(){return G.y})),r.d(e,"u",(function(){return G.n})),r.d(e,"y",(function(){return G.r})),r.d(e,"D",(function(){return G.u})),r.d(e,"B",(function(){return w})),r.d(e,"r",(function(){return x.a})),r.d(e,"T",(function(){return A})),r.d(e,"K",(function(){return F})),r.d(e,"C",(function(){return k})),r.d(e,"M",(function(){return S})),r.d(e,"Q",(function(){return P})),r.d(e,"N",(function(){return N})),r.d(e,"G",(function(){return U})),r.d(e,"F",(function(){return V})),r.d(e,"E",(function(){return W})),r.d(e,"g",(function(){return Y})),r.d(e,"h",(function(){return Z}))},143:function(n,e,r){"use strict";var t=r(3),a=r(14);const d={calendarEntryMapping:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap,calendarIdOrderedList:[],calendarGroupKeyOrderedList:[]};e.a=Object(t.createStore)("calendarsCacheStore",d)},230:function(n,e,r){"use strict";r.d(e,"s",(function(){return u})),r.d(e,"v",(function(){return i})),r.d(e,"e",(function(){return l})),r.d(e,"q",(function(){return s})),r.d(e,"p",(function(){return f})),r.d(e,"m",(function(){return b})),r.d(e,"k",(function(){return p})),r.d(e,"l",(function(){return I})),r.d(e,"j",(function(){return O})),r.d(e,"o",(function(){return j})),r.d(e,"f",(function(){return y})),r.d(e,"h",(function(){return m})),r.d(e,"i",(function(){return G})),r.d(e,"t",(function(){return C})),r.d(e,"c",(function(){return x})),r.d(e,"d",(function(){return g})),r.d(e,"b",(function(){return M})),r.d(e,"w",(function(){return v})),r.d(e,"x",(function(){return E})),r.d(e,"z",(function(){return h})),r.d(e,"a",(function(){return L})),r.d(e,"g",(function(){return T})),r.d(e,"y",(function(){return w})),r.d(e,"n",(function(){return A})),r.d(e,"r",(function(){return K})),r.d(e,"u",(function(){return F}));var t=r(397),a=r(143),d=r(209),c=r(223);r.d(e,"A",(function(){return c.o}));var o=r(616);function u(n){return n||(n=Object(d.d)().userIdentity),Object(a.a)().defaultCalendars.get(n)}function i(n,e){const r=u(e);return r&&n===r.calendarId}function l(){const{calendarEntryMapping:n,calendarIdOrderedList:e}=Object(a.a)();return e.map(e=>n.get(e))}function s(n){const e=Object(o.a)(Object(a.a)().calendarIdOrderedList,e=>e===n);return e?e.index:-1}function f(){return Object(a.a)().calendarIdOrderedList}function b(){const{calendarGroupsMapping:n,calendarGroupKeyOrderedList:e}=Object(a.a)();return e.map(e=>n.get(e))}function p(n,e){const r=Object(t.a)(e,n),d=Object(o.a)(Object(a.a)().calendarGroupKeyOrderedList,n=>n===r);return d?d.index:-1}function I(){return Object(a.a)().calendarGroupKeyOrderedList}function O(n,e){const{calendarGroupsMapping:r}=Object(a.a)(),d=Object(t.a)(e,n);return r.get(d)}function j(n){const{folderIdToCalendarId:e}=Object(a.a)();return e.get(n)}function y(n){const{calendarEntryMapping:e}=Object(a.a)();return e.get(n)}function m(n){const e=j(n);return e?y(e.id):void 0}function G(n){return C(n.calendarId.id)}function C(n){var e;const{calendarEntryMapping:r}=Object(a.a)(),t=r.get(n);return t?null===(e=Object(c.j)(t))||void 0===e?void 0:e.Id:null}function x(n){const{calendarEntryMapping:e}=Object(a.a)(),r=e.get(n);if(r){const n=Object(c.j)(r);return n?n.Id:null}return null}function g(n){const e=u(n);return e?Object(c.j)(e).Id:null}function M(n){return!!y(n)}function v(n){const{folderIdToCalendarId:e,calendarEntryMapping:r}=Object(a.a)(),t=e.get(n);if(t){const n=r.get(t.id);return n&&!n.IsGroupMailboxCalendar&&!Object(c.l)(n)}return!1}function E(n){if(v(n)){let e=m(n);return null==e?void 0:e.IsReadOnly}return!1}function h(n){const{validEntryMapping:e}=Object(a.a)();return n&&e.get(n.calendarId.id)}function L(n){if(!v(C(n))){return!h(y(n))}return!1}function T(n){const{folderIdToCalendarId:e,calendarEntryMapping:r}=Object(a.a)(),t=e.get(n);let d;if(t)d=r.get(t.id);else{d=[...r.values()].filter(e=>e.OwnerEmailAddress&&e.OwnerEmailAddress.toLowerCase()==n.toLowerCase())[0]}return d}function w(n){var e,r;return"TeamsMailbox"==(null===(r=null===(e=null==n?void 0:n.id)||void 0===e?void 0:e.mailboxInfo)||void 0===r?void 0:r.type)}function A(n){const e=b();return{userCalendarGroups:e.filter(e=>"UserMailbox"===e.calendarGroupId.mailboxInfo.type&&e.calendarGroupId.mailboxInfo.userIdentity==n),groupCalendarGroups:e.filter(e=>"GroupMailbox"===e.calendarGroupId.mailboxInfo.type&&e.calendarGroupId.mailboxInfo.userIdentity==n),teamsCalendarGroups:e.filter(e=>"TeamsMailbox"===e.calendarGroupId.mailboxInfo.type&&e.calendarGroupId.mailboxInfo.userIdentity==n)}}function K(n,e){return l().filter(r=>r&&r.ParentGroupId===e&&r.calendarId.mailboxInfo.userIdentity===n)}function F(){let n=[];return l().forEach(e=>{e.CanShare&&n.push(e)}),n}},397:function(n,e,r){"use strict";function t(n,e){return`${e}_${n}`}r.d(e,"a",(function(){return t}))},616:function(n,e,r){"use strict";function t(n,e){for(let r=0,t=n.length;r<t;r++){let t=n[r];if(e(t))return{item:t,index:r}}return null}r.d(e,"a",(function(){return t}))}}]);
//# sourceMappingURL=owa.40.js.map
self.scriptsLoaded['owa.40.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.40.js'] = (new Date()).getTime();