self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.42.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[42],{1737:function(e,t,r){"use strict";r.r(t);var o=r(20),a=r(3),i=r(3154),n=r(8374),s=r(8375),d=r(8376);Object(a.mutator)(i.a,e=>{const{temporaryData:t,favoriteData:r,newIndex:o}=e;Object(s.a)(t),Object(d.b)(t),Object(n.a)(r,o)}),Object(a.mutator)(i.c,e=>{const{favoriteData:t,newIndex:r}=e;Object(n.a)(t,r),Object(d.a)(t)}),Object(a.mutator)(i.d,e=>{const{favoriteData:t}=e;Object(n.a)(t)}),Object(a.mutator)(i.b,e=>{const{favoriteData:t}=e;Object(d.b)(t),Object(s.a)(t)}),Object(a.mutator)(i.e,e=>{const{temporaryFavorites:t,favoritesData:r}=e;t.forEach(e=>{Object(s.a)(e)}),r.forEach(e=>{Object(n.a)(e)})}),Object(a.mutator)(i.f,e=>{const{favoritesData:t}=e;t.forEach(e=>{Object(n.a)(e)})});var u=r(2301),c=r(7359),l=(Object(a.mutator)(c.a,e=>{u.a.orderedOutlookFavoritesIds.push(e.favoriteId)}),r(6217)),f=(Object(a.mutator)(l.a,e=>{u.a.favoritesLoaded=!0}),r(2752)),v=r(5813),b=r(9091),p=r(44),F=(Object(a.orchestrator)(f.a,e=>{Object(p.j)("tri-favorites-roaming")?Object(b.a)():Object(v.b)()}),r(3991)),y=r(3156),m=r(3992);function O(){const e=Object(u.b)();return Object(p.j)("tri-favorites-roaming")?[...e.outlookFavorites.entries()].filter(([e,t])=>"persona"===t.type).map(([e,t])=>e):[...e.favoritesPersonaNodes.keys()]}function g(e){const t=Object(u.b)();return Object(p.j)("tri-favorites-roaming")?t.outlookFavorites.get(e):t.favoritesPersonaNodes.get(e)}function I(e){const t=g(e);return t?t.mainEmailAddress:null}function j(e){const t=g(e);return t?t.displayName:null}var S=r(6802),h=r(5818),A=r(7362),N=r(7363),w=r(5),D=r(2649),T=r(21),C=r(29),k=r(0);var M=Object(T.a)((function(e){var t;const{isInFavorites:r,isClickDisabled:o,animate:a,iconStyles:i,buttonStyles:n,spinnerStyles:s,tooltipStyles:d,onClick:u,isCategory:c}=e,l=Object(C.a)();if(null===(t=null==l?void 0:l.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)return null;const f=c?Object(w.b)(N.a):Object(w.b)(h.a),v=c?Object(w.b)(A.a):Object(w.b)(S.a);return k.createElement(D.a,{isStarred:r,onClick:u,isClickDisabled:o,animate:a,iconStyles:i,buttonStyles:n,spinnerStyles:s,tooltipStyles:d,ariaLabelText:r?f:v,tooltip:{starred:f,unstarred:v}})})),P=r(5060),E=r(5759),V=r(4540),z=r(5815),L=r(5817);function K(e){return Object(p.j)("tri-favorites-roaming")?[...u.a.outlookFavorites.values()].filter(e=>"persona"===e.type).some(t=>t.searchFolderId&&t.searchFolderId===e):[...u.a.favoritesPersonaNodes.values()].some(t=>t.searchFolderId&&t.searchFolderId===e)}function R(e){return!!Object(p.j)("tri-favorites-roaming")&&[...u.a.outlookFavorites.values()].filter(e=>"privatedistributionlist"===e.type).some(t=>t.searchFolderId&&t.searchFolderId===e)}var x=r(4305),U=r(5816),_=r(5349),W=r(5350),G=r(6218),B=r(5351),J=r(6803),q=r(6219),Q=r(3879),Y=r(7361);function $(e,t){return function(e){const t=[...u.a.outlookFavorites.values()].filter(t=>"privatedistributionlist"===t.type&&t.pdlId===e);return t.length>0?t[0].favoriteId:void 0}(e)||function(e){const t=[...u.a.outlookFavorites.values()].filter(t=>"privatedistributionlist"===t.type&&Object(Y.a)(t.members,e));return t.length>0?t[0].favoriteId:void 0}(t)}var H=r(1736);r.d(t,"lazyMigrateFavorites",(function(){return Z})),r.d(t,"lazyMoveFavoriteUpDown",(function(){return ee})),r.d(t,"lazyUpdateFavoritePosition",(function(){return te})),r.d(t,"lazyAddFavoriteCategory",(function(){return re})),r.d(t,"lazyRemoveFavoriteCategory",(function(){return oe})),r.d(t,"lazyAddNewMailboxDefaultFavorites",(function(){return ae})),r.d(t,"lazyRemoveFavoritePersonaV2",(function(){return ie})),r.d(t,"lazyAddFavoritePersonaV2",(function(){return ne})),r.d(t,"lazyRemoveFavoriteGroup",(function(){return se})),r.d(t,"lazyAddFavoriteGroup",(function(){return de})),r.d(t,"lazyRemoveFavoriteFolderV2",(function(){return ue})),r.d(t,"lazyAddFavoriteFolderV2",(function(){return ce})),r.d(t,"lazyRemoveFavoritePrivateDistributionList",(function(){return le})),r.d(t,"lazyAddFavoritePrivateDistributionList",(function(){return fe})),r.d(t,"lazyEditFavoritePrivateDistributionList",(function(){return ve})),r.d(t,"lazySetOutlookFavoritesBitFlag",(function(){return be})),r.d(t,"lazyAddFavoriteToStore",(function(){return pe})),r.d(t,"lazyAddFavoriteCompleted",(function(){return Fe})),r.d(t,"lazyAddFavoriteFailed",(function(){return ye})),r.d(t,"lazyAddMultipleFavoritesToStore",(function(){return me})),r.d(t,"lazyAddMultipleFavoritesCompleted",(function(){return Oe})),r.d(t,"lazyRemoveFavoriteFromStore",(function(){return ge})),r.d(t,"lazyRemoveFavoriteCompleted",(function(){return Ie})),r.d(t,"lazyRemoveFavoriteFailed",(function(){return je})),r.d(t,"lazyEditOutlookFavoriteService",(function(){return Se})),r.d(t,"lazyCreateOutlookFavoriteService",(function(){return he})),r.d(t,"lazyDeleteOutlookFavoriteService",(function(){return Ae})),r.d(t,"lazyCreateMultipleOutlookFavoritesService",(function(){return Ne})),r.d(t,"addFavoriteFailed",(function(){return i.b})),r.d(t,"addFavoriteToStoreInitial",(function(){return i.d})),r.d(t,"removeFavoriteFailed",(function(){return F.b})),r.d(t,"getStore",(function(){return u.b})),r.d(t,"favoritesStore",(function(){return u.a})),r.d(t,"loadFavorites",(function(){return f.a})),r.d(t,"isFolderInFavorites",(function(){return y.c})),r.d(t,"isGroupInFavorites",(function(){return y.d})),r.d(t,"isPersonaInFavorites",(function(){return y.e})),r.d(t,"isSearchInFavorites",(function(){return y.h})),r.d(t,"isCategoryInFavorites",(function(){return y.b})),r.d(t,"isPublicFolderInFavorites",(function(){return y.g})),r.d(t,"isPrivateDLInFavorites",(function(){return y.f})),r.d(t,"getPersonaFromPersonIdOrEmailAddress",(function(){return y.a})),r.d(t,"isOutlookFavoritingInProgress",(function(){return m.a})),r.d(t,"getFavoriteIdsForPersonaFavorites",(function(){return O})),r.d(t,"getFavoritePersonaEmail",(function(){return I})),r.d(t,"getFavoritePersonaDisplayName",(function(){return j})),r.d(t,"ToggleFavoriteButton",(function(){return M})),r.d(t,"parseFavoriteNode",(function(){return P.a})),r.d(t,"updateFavoritesUserOption",(function(){return E.a})),r.d(t,"addFavoriteToStoreV1",(function(){return v.a})),r.d(t,"getIsBitEnabled",(function(){return V.a})),r.d(t,"getFavoriteIdFromGroupId",(function(){return z.a})),r.d(t,"getFavoriteIdFromFolderId",(function(){return L.a})),r.d(t,"isFolderPersonaFavoriteSearchFolder",(function(){return K})),r.d(t,"isFolderPrivateDLFavoriteSearchFolder",(function(){return R})),r.d(t,"convertEWSFolderIdToRestFolderId",(function(){return x.a})),r.d(t,"convertRestFolderIdToEWSFolderId",(function(){return x.b})),r.d(t,"getFavoriteIdFromCategoryId",(function(){return U.a})),r.d(t,"createOwsFavoriteCategoryData",(function(){return _.a})),r.d(t,"createOwsFavoriteFolderData",(function(){return _.b})),r.d(t,"createClientFavoriteCategoryData",(function(){return W.a})),r.d(t,"createClientFavoriteFolderData",(function(){return W.b})),r.d(t,"migrateOutlookFavorites",(function(){return G.a})),r.d(t,"onCategoryFavorited",(function(){return B.a})),r.d(t,"onCategoryUnfavorited",(function(){return B.b})),r.d(t,"convertFavoritePersonaDataToFavoritePersonaNode",(function(){return J.a})),r.d(t,"convertFavoritePdlDataToFavoritePdlNode",(function(){return q.a})),r.d(t,"convertServiceResponseToFavoriteData",(function(){return Q.a})),r.d(t,"getSingleValueSettingValueForKey",(function(){return Q.b})),r.d(t,"getFavoriteIdForPDL",(function(){return $}));const X=new o.c(()=>Promise.all([r.e(12),r.e(690)]).then(r.bind(null,19093)));let Z=new o.a(X,e=>e.migrateFavorites),ee=new o.b(X,e=>e.moveFavoriteUpDown),te=new o.b(X,e=>e.updateFavoritePosition),re=new o.b(X,e=>e.addFavoriteCategory),oe=new o.b(X,e=>e.removeFavoriteCategory),ae=new o.a(X,e=>e.addNewMailboxDefaultFavorites),ie=new o.b(X,e=>e.removeFavoritePersonaV2),ne=new o.b(X,e=>e.addFavoritePersonaV2),se=new o.b(X,e=>e.removeFavoriteGroup),de=new o.b(X,e=>e.addFavoriteGroup),ue=new o.b(X,e=>e.removeFavoriteFolderV2),ce=new o.b(X,e=>e.addFavoriteFolderV2),le=new o.b(X,e=>e.removeFavoritePrivateDistributionList),fe=new o.b(X,e=>e.addFavoritePrivateDistributionList),ve=new o.b(X,e=>e.editFavoritePrivateDistributionList),be=new o.a(X,e=>e.setOutlookFavoritesBitFlag),pe=new o.b(X,e=>e.addFavoriteToStore),Fe=new o.b(X,e=>e.addFavoriteCompleted),ye=new o.b(X,e=>e.addFavoriteFailed),me=new o.b(X,e=>e.addMultipleFavoritesToStore),Oe=new o.b(X,e=>e.addMultipleFavoritesCompleted),ge=new o.b(X,e=>e.removeFavoriteFromStore),Ie=new o.b(X,e=>e.removeFavoriteCompleted),je=new o.a(X,e=>e.removeFavoriteFailed),Se=new o.a(X,e=>e.editOutlookFavoriteService),he=new o.a(X,e=>e.createOutlookFavoriteService),Ae=new o.a(X,e=>e.deleteOutlookFavoriteService),Ne=new o.a(X,e=>e.createMultipleOutlookFavoritesService);Object(o.f)(H.a,X,e=>e.reloadFavoritesForAccountSelectionChangeOrchestrator)},2301:function(e,t,r){"use strict";r.d(t,"b",(function(){return n}));var o=r(14),a=r(3);let i={favoritesFolderNodes:new o.ObservableMap,favoritesPersonaNodes:new o.ObservableMap,favoriteSearches:new o.ObservableMap,favoriteCategories:new o.ObservableMap,orderedFavoritesNodeIds:[],orderedOutlookFavoritesIds:[],outlookFavorites:new o.ObservableMap,favoriteSecondaryKeyMap:new o.ObservableMap,favoritingInProgressMap:new o.ObservableMap,favoritesLoaded:!1,reloadInProgress:!1};const n=Object(a.createStore)("favorites",i);t.a=n()},3154:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return u})),r.d(t,"f",(function(){return c}));var o=r(3),a=r(71);const i=Object(o.action)("addFavoriteCompleted",(e,t,r)=>Object(a.b)({name:"AddFavoriteCompleted",customData:{temporaryFavoriteId:e.favoriteId,favoriteId:t.favoriteId,favoriteKind:t.type}},{temporaryData:e,favoriteData:t,newIndex:r})),n=Object(o.action)("addMultipleFavoritesCompleted",(e,t)=>Object(a.b)({name:"AddMultipleFavoritesCompleted"},{temporaryFavorites:e,favoritesData:t})),s=Object(o.action)("addFavoriteFailed",(e,t)=>Object(a.b)({name:"AddFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})),d=Object(o.action)("addFavoriteToStore",(e,t)=>Object(a.b)({name:"AddFavoriteToStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e,newIndex:t})),u=Object(o.action)("addFavoriteToStoreInitial",e=>Object(a.b)({name:"AddFavoriteToStoreInitial",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})),c=Object(o.action)("addMultipleFavoritesToStore",e=>Object(a.b)({name:"AddMultipleFavoritesToStore"},{favoritesData:e}))},3156:function(e,t,r){"use strict";r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"h",(function(){return l})),r.d(t,"b",(function(){return f})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return p})),r.d(t,"a",(function(){return F}));var o=r(2301),a=r(44),i=r(7361),n=r(5815),s=r(5816),d=r(5817);function u(e){return Object(a.j)("tri-favorites-roaming")?!!Object(d.a)(e):Object(o.b)().favoritesFolderNodes.has(e)}function c(e){return!!Object(n.a)(e)}function l(e){return Object(a.j)("tri-favorites-roaming")?[...Object(o.b)().outlookFavorites.values()].filter(e=>"search"===e.type).some(t=>t.searchQuery===e):Object(o.b)().favoriteSearches.has(e)}function f(e){return Object(a.j)("tri-favorites-roaming")?!!Object(s.a)(e):Object(o.b)().favoriteCategories.has(e)}function v(e,t){return null!==F(e,t)}function b(e,t){return[...Object(o.b)().outlookFavorites.values()].filter(e=>"privatedistributionlist"===e.type).some(r=>r.pdlId===e||Object(i.a)(r.members,t))}function p(e){return Object(o.b)().favoriteSecondaryKeyMap.has(e)}function F(e,t){const r=Object(o.b)();let i=null;if(Object(a.j)("tri-favorites-roaming")){i=[...r.outlookFavorites.values()].filter(r=>"persona"===r.type&&y(r,e,t))}else i=[...r.favoritesPersonaNodes.values()].filter(r=>y(r,e,t));return i&&i.length>0?i[0]:null}function y(e,t,r){return t&&e.personaId===t||r&&e.allEmailAddresses&&e.allEmailAddresses.some(e=>e&&e.toLocaleLowerCase()===r.toLocaleLowerCase())}},3879:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"a",(function(){return F}));var o=r(4305);const a="SearchFolderId",i="PersonaId",n="MainEmailAddress",s="EmailAddresses",d="ContactDisplayName",u="ContactMainEmailAddress",c="PdlId",l="MemberNames",f="EmailAddress",v="ExtDirId";function b(e,t){const r=e.SingleValueSettings&&e.SingleValueSettings.filter(e=>e.Key==t);return r&&1===r.length?r[0].Value:void 0}function p(e,t){const r=e.MultiValueSettings&&e.MultiValueSettings.filter(e=>e.Key==t);return r&&1===r.length?r[0].Values:[]}function F(e,t){let r;switch(t){case"folder":r={type:"folder",folderId:Object(o.b)(e.SingleValueSettings[0].Value)};break;case"persona":const t=b(e,a),F=t?Object(o.b)(t):null,y=p(e,s),m=b(e,n),O=b(e,i),g=b(e,d),I=b(e,u);r={type:"persona",searchFolderId:F,allEmailAddresses:y,mainEmailAddress:m,isSearchFolderPopulated:!!F,personaId:O,contactDisplayName:g,contactMainEmailAddress:I,isSyncUpdateDone:!1};break;case"privatedistributionlist":const j=b(e,a),S=j?Object(o.b)(j):null,h=b(e,c),A=b(e,"PersonaId"),N=A?Object(o.b)(A):null,w=p(e,s),D=p(e,l),T=[];for(let e=0;e<w.length;e++)T.push({name:D[e],emailAddress:w[e]});r={type:"privatedistributionlist",searchFolderId:S,isSearchFolderPopulated:!!S,pdlId:h,members:T,owsPersonaId:N};break;case"group":r={type:"group",groupId:e.SingleValueSettings[0].Value.toLowerCase(),groupSmtp:b(e,f).toLowerCase(),groupExternalDirectoryObjectId:b(e,v)};break;case"category":r={type:"category",categoryId:e.SingleValueSettings[0].Value};break;case"search":r={type:"search",searchQuery:e.SingleValueSettings[0].Value};break;case"publicFolder":r={type:"publicFolder",publicFolderId:b(e,"FolderId")};break;default:r={type:e.Type}}return r.treeType="favorites",r.favoriteId=e.Id,r.displayName=e.DisplayName,r.client=e.Client,r.lastModifiedTime=e.LastModifiedTime,r}},3991:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return s}));var o=r(3),a=r(71);const i=Object(o.action)("removeFavoriteCompleted",e=>Object(a.b)({name:"RemoveFavoriteCompleted",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})),n=Object(o.action)("removeFavoriteFailed",(e,t)=>Object(a.b)({name:"RemoveFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})),s=Object(o.action)("removeFavoriteFromStore",e=>Object(a.b)({name:"RemoveFavoriteFromStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e}))},3992:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r(2301),a=r(5348);function i(e){if(!e)return!1;const{favoritingInProgressMap:t}=o.a;return"string"==typeof e?t.has(e):t.has(Object(a.a)(e))}},4305:function(e,t,r){"use strict";function o(e){return i(i(e,"/","-"),"+","_")}function a(e){return i(i(e,"-","/"),"_","+")}function i(e,t,r){return e.split(t).join(r)}r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}))},4540:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var o=r(29),a=r(317);function i(e){return!!(e&Object(o.a)().UserOptions.FavoritesBitFlags)}function n(e,t){Object(a.a)(r=>{e?r.UserOptions.FavoritesBitFlags|=t:r.UserOptions.FavoritesBitFlags&=~t})}},5060:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var o=r(913),a=r(40);function i(e){let t;try{t=JSON.parse(e)}catch(t){return void a.h.warn("Cannot parse folderForestNode: "+e)}if(void 0!==t.id)switch(t.type){case 6:case 0:return{id:t.id,type:t.type,treeType:"favorites"};case 3:case 4:return{id:t.id,type:t.type,treeType:"favorites",dropViewState:Object(o.a)()};case 1:const e={id:t.id,type:t.type,treeType:"favorites",displayName:t.displayName,mainEmailAddress:t.personaEmail,allEmailAddresses:t.personaAllEmails||[],searchFolderId:t.personaSearchFolderId,isJustAdded:!1,isSearchFolderPopulated:!0,isSyncUpdateDone:!1,dropViewState:Object(o.a)()};return t.personaId&&(e.personaId=t.personaId),e;default:return void a.h.warn("Non supported FolderForestNodeType: "+t.type)}}function n(e,t,r,o,i){return e.map(e=>{let n;return t.has(e)?n=t.get(e):r.has(e)?n=r.get(e):o.has(e)?n=o.get(e):i.has(e)?n=i.get(e):a.h.warn("Favorites not found. favoriteType: "+n.type),function(e){const t={id:e.id,type:e.type};if(1===e.type){const r=e;t.displayName=r.displayName,t.personaSearchFolderId=r.searchFolderId,t.personaEmail=r.mainEmailAddress,t.personaAllEmails=r.allEmailAddresses,t.personaId=r.personaId}return JSON.stringify(t)}(n)})}},5348:function(e,t,r){"use strict";function o(e){switch(e.type){case"folder":return e.folderId;case"group":return e.groupId.toLowerCase();case"category":return e.categoryId;case"persona":const t=e;return t.personaId||t.mainEmailAddress;case"privatedistributionlist":return"FavoritePdl";case"publicFolder":return e.publicFolderId;default:return}}r.d(t,"a",(function(){return o}))},5349:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var o=r(1683),a=r(4305);function i(e,t){return{Type:"category",DisplayName:e.Name,SingleValueSettings:[{Key:"CategoryId",Value:e.Id}],Client:t?"Migration":"OWA"}}function n(e,t,r){return{Type:"folder",DisplayName:Object(o.h)(e),SingleValueSettings:[{Key:"FolderId",Value:Object(a.a)(e.id)},{Key:"ChangeKey",Value:e.changeKey}],Client:t?"Migration":"OWA",Index:r}}},5350:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var o=r(1683);function a(e,t,r){return{treeType:"favorites",type:"category",favoriteId:e,displayName:t.Name,categoryId:t.Id,client:r?"Migration":"OWA"}}function i(e,t,r){return{treeType:"favorites",type:"folder",favoriteId:e,displayName:Object(o.h)(t),folderId:t.id,client:r?"Migration":"OWA"}}},5351:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var o=r(3);let a=Object(o.action)("ON_CATEGORY_FAVORITED",e=>({categoryId:e})),i=Object(o.action)("ON_CATEGORY_UNFAVORITED",e=>({categoryId:e}))},5759:function(e,t,r){"use strict";var o=r(5060),a=r(49);var i=r(2301);function n(e={favoritesFolderNodes:i.a.favoritesFolderNodes,favoritesPersonaNodes:i.a.favoritesPersonaNodes,favoriteSearches:i.a.favoriteSearches,favoriteCategories:i.a.favoriteCategories,orderedFavoritesNodeIds:i.a.orderedFavoritesNodeIds}){const t=o.b(e.orderedFavoritesNodeIds,e.favoritesFolderNodes,e.favoritesPersonaNodes,e.favoriteSearches,e.favoriteCategories);return Object(a.x)(e=>{e.UserOptions.FavoriteNodes=t}),r=t,a.u.importAndExecute([{key:"FavoriteNodes",valuetype:"StringArray",value:r}]).then(e=>{const t=e.Body.ResponseMessages.Items[0];return"Success"==t.ResponseClass?Promise.resolve():Promise.reject("updateUserConfiguration failed: "+t.ResponseClass)});var r}r.d(t,"a",(function(){return n}))},5813:function(e,t,r){"use strict";r.d(t,"d",(function(){return p})),r.d(t,"c",(function(){return y})),r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return O}));var o=r(5060),a=r(4540),i=r(2301),n=r(61),s=r(805),d=r(1737),u=r(1683),c=r(29),l=r(40),f=r(699),v=r(3),b=r(6217);const p=Object(v.mutatorAction)("tryAddSingleFavoriteFolderToStore",e=>{(function(e,t={favoritesStore:i.a,folderTable:u.d.folderTable}){return!(t.folderTable.size>0)||!t.favoritesStore.favoritesFolderNodes.has(e)&&t.folderTable.has(e)})(e.id)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoritesFolderNodes.set(e.id,e))});function F(e){var t;t=e.id,Object(s.q)(t)&&!i.a.favoriteCategories.get(t)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoriteCategories.set(e.id,e))}let y=Object(f.action)("loadFavoriteNodesToStore")((function(e){const t=Object(c.a)().UserOptions;if(!t.FavoriteNodes)return;t.FavoriteNodes.forEach(t=>{const r=o.a(t);if(r)switch(r.type){case 0:p(r);break;case 3:!function(e){i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoriteSearches.set(e.id,e)}(r);break;case 1:(function(e){return!i.a.favoritesPersonaNodes.has(e)})(r.id)&&(e.orderedFavoritesNodeIds.push(r.id),e.favoritesPersonaNodes.set(r.id,r));break;case 4:F(r);break;default:l.h.warn("Non supported FolderForestNodeType: "+r.id)}});const r=[...e.favoritesPersonaNodes.values()].filter(e=>e.personaId);Object(n.o)("LoadFavorites",[e.favoritesFolderNodes.size,e.favoritesPersonaNodes.size,e.favoriteSearches.size,e.favoriteCategories.size,r.length])}));function m(e={favoritesStore:i.a}){if(i.a.favoritesLoaded)return;0===u.d.folderTable.size&&Object(u.v)(),Object(a.a)(2)?y(e.favoritesStore):d.lazyMigrateFavorites.importAndExecute(),Object(b.a)()}let O=Object(f.action)("addFavoriteToStoreV1")((function(e){i.a.favoritesFolderNodes.has(e.id)||(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoritesFolderNodes.set(e.id,e))}))},5814:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));const o="ows/api/beta/outlookfavorites"},5815:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r(1737);function a(e){return Object(o.getStore)().favoriteSecondaryKeyMap.get(e.toLowerCase())}},5816:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r(1737);function a(e){return Object(o.getStore)().favoriteSecondaryKeyMap.get(e)}},5817:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r(1737);function a(e){return Object(o.getStore)().favoriteSecondaryKeyMap.get(e)}},5818:function(e){e.exports=JSON.parse('{"a":"b7b"}')},6217:function(e,t,r){"use strict";var o=r(3);t.a=Object(o.action)("SET_FAVORITES_LOADED")},6218:function(e,t,r){"use strict";var o=r(7360),a=r(3),i=r(71);t.a=Object(a.action)("MIGRATE_OUTLOOK_FAVORITES",()=>Object(i.b)(o.a.MigrateOutlookFavorites))},6219:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return d}));var o=r(4305);function a(e){return{id:e.favoriteId,treeType:"favorites",type:5,data:e}}function i(e,t,r,o,a){return{treeType:"favorites",type:"privatedistributionlist",favoriteId:e,displayName:t,members:r,pdlId:o,searchFolderId:void 0,client:"OWA",isSearchFolderPopulated:!1,owsPersonaId:a}}function n(e,t){return{Type:"privatedistributionlist",DisplayName:e,MultiValueSettings:[{Key:"EmailAddresses",Values:t.map(e=>e.emailAddress)},{Key:"MemberNames",Values:t.map(e=>e.name)}],Client:"OWA"}}function s(e,t,r){return{Type:"privatedistributionlist",DisplayName:e,SingleValueSettings:[{Key:"PdlId",Value:Object(o.a)(t)},{Key:"PersonaId",Value:r}],Client:"OWA"}}function d(e,t){const r={Type:"privatedistributionlist",Client:"OWA"};if(e&&(r.DisplayName=e),t){const e=[{Key:"EmailAddresses",Values:t.map(e=>e.emailAddress)},{Key:"MemberNames",Values:t.map(e=>e.name)}];r.MultiValueSettings=e}return r}},6802:function(e){e.exports=JSON.parse('{"a":"e7b"}')},6803:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return i}));r(1737);function o(e){return{id:e.favoriteId,treeType:"favorites",type:1,allEmailAddresses:e.allEmailAddresses,displayName:e.displayName,mainEmailAddress:e.mainEmailAddress,searchFolderId:e.searchFolderId,isSyncUpdateDone:!0,isJustAdded:!1,isSearchFolderPopulated:e.isSearchFolderPopulated,markedForDeletion:!1,dropViewState:null,personaId:e.personaId}}function a(e,t,r){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t,searchFolderId:void 0,client:"OWA",allEmailAddresses:[r],personaId:void 0,mainEmailAddress:r,isSearchFolderPopulated:!1,isSyncUpdateDone:!0}}function i(e,t){return{Type:"persona",DisplayName:e,SingleValueSettings:[{Key:"MainEmailAddress",Value:t}],Client:"OWA"}}},7359:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r(3);const a=Object(o.action)("ADD_TO_ORDERED_FAVORITE_ID_LIST",e=>({favoriteId:e}))},7360:function(e,t,r){"use strict";t.a={MigrateOutlookFavorites:{name:"MigrateOutlookFavorites",options:{isCore:!0}},UpdateFavoriteNode:{name:"UpdateFavoriteNode"}}},7361:function(e,t,r){"use strict";function o(e,t){if(e.length!==t.length)return!1;const r=e.map(e=>e.emailAddress.toLocaleLowerCase()),o=t.map(e=>e.emailAddress.toLocaleLowerCase());return r.filter(e=>o.includes(e)).length===r.length}r.d(t,"a",(function(){return o}))},7362:function(e){e.exports=JSON.parse('{"a":"lja"}')},7363:function(e){e.exports=JSON.parse('{"a":"kja"}')},8374:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r(2301),a=r(5348);function i(e,t){const{favoriteSecondaryKeyMap:r,orderedOutlookFavoritesIds:i,outlookFavorites:n}=o.a;i.some(t=>t===e.favoriteId)||(void 0!==t?i.splice(t,0,e.favoriteId):i.push(e.favoriteId),n.set(e.favoriteId,Object.assign({treeType:"favorites"},e)),r.set(Object(a.a)(e),e.favoriteId))}},8375:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r(5348),a=r(2301);function i(e){const{favoriteSecondaryKeyMap:t,orderedOutlookFavoritesIds:r,outlookFavorites:i}=a.a;a.a.orderedOutlookFavoritesIds=r.filter(t=>t!==e.favoriteId),i.delete(e.favoriteId),t.delete(Object(o.a)(e))}},8376:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var o=r(2301),a=r(5348);function i(e){const{favoritingInProgressMap:t}=o.a;t.set(Object(a.a)(e),!0)}function n(e){const{favoritingInProgressMap:t}=o.a;t.delete(Object(a.a)(e))}},9091:function(e,t,r){"use strict";var o=r(61),a=r(805),i=r(44),n=r(1683),s=r(703),d=r(29),u=r(3155),c=r(4540),l=r(6217),f=r(3154),v=r(7359),b=r(6218),p=r(1737),F=r(5814),y=r(312);var m=r(2301),O=r(3879);r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return j}));const g=36e5;async function I(){if(m.a.favoritesLoaded)return;0===n.d.folderTable.size&&Object(n.v)(),await j();const e=Object(c.a)(2);Object(c.a)(16)||Object(b.a)(),e||(0==m.a.orderedOutlookFavoritesIds.length&&function(){let e=new Date(Object(d.a)().MailboxCreateDate);return Date.now()-e.getTime()<g}()&&p.lazyAddNewMailboxDefaultFavorites.importAndExecute(),p.lazySetOutlookFavoritesBitFlag.importAndExecute(2)),Object(l.a)(),function(){const e=[...m.a.outlookFavorites.values()],t=e.filter(e=>"folder"===e.type),r=t.filter(e=>"Migration"===e.client),a=e.filter(e=>"category"===e.type),i=a.filter(e=>"Migration"==e.client),n=e.filter(e=>"persona"===e.type),s=n.filter(e=>"Migration"==e.client),d=e.filter(e=>"group"===e.type),u=e.filter(e=>"privatedistributionlist"===e.type);Object(o.o)("LoadOutlookFavorites",[t.length,d.length,a.length,n.length,u.length,r.length,i.length,s.length])}()}async function j(e,t){var r,c,l;const b=Object(d.a)(),g=e&&e!==(null===(r=b.SessionSettings)||void 0===r?void 0:r.UserEmailAddress);let I=null,j=!1;if(g||(I=null===(c=Object(u.a)())||void 0===c?void 0:c.value,j=null===(l=null==b?void 0:b.SessionSettings)||void 0===l?void 0:l.IsExplicitLogon),g||!I&&!j){let e;try{e=await Object(y.b)(F.a,void 0,!1,void 0,!0)}catch(e){return void Object(o.o)("GetOutlookFavoritesRetryFailed",{errorMessage:e.toString()})}if(I=null==e?void 0:e.value,!I||t&&t!==Object(s.a)().selectedAccountSourceId)return;Object(o.o)("FavoritesRetrySuccess")}null==I||I.forEach(e=>{const t=e.Type.toLocaleLowerCase();let r=null;try{switch(r=Object(O.a)(e,t),t){case"folder":!function(e,t){(function(e,t){if(0===n.d.folderTable.size)return!1;return!m.a.outlookFavorites.has(e)&&n.d.folderTable.has(t)})(t,e.folderId)&&Object(f.d)(e)}(r,e.SingleValueSettings[0].Value);break;case"persona":Object(f.d)(r);break;case"group":!function(e){Object(p.isGroupInFavorites)(e.groupId)||Object(f.d)(e)}(r);break;case"category":!function(e){(function(e){return Object(a.q)(e.categoryId)&&!m.a.outlookFavorites.has(e.favoriteId)})(e)&&(Object(f.d)(e),a.A.importAndExecute())}(r);break;case"privatedistributionlist":Object(i.j)("peo-favoritePdls")&&Object(f.d)(r);break;default:Object(v.a)(r.favoriteId)}}catch(e){Object(o.o)("AddFavoriteToStoreInitialFailed",{favoriteType:t,errorMessage:e.toString()})}})}}}]);
//# sourceMappingURL=owa.42.js.map
self.scriptsLoaded['owa.42.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.42.js'] = (new Date()).getTime();