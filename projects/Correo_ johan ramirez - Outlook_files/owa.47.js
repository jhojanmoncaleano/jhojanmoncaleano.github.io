self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.47.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[47],{2206:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));var i=n(2065);function r(e){return o(e.type)}function c(e){return o(Object(i.a)(e))}function o(e){return 1===e||3===e}},2239:function(e,t,n){"use strict";var i,r=n(1724),c=n(2324),o=n(29),a=n(1799),s=n(3261),u=n(2065);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(i||(i={}));class l{constructor(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPublicComputersEnabled):(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPrivateComputersEnabled),this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=i[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}getPolicyInfo(e,t,n,r){e&&(e=e.toLowerCase());let c=this.getFileAccessLevel(e,t),o=!1,u=!1,l=!1;const d=1===r||3===r;if(c!==i.Block&&n){this.isWacViewingEnabled(e)&&(o=!0),!this.directFileAccessEnabled&&d&&(o=!1),u=this.isForceBrowserViewingFirst(o),o&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(l=0===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),o||Object(a.b)(e)||Object(s.a)(e)||this.directFileAccessEnabled||(c=i.AccessDisabled)}return{directFileAccessEnabled:this.directFileAccessEnabled,level:c,useWac:o,forceBrowserViewingFirst:u,wacEdit:l}}isPdfPreviewEnabled(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled}getFileAccessLevel(e,t){let n=this.fileTypeToPolicyMap[e];if(n||(n=i.Undefined),n===i.Block)return i.Block;const r=this.mimeTypeToPolicyMap[t];return r===i.Block?i.Block:n===i.ForceSave||r===i.ForceSave?i.ForceSave:n===i.Allow||r===i.Allow?i.Allow:this.policyForUnknownTypes}isWacViewingEnabled(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0}isForceBrowserViewingFirst(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)}addPolicyIntoMap(e,t,n){t&&t.forEach(t=>{e[t]=n})}createPolicyMap(e,t,n){const r={};return this.addPolicyIntoMap(r,n,i.Allow),this.addPolicyIntoMap(r,t,i.ForceSave),this.addPolicyIntoMap(r,e,i.Block),r}}let d=null,b=null;function p(){if(!d){const e=Object(o.a)(),t=Object(c.c)(),n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;d=new l(t,n),n&&(b=d)}return d}function h(e,t){const n=Object(r.b)(e.Name),i=e.ContentType;return p().getPolicyInfo(n,i,t,Object(u.a)(e))}function f(e,t){const n=Object(r.b)(e.Name),i=e.ContentType;return function(){if(!b){const e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return p();b=new l(Object(c.c)(),!0)}return b}().getPolicyInfo(n,i,t,Object(u.a)(e))}function m(e,t,n,r,c){if(r||c)return!1;const o=h(e,!0),a=p();return o.level!==i.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p}))},2321:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}n.d(t,"a",(function(){return i}))},2859:function(e,t,n){"use strict";var i=n(3892),r=n(4325),c=n(266);const{getDataProviderInfo:o,getDefaultDataProviderInfo:a}=Object(i.a)((function(e){switch(e){case 0:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:(e,t)=>t,supportedPermissionLevels:[2,1]});case 3:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 2:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:(e,t)=>!1});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:e=>Object(r.a)(e),supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(c.a)(e)}}));t.a=o},2865:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(32),r=n(2321);function c(e,t){return void 0===e||e.__type||(e=Object(r.a)(e)),Object(i.a)("FetchDataProviderResource",e,t)}},3078:function(e,t,n){"use strict";function i(e,t){if(null===e)return[];const n=[];if(0===t){const t=e;t.CanShareInternally&&(n.push(2),n.push(1)),t.CanCreateOrganizationEditLink&&n.push(6),t.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function r(e,t,n){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return n?t?2:1:0;default:return 0}}var c=n(4827),o=n(5);const a="OneDrivePro";var s=n(266),u=n(29);function l(e,t){switch(e){case 3:return Object(o.b)(c.b);case 4:return Object(o.b)(c.a);case 6:return Object(o.b)(c.d);case 5:return Object(o.b)(c.e);case 1:return t===a?Object(o.b)(c.g):Object(o.b)(c.b);case 2:return t===a?Object(o.b)(c.f):Object(o.b)(c.a);case 0:return Object(o.b)(c.c);default:return Object(s.a)(e)}}function d(e,t){return 0===t?function(e){var t;const n=null===(t=Object(u.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(o.b)(c.i);case 4:return Object(o.b)(c.h);case 6:return Object(o.c)(Object(o.b)(c.j),n);case 5:return Object(o.c)(Object(o.b)(c.k),n);case 1:return Object(o.b)(c.g);case 2:return Object(o.b)(c.f);case 0:return Object(o.b)(c.c);default:return Object(s.a)(e)}}(e):l(e,null)}function b(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return b}))},3261:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));var i=n(1699);const r=[".txt",".xml",".log"];function c(e){return o(Object(i.a)(e))}function o(e){return!!e&&r.indexOf(e.toLowerCase())>=0}},3664:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(1751);function r(e){return(e.__type||e.OwsTypeName)===i.a}},3892:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1865),r=n(1791);const c=[0,1,3,2,6,5,7,8,4];function o(e){let t=null;const n=function(n){const i=Object(r.b)(n);return null===i?null:function(){if(!t){t={};for(const n of c)t[n]=e(n)}return t}()[i]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?i.h:i.i)}}}},4068:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(1751);function r(e){return(e.__type||e.OwsTypeName)===i.b}},4207:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(2781),r=n(5158);async function c(e){var t;const n=Object(r.a)(e.AttachLongPathName);return(null===(t=(await Object(i.l)(n)).result)||void 0===t?void 0:t.thumbnailLink)||null}},4325:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const i=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function r(e){return!!e.ContentType&&i.indexOf(e.ContentType.toLowerCase())>-1}},4617:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(1751);function r(e){return(e.__type||e.OwsTypeName)===i.c}},4827:function(e){e.exports=JSON.parse('{"b":"Qda","a":"Rda","d":"Sda","e":"Tda","g":"Uda","f":"Vda","c":"Wda","i":"Xda","h":"Yda","j":"Zda","k":"_da"}')},5087:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(96);function r(e,t){return i.d()||i.e()||i.h()?function(e){const t=["Chrome PDF Viewer","Microsoft Edge PDF Viewer","WebKit built-in PDF"];e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins);try{return"function"==typeof(null==e?void 0:e.namedItem)&&t.some(t=>null!==e.namedItem(t))}catch(e){}return!1}(t):(i.f(),!1)}},5158:function(e,t,n){"use strict";function i(e){const t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return i}))},5730:function(e,t,n){"use strict";var i=n(2859),r=n(1724);function c(e){const t=Object(r.b)(e.Name);return t&&".pdf"===t.toLowerCase()}const o=[".mp3"];const a=[".ics",".ical",".ifb",".icalendar"];const s=[".eml",".msg"];var u=n(4325),l=n(1822);const d=["image/jpeg","image/png","image/gif","image/bmp"];function b(e){return Object(r.g)(e.Name)||!Object(l.a)(e)&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var p=n(5087),h=n(2239);function f(e,t){if(c(e)&&Object(p.a)()){if(t)return!0;{const t=Object(h.c)(e,!0);return Object(h.b)(e,!0).directFileAccessEnabled&&t.directFileAccessEnabled}}return!1}var m=n(3261);const P=[".mp4"],v=[".mov"];var O=n(283),g=n(3664),w=n(4617),y=n(4068),j=n(2523);function F(e,t){let n;if(Object(l.a)(t)||Object(j.a)(t)){n=function(e){const t=Object(i.a)(e.ProviderType);return t&&t.supportPreview(e,Object(O.a)())}(t)?b(t)?e.directFileAccessEnabled?2:0:Object(u.a)(t)?6:f(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0}else n=Object(g.a)(t)?e.level===h.a.Block?1:e.level===h.a.AccessDisabled?0:b(t)?2:c(t)?function(e,t){if(!Object(h.e)().isPdfPreviewEnabled())return 1;if(f(t,!1))return 3;if(function(e){return c(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){const t=Object(r.b)(e.Name);return!!t&&o.indexOf(t.toLowerCase())>=0}(t)?5:function(e){const t=Object(r.b)(e.Name);return!!t&&s.indexOf(t.toLowerCase())>=0}(t)?10:Object(m.b)(t.Name)?11:function(e,t){var n;const i=Object(r.b)(e.Name);if(i){const e=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),r=-1!==e.indexOf("Safari")&&-1===e.indexOf("Chrome");return P.indexOf(i.toLowerCase())>=0||r&&v.indexOf(i.toLowerCase())>=0}return!1}(t)?12:function(e){const t=Object(r.b)(e.Name);return!!t&&-1!==a.indexOf(t.toLowerCase())}(t)?13:0:Object(y.a)(t)?8:Object(w.a)(t)?9:0;return n}n.d(t,"a",(function(){return F}))}}]);
//# sourceMappingURL=owa.47.js.map
self.scriptsLoaded['owa.47.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.47.js'] = (new Date()).getTime();