self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.512.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[512,2033],{10313:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(8301),i=n(40);async function a(e,t,n,a){const o={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."};try{if(a){const e="getAttachmentTextPreview"+a;(t=t||{}).headers=t.headers||new Headers,t.headers.set("X-OWA-ActionName",e)}const i=await Object(r.a)({AttachmentId:e,ReadMode:n},t);if(i&&0===i.Status)return i.Content;{const e=(null==i?void 0:i.Status)||1;switch(e){case 2:o.errorMessage="The attachment has been moved or deleted.";break;case 3:o.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:o.errorMessage="Something went wrong while the document preview was being created. Please try again later."}o.error=new Error(`getAttachmentTextPreview failed with status: ${e}`)}}catch(e){i.h.warn(`getAttachmentTextPreview failed with error: ${e}`),o.error=e}throw o}},10649:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3595),i=n(5),a=n(5175),o=n(4883);async function c(e,t,n){let c;try{c=await Object(o.a)(e,t,n,!0)}catch(e){throw{errorMessage:Object(i.b)(r.a),error:e}}if(0===c.Status)return{wacUrl:c.WacUrl,bootScriptUrl:c.BootScriptUrl,wopiSrcUrl:c.WopiSrcUrl,accessToken:c.AccessToken,accessTokenTtl:c.AccessTokenTtl,additionalParameters:c.AdditionalParameters,deprecatedTokenAndParameters:c.Token};throw{errorMessage:Object(a.a)(c.Status),error:new Error(`GetWacAttachmentInfo failed with status: ${c.Status}`)}}},10650:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5578),i=n(1699),a=n(1799),o=n(3261);function c(e){const t=Object(i.b)(e)||"";return n=t,Object(r.a)(n)||(Object(a.b)(s(n))?"Image":Object(o.a)(s(n))?"Text":"pdf"==n?"Pdf":null==n?void 0:n.substring(0,4));var n}function s(e){return"."+e}},164:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function a(t){r--,delete e[t]}this.put=function(t,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var s={value:n,expire:i+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){a(t),o&&o(t,n)}.bind(this),i)),e[t]=s,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&a(t),n},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(a){var o=e[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&t++,o.value;i&&n++,r--,delete e[a]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),a=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(e[o])continue;var c=r[o],s=c.expire-i;if(s<=0){this.del(o);continue}s=s>0?s:void 0,this.put(o,c.value,s)}return this.size()}}e.exports=new r,e.exports.Cache=r},1685:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e){if(!e)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(e)}},1688:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"i",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return p}));const r=["journal","outbox","syncissues"],i="archivemsgfolderroot",a="msgfolderroot",o="archivedeleteditems",c="deleteditems",s="archiverecoverableitemsdeletions",u="recoverableitemsdeletions",d="msgfolderroot",l="sharedFolderTree",f="primaryFolderTree",b="archiveFolderTree",m="favorites",p="groups"},1690:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(14),i=n(3);const a={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}};let o=Object(i.createStore)("mail",a);const c=o();t.a=c},1692:function(e,t,n){"use strict";var r=n(20),i=n(1690),a=n(1827),o=n(1760),c=n(1752);const s="ChronologicalNewestOnBottom";function u(e,t){return e[t==s?0:e.length-1]}var d=n(705),l=n(1705);function f(e){return Object(c.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(l.a)({FieldURI:"TailoredXpEntities"}),Object(l.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(l.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(l.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then(e=>{if(e&&!(e instanceof Error)){const{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}=e;return{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}}return{}})}var b=n(1838),m=n(29);function p(e){const t=i.a.conversations.get(e);if(t){const e=Object(m.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==e}return!1}var w=n(1797),h=n(1683);function v(e,t={folderTable:h.d.folderTable}){return!!t.folderTable.get(e)}var g=n(1688);function I(e,t){const n=h.d.folderTable.get(e);return!!n&&(Object(h.H)(n,g.d,t)||n.distinguishedFolderType===g.b)}function O(e){return I(e)||function(e){const t=h.d.folderTable.get(e);return t&&t.distinguishedFolderType===g.d}(e)}function S(e,t,n={folderTable:h.d.folderTable}){return Object(h.H)(e,t,n)}var j=n(1839),y=n(1812);function P(e){return e&&(Object(y.a)(e,g.i)||Object(y.a)(e,g.b))}function T(e){return e&&(S(e,g.h)||S(e,g.a))}var C=n(1809);function x(e,t){try{return E(e,t)}catch(e){return null}}function E(e,t){if(!e||!t)return null;const n=Object(h.m)().get(e).PermissionSet.Permissions.filter(e=>e.UserId.PrimarySmtpAddress===t);return null==n?void 0:n[0]}var A=n(283);const k="OneOff",R="Unknown";function M(e,t,n){return!Object(A.a)()&&(n==k||n==R)&&(null==e?void 0:e.indexOf(t))<0}var D=n(3),L=Object(D.mutatorAction)("setIsDraftQueuedForSubmission",(e,t)=>{const n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}),N=n(1741);n.d(t,"s",(function(){return U})),n.d(t,"u",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return u})),n.d(t,"t",(function(){return f})),n.d(t,"v",(function(){return b.a})),n.d(t,"q",(function(){return p})),n.d(t,"c",(function(){return w.a})),n.d(t,"r",(function(){return v})),n.d(t,"m",(function(){return I})),n.d(t,"l",(function(){return O})),n.d(t,"n",(function(){return S})),n.d(t,"j",(function(){return j.a})),n.d(t,"k",(function(){return P})),n.d(t,"p",(function(){return T})),n.d(t,"f",(function(){return C.a})),n.d(t,"h",(function(){return x})),n.d(t,"i",(function(){return E})),n.d(t,"o",(function(){return M})),n.d(t,"w",(function(){return L})),n.d(t,"x",(function(){return N.a}));const F=new r.c(()=>n.e(2067).then(n.bind(null,19538))),U=new r.a(F,e=>e.setTriageActionAnnouncement)},1699:function(e,t,n){"use strict";function r(e){if(!e)return null;const t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){const t=r(e);return t?t.replace(".",""):null}function a(e){var t;return(null===(t=i(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}))},1702:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1705:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"PropertyUri:#Exchange"},e)}n.d(t,"a",(function(){return r}))},17058:function(e){e.exports=JSON.parse('{"a":"v2b"}')},1724:function(e,t,n){"use strict";var r=n(1699),i=n(1959),a=n(5);function o(e){let t;return e>=1073741824?(e/=1073741824,t=Object(a.b)(i.b)):e>=1048576?(e/=1048576,t=Object(a.b)(i.d)):e>=1024?(e/=1024,t=Object(a.b)(i.c)):t=Object(a.b)(i.a),Object(a.c)(t,Math.round(e))}var c=n(1799),s=n(44);const u=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(e){if(!Object(s.j)("doc-attachment-documentThumbnail"))return!1;const t=Object(r.a)(e);return!!t&&u.indexOf(t.toLowerCase())>=0}var l;function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return l.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return l.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return l.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(l||(l={}));var b=n(1762);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return l}))},1726:function(e,t,n){"use strict";var r=n(3);let i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}});var a=i();function o(){return a.selectedNode}function c(){const e=o();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a}))},1727:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(3),i=n(14);const a=Object(r.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxFolderTreeData:new i.ObservableMap}),o=a();t.a=a},1729:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1857);function i(e,t){const n=Object(r.a)(t),i=n&&n.get(e);return null==i?void 0:i.rootFolder}},1741:function(e,t,n){"use strict";var r=n(44),i=n(121),a=n(49),o=n(20);const c=new o.c(()=>n.e(1160).then(n.bind(null,19563))),s=new o.b(c,e=>e.isReadingPaneConversationEnabled);function u(){var e,t;if(Object(r.j)("mon-rp-unstackedConversation")){return 0==(null===(t=null===(e=Object(a.g)())||void 0===e?void 0:e.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)&&!function(){var e,t;let n=null;const r=s.tryImportForRender();if(r)n=r();else{const r=Object(i.a)("useNativeConversationOptions");let o=null===(e=Object(a.g)())||void 0===e?void 0:e.PrimeSettings;if(null==o?void 0:o.Items)for(let e of o.Items)if("ReadingPaneConversationOptions"===e.Id&&e.Value){const i=null===(t=e.Value.options)||void 0===t?void 0:t[0];n=r?null==i?void 0:i.conversationEnabledNativeHost:null==i?void 0:i.conversationEnabled;break}null==n&&(n=!r)}return n}()}return!1}n.d(t,"a",(function(){return u}))},1752:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1977),i=n(44);const a=new(n(4).d)(()=>Promise.all([n.e(9),n.e(10),n.e(12),n.e(13),n.e(291),n.e(2068)]).then(n.bind(null,2508)));function o(e,t,n,o,c,s,u,d,l){if(Object(i.j)("mon-rp-loadItemViaGql")){if(!e&&!d)throw new Error("getItem passed a null or undefined id");return a.import().then(r=>r.getItemViaGraphQL(e,t,n,o,c,s,u,d,l))}return Object(r.a)(e,t,n,o,s,u,d)}},1754:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(316);function i(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1760:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1762:function(e,t,n){"use strict";function r(e){return function(e){const t=a.exec(e);return t&&t.length>1&&i[t[1].toLowerCase()]}(e||"")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){let t="";return Object.entries(i).forEach(n=>{n[1]===e&&(t=n[0])}),t}},1765:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1777),i=n(1774);function a(e){if(!e)return Promise.reject(Object(r.a)("500","Server returned a null response!",null));const t=Array.isArray(e)?e:[e];for(const e of t)if(e&&!Object(i.a)(e))return Promise.reject(Object(r.a)(e.ResponseCode,e.StackTrace,e.MessageText));return Promise.resolve()}},1774:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r="Success";function i(e){return e&&e.ResponseClass==r}},1777:function(e,t,n){"use strict";function r(e,t,n){let r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);const i=new Error(r);return i.responseCode=e,i.fetchErrorType="ServerFailure",n&&(i.diagnosticInfo="MessageText= "+n),i}n.d(t,"a",(function(){return r}))},1788:function(e,t,n){"use strict";var r,i,a;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},1791:function(e,t,n){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){let t=null;const n=r.exec(e);if(n){const e=n[1],r=n[2];let i=null;try{i=atob(r)}catch(e){}if(i){const n=new ArrayBuffer(i.length),r=new Uint8Array(n);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);t=new File([n],"image.png",{type:e})}}return t}var a=n(1702),o=n(1724);function c(e){return e.map(e=>({fileType:a.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}))}var s=n(40);function u(e,t,n){if(e.length!=t.length)return s.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let i=0;i<e.length;i++){const o={fileType:a.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};r.push(o)}return r}function d(e,t,n){const r=[],i={fileType:a.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(i),r}function l(e){if(!e)return null;let t=[];for(var n=0;n<e.length;n++){const r=e[n],i={fileType:a.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}function f(e){if(!e)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function b(e){var t,n;if(null===e)return null;return{fileType:a.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function m(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p=n(1865);function w(e){switch(e?e.toLowerCase():null){case p.d.ONE_DRIVE_PRO.toLowerCase():return 0;case p.d.GDRIVE.toLowerCase():return 5;case p.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.d.DROPBOX.toLowerCase():return 2;case p.d.BOX.toLowerCase():return 3;case p.d.WOPI_BOX.toLowerCase():return 7;case p.d.WOPI_EGNYTE.toLowerCase():return 8;case p.d.MAILBOX.toLowerCase():return 4;case p.d.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return a.a}))},1793:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(14),i=n(1797),a=n(3);const o={loadedItemReadingPaneViewStates:new r.ObservableMap({}),loadedConversationReadingPaneViewStates:new r.ObservableMap({}),itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null,loadingProjectionIds:[]};let c=Object(a.createStore)("readingpane",o);const s=c();i.a.registerReference(()=>[...s.loadedConversationReadingPaneViewStates.keys()]),t.a=s},1797:function(e,t,n){"use strict";const r=new(n(939).a)(50);t.a=r},1799:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(1699),i=n(1762),a=n(169);const o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function s(e,t,n=!0){return u(Object(r.a)(e)||Object(i.a)(t),n)}function u(e,t=!0){return!!e&&(o.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(a.c)()||Object(a.f)()))}},1809:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1683),i=n(1726);function a(){const e=Object(i.c)();let t=null;return t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id,null==t?null:r.d.folderTable.get(t)}},1812:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},1825:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"DistinguishedFolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1827:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1838:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1690);function i(e){return r.a.items.get(e)}},1839:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1812),i=n(1688);function a(e){return e&&(Object(r.a)(e,i.h)||Object(r.a)(e,i.a))}},1845:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1727);function i(){return Object(r.a)().folderTable}},1857:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1727),i=n(49);function a(e){return o(e).folderTreeTable}function o(e){return e||(e=Object(i.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},1860:function(e,t,n){"use strict";var r=n(49),i=n(44);function a(e){var t;const n=Object(r.g)().SegmentationSettings,a=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(i.j)("cal-stickyNotesFolder")&&!a}var o=n(283);function c(){const e=Object(o.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(i.j)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}))},1865:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"d",(function(){return m}));const r="Box",i="Dropbox",a="Facebook",o="GDrive",c="Mailbox",s="MailMessage",u="OneDriveConsumer",d="OneDrivePro",l="WopiBox",f="WopiDropbox",b="WopiEgnyte",m={BOX:r,DROPBOX:i,FACEBOOK:a,GDRIVE:o,MAILBOX:c,ONE_DRIVE_CONSUMER:u,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:l,WOPI_EGNYTE:b}},1885:function(e,t,n){"use strict";n.d(t,"m",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"k",(function(){return l})),n.d(t,"q",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"l",(function(){return w})),n.d(t,"j",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"g",(function(){return g})),n.d(t,"n",(function(){return I})),n.d(t,"b",(function(){return O})),n.d(t,"e",(function(){return S}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(0),n.e(4),n.e(5),n.e(9),n.e(10),n.e(12),n.e(11),n.e(13),n.e(14),n.e(17),n.e(20),n.e(19),n.e(24),n.e(25),n.e(26),n.e(29),n.e(31),n.e(33),n.e(34),n.e(47),n.e(50),n.e(54),n.e(56),n.e(63),n.e(472)]).then(n.bind(null,2814))),a={captureBundleTime:!0};let o=new r.a(i,e=>e.replyToMessage,a),c=new r.a(i,e=>e.forwardMessage,a),s=new r.a(i,e=>e.closeCompose),u=new r.a(i,e=>e.discardCompose),d=new r.a(i,e=>e.loadDraftToCompose),l=new r.a(i,e=>e.openCompose),f=new r.a(i,e=>e.trySaveAndCloseCompose),b=new r.a(i,e=>e.trySaveAndCloseAllMessages),m=new r.a(i,e=>e.moveComposeToTab),p=new r.a(i,e=>e.tryCreateResendDraft),w=new r.a(i,e=>e.replyToApprovalMessage);const h=new r.a(i,e=>e.onEditDraftButtonClicked);let v=new r.b(i,e=>e.createReply),g=new r.b(i,e=>e.getToCcRecipientsForReply),I=new r.b(i,e=>e.replyToMessageAndCreateViewState),O=new r.b(i,e=>e.createAttachments),S=new r.b(i,e=>e.extractComposePopoutData)},1889:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1729),i=n(1688);function a(e){return Object(r.a)(i.k,e)}},1890:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1729),i=n(1688);function a(e){return Object(r.a)(i.d,e)}},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1729);function i(e){return Object(r.a)(e)}},1902:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1793),i=n(2349);function a(e){return Object(r.b)().loadedConversationReadingPaneViewStates.get(e||Object(r.b)().sxsItemId||Object(i.a)())}},1917:function(e,t,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1946:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return c}))},1958:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1959:function(e){e.exports=JSON.parse('{"b":"Mda","d":"Nda","c":"Oda","a":"Pda"}')},1965:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b}));var r=n(1685),i=n(1703),a=n(1727),o=n(1889),c=n(1845),s=n(1890),u=n(1896),d=n(1860);function l(e,t){const n=Object(c.a)();if(t){return[...n.values()].filter(n=>n.distinguishedFolderType===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function f(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(s.a)(t);break;case"SharedMailbox":n=Object(u.a)(t);break;default:n=Object(o.a)(t)}const c=Object(d.a)();if("UserMailbox"==e&&n.distinguishedFolderType==Object(o.a)(t).distinguishedFolderType&&n.id){const e=c.map(e=>l(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.id):e.map(e=>e.id)}const f=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>a.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.id)}(n,t);for(let e=0;e<f.length;e++)-1==c.indexOf(Object(i.a)(f[e]))&&r.push(f[e]);return r}function b(e,t){const n=Object(c.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},1974:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(266);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1977:function(e,t,n){"use strict";var r=n(954),i=n(910);var a=n(955),o=n(245),c=n(40),s=n(1765);function u(e,t,n,u,d,l,f){const b=Object(o.b)();var m;return u&&(b.RequestServerVersion=u),l&&(b.ManagementRole=(m={UserRoles:["MailboxSearch"]},Object.assign({__type:"ManagementRoleType:#Exchange"},m))),Object(a.a)({Header:b,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map(e=>Object(i.a)({Id:e})):e?[Object(i.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:f})},d).then(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}).then(e=>Object(s.a)(e).then(()=>e)).then(t=>{if(!(null==t?void 0:t.length))return null;let n=[];return t.forEach(e=>{n=n.concat(e.Items)}),n.length?Array.isArray(e)||void 0!==f?n:n[0]:null}).catch(e=>(c.h.warn("GetItem:"+e.message),e))}n.d(t,"a",(function(){return u}))},198:function(e,t,n){"use strict";var r=n(40);let i;function a(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}var o=n(108);const c=500,s=[],u=[],d=[];let l=!0;function f(e,t){Object(r.g)((e,t,n)=>{l&&(t==r.b.Error&&u.push({message:e,error:n}),s.push({message:e,level:t}))}),e(m),t(m),a()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function b(e){const t=Object(o.a)(e);return l=!1,{traces:s,errors:u,network:d,usage:t}}function m(){l&&d.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return a}))},2036:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(5),i=n(283),a=n(50),o=n(2199),c=n(96),s=n(2),u=n(30),d=n(2039),l=n(2037);function f(e,t,n,f=!1,b=null){if(!e||!e.Id||!e.mailboxInfo)return null;const m=Object(d.b)(e.mailboxInfo),p=null==m?void 0:m.downloadUrlBase,w=Object(l.a)(e.mailboxInfo);if(b=b||Object(r.c)(t,encodeURIComponent(e.Id)),!p||f&&"Firefox"===Object(c.a)().browser){const e=o.e+b+"&X-OWA-CANARY="+Object(a.a)();return Object(u.a)(e)}let h="{0}{1}/{2}";Object(i.a)()&&(h+="&isc=1");let v=Object(r.c)(h,p,w,b);return n&&(v+="&token="+(null==m?void 0:m.downloadToken),v+="&X-OWA-CANARY="+Object(a.a)()),v+="&owa="+window.location.hostname,v+="&scriptVer="+Object(s.u)()||!1,v}},2037:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(209),i=n(272);function a(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const t=e.userIdentity&&Object(i.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2039:function(e,t,n){"use strict";var r=n(272);const i={};function a(e){return i[e]}function o(e,t){const n=i[e];i[e]=Object.assign(Object.assign({},n),t)}var c=n(49),s=n(707),u=n(61),d=n(914),l=n(807),f=n(32);var b=n(40),m=n(1718),p=n(1715);const w=Object(l.b)({timeBetweenRetryInMS:()=>3e4});async function h(e){const t=async()=>{try{let t={};return Object(s.b)()?t={sourceId:Object(d.a)(null==e?void 0:e.userIdentity)}:Object(r.r)(e.userIdentity)&&(t=await async function(e){let t={};t.headers=new Headers;const n=await Object(m.a)(e);return Object(p.b)(t.headers,n),t}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(t)}catch(e){throw b.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},n=a(e.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){o(e.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:r}=w(async()=>{n++;const r=await t();b.h.info("update new token"),o(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),i=new u.c("AttachmentRefreshDownloadToken");try{await r(),i.addCustomData([n]),i.end()}catch(t){b.h.warn(`Retry to refresh token failed: ${t}`),i.addCustomData([n]),i.endWithError("ServerError",t),o(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function v(e){const t=Object(r.r)(e.userIdentity)?Object(c.h)(e.userIdentity):Object(c.g)(),n=null==t?void 0:t.ApplicationSettings;if(n){const t=n.DownloadUrlBase;o(e.userIdentity,{downloadUrlBase:t,downloadToken:n.FirstDownloadToken}),t&&function(e,t){t=t<1?1:t,Object(s.b)()&&h(e),setInterval(()=>{h(e)},6e4*t)}(e,n.DownloadTokenRefreshMinutes)}}var g=n(266);function I(e){const t=Object(r.j)(null==e?void 0:e.userIdentity),n=a(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Office365":case"Outlook":v(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(g.a)(t)}const i=a(e.userIdentity);return i||(Object(u.o)("FilesUrlDataNotFound",{accountProviderType:t}),b.h.warn("Unable to get the url data")),i}function O(e){if(!e)return null;const t=I(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return O}))},2050:function(e,t,n){"use strict";var r=n(1825),i=n(598);function a(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function o(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var c=n(1958),s=n(1703);var u=n(1685),d=n(1946),l=n(1688),f=n(1965);n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return S}));const b={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(d.b)({folderId:Object(u.a)(l.k),kind:"PrimaryMailbox"}));const t=Object(f.b)("UserMailbox");for(let n of t)e.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(s.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),[(a={FolderScope:o({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},a))];var a}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(d.a)({folderId:Object(u.a)(l.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(u.a)(l.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(s.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(c={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},c))]:[a({FolderScope:o({BaseFolderId:n})})];var c}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},w={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(c.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},h={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},g=e=>{switch(e.kind){case"PrimaryMailbox":return b;case"ArchiveMailbox":return m;case"SharedFolders":return p;case"Group":return w;case"Calendar":return h;case"PublicFolder":return v;default:throw new Error("Unregistered search scope")}},I=e=>g(e).getKey(e),O=e=>g(e).getSearchScopeList(),S=e=>g(e).getSearchScopeType(e)},2081:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},2089:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(e,t,n)=>({itemContexts:e,parentFolderId:t,actionType:n}))},2101:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},2102:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2121:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.linkIds=0]="linkIds",e[e.quotedBodyLinkIds=1]="quotedBodyLinkIds"}(r||(r={}))},2125:function(e,t,n){"use strict";var r=n(1754);function i(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var a=n(1974),o=n(1822);function c(){return i()}function s(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(o.a)(e)}(e))}(e)?i():[]).map(a.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}))},2137:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(e,t,n)=>({tableView:e,markAsRead:t,rowIdsToExclude:n}))},2194:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(e,t,n)=>({conversationIds:e,tableView:t,actionType:n}))},2195:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1793),i=n(2349);function a(e){return Object(r.b)().loadedItemReadingPaneViewStates.get(e||Object(i.a)())}},2199:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return d}));const r="/owa/",i="service.svc/s/GetFileAttachment?id={0}",a="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",o="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",s="service.svc/s/GetAttachmentThumbnail?id={0}",u="pdfprint.aspx?id={0}",d="pdfprint.aspx?id={0}&location={1}"},2202:function(e,t,n){"use strict";var r=n(20),i=n(2647),a=n(2194),o=n(2089),c=n(2137),s=n(2313),u=n(2314),d=n(2412),l=n(2648),f=n(2496),b=n(1793),m=n(1690);function p(e,t){return!!e&&(1!==t&&!!m.a.conversations.get(e))}function w(e,t){return 2!=t&&b.a.loadedItemReadingPaneViewStates.has(e)}var h=n(2286),v=n(2287),g=n(2195),I=n(1902);n.d(t,"l",(function(){return S})),n.d(t,"p",(function(){return j})),n.d(t,"m",(function(){return y})),n.d(t,"q",(function(){return P})),n.d(t,"s",(function(){return T})),n.d(t,"n",(function(){return C})),n.d(t,"o",(function(){return x})),n.d(t,"i",(function(){return E})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return k})),n.d(t,"g",(function(){return R})),n.d(t,"r",(function(){return M})),n.d(t,"h",(function(){return D})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return h.a})),n.d(t,"a",(function(){return v.a})),n.d(t,"t",(function(){return b.a})),n.d(t,"c",(function(){return g.a})),n.d(t,"b",(function(){return I.a}));const O=new r.c(()=>Promise.all([n.e(0),n.e(5),n.e(6),n.e(11),n.e(14),n.e(17),n.e(18),n.e(24),n.e(27),n.e(30),n.e(41),n.e(63),n.e(73),n.e(75),n.e(157),n.e(198),n.e(185),n.e(206),n.e(260),n.e(275),n.e(240),n.e(331),n.e(417)]).then(n.bind(null,19099)));let S=new r.a(O,e=>e.loadConversationReadingPane),j=new r.a(O,e=>e.moveReadingPaneToTab),y=new r.a(O,e=>e.loadConversationReadingPaneForSingleMailItemSelected),P=new r.a(O,e=>e.print),T=new r.a(O,e=>e.setItemIdToScrollTo),C=new r.a(O,e=>e.loadItemReadingPane),x=new r.a(O,e=>e.loadItemReadingPaneForSingleMailItemSelected),E=new r.a(O,e=>e.expandCollapseAllItemParts);Object(r.f)(o.a,O,e=>e.deleteItemsStoreUpdateOrchestrator),Object(r.f)(s.a,O,e=>e.markConversationsAsReadStoreUpdateOrchestrator),Object(r.f)(u.a,O,e=>e.markItemsAsReadStoreUpdateOrchestrator),Object(r.f)(c.a,O,e=>e.markAllAsReadOrchestrator),Object(r.f)(i.a,O,e=>e.applyConversationFlagStateStoreUpdateOrchestrator),Object(r.f)(a.a,O,e=>e.deleteConversationStoreUpdateOrchestrator),Object(r.f)(f.a,O,e=>e.conversationReadyToLoadOrchestrator),Object(r.f)(f.b,O,e=>e.updateAttachmentsOrchestrator),Object(r.f)(f.c,O,e=>e.updateItemMandatoryPropertiesOrchestrator),Object(r.f)(d.a,O,e=>e.updateInternetMessageIdOrchestrator),Object(r.f)(l.a,O,e=>e.initializeExtendedCardForItemReadingPaneOrchestrator);new r.b(O,e=>e.getLastestNonDraftItemId);let A=new r.b(O,e=>e.getLatestNonDraftItemIdFromConversation),k=new r.b(O,e=>e.isUnsupportedItem),R=new r.a(O,e=>e.clearReadingPaneStore),M=new r.a(O,e=>e.replyByMeeting),D=new r.a(O,e=>e.ensureSecondaryReadingPaneTabHandler)},2225:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2050);function i(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},2247:function(e,t,n){"use strict";n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return w})),n.d(t,"l",(function(){return h}));var r=n(20),i=n(2101);n.d(t,"n",(function(){return i.a}));var a=n(2081);n.d(t,"a",(function(){return a.a}));var o=n(1917);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(2102);n.d(t,"b",(function(){return c.a}));const s=new r.c(()=>Promise.all([n.e(0),n.e(26),n.e(94),n.e(735)]).then(n.bind(null,3285))),u=new r.b(s,e=>e.getSharingInformation),d=new r.b(s,e=>e.getSharingIssuesForSharingData),l=new r.b(s,e=>e.getInfoBarCreator),f=new r.b(s,e=>e.hasLargeDLRecipient),b=new r.b(s,e=>e.hasRecipientExpansionFailure),m=new r.b(s,e=>e.getGroupsAndSmallDLs),p=new r.b(s,e=>e.getInvididualRecipients),w=new r.b(s,e=>e.hasGetRecipientPermissionFailed),h=new r.b(s,e=>e.logSharingTipChangesForLinkRemoval)},2251:function(e,t,n){"use strict";var r=n(266),i=n(5),a=n(50),o=n(2199);const c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var s=n(2036),u=n(30);function d(e,t,n,d,l=0,f=0,b=!0,m=null,p=null){let w;switch(n){case 0:w=o.f;break;case 3:w=o.h;break;case 1:if(!function(e){if(!e)return!1;let t=null;const n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&c.indexOf(t.toLowerCase())>=0}(m))return null;w=o.g;break;default:Object(r.a)(n)}let h=d?f:l;!h&&l&&(h=l);let v=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(w,encodeURIComponent(e.Id),encodeURIComponent(t)),h);const g=Object(s.a)(e,w,!0,3===n,v);if(g)return g;let I=Object(i.c)("{0}{1}{2}",o.e,p,v);if(b){I=`${I}&X-OWA-CANARY=${Object(a.a)()}`}return Object(u.a)(I)}function l(e,t,n=!1,a=!0){let c;switch(t){case 0:c=o.a;break;case 1:c=o.b;break;case 2:c=o.d;break;case 3:c=o.c;break;default:return Object(r.a)(t)}if(!Object(i.k)(c)){const r=Object(s.a)(e,c,a,3===t);return Object(i.c)("{0}{1}{2}",r,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}))},2286:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(44);function i(){return Object(r.j)("rp-linkedInViewProfile")||Object(r.j)("rp-linkedInViewProfileV1_1")}},2287:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="displaylinkedindataprebind"},2292:function(e,t,n){"use strict";n.d(t,"u",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return w})),n.d(t,"n",(function(){return h})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return I})),n.d(t,"r",(function(){return O})),n.d(t,"s",(function(){return S})),n.d(t,"t",(function(){return j})),n.d(t,"v",(function(){return y})),n.d(t,"h",(function(){return P}));var r=n(20),i=n(3671);n.d(t,"a",(function(){return i.a}));var a=n(3066);n.d(t,"b",(function(){return a.a})),n.d(t,"e",(function(){return a.d}));var o=n(3167);n.d(t,"f",(function(){return o.a}));var c=n(3262);n.d(t,"d",(function(){return c.a}));var s=n(3672);n.d(t,"c",(function(){return s.a}));const u=new r.c(()=>n.e(1202).then(n.bind(null,7181))),d=new r.b(u,e=>e),l=new r.b(u,e=>e.resetPreviewPane),f=(new r.b(u,e=>e.setAudioPreviewState),new r.b(u,e=>e.setBlankPreviewState),new r.b(u,e=>e.setCustomPreviewState),new r.b(u,e=>e.setIframePreviewState)),b=(new r.b(u,e=>e.setImageGalleryItems),new r.b(u,e=>e.setImagePreviewLoaded)),m=new r.b(u,e=>e.setImagePreviewState),p=new r.b(u,e=>e.setImagePreviewStateFromImageGalleryItem),w=(new r.b(u,e=>e.setNativePdfPreviewState),new r.b(u,e=>e.setPanesSize)),h=(new r.b(u,e=>e.setPdfJsPreviewState),new r.b(u,e=>e.setPdfJsPreviewStateByData),new r.b(u,e=>e.setPreviewError)),v=new r.b(u,e=>e.setPreviewLoading),g=new r.b(u,e=>e.setRightPaneDisplayAndUpdateSize),I=new r.b(u,e=>e.setSaveStatusText),O=new r.b(u,e=>e.setTextPreviewState),S=(new r.b(u,e=>e.setVideoPreviewState),new r.b(u,e=>e.setWacPreviewState)),j=new r.b(u,e=>e.setWacReadOnly),y=new r.b(u,e=>e.updatePanesSize),P=new r.b(u,e=>e.saveHideReadingPaneOption);new r.b(u,e=>e.saveDefaultEditCommandOption)},2313:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(e,t,n,r)=>({conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}))},2314:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(e,t,n,r)=>({itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}))},2324:function(e,t,n){"use strict";var r=n(20);const i=[0,1];var a=n(2449),o=n(2415),c=n(5),s=n(266),u=n(1788);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(o.a),messageParts:[Object(c.b)(o.a),l()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(a.b),messageParts:[Object(c.b)(a.b),l()],color:u.a.Red};default:return Object(s.a)(e)}}function l(){return{text:Object(c.b)(a.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2125),b=n(1974),m=n(44),p=n(1754);function w(){const e=Object(p.a)();if(Object(m.j)("fwk-devTools")){if(Object(m.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(m.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function h(){const e=w();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return b.a})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return w}));const v=new r.c(()=>n.e(2036).then(n.bind(null,18919))),g=new r.b(v,e=>e.getAccessIssuesForAttachments)},2334:function(e,t,n){"use strict";n.d(t,"m",(function(){return a})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"r",(function(){return w})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"j",(function(){return g})),n.d(t,"f",(function(){return I})),n.d(t,"i",(function(){return O})),n.d(t,"a",(function(){return S}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(0),n.e(9),n.e(10),n.e(12),n.e(13),n.e(17),n.e(20),n.e(24),n.e(25),n.e(26),n.e(47),n.e(50),n.e(54),n.e(103),n.e(339),n.e(500)]).then(n.bind(null,4099))),a=new r.a(i,e=>e.onSmimeItemAttachmentOpened),o=new r.a(i,e=>e.mergeSmimeDecodedMessageProperties),c=(new r.b(i,e=>e.fetchAndDecodeSmimeMessage),new r.b(i,e=>e.setSmimePropertiesInDraftMessage)),s=new r.b(i,e=>e.trySetSmimeProperties),u=new r.b(i,e=>e.tryAddSmimeProperties),d=new r.b(i,e=>e.createMailResponseBodyContent),l=new r.b(i,e=>e.downloadSmimeAttachment),f=new r.b(i,e=>e.getMergedSmimeViewState),b=new r.b(i,e=>e.getMergedSmimeViewStateForDraft),m=new r.b(i,e=>e.isSmimeItemDecoding),p=new r.b(i,e=>e.previewSmimeAttachment),w=new r.b(i,e=>e.updateSmimeAttachmentIds),h=new r.b(i,e=>e.createSmimeAttachmentsFromFiles),v=new r.b(i,e=>e.createSmimeAttachmentsViaSmimeQueueManager),g=new r.b(i,e=>e.initializeAttachmentStateForSmimeAttachments),I=new r.b(i,e=>e.getAttachmentsForSmimeResponse),O=new r.b(i,e=>e.getSmimeAttachmentsForRequest),S=Object(r.d)(i,e=>e.SignatureDetails)},2349:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(797),i=n(2606);function a(){const e=Object(r.d)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(i.a)()}}},2377:function(e,t,n){"use strict";var r=n(266),i=n(2532),a=n(50),o=n(2686);function c(e,t,n,a,c=!0){var s;const{Name:u,OriginalPermissionType:d,PermissionType:l}=t,f=Object(o.a)(t),b="GroupMailbox"===(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(e,f,n,a,l,d,c,u,b);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(e,f,1,a,l,d,c,u,b);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n=!1,r=!0){return i.a(e,t,n,r)}function u(e,t,n,r,o=!1){const u=n?c(e,t,1,r,!1):s(e,1,o,!1);if(n)return{url:u,init:{credentials:"include",headers:new Headers}};{const t=i.c(e.mailboxInfo),n=new Headers;return n.set("X-Token",t),n.set("X-OWA-CANARY",Object(a.a)()),{url:u,init:{headers:n}}}}function d(e,t,n,r,i,a=!1){return r?c(e,t,n,i):s(e,n,a)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}))},2412:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateInternetMessageId",(e,t,n)=>({conversationId:e,itemId:t,internetMessageId:n}))},2415:function(e){e.exports=JSON.parse('{"a":"kca"}')},2449:function(e){e.exports=JSON.parse('{"a":"eca","b":"fca"}')},2496:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n(3);const i=Object(r.action)("CONVERSATION_READY_TO_LOAD",(e,t)=>({conversationId:e,nodeIdCollectionChange:t})),a=Object(r.action)("UPDATE_ATTACHMENTS"),o=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(e,t)=>({conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}))},2532:function(e,t,n){"use strict";var r=n(2251);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(2039);n.d(t,"c",(function(){return i.a}));var a=n(2037);n.d(t,"e",(function(){return a.a}));var o=n(2036);n.d(t,"d",(function(){return o.a}))},2606:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1793),i=n(597);function a(){var e,t;return Object(i.w)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(r.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},2647:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(e,t,n)=>({conversationIds:e,flagType:t,tableViewId:n}))},2648:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(e,t)=>({itemReadingPaneViewState:e,loadedItem:t}))},2657:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(32);function i(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},267:function(e,t,n){"use strict";var r=n(912);n.d(t,"a",(function(){return r.a}))},2686:function(e,t,n){"use strict";function r(e){let t=null;return t=e.AttachLongPathName,t||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},2690:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(797),i=n(246),a=n(929),o=n(266);function c(e,t=0,n,c){const l=function(e){switch(e){case 0:return s;case 1:return u;case 2:return d;default:return Object(o.a)(e)}}(t),f=Object(a.c)();for(const t of Object(i.a)().tabs)if(t.type==r.a.MailCompose&&0==t.state){const r=f.viewStates.get(t.data);if((null==r?void 0:r.isInlineCompose)&&l(r,e)&&(0==r.asyncSendState||n&&6==r.asyncSendState)&&(!c&&!t.projectionRPTabId||t.projectionRPTabId==c))return r}return null}function s(e,t){return e.conversationId===t}function u(e,t){return e.referenceItemId.Id===t}function d(e,t){return!1}},2697:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4);const i=new r.d(()=>n.e(1346).then(n.bind(null,4123))),a=new r.a(i,e=>e.logSigsDatapoint)},276:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(117),i=n(97),a=n(2);let o;function c(e){o=e}async function s(e){var t,n;if(Object(a.P)())return i.f.importAndExecute(Object(r.a)());const c=o&&await o(void 0,e);if(c&&c.length>0){if("bearer"===(null===(t=null==c?void 0:c.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return c.split(" ")[1];if("msauth1.0"===(null===(n=null==c?void 0:c.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return c}}},2927:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1688),i=n(1692),a=n(1685),o=n(1946),c=n(2225);function s(e){const t=e;return Object(i.m)(t.folderId)?Object(c.a)(t.searchScope,Object(o.a)({folderId:Object(a.a)(r.a),kind:"ArchiveMailbox"})):Object(c.a)(t.searchScope,Object(o.b)({folderId:Object(a.a)(r.h),kind:"PrimaryMailbox"}))}},3025:function(e,t,n){"use strict";function r(e,t,n,r,i,a,o,c,s,u){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:[...r.values()],includeAttachments:a,fromDate:o,toDate:c,scenarioType:"mail",lastIndexFetched:0,searchProvider:s,viewFilter:u||"All"}}function i(e){const t=e;return 1==e.type?t.scenarioType:void 0}var a=n(1688),o=n(1692),c=n(1685),s=n(1946),u=n(2225);function d(e){if(!e)return!1;const t=e;return Object(o.m)(t.folderId)?Object(u.a)(t.searchScope,Object(s.a)({folderId:Object(c.a)(a.b),kind:"ArchiveMailbox"})):Object(u.a)(t.searchScope,Object(s.b)({folderId:Object(c.a)(a.i),kind:"PrimaryMailbox"}))}n(2927);n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return d}))},3066:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return s}));const r=600,i=600,a=650,o=1/2.89*100,c=420,s=420/1300*100},311:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function o(e){return r.test(e)}},3205:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function a(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){let n="";n=t?"Empty response from server":"Null response from server",a(e,n)}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return o}))},3595:function(e){e.exports=JSON.parse('{"a":"MYb"}')},3671:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="autoHideEmail"},3672:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},417:function(e,t,n){"use strict";class r{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return r}))},5175:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5176),i=n(5560),a=n(3595),o=n(5);function c(e){switch(e){case 2:return Object(o.b)(i.d);case 3:return Object(o.b)(i.e);case 5:return Object(o.b)(i.c);case 6:return Object(o.b)(r.a);case 7:return Object(o.b)(i.g);case 4:return Object(o.b)(i.f);case 10:return Object(o.b)(i.a);case 11:return Object(o.b)(i.b);default:return Object(o.b)(a.a)}}},5176:function(e){e.exports=JSON.parse('{"a":"LYb"}')},5342:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(929),i=n(797);function a(){const e=Object(i.d)(),t=Object(r.c)(),n=e?function(e,t){switch(e.type){case i.a.Primary:return t.primaryComposeId;case i.a.MailCompose:return e.data;default:return null}}(e,t):t.primaryComposeId,a=n?t.viewStates.get(n):null;return a&&!a.isInlineCompose?a:null}},5560:function(e){e.exports=JSON.parse('{"d":"NYb","e":"OYb","c":"PYb","g":"QYb","f":"RYb","a":"SYb","b":"TYb"}')},5576:function(e){e.exports=JSON.parse('{"a":"lYb"}')},5599:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},5721:function(e,t,n){"use strict";n.r(t);var r=n(3);const i=Object(r.action)("initializeReadingPaneInSxS",(e,t,n,r,i,a)=>({readingPaneStrategy:e,attachmentSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:i,isProjectionPopout:a})),a=Object(r.action)("initializeConversationReadingPaneInSxS",(e,t,n,r,i)=>({readingPaneStrategy:e,attachmentSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:i})),o=Object(r.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",(e,t,n,r,i)=>({attachmentSelectionSource:e,parentItemId:t,instrumentationContext:n,sxsId:r,isProjectionPopout:i}));var c=n(266),s=n(2202),u=n(1859);Object(r.orchestrator)(a,async e=>{const{readingPaneStrategy:t,attachmentSelectionSource:n,parentItemId:r,instrumentationContext:i,sxsId:a}=e;if(!t||!t.conversationId)return;const o=Object(u.l)(a);o.readingPaneState&&o.readingPaneState.mode===u.h.ConversationReadingPane&&o.readingPaneState.conversationId&&o.readingPaneState.conversationId.Id===t.conversationId.Id?r&&function(e){switch(e){case u.b.MailList:case u.b.ConversationAttachmentWell:return!0;case u.b.ReadingPane:case u.b.FilesHub:case u.b.PhotoHub:case u.b.GroupFilesHub:case u.b.ConsumerGroupFilesHub:case u.b.Deeplink:case u.b.FileSuggestion:case u.b.LinkSuggestion:case u.b.ComposeDocLink:case u.b.ReadingPaneDocLink:return!1;default:return Object(c.a)(e)}}(n)&&s.s.importAndExecute(t.conversationId.Id,r.Id):(Object(u.I)(t.conversationId.Id),await s.l.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo),Object(u.M)({mode:u.h.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject},a),r&&s.s.importAndExecute(t.conversationId.Id,r.Id))});const d=Object(r.action)("initializeItemReadingPaneInSxS",(e,t,n)=>({readingPaneStrategy:e,sxsId:t,instrumentationContext:n}));Object(r.orchestrator)(d,async e=>{const{readingPaneStrategy:t,instrumentationContext:n,sxsId:r}=e;if(!t||!t.itemId)return;const i=Object(u.l)(r);if(i.readingPaneState&&i.readingPaneState.mode===u.h.ItemReadingPane&&i.readingPaneState.itemId&&i.readingPaneState.itemId.Id===t.itemId.Id)return;const a=Object(s.c)(t.itemId.Id);if(a&&a.itemId==t.itemId.Id)Object(u.M)({mode:u.h.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:a},r);else{const e=await s.n.import();await e(t.itemId,n,e=>{Object(u.M)({mode:u.h.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e},r)})}});var l=n(2808),f=n(929),b=n(3025),m=n(1793),p=n(1902),w=n(797),h=n(597),v=n(1885),g=n(5342),I=n(2690),O=n(1679),S=n(1741);Object(r.orchestrator)(o,async e=>{var t;if(e.isProjectionPopout)return;const n=Object(u.l)(e.sxsId);if(n.shouldShow&&(n.readingPaneState||n.composeId))return;const{attachmentSelectionSource:r,parentItemId:i,instrumentationContext:o}=e,c=null===(t=O.Z.tableViews.get(O.Z.selectedTableViewId))||void 0===t?void 0:t.tableQuery,s=c&&(Object(O.S)(c)||Object(b.c)(c));let j=Object(w.d)();const y=Object(g.a)();if(y){if(Object(h.w)()&&window.opener)return;if(y.composeId===f.a.primaryComposeId){(await v.i.import())(y,!0,!1),j=Object(w.d)()}return void(await u.B.import())(y.composeId,e.sxsId)}const{deeplinkId:P}=m.a,T=Object(p.a)();if(P)d({method:l.a.LoadItemReadingPane,itemId:{mailboxInfo:P.mailboxInfo,Id:P.id}},e.sxsId,o);else if(j&&j.type===w.a.SecondaryReadingPane){const t=j.data;1===t.listViewType||Object(S.a)()?d({method:l.a.LoadItemReadingPane,itemId:t.id},e.sxsId,o):0===t.listViewType&&a({method:l.a.LoadConversationReadingPane,conversationId:t.id,conversationSubject:t.subject,conversationCategories:t.categories},r,i,o,e.sxsId)}else if(T&&Object(I.a)(T.conversationId.Id))a({method:l.a.LoadConversationReadingPane,conversationId:T.conversationId,conversationSubject:T.conversationSubject,conversationCategories:T.conversationCategories},r,i,o,e.sxsId);else{const t=Object(O.I)(),n=t&&[...t.selectedRowKeys.keys()],c=null==t?void 0:t.isInVirtualSelectAllMode,u=O.Z.expandedConversationViewState.selectedNodeIds.length;if(1==n.length&&u<=1&&!c&&!s){const c=O.b.getRowIdToShowInReadingPane(n[0],t),s=t&&t.tableQuery.listViewType;if(1===s||Object(S.a)())d({method:l.a.LoadItemReadingPane,itemId:c},e.sxsId,o);else if(0===s){const s=O.b.getSubject(n[0],t),u=O.b.getCategories(n[0],t);a({method:l.a.LoadConversationReadingPane,conversationId:c,conversationSubject:s,conversationCategories:u},r,i,o,e.sxsId)}}}}),Object(r.orchestrator)(i,async e=>{const{readingPaneStrategy:t,attachmentSelectionSource:n,parentItemId:r,instrumentationContext:i,sxsId:c,isProjectionPopout:s}=e;if(t)switch(t.method){case l.a.NoOp:return;case l.a.AlwaysHidden:return void Object(u.M)(null,c);case l.a.CopyMailReadingPaneContainer:return void o(n,r,i,c,s);case l.a.LoadConversationReadingPane:return void a(t,n,r,i,c);case l.a.LoadItemReadingPane:return void d(t,c,i);default:return}});var j=n(61),y=n(1932),P=n(1975),T=n(1829),C=n(2781),x=n(5158);const E="download",A="open";async function k(e){var t;const n=Object(x.a)(e.AttachLongPathName),r=await Object(C.l)(n);return(null===(t=r.result)||void 0===t?void 0:t.webContentLink)&&(i=r.result.webContentLink).lastIndexOf(E,i.length-E.length)>-1?function(e){return e.slice(0,-E.length)+A}(r.result.webContentLink):null;var i}var R=n(2206),M=n(2239),D=n(10313),L=n(2377),N=n(4067),F=n(10649),U=n(44),_=n(1724),B=n(5578),W=n(311),V=n(5),G=n(3595),z=n(5176),H=n(5576),K=n(1692),J=n(8845),X=n(6),$=n(2292),Y=n(40);function q(e){switch(e){case y.b.Unsupported:return"Unsupported";case y.b.Image:return"Image";case y.b.MailItem:return"MailItem";case y.b.CalendarEvent:return"CalendarEvent";case y.b.Wac:return"Wac";case y.b.SuiteExtensions:return"SuiteExtensions";case y.b.Audio:return"Audio";case y.b.Text:return"Text";case y.b.NativeView:return"NativeView";case y.b.GoogleDoc:return"GoogleDoc";case y.b.PdfJs:return"PdfJs";case y.b.ItemAttachment:return"ItemAttachment";case y.b.Video:return"Video";default:return Object(c.a)(e)}}const Q="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";var Z=n(2532);async function ee(e){if(!e.mailboxInfo)return null;const t=Object(Z.e)(e.mailboxInfo),n=await async function(e,t){const n=Object(V.c)(Q,e,encodeURIComponent(t));return await fetch(n,{credentials:"same-origin"})}(t,e.Id);if(n.ok){const e=(await n.text()).replace(/\s/gi,""),t=atob(e),r=t.length,i=new Uint8Array(new ArrayBuffer(r));for(let e=0;e<r;e++)i[e]=t.charCodeAt(e);const a=n.headers.get("PrintAllowed"),o=n.headers.get("CopyAllowed"),c=n.headers.get("ExportAllowed");return{data:i,printAllowed:!a||"true"===a.toLowerCase(),copyAllowed:!o||"true"===o.toLowerCase(),exportAllowed:!c||"true"===c.toLowerCase()}}throw n.statusText}var te=n(2);function ne(e,t){const n=Object(te.O)()?"OWA-PWA":"OWA-WEB",r=t?"SXS-EDIT":"SXS-VIEW";let i="";switch(e){case u.b.MailList:i="ML";break;case u.b.ConversationAttachmentWell:i="CAW";break;case u.b.ReadingPane:i="RP";break;case u.b.FilesHub:i="FH";break;case u.b.PhotoHub:i="PH";break;case u.b.GroupFilesHub:i="GFH";break;case u.b.ConsumerGroupFilesHub:i="CGF";break;case u.b.Deeplink:i="DL";break;case u.b.FileSuggestion:i="FS";break;case u.b.LinkSuggestion:i="LS";break;case u.b.ComposeDocLink:i="CDL";break;case u.b.ReadingPaneDocLink:i="RPDL";break;default:i="UNKNOWN"}return`${n}.${i}.${r}`}var re=n(2807);function ie(e){const t=new Error(e);throw t.isUserError=!0,t}function ae(e){if(null!=e){if(e.isUserError)return!0}return!1}var oe=n(17058),ce=n(2949),se=n(700),ue=n(1865);const de=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];async function le(e,t,n){(await v.h.import())(e.Id,t,3,{forceInsertSignatureOperation:n})}async function fe(e){const t=e.mailboxInfo,n=t&&"GroupMailbox"==t.type?t.mailboxSmtpAddress:null,r=await v.c.import(),i=await r(e.Id,!0,n,!1);return Object.assign(Object.assign({},i.ItemId),{mailboxInfo:e.mailboxInfo})}async function be(e){const t=Object(I.a)(e);if(t){const e=await v.q.import();return await e(t),t.itemId}return null}async function me(e,t,n,r,a,o,c,s,d,l=u.f.Mail,f){var h,v;const S=new Date,C=await u.G.import();if(!re.a.available())return void C.openSxSInANewWindow(t,e.attachmentId.Id,null);const x=(d=d||window)!==window,E=Object(u.k)(d);if(re.a.run(d,E),f&&a==y.c.Deeplink){const e=(new Date).getTime()-f;Object(j.o)("PopOutSxSUsage",{PopOutType:"DeepLink",TimeElapsed:e})}const A=await $.u.import(),{onPreviewOperationStart:_,onPreviewOperationFinished:Q}=C,Z=Object(u.l)(E).viewState,te=await T.g.import(),me=te(e.attachmentId),ve=e.strategy,ge=-1!==ve.supportedOpenActions.indexOf(y.a.Download)&&(null==me?void 0:me.download)?me.download.url:null,Ie=me.info.allowDownload;let Oe=0;Oe=ve.isSaveToCloudSupported?Object(V.k)(me.model.AttachmentOriginalUrl)?1:3:0;const Se={downloadUrl:ge,downloadShouldOpenNewTab:ve.previewMethod===y.b.Wac,fileName:me.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId,isCloudy:e.isCloudy,openInNewTabUrl:null};let je=ve.previewMethod,ye=!1;if(ve.previewMethod===y.b.NativeView||ve.previewMethod===y.b.PdfJs){const e=K.u.items.get(t.Id);e&&e.RightsManagementLicenseData&&(je=y.b.PdfJs,ye=!0)}const{perfDatapoint:Pe,perfDatapointCreatedTime:Te}=function(e,t,n,r,i,a,o,c){var s,u;const d=he(e),l=new j.b("PreviewAttachmentInSxSE2E",{timeout:pe}),f=Date.now();let b=!1;c&&(b=!!we&&we===c,we=c);const m={previewMethod:q(t),isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:Object(B.a)(d),actionSource:y.c[i],attachmentFileType:a,isRepeat:o,downloadAllowed:!!e.download.url,fromSameReadingPane:b};let p="";Object(U.j)("doc-SxS-jsApi-ODB-Base")&&(p+="doc-SxS-jsApi-ODB-Base;");Object(U.j)("doc-SxS-jsApi-ODB-BaseNoEditString")&&(p+="doc-SxS-jsApi-ODB-BaseNoEditString;");Object(U.j)("doc-SxS-jsApi-ODB-Readonly")&&(p+="doc-SxS-jsApi-ODB-Readonly;");Object(U.j)("doc-SxS-jsApi-ODB-Basecf")&&(p+="doc-SxS-jsApi-ODB-Basecf;");return m.associatedFlights=p,m.hostName=window.location.hostname,m.hideEmailOption=null===(s=$.u.tryImportForRender())||void 0===s?void 0:s.getHideReadingPaneOption(),l.addCustomData(m),l.addCosmosOnlyData(JSON.stringify({attachmentId:null===(u=null==e?void 0:e.id)||void 0===u?void 0:u.Id,fileType:(null==d?void 0:d.substring(0,4))||"",fileSize:e.model.Size})),Object(j.o)("PreviewAttachmentInSxSUsage",m,{excludeFromKusto:!0}),{perfDatapoint:l,perfDatapointCreatedTime:f}}(me,je,e.isCloudy,Object(u.l)(E).editState.mode!==u.c.View,a,e.fileType,C.repeatTracker.contains(e.attachmentId.Id),!Object(u.l)(E).shouldShow&&function(){var e,t,n,r,i;const a=null===(e=O.Z.tableViews.get(O.Z.selectedTableViewId))||void 0===e?void 0:e.tableQuery,o=a&&(Object(O.S)(a)||Object(b.c)(a)),c=Object(w.d)(),s=Object(g.a)(),u=null===(t=null==s?void 0:s.itemId)||void 0===t?void 0:t.Id;if(u)return u;const{deeplinkId:d}=Object(m.b)(),l=Object(p.a)();if(d)return d.id;if(c&&c.type===w.a.SecondaryReadingPane){const e=c.data;return null===(n=null==e?void 0:e.id)||void 0===n?void 0:n.Id}if(l&&Object(I.a)(l.conversationId.Id))return l.conversationId.Id;{const e=Object(O.I)(),t=e&&[...e.selectedRowKeys.keys()],n=null==e?void 0:e.isInVirtualSelectAllMode,a=null===(i=null===(r=O.Z.expandedConversationViewState)||void 0===r?void 0:r.selectedNodeIds)||void 0===i?void 0:i.length;if(1===(null==t?void 0:t.length)&&a<=1&&!n&&!o){return O.b.getRowClientItemId(t[0],e).Id}}return null}()),Ce=()=>{Pe.addCustomData({autoHide:!0})};Z.eventManager.on($.a,Ce);const xe={id:`${(new Date).getTime()}_${Math.floor(1e3*Math.random())}`,attachmentId:e.attachmentId};_(xe,E);try{await C.canCloseSxS(E)||Pe.addCustomData({exitEditMode:"notSaved"}),Ee(),r&&!n||i(c,a,t,s,E,x);const d=null==t?void 0:t.Id,f=d&&Object(K.v)(d);let b;if(A.setPreviewLoading(Z,"",Se),C.showSxS(Object(u.l)(E).shouldShow?null:l,{previewMode:je,attachmentId:e.attachmentId,selectionSource:a,isCloudy:e.isCloudy,saveToCloudStatus:Oe,textPreviewReadMode:0},{editAllowed:ve.allowEdit&&!(Object(X.f)("sxsHideEdit")&&(Object(u.l)(E).shouldShow?Object(u.l)(E).customization:l)===u.f.DeepLink),itemId:t,isDraft:n},null,E,{itemId:d,fileId:e.attachmentId.Id,fileType:he(me),sender:null===(v=null===(h=(null==f?void 0:f.From)||(null==f?void 0:f.Sender))||void 0===h?void 0:h.Mailbox)||void 0===v?void 0:v.EmailAddress,startTime:(new Date).getTime()}),Object(u.L)(null),!r){switch(je){case y.b.Image:await async function(){const t=o?await o():null;Ee(),A.setImagePreviewState(Z,me.previewImage.url,t,Ie,!Ie&&!Object(M.e)().printWithoutDownloadEnabled,Se);const n=await T.i.import();await n(e.attachmentId,e.isReadOnly),Ee(),A.setImagePreviewState(Z,te(e.attachmentId).previewImage.url,t,Ie,!Ie&&!Object(M.e)().printWithoutDownloadEnabled,Se)}();break;case y.b.Wac:await async function(){const t=me.model.ProviderType;Object(P.b)(e.isCloudy,t,me.model.Name)&&t===ue.d.ONE_DRIVE_PRO?await async function(){var e;const t=me,n=Object(U.j)("doc-unwrap-safelinks")?t.originalUrl:t.openUrl;try{if(Pe.addCustomData({useJsApi:"true"}),null==n)throw new Error("openUrl is null");const t=me.model.Name,i=t&&t.substring(t.lastIndexOf(".")),o=(r=i,!Object(U.j)("doc-SxS-jsApi-ODB-Readonly")&&".xls"!==r),c=await Object(N.a)(0,n,o,!0);if(!c)throw new Error("Vroom API call failed");Ee();const s=Object(W.a)();A.setWacPreviewState(Z,c.openWith.wac.applicationUrl,{bootScriptUrl:c.openWith.wac.bootstrapperUrl,wopiSrcUrl:c.openWith.wac.wopiSrc,accessToken:c.openWith.wac.accessToken,accessTokenExpiry:c.openWith.wac.accessTokenExpiry,fileSize:me.model.Size,fileGetUrl:c.openWith.wac.fileGetUrl,bundleInfo:c.officeBundle,fetchStartTime:c.fetchStartTime,responseStartTime:c.responseStartTime,openUrl:n,owaSessionId:s,userId:c.openWith.wac.userId,sessionOrigin:ne(a,o),clientThrottlingProtection:c.openWith.wac.clientThrottlingProtection,requestedCallThrottling:c.openWith.wac.requestedCallThrottling,irmEnabled:null===(e=c.sensitivityLabel)||void 0===e?void 0:e.protectionEnabled},null,null,null,null,S.getTime(),c.currentUserRole.readOnly,Se),Pe.addCustomData({owaSessionId:s})}catch(e){throw Y.h.warn(`Something went wrong while getting the attachment state: ${e.message}`),A.setPreviewError(Z,Object(V.b)(G.a),Object.assign(Object.assign({},Se),{openInNewTabUrl:n})),e}var r}():await async function(){try{const t=!1,n=await Object(F.a)(e.attachmentId,t,y.c[a]);if(me.model.Name){const e=me.model.Name.lastIndexOf(".");if(e>=0){const t=me.model.Name.substr(e).toLowerCase();Se.useHighContrastCommandBar=de.indexOf(t)>=0}}Ee(),A.setWacPreviewState(Z,n.wacUrl,null,n.accessToken,n.accessTokenTtl,n.additionalParameters,n.deprecatedTokenAndParameters,S.getTime(),!t,Se)}catch(t){const n=t;if(null==n?void 0:n.errorMessage){if(Y.h.warn(`Something went wrong while getting the attachment state: ${n}`),e.isCloudy){const e=me;Se.openInNewTabUrl=Object(U.j)("doc-unwrap-safelinks")?e.originalUrl:e.openUrl}throw A.setPreviewError(Z,n.errorMessage,Se),n.error}throw t}}()}();break;case y.b.GoogleDoc:A.setIframePreviewState(Z,me.model.AttachLongPathName,Se);break;case y.b.NativeView:await async function(){if(Object(R.b)(me.model)&&me.model.ProviderType===ue.d.GDRIVE)await async function(){let e=null;try{const e=await k(me.model);if(e)return Ee(),void A.setNativePdfPreviewState(Z,e,null,"application/pdf",Se)}catch(t){e=t}throw Ee(),A.setPreviewError(Z,Object(V.b)(z.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}();else{const t=Object(L.a)(e.attachmentId,me.model,3,Object(R.b)(me.model),e.isReadOnly);A.setNativePdfPreviewState(Z,me.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",Se)}}();break;case y.b.PdfJs:await async function(){const t=Object(M.c)(me.model,!0);if(Ie&&t.directFileAccessEnabled&&!ye)A.setPdfJsPreviewState(Z,me.download.url+"&isDocumentPreview=True",!1,Se);else{const t=await ee(e.attachmentId);Ee(),A.setPdfJsPreviewStateByData(Z,t.data,!Ie&&!Object(M.e)().printWithoutDownloadEnabled||!t.printAllowed,t.copyAllowed,t.exportAllowed,Se)}}();break;case y.b.Audio:A.setAudioPreviewState(Z,me.download.url,Se);break;case y.b.Video:A.setVideoPreviewState(Z,me.download.url,Se);break;case y.b.Text:await async function(){try{const t=await Object(D.a)(e.attachmentId.Id,Object(se.a)(e.attachmentId.mailboxInfo),0,y.c[a]);Ee(),A.setTextPreviewState(Z,t,Ie,Se)}catch(e){const t=e;if(null==t?void 0:t.errorMessage)throw Ee(),A.setPreviewError(Z,t.errorMessage),t.error;throw e}}();break;case y.b.ItemAttachment:Object(ce.a)(e.attachmentId,Pe),A.setCustomPreviewState(Z,Se);break;case y.b.CalendarEvent:await async function(){const t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:J.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},n=await J.d.import();let r=null;if(await n({attachmentId:e.attachmentId,size:me.model.Size,showSizeLimitExceedsError:()=>{r=Object(V.b)(oe.a)},errorCallback:()=>{r=Object(V.b)(H.a)},state:t}),Ee(),r)throw A.setPreviewError(Z,r),new Error(r);C.onShowCustomPreview(t,E),A.setCustomPreviewState(Z,Se)}();break;default:throw new Error("Unsupported preview method")}b=await C.waitForPreviewLoadOrThrowError(E)}if(Ee(),Q(E),r)if(n){(await u.t.import())(le,E)}else{(await u.s.import())(le,fe,be,E)}const m=null==b?void 0:b.errorObject,p=null==b?void 0:b.loadedTime;if(m&&Pe.addCustomData({errorObject:m}),p){const e=p-Te;Pe.end(e)}else Pe.end();C.repeatTracker.add(e.attachmentId.Id)}catch(e){Pe.endWithError(ae(e)?"UserError":"ServerError",e)}finally{Z.eventManager.off($.a,Ce)}function Ee(){Object(u.l)(E).pendingPreviewOperation&&xe.id===Object(u.l)(E).pendingPreviewOperation.id||ie("Preview changed before loading finished")}}const pe=18e4;let we=null;function he(e){return 8!==e.attachmentClass&&9!==e.attachmentClass&&Object(_.c)(e.model.Name||"")||e.model.ContentType||""}var ve=n(1738),ge=n(2334);async function Ie(e){const t=e.viewState&&Object(ve.a)(e.viewState.attachmentId);t&&Object(T.c)(t.model)?(await ge.n.import())(t.model,e.parentItemId):(e.onBeforePreview&&e.onBeforePreview(),await me(e.viewState,e.parentItemId,e.isDraft,e.isEdit,e.attachmentSelectionSource,e.createImageGallery,{method:l.a.CopyMailReadingPaneContainer},e.instrumentationContext,e.targetWindow))}var Oe=n(11236),Se=n(1881);function je(e,t,n){const r=new j.b(n,{isCore:"PreviewLinkInSxSE2E"===n});return r.addCustomData({previewMethod:q(e),actionSource:u.b[t]}),r}async function ye(e,t,n,r,a,o,c,d,l=u.f.Mail){var b,m;const p=(c=c||window)!==window,w=Object(Se.m)(a),h=Object(u.k)(c);re.a.run(c,h);const v=await $.u.import(),g=await u.G.import(),{onPreviewOperationStart:I,onPreviewOperationFinished:O}=g,S=Object(u.l)(h),j=S.viewState;let P={downloadUrl:w.url,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:{Id:a,RootItemId:a,mailboxInfo:e.mailboxInfo},fileName:w.fileName};const T=je(y.b.Image,t,"PreviewBeautifulLinkImageInSxS"),C=()=>{T.addCustomData({autoHide:!0})};j.eventManager.on($.a,C);const x={id:Object(W.a)(),attachmentId:null};let E,A=[];try{if(t===u.b.ComposeDocLink&&d)E=Object(f.b)(d),A=await Object(Oe.a)(E,d);else{if(t!==u.b.ReadingPaneDocLink||!d)throw Error("Unexpected error regarding SelectionSource and/or linksContainerId");{const t=null===(b=Object(s.b)())||void 0===b?void 0:b.itemPartsMap;if(t){for(let n of t.values())if(n.itemId===e.Id){E=n.attachmentWell;break}}else E=null===(m=Object(s.c)(e.Id))||void 0===m?void 0:m.itemViewState.attachmentWell;A=await Object(Oe.a)(E,d)}}}catch(e){Y.h.warn(`Error generating ImageGallery to Preview BeautifulLink: ${e}`)}I(x,h);try{await g.canCloseSxS(h),k(),i(n,t,t===u.b.ReadingPaneDocLink?e:null,r,h,p),v.setPreviewLoading(j,"",P),v.setImagePreviewState(j,w.previewUrl,A,!0,!1,P);const c=()=>t===u.b.ReadingPaneDocLink?l:S.shouldShow?null:l;g.showSxS(c(),{previewMode:y.b.Image,attachmentId:{Id:a,RootItemId:a,mailboxInfo:e.mailboxInfo},selectionSource:t,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:e,isDraft:!1},a,h),Object(u.L)(a,o),await g.waitForPreviewLoadOrThrowError(h),k(),O(h),T.end()}catch(e){T.endWithError(ae(e)?"UserError":"ServerError",e)}finally{j.eventManager.off($.a,C)}function k(){S.pendingPreviewOperation&&x.id===S.pendingPreviewOperation.id||ie("Preview changed before loading finished")}}var Pe=n(8049),Te=n(5862);async function Ce(e,t,n,r){var a,o,c;const s=(null===(o=null===(a=r)||void 0===a?void 0:a.ownerDocument)||void 0===o?void 0:o.defaultView)||window,d=s===window?"primaryTab":Object(Te.a)(s),f=s!==window;re.a.run(s,d);const b=Object(u.l)(d),m=await u.A.import(),p=await u.z.import();let w=await async function(e){var t,n;let r=null;if(Object(U.j)("mail-popout-projection"))if("IMG"===(null===(n=null===(t=e)||void 0===t?void 0:t.tagName)||void 0===n?void 0:n.toUpperCase())){r=(await Pe.b.import())(e)}else r=e;else if(e instanceof HTMLElement){r=(await Pe.b.import())(e)}else r=e;return r}(r);w||(w=b.viewState);const h={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},v={id:`${(new Date).getTime()}_${Math.floor(1e3*Math.random())}`,attachmentId:e.id};m(v,d);try{const r=await u.F.import(),a=await $.k.import(),o=null===(c=(await T.g.import())(e.id))||void 0===c?void 0:c.info.allowDownload;b.pendingPreviewOperation&&v.id===b.pendingPreviewOperation.id||ie("Preview changed before loading finished"),i({method:l.a.CopyMailReadingPaneContainer},u.b.ReadingPane,null,null,d,f),a(w,e.previewUrl,t,o,!o&&!Object(M.e)().printWithoutDownloadEnabled,h),r(b.shouldShow?null:u.f.Mail,{previewMode:y.b.Image,attachmentId:e.id,selectionSource:u.b.ReadingPane,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:n,isDraft:!1},null,d),Object(u.L)(null),p(d)}catch(e){}}var xe=n(10650);async function Ee(e,t,n,r,a,o,c,s,d=null,l=null,f=u.f.Mail){const b=(s=s||window)!==window,m=Object(u.k)(s);re.a.run(s,m);const p=e(),w=await $.u.import(),h=await u.G.import(),{onPreviewOperationStart:v,onPreviewOperationFinished:g}=h,I=Object(u.l)(m),O=I.viewState,S={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:d,openInNewTabUrl:l},j=je(y.b.Wac,n,"PreviewLinkInSxSE2E"),P=()=>{j.addCustomData({autoHide:!0})};d&&j.addCustomData({fileType:Object(xe.a)(d)}),O.eventManager.on($.a,P);const T={id:`${(new Date).getTime()}_${Math.floor(1e3*Math.random())}`,attachmentId:null};v(T,m);try{await h.canCloseSxS(m),C(),i(r,n,t,a,m,b),w.setPreviewLoading(O,"",S),h.showSxS(I.shouldShow?null:f,{previewMode:y.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:t,isDraft:!1},o,m),Object(u.L)(o,c);try{const e=await p;if(C(),e.jsApiInfo){const t=Object(W.a)();e.jsApiInfo.owaSessionId=t;const r=ne(n,!0);e.jsApiInfo.sessionOrigin=r,S.fileName=e.jsApiInfo.fileName,function(e,t,n){const r=Object(_.c)(t.fileName);e.addCustomData({useJsApi:"true",officeFileType:Object(B.a)(r),owaSessionId:t.owaSessionId,extraInfo:n}),e.addCosmosOnlyData(JSON.stringify({fileType:(null==r?void 0:r.substring(0,4))||""}))}(j,e.jsApiInfo,e.extraInfo)}w.setWacPreviewState(O,e.wacUrl,e.jsApiInfo,e.accessToken,e.accessTokenTtl,e.additionalParameters,e.deprecatedTokenAndParameters,(new Date).getTime(),c,S)}catch(e){const t=e;throw(null==t?void 0:t.errorMessage)?(w.setPreviewError(O,t.errorMessage),t.error):(w.setPreviewError(O,e.message||""+e),e)}await h.waitForPreviewLoadOrThrowError(m),C(),g(m),j.end()}catch(e){j.endWithError(ae(e)?"UserError":"ServerError",e)}finally{O.eventManager.off($.a,P)}function C(){I.pendingPreviewOperation&&T.id===I.pendingPreviewOperation.id||ie("Preview changed before loading finished")}}n.d(t,"previewAttachment",(function(){return Ie})),n.d(t,"previewAttachmentInSxS",(function(){return me})),n.d(t,"previewBeautifulLinkImageInSxS",(function(){return ye})),n.d(t,"previewImageInSxS",(function(){return Ce})),n.d(t,"previewLinkInSxS",(function(){return Ee})),n.d(t,"initializeItemReadingPaneInSxS",(function(){return d}))},598:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},606:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(14),i=n(3);const a={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},o=Object(i.createStore)("compose",a),c=o()},700:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},701:function(e,t,n){"use strict";function r(e){return null==e||0==e.trim().length}n.d(t,"a",(function(){return r}))},705:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemResponseShape:#Exchange"},e)}n.d(t,"a",(function(){return r}))},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(121),i=n(12);function a(){return Object(r.a)("acctmonaccounts")&&Object(i.i)("acctmonaccounts")}function o(){return a()||!Object(r.a)("acctmonaccounts")&&Object(i.i)("accountsapi")}},8049:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(4),n.e(17),n.e(20),n.e(25),n.e(26),n.e(27),n.e(29),n.e(33),n.e(41),n.e(47),n.e(50),n.e(54),n.e(94),n.e(124),n.e(312),n.e(564)]).then(n.bind(null,11066))),a=new r.b(i,e=>e.getSxSViewStateFromElement),o=Object(r.d)(i,e=>e.SxSLayerView);Object(r.d)(i,e=>e.SxSView)},807:function(e,t,n){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:t,timeBetweenRetryInMS:n}=e;return e=>{let r=0,i=!1;const a=(o,c)=>{i?c(new Error("The function retry was cancelled")):(r++,e().then(e=>o(e)).catch(e=>{t&&r>=t?c(e):setTimeout(()=>a(o,c),n(r))}))};return{retriableFunc:()=>new Promise((e,t)=>a(e,t)),cancel:()=>i=!0}}}function i(e){return t=>Math.pow(2,t)*e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},8301:function(e,t,n){"use strict";var r=n(32);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetAttachmentTextPreviewRequest:#Exchange"},n)),Object(r.a)("GetAttachmentTextPreview",e,t)}n.d(t,"a",(function(){return i}))},8845:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(20),i=n(5599);n.d(t,"a",(function(){return i.a}));const a=new r.c(()=>Promise.all([n.e(4),n.e(5),n.e(11),n.e(14),n.e(17),n.e(35),n.e(73),n.e(285),n.e(581)]).then(n.bind(null,12752))),o=new r.b(a,e=>e.addToCalendar),c=(new r.b(a,e=>e.getIcsCalendarItem),new r.b(a,e=>e.getIcsCalendarItemOrchestrator)),s=Object(r.d)(a,e=>e.IcsPreview)},910:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},912:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},913:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},929:function(e,t,n){"use strict";var r=n(606);function i(e){let t,n=Object(r.b)().viewStates.values();for(let r of n)if(r.linksContainerId===e){t=r.attachmentWell;break}return t}n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"b",(function(){return i}))},939:function(e,t,n){"use strict";var r=n(699);class i{constructor(e){this.maxSize=e,this.references=[],this.mruList=[]}initialize(e,t){if(!this.store){this.store=e,this.deleteCallback=t;for(let t of e.keys())this.mruList.push(t)}}add(e,t){Object(r.action)("MruCache_add")(()=>{this.store.set(e,t),this.mruList.indexOf(e)>=0?this.touch(e):(this.mruList.push(e),this.purgeIfNecessary())})()}get(e){return this.store.get(e)}getAndTouch(e){const t=this.store.get(e);return t&&this.touch(e),t}has(e){return this.store.has(e)}remove(e){Object(r.action)("MruCache_remove")(()=>{if(this.store.has(e)&&!this.isReferenced(e))return this.removeItemAtIndex(this.mruList.indexOf(e))})()}registerReference(e){this.references.push(e)}clear(){Object(r.action)("MruCache_clear")(()=>{this.purgeTillSize(0)})()}getItemIds(){return new Array(...this.mruList)}touch(e){let t=this.mruList.indexOf(e);if(t<0)throw new Error(`Item with key '${e}' does not exist in the cache.`);this.mruList.splice(t,1),this.mruList.push(e)}purgeIfNecessary(){this.purgeTillSize(this.maxSize)}purgeTillSize(e){let t=0;for(;this.mruList.length>e&&t<this.mruList.length;){let e=this.mruList[t];this.isReferenced(e)?t++:this.removeItemAtIndex(t)}}removeItemAtIndex(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);let t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)}isReferenced(e){for(let t=0;t<this.references.length;t++){const n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1}}n.d(t,"a",(function(){return i}))},954:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},955:function(e,t,n){"use strict";var r=n(32);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.512.js.map
self.scriptsLoaded['owa.512.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.512.js'] = (new Date()).getTime();