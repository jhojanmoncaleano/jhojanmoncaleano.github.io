self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.543.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[543,2033],{10312:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(44);function o(t,e,n,o,c,i,a){const u=/([?&])access_token=([^&]+)/;Object(r.j)("doc-SxS-useNewAccessToken")?u.test(e)&&(e=e.replace(u,"$1")):(n=null,u.test(e)&&(n=decodeURIComponent(e.match(u)[2]),e=e.replace(u,"$1"))),e+="&hh=1",e+="&mscc=1",e+="&sdr=1",e+="&uiembed=1",e+="&wdorigin=OWA-SXS",e+="&accloop=1",a&&(e+="&uih=owalegacy",Object(r.j)("doc-SxS-jsApi-ODB-Basecf")&&(e+="&wdOwaUnifiedFlight=0")),t.onload=()=>{t.onload=null;const a=t.contentDocument;if(!a.body){const t=a.createElement("div"),e=a.createElement("body");e.appendChild(t),a.appendChild(e)}const u=a.createElement("form");if(u.action=e,u.method="POST",u.style.visibility="hidden",n){const t=a.createElement("input");t.type="hidden",t.name="access_token",t.value=n,u.appendChild(t)}if(o>0){o<Date.UTC(2020,1,1,0,0,0)&&(o=Number(o)+(new Date).getTime());const t=a.createElement("input");t.type="hidden",t.name="access_token_ttl",t.value=o.toString(),u.appendChild(t)}if(Object(r.j)("doc-SxS-useNewAccessToken")){if(c){const t=c.split("&");for(let e=0;e<t.length;e++){const n=t[e].split("=");if(2===n.length){const t=a.createElement("input");t.type="hidden",t.name=n[0],t.value=decodeURIComponent(n[1]),u.appendChild(t)}}}}else if(i){const t=i.split("&");for(let e=0;e<t.length;e++){const n=t[e].split("=");if(2===n.length){const t=a.createElement("input");t.type="hidden",t.name=n[0],t.value=decodeURIComponent(n[1]),u.appendChild(t)}}}a.body.appendChild(u),u.submit()},t.src="about:blank"}},10313:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(8301),o=n(40);async function c(t,e,n,c){const i={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."};try{if(c){const t="getAttachmentTextPreview"+c;(e=e||{}).headers=e.headers||new Headers,e.headers.set("X-OWA-ActionName",t)}const o=await Object(r.a)({AttachmentId:t,ReadMode:n},e);if(o&&0===o.Status)return o.Content;{const t=(null==o?void 0:o.Status)||1;switch(t){case 2:i.errorMessage="The attachment has been moved or deleted.";break;case 3:i.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:i.errorMessage="Something went wrong while the document preview was being created. Please try again later."}i.error=new Error(`getAttachmentTextPreview failed with status: ${t}`)}}catch(t){o.h.warn(`getAttachmentTextPreview failed with error: ${t}`),i.error=t}throw i}},15851:function(t){t.exports=JSON.parse('{"b":"IYb","c":"JYb","a":"KYb"}')},15852:function(t){t.exports=JSON.parse('{"a":"$ba"}')},1686:function(t,e,n){"use strict";var r=n(3);const o=Object(r.action)("initializeOwaObservableDateTime"),c=Object(r.action)("observableNowChanged"),i=Object(r.action)("observableTodayChanged");var a=n(7),u=n(14),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0});const d=Object(u.computed)(()=>Object(a.qc)(s().now)),l=()=>d.get(),f=Object(u.computed)(()=>Object(a.qc)(s().today)),b=()=>f.get(),O=t=>Object(a.Jb)(t,l()),j=t=>Object(a.Hb)(t,l()),v=t=>p(t,a.Jb),m=t=>p(t,a.Kb),p=(t,e)=>e(Object(a.bc)(Object(a.qc)(t)),b());function w(t){if(!t)return"";const e=Object(a.qc)(t);return function(t,e){const n=Object(a.bc)(t);if(Object(a.Lb)(n,e))return a.ab;const r=t=>Object(a.Rb)(n,Object(a.e)(e,-t),e);if(r(3))return a.ib;if(r(30))return a.hb;return a.Y}(e,b())(e)}function S(t){if(!t)return"";const e=Object(a.qc)(t);return function(t,e){const n=Object(a.bc)(t);if(Object(a.Lb)(n,e))return a.T;return a.U}(e,b())(e)}function h(t){if(!t)return"";return function(t,e){const n=Object(a.bc)(t);return Object(a.Lb)(n,e)?Object(a.ab)(t):I(n,e,2)?Object(a.lb)(t):I(n,e,7)?Object(a.H)(Object(a.bb)(t),Object(a.ab)(t)):Object(a.H)(Object(a.J)(t),Object(a.ab)(t))}(Object(a.qc)(t),b())}function I(t,e,n){return Object(a.Rb)(t,Object(a.e)(e,-n),e)}const g=Object(r.action)("updateTimes"),y=Object(r.action)("setNow"),x=Object(r.action)("setToday",t=>({today:t}));Object(r.mutator)(y,()=>{s().now=Object(a.oc)()}),Object(r.mutator)(x,({today:t})=>{s().today=t});var A=n(22),k=n(75);let T=!1;Object(r.orchestrator)(o,()=>{if(g(),!T){const t=Object(a.Ub)(),e=Object(a.dc)(Object(a.h)(t,1)),n=Object(a.w)(e,t);setTimeout(()=>setInterval(g,A.g),n),document&&document.addEventListener("visibilitychange",g),T=!0}}),Object(r.orchestrator)(k.m,()=>{g()}),Object(r.orchestrator)(g,()=>{y();const t=Object(a.Cb)(Object(a.pc)()),e=s().today!=t;e&&x(t),c(),e&&i()}),n.d(e,"d",(function(){return o})),n.d(e,"j",(function(){return c})),n.d(e,"l",(function(){return i})),n.d(e,"i",(function(){return l})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return O})),n.d(e,"e",(function(){return j})),n.d(e,"f",(function(){return v})),n.d(e,"h",(function(){return m})),n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return S})),n.d(e,"c",(function(){return h}))},1715:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach(n=>t.set(n,e[n]))}function o(t){let e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},1718:function(t,e,n){"use strict";var r=n(1787),o=n(272),c=n(1686),i=n(61),a=n(7),u=n(40);const s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function b(t,e){const n={},b=Object(o.k)(t);if(e?(n[s]=e,n[f]=e):b&&(n[s]=b.anchorMailbox),Object(o.s)())return u.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(b){if(b.accountState==o.b.AccessRevoked)return null;if(b.accountState==o.b.AccountDeprovisioned||b.accountState==o.b.AccountNotFound)return Object(o.d)(b.accountState,b.accountProviderType),null}if(b){let e,o=b.token,s=Object(c.g)(b.tokenExpiry);!s&&o||(Object(i.o)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Ub)()),isTokenExpired_1:s,isTokenInvalid_2:!o},{isCore:!0}),o=await r.a.importAndExecute(b.accountId,t,o),u.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+t+o),o||(o="")),"Outlook"==b.accountProviderType?(e=`MSAuth1.0 usertoken="${o}", type="MSACT"`,n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType&&"Yahoo"!=b.accountProviderType||(e=`Bearer ${o}`,n[l]=2..toString()),n[d]=e}return n}var O=n(1715),j=n(914);async function v(t,e){var n;const r=Object(O.a)();if(r.headers=await async function(t,e){var n;const r=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,o=await b(t.mailboxInfo.userIdentity,m(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null);return Object(O.b)(r,o),r}(t,e),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},Object(o.s)()){const e=Object(j.a)(null===(n=null==t?void 0:t.mailboxInfo)||void 0===n?void 0:n.userIdentity);u.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+e),r.sourceId=e,r.datapoint.mailbox="Connected"}else r.datapoint.mailbox="Connected";return r}function m(t,e){const n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&u.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return m}))},1719:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"i",(function(){return c})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"g",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"h",(function(){return d})),n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return f}));var r=n(3);const o=Object(r.action)("ADD_SHARING_LINK",(t,e,n,r,o,c,i,a,u,s,d,l,f)=>({linkId:t,url:e,sharingLinkIds:n,response:r,source:o,providerType:c,linksContainerId:i,unwrappedUrl:a,creationDateTime:u,thumbnailUrl:s,previewUrl:d,shareId:l,fromQuotedBody:f})),c=Object(r.action)("SHARING_LINK_REMOVED",(t,e,n,r,o)=>({linkId:t,sharingLinkIds:e,fileName:n,providerType:r,linksContainerId:o})),i=Object(r.action)("DELETE_LINK",(t,e)=>({linkId:t,targetWindow:e})),a=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(t,e,n,r)=>({linkId:t,providerId:e,isTryAgain:n,targetWindow:r})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(t,e,n,r)=>({linkId:t,recipientInfos:e,composeId:n,isCalendar:r})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(t,e)=>({linkId:t,linkIdContainer:e})),d=Object(r.action)("REMOVE_SHARING_LINK_FROM_CONTAINER",(t,e)=>({linkId:t,linkIdContainer:e})),l=Object(r.action)("ON_FLUID_LINK_CREATED",(t,e,n,r,o)=>({linkId:t,containerId:e,owaSource:n,url:r,viewStateId:o})),f=Object(r.action)("ON_EXISTING_FLUID_LINK_PROCESSED",(t,e,n,r,o)=>({linkId:t,containerId:e,owaSource:n,url:r,viewStateId:o}))},1721:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("triggerReInitializeAccount",t=>({userIdentity:t}))},1779:function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return d}));var r=n(3);const o=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(t,e)=>({linkId:t,sharingDialogResponse:e})),c=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(t,e)=>({linkId:t,newPermission:e})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(t,e,n,r)=>({linkId:t,newLinkUrl:e,oldLinkUrl:n,expirationDate:r})),a=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(t,e)=>({linkId:t,actionStatus:e})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(t,e,n,r,o,c,i,a,u)=>({linkId:t,sharingUrl:e,currentUrl:n,canonicalUrl:r,newPermissionLevel:o,providerType:c,composeId:i,recipientInfos:a,isCalendar:u})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(t,e)=>({linkId:t,linkModel:e})),d=Object(r.action)("TOKEN_UNAVAILABLE",t=>({linkId:t}))},1787:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(20),o=n(1721);n.d(e,"b",(function(){return o.a}));const c=new r.c(()=>n.e(1045).then(n.bind(null,2021))),i=new r.a(c,t=>t.getAndUpdateAccessToken)},1802:function(t,e,n){"use strict";var r=n(20);const o={sequentialIndex:"0",nonSequentialIndex:"-1"};n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return o}));const c=new r.c(()=>Promise.all([n.e(9),n.e(10),n.e(12),n.e(13),n.e(693)]).then(n.bind(null,19539))),i=new r.a(c,t=>t.registerComponent),a=new r.a(c,t=>t.resetFocus),u=new r.a(c,t=>t.setFocusToSynchronous)},1826:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2082),o=n(1830);function c(t){const e=Object(r.a)(),n=Object(o.b)(t);return e.sharingLinks.get(n)}},1830:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var r=n(44);const o="_ODSPPSL";function c(t){return Object(r.j)("doc-link-savePermission")&&t&&-1!==t.indexOf(o)?t.substring(0,t.length-o.length):t}function i(t){return!!Object(r.j)("doc-link-savePermission")&&t.lastIndexOf(o)===t.length-o.length}function a(t,e){return!Object(r.j)("doc-link-savePermission")||2!==e&&1!==e?t:t+o}},1881:function(t,e,n){"use strict";var r,o=n(20),c=n(1719),i=n(1779),a=n(2158);!function(t){t.PasteHtml="PasteHtml",t.InsertLinkFromToolbar="InsertLinkFromToolbar",t.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",t.AutoLink="AutoLink",t.ReplyOrForward="ReplyOrForward",t.LinkContextMenu="LinkContextMenu",t.Undo="Undo",t.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",t.RestoreCursor="RestoreCursor",t.ShareLinkCompose="ShareLinkCompose",t.NewFluidFile="NewFluidFile",t.Unknown="Unknown"}(r||(r={}));var u=n(1944),s=n(2170),d=n(2121),l=n(1830),f=n(1826);const b=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function O(t){const e=Object(f.a)(t);return e&&-1!==b.indexOf(e.source)}var j=n(2114);function v(t){const e=Object(f.a)(t);return e?{id:e.linkId,name:e.fileName,supportsDownsell:!1,currentPermissionLevel:e.permissionLevel,sharingInfo:e.sharingInfo,sharingTipsIgnored:e.sharingTipsIgnored,sharingRecipientsInfo:e.sharingRecipientsInfo,typeOfLink:O(t)?"newLink":"oldLink"}:null}var m=n(2082);function p(){return Object(m.a)().sharingLinks.size}var w=n(2159);n.d(e,"t",(function(){return h})),n.d(e,"D",(function(){return I})),n.d(e,"K",(function(){return g})),n.d(e,"G",(function(){return y})),n.d(e,"E",(function(){return x})),n.d(e,"B",(function(){return A})),n.d(e,"H",(function(){return k})),n.d(e,"I",(function(){return T})),n.d(e,"J",(function(){return P})),n.d(e,"v",(function(){return E})),n.d(e,"s",(function(){return C})),n.d(e,"A",(function(){return L})),n.d(e,"u",(function(){return R})),n.d(e,"F",(function(){return M})),n.d(e,"C",(function(){return _})),n.d(e,"y",(function(){return N})),n.d(e,"x",(function(){return U})),n.d(e,"w",(function(){return D})),n.d(e,"z",(function(){return F})),n.d(e,"P",(function(){return S})),n.d(e,"d",(function(){return c.a})),n.d(e,"e",(function(){return c.b})),n.d(e,"f",(function(){return c.c})),n.d(e,"h",(function(){return c.d})),n.d(e,"R",(function(){return c.h})),n.d(e,"T",(function(){return c.i})),n.d(e,"M",(function(){return c.f})),n.d(e,"N",(function(){return c.g})),n.d(e,"L",(function(){return c.e})),n.d(e,"U",(function(){return i.e})),n.d(e,"V",(function(){return i.f})),n.d(e,"W",(function(){return i.g})),n.d(e,"S",(function(){return i.c})),n.d(e,"g",(function(){return i.b})),n.d(e,"Q",(function(){return a.b})),n.d(e,"a",(function(){return r})),n.d(e,"o",(function(){return u.a})),n.d(e,"q",(function(){return u.b})),n.d(e,"O",(function(){return s.a})),n.d(e,"c",(function(){return d.a})),n.d(e,"i",(function(){return l.a})),n.d(e,"j",(function(){return l.b})),n.d(e,"r",(function(){return l.c})),n.d(e,"p",(function(){return O})),n.d(e,"b",(function(){return j.a})),n.d(e,"m",(function(){return f.a})),n.d(e,"l",(function(){return v})),n.d(e,"k",(function(){return p})),n.d(e,"n",(function(){return w.a}));const S=new o.c(()=>Promise.all([n.e(0),n.e(26),n.e(94),n.e(643)]).then(n.bind(null,19118))),h=new o.b(S,t=>t.addRecipientsIntoLink),I=new o.b(S,t=>t.removeRecipientsFromLink),g=new o.b(S,t=>t.updateRecipientPermissionInfos),y=new o.b(S,t=>t.setGetPermissionInfoFailure),x=new o.b(S,t=>t.resetSharingRecipientsInfo),A=new o.b(S,t=>t.ignoreSharingTip),k=new o.b(S,t=>t.setLinkActionStatus),T=new o.b(S,t=>t.updateLinkContainerIdOfLink),P=new o.b(S,t=>t.updateLinkIds),E=new o.b(S,t=>t.createLinksIdContainer),C=new o.b(S,t=>t.addLinkIdToLinksIdContainer),L=new o.b(S,t=>t.getSharingTipRecipientInfo),R=new o.b(S,t=>t.createCloudFileFromSharingLink),M=new o.b(S,t=>t.retrieveImageUrlsForImageFile),_=new o.b(S,t=>t.imageLinkPreviewCondition),N=new o.b(S,t=>t.getLinksIdContainer),U=new o.b(S,t=>t.getAllLinksContainerIds),D=new o.b(S,t=>t.doesLinksIdContainerExist),F=new o.b(S,t=>t.getSharingLinkInfo)},19110:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"clear",(function(){return Et})),n.d(r,"add",(function(){return Ct})),n.d(r,"contains",(function(){return Lt}));var o=n(2184),c=n(3);const i=Object(c.action)("closeComposeInSxS",t=>({composeViewState:t})),a=Object(c.action)("editAndReply",(t,e,n,r)=>({loadDraftToCompose:t,createReply:e,trySaveAndCloseCompose:n,sxsId:r})),u=Object(c.action)("editInDraft",(t,e)=>({loadDraftToCompose:t,sxsId:e})),s=Object(c.action)("forceCloseSxS",(t,e,n)=>({closingSource:t,sxsId:e,shouldCloseWindow:n})),d=Object(c.action)("openComposeInSxS",(t,e)=>({composeId:t,sxsId:e})),l=Object(c.action)("tryCloseSxS",(t,e)=>({closingSource:t,sxsId:e})),f=Object(c.action)("tryExitSxSEditMode",t=>({sxsId:t})),b=Object(c.action)("onPreviewOperationStart",(t,e)=>({pendingPreviewOperation:t,sxsId:e})),O=Object(c.action)("onPreviewOperationFinished",t=>({sxsId:t})),j=Object(c.action)("onPendingNavigation",(t,e)=>({attachmentId:t,sxsId:e})),v=Object(c.action)("onChangeByImageGallery",t=>({sxsId:t})),m=Object(c.action)("onShowCustomPreview",(t,e)=>({customPreviewState:t,sxsId:e})),p=Object(c.action)("saveToCloud",(t,e)=>({entryPoint:t,sxsId:e})),w=Object(c.action)("openSxSInANewWindow",(t,e,n,r)=>({parentItemId:t,attachmentId:e,isEdit:n,startTime:r})),S=Object(c.action)("reloadTextPreview",(t,e)=>({readMode:t,sxsId:e}));var h=n(2209);function I(t){const{composeId:e,sxsId:n}=t;Object(h.a)(n).composeId=e}function g(t){const{customization:e,sxsId:n}=t;null!=e&&(Object(h.a)(n).customization=e)}Object(c.mutator)(d,I),Object(c.mutator)(o.d,I),Object(c.mutator)(o.h,g),Object(c.mutator)(o.e,g),Object(c.mutator)(m,t=>{const{customPreviewState:e,sxsId:n}=t;Object(h.a)(n).customPreviewState=e});const y=Object(c.action)("onEditModeChange",(t,e,n)=>({mode:t,itemId:e,sxsId:n})),x=Object(c.action)("onImageGalleryItemUpdatePreviewUrl",(t,e)=>({imageGalleryItem:t,previewUrl:e})),A=Object(c.action)("onAttachmentIdUpdate",(t,e)=>({attachmentId:t,sxsId:e})),k=Object(c.action)("internalCloseSxS",(t,e)=>({sxsId:t,shouldCloseWindow:e})),T=Object(c.action)("setSaveToCloudStatus",(t,e,n)=>({saveToCloudStatus:t,attachmentId:e,sxsId:n})),P=Object(c.action)("onInvisibilityChange",(t,e)=>({invisible:t,sxsId:e})),E=Object(c.action)("onShouldUseFakeRightHandSideChange",(t,e)=>({shouldUseFakeRightHandSide:t,sxsId:e})),C=Object(c.action)("onUsingFakeRightHandSideChange",(t,e)=>({isUsingFakeRightHandSide:t,sxsId:e})),L=Object(c.action)("updateSigsInfo",(t,e)=>({sigsInfo:t,sxsId:e}));var R=n(3168);Object(c.mutator)(o.h,t=>{const{editState:e,sxsId:n}=t;Object(h.a)(n).editState=Object.assign({mode:R.a.View},e)}),Object(c.mutator)(k,t=>{const{sxsId:e}=t;Object(h.a)(e).editState={mode:R.a.View,editAllowed:!1,itemId:null,isDraft:!1}}),Object(c.mutator)(y,t=>{const{mode:e,itemId:n,sxsId:r}=t,o=Object(h.a)(r);o.editState.mode=e,o.editState.itemId=n});var M=n(1932),_=n(1829),N=n(209),U=n(5),D=n(2292),F=n(266),V=n(1859),W=n(3663),B=n(7449);function H(t,e){var n,r;const o=Object(V.l)(e).readingPaneState;if(o){const c=o.mode;switch(c){case V.h.ConversationReadingPane:const i=(null===(r=null===(n=Object(V.l)(e))||void 0===n?void 0:n.editState)||void 0===r?void 0:r.itemId)?Object(V.l)(e).editState.itemId:null;return function(t,e,n){if(!n)return null;const r=B.a.run(t,n.Id);if(r){const t=Object(W.a)(r,e);if(t)return t}return null}(o.conversationId.Id,t,i);case V.h.ItemReadingPane:return function(t,e){var n;if(!e)return null;if(null===(n=e.itemReadingPaneViewState)||void 0===n?void 0:n.itemViewState){const n=e.itemReadingPaneViewState.itemViewState.attachmentWell;if(n){const e=Object(W.a)(n,t);if(e)return e}}return null}(t,o);default:return Object(F.a)(c)}}return null}var G=n(1822);Object(c.mutator)(o.h,t=>{const{extendedViewState:e,sxsId:n}=t;Object(h.a)(n).extendedViewState=e}),Object(c.mutator)(k,t=>{const{sxsId:e}=t;Object(h.a)(e).extendedViewState={previewMode:M.b.Unsupported,attachmentId:null,selectionSource:M.c.MailList,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0}}),Object(c.mutator)(v,t=>{var e;const{sxsId:n}=t,r=Object(h.a)(n);if(r.viewState.previewPane.mode===D.d.Image){const t=_.g.tryImportForRender();if(t){const o=r.viewState.previewPane.id,c=t(o);r.extendedViewState.attachmentId=o,r.extendedViewState.isCloudy=(null==c?void 0:c.model)&&Object(G.a)(c.model);let i=!1;if((null==c?void 0:c.model)&&!c.model.IsInline){const t=H(o,n);i=(null===(e=null==t?void 0:t.strategy)||void 0===e?void 0:e.isSaveToCloudSupported)&&Object(U.k)(c.model.AttachmentOriginalUrl)}const a=i?1:0;r.extendedViewState.saveToCloudStatus=a}}}),Object(c.mutator)(A,t=>{const{attachmentId:e,sxsId:n}=t;Object(h.a)(n).extendedViewState.attachmentId=e}),Object(c.mutator)(T,t=>{const{attachmentId:e,saveToCloudStatus:n,sxsId:r}=t,o=Object(h.a)(r);Object(N.e)(o.extendedViewState.attachmentId,e)&&(o.extendedViewState.saveToCloudStatus=n)}),Object(c.mutator)(S,t=>{const{readMode:e,sxsId:n}=t;Object(h.a)(n).extendedViewState.textPreviewReadMode=e}),Object(c.mutator)(x,t=>{const{imageGalleryItem:e,previewUrl:n}=t;e.previewUrl=n}),Object(c.mutator)(o.h,t=>{Object(h.a)(t.sxsId).isInvisible=!1}),Object(c.mutator)(P,t=>{const{invisible:e,sxsId:n}=t;Object(h.a)(n).isInvisible=e});var z=n(1692),$=n(2322);Object(c.mutator)(o.h,({extendedViewState:t,sxsId:e})=>{if(null==t?void 0:t.attachmentId){const n=Object(z.v)(t.attachmentId.Id);Object(h.a)(e).meetingMessageAddToCalendarStatus=n&&!Object($.b)(n)?0:1}}),Object(c.mutator)($.h,({status:t,sxsId:e})=>{Object(h.a)(e).meetingMessageAddToCalendarStatus=t}),Object(c.mutator)(j,t=>{const{attachmentId:e,sxsId:n}=t;Object(h.a)(n).pendingNavigation=e?{toAttachmentId:{Id:e,mailboxInfo:null},triggerTime:(new Date).getTime()}:null}),Object(c.mutator)(b,t=>{const{sxsId:e}=t;Object(h.a)(e).pendingNavigation=null}),Object(c.mutator)(b,t=>{const{pendingPreviewOperation:e,sxsId:n}=t;Object(h.a)(n).pendingPreviewOperation=e}),Object(c.mutator)(O,t=>{const{sxsId:e}=t;Object(h.a)(e).pendingPreviewOperation=null}),Object(c.mutator)(k,t=>{const{sxsId:e}=t;Object(h.a)(e).pendingPreviewOperation=null}),Object(c.mutator)(o.g,t=>{const{readingPaneState:e,sxsId:n}=t;Object(h.a)(n).readingPaneState=e});var q=n(797),K=n(1071),J=n(5757);Object(c.mutator)(o.h,t=>{const{sxsId:e}=t,n=Object(h.a)(e);n.shouldShow||(n.shouldShow=!0,n.sessionStartTime=(new Date).getTime()),n.sessionPreviewCount++}),Object(c.mutator)(k,t=>{const{sxsId:e,shouldCloseWindow:n}=t,r=Object(q.c)(e),o=Object(h.a)(e);if(o.shouldShow=!1,o.sessionPreviewCount=0,n){const t=Object(K.a)(r);Object(J.a)(t)}}),Object(c.mutator)(L,t=>{const{sigsInfo:e,sxsId:n}=t;Object(h.a)(n).sigsInfo=e});var Y=n(2492);Object(c.mutator)(o.a,t=>{var e;const{sxsId:n,newSxSId:r}=t,o=Object(h.a)(n),c=Object(Y.a)(o);if(null===(e=null==o?void 0:o.viewState)||void 0===e?void 0:e.previewPane){o.viewState.previewPane.imageGallery&&(c.viewState.previewPane=JSON.parse(JSON.stringify(o.viewState.previewPane)))}Object(h.b)().sxsStoreMapping.set(r,c)});var X=n(44),Q=n(1881),Z=n(2702);Object(c.mutator)(o.h,t=>{const{sxsId:e}=t;Object(h.a)(e).viewState.minRightPaneWidth=420}),Object(c.mutator)(k,t=>{const{sxsId:e}=t,n=Object(h.a)(e);n.viewState.rightPaneDisplay=D.f.Initial,n.viewState.didAutoHideRightPane=!1}),Object(c.mutator)(v,t=>{var e;const{sxsId:n}=t,r=Object(h.a)(n);if(r.viewState.previewPane.mode===D.d.Image){const t=r.viewState.previewPane.id,n=t.Id.indexOf(Z.d)>=0;if((Object(X.j)("doc-deprecateCloudy-preview")||Object(X.j)("doc-deprecateCloudy-preview-thumbnailView"))&&n){const e=Object(Q.m)(t.Id),n=null==e?void 0:e.fileName;n&&(r.viewState.previewPane.fileName=n)}else{const n=_.g.tryImportForRender(),o=null==n?void 0:n(t),c=null===(e=null==o?void 0:o.model)||void 0===e?void 0:e.Name;c&&(r.viewState.previewPane.fileName=c)}}}),Object(c.mutator)(o.h,t=>{const{sxsId:e}=t,n=Object(h.a)(e);n.shouldUseFakeRightHandSide=!1,n.isUsingFakeRightHandSide=!1}),Object(c.mutator)(E,t=>{const{shouldUseFakeRightHandSide:e,sxsId:n}=t;Object(h.a)(n).shouldUseFakeRightHandSide=e}),Object(c.mutator)(C,t=>{const{isUsingFakeRightHandSide:e,sxsId:n}=t;Object(h.a)(n).isUsingFakeRightHandSide=e});var tt=n(3169),et=n(4561),nt=n(2112);Object(c.orchestrator)(i,t=>{var e,n;const{composeViewState:r}=t,c=Object(et.a)(r.composeId);if(Object(tt.c)(r,c)){let t=!1;const i=Object(h.a)(c);r&&r.composeId===i.composeId&&(Object(o.d)(null,c),i.readingPaneState||(t=!0));const a=null==r?void 0:r.itemId,u=null===(e=i.editState)||void 0===e?void 0:e.itemId;if(a&&u&&a.Id===u.Id&&(t=!0),t){const t=Object(q.c)(c),e=((null===(n=Object(nt.a)(t))||void 0===n?void 0:n.window)||window)!==window;s("closeCompose",c,e)}}});var rt=n(5175),ot=n(5157),ct=n(4067),it=n(10312),at=n(1724),ut=n(311),st=n(3915),dt=n(32);function lt(t,e){var n;return void 0===t||t.__type||(n=t,t=Object.assign({__type:"SynchronizeWacAttachmentRequest:#Exchange"},n)),Object(dt.a)("SynchronizeWacAttachment",t,e)}var ft,bt=n(40);async function Ot(t,e){try{switch((await lt({AttachmentId:t},e)).Result){case 0:return ft.Success;case 1:return ft.Busy;default:return bt.d("synchronizeWacAttachment: unexpected value of SynchronizeWacAttachmentResult"),ft.Failed}}catch(t){return bt.h.warn("synchronizeWacAttachment failed"),ft.Failed}}!function(t){t[t.Success=0]="Success",t[t.Busy=1]="Busy",t[t.Failed=2]="Failed"}(ft||(ft={}));var jt=n(4562),vt=n(3728),mt=n(61),pt=n(1738);const wt=Object.freeze({0:"WacEdit",1:"WacEditAndReply"});function St(t,e,n){const r=Object(pt.a)(t);if(!r)return;const o=Object(at.d)(r.model.Name||"")||r.model.ContentType||"";Object(mt.o)(wt[e],[o,1===r.type?"cloudy":"classic"])}var ht=n(15851),It=n(700);async function gt(t,e,n,r,o){var c;const i=Object(h.a)(t);if(T(0,i.extendedViewState.attachmentId,t),St(i.extendedViewState.attachmentId,1,M.c[i.extendedViewState.selectionSource]),i.extendedViewState.attachmentId){(await D.o.import())(i.viewState,i.extendedViewState.isCloudy?Object(U.b)(ht.b):Object(U.b)(ht.c))}y(R.a.EnteringEdit,i.editState.itemId,t);let a=null,u=!0;try{if((null===(c=i.readingPaneState)||void 0===c?void 0:c.mode)===jt.a.ConversationReadingPane){const t=i.readingPaneState.conversationId;a=await o(t.Id,i.composeId)}a||(u=!1,a=await r(i.editState.itemId))}catch(e){(await D.n.import())(i.viewState,Object(U.b)(ht.a)),y(R.a.View,i.editState.itemId,t)}a&&(i.extendedViewState.attachmentId?await yt(t,a,i.extendedViewState.attachmentId,!0,e,n,u?void 0:1,()=>{u||At(a)}):function(t,e,n,r,o){const c=Object(h.a)(t);y(R.a.Edit,e,t),c.composeId||n(e,t,r)}(t,a,n,u?void 0:1)),i.eventManager.emit(vt.EnteredEditModeEvent,i.editState.mode===R.a.Edit)}async function yt(t,e,n,r,o,c,i,a){var u;const s=Object(h.a)(t);let d;try{if(d=await async function t(e,n,r){let o=await Object(ot.a)(e.Id,!0,n?n.Id:null,Object(It.a)(e.mailboxInfo),r);if((null==o?void 0:o.IsConversion)&&0===o.Status){const n=document.createElement("iframe");try{n.style.borderWidth="0",n.style.position="absolute",n.style.width=n.style.height="1px",document.body.appendChild(n),Object(it.a)(n,o.WacUrl,o.AccessToken,o.AccessTokenTtl,o.AdditionalParameters,o.Token),await Ot(o.AttachmentId.Id,Object(It.a)(e.mailboxInfo))}finally{document.body.removeChild(n)}o=await t(Object.assign(Object.assign({},o.AttachmentId),{mailboxInfo:e.mailboxInfo}),null,r)}return o}(n,r?e:null,M.c[s.extendedViewState.selectionSource]),0!==d.Status)return void xt(t,a,d.Status)}catch(e){return void xt(t,a,1)}r&&A(Object.assign(Object.assign({},d.AttachmentId),{mailboxInfo:null}),t);let l,f,b=!1;if(Object(X.j)("doc-SxS-jsApi-ODB-Readonly")){const t=(await _.g.import())(n);if(t){const e=t.model.Name,n=t;if(l=Object(X.j)("doc-unwrap-safelinks")?n.originalUrl:n.openUrl,f=t.model.Size,l&&e){const t=e.substring(e.lastIndexOf(".")),n=Object(at.f)(t);b=n==at.a.Word||n==at.a.Excel}}}const O=await D.s.import();if(b){const e=await Object(ct.a)(0,l,!0,!0);if(!e)return void xt(t,a,1);O(s.viewState,e.openWith.wac.applicationUrl,{bootScriptUrl:e.openWith.wac.bootstrapperUrl,wopiSrcUrl:e.openWith.wac.wopiSrc,accessToken:e.openWith.wac.accessToken,accessTokenExpiry:e.openWith.wac.accessTokenExpiry,fileSize:f,fileGetUrl:e.openWith.wac.fileGetUrl,bundleInfo:e.officeBundle,fetchStartTime:e.fetchStartTime,responseStartTime:e.responseStartTime,openUrl:l,owaSessionId:Object(ut.a)(),userId:e.openWith.wac.userId,clientThrottlingProtection:e.openWith.wac.clientThrottlingProtection,requestedCallThrottling:e.openWith.wac.requestedCallThrottling,irmEnabled:null===(u=e.sensitivityLabel)||void 0===u?void 0:u.protectionEnabled},null,null,null,null,o.getTime(),e.currentUserRole.readOnly,s.viewState.previewPane)}else O(s.viewState,d.WacUrl,null,d.AccessToken,d.AccessTokenTtl,d.AdditionalParameters,d.Token,o.getTime(),null,s.viewState.previewPane);y(R.a.Edit,e,t),s.composeId||c(e,t,i)}async function xt(t,e,n){const r=Object(h.a)(t);null==e||e(),(await D.n.import())(r.viewState,Object(rt.a)(n)),y(R.a.View,r.editState.itemId,t)}function At(t){t&&Object(st.a)([t],"HardDelete",Object(It.a)(t.mailboxInfo))}Object(c.orchestrator)(a,t=>{const{loadDraftToCompose:e,createReply:n,trySaveAndCloseCompose:r,sxsId:o}=t;gt(o,new Date,e,n,r)}),Object(c.orchestrator)(u,t=>{const{loadDraftToCompose:e,sxsId:n}=t;!async function(t,e,n){const r=Object(h.a)(t);St(r.extendedViewState.attachmentId,0,M.c[r.extendedViewState.selectionSource]),(await D.o.import())(r.viewState,""),y(R.a.EnteringEdit,r.editState.itemId,t),await yt(t,r.editState.itemId,r.extendedViewState.attachmentId,!1,e,n,null,null),r.eventManager.emit(vt.EnteredEditModeEvent,r.editState.mode===R.a.Edit)}(n,new Date,e)});var kt=n(8771);var Tt=n(7815);const Pt=[];function Et(){Pt.splice(0,Pt.length)}function Ct(t){Pt.push(t)}function Lt(t){return-1!==Pt.indexOf(t)}var Rt=n(2577),Mt=n(1802),_t=n(993),Nt=n(149),Ut=n(2988);function Dt(t){var e;const n=null===(e=null==t?void 0:t.document)||void 0===e?void 0:e.getElementById(Ut.b);n&&(Nt.unmountComponentAtNode(n),n.parentNode&&n.parentNode.removeChild(n))}var Ft=n(121);function Vt(t){return new Promise(e=>setTimeout(e,t))}async function Wt(t){if(Object(Ft.a)("floodgate")){(await Rt.b.import())(t)}}async function Bt(t,e,n){var r,c,i;const a=Object(h.a)(e),u=(null===(r=Object(nt.a)(Object(q.c)(e)))||void 0===r?void 0:r.window)||window;!function(t,e,n,r){const o=Object(kt.a)(r);Object(mt.o)("SxSClose",Object.assign(Object.assign({},o.customData),{closingSource:t}),{cosmosOnlyData:JSON.stringify(Object.assign(Object.assign({},o.cosmosOnlyData),{sessionLength:e,sessionPreviewCount:n}))})}(t,(new Date).getTime()-a.sessionStartTime,a.sessionPreviewCount,e),E(!0,e),await Vt(1),C(!0,e),await Vt(1),Object(o.g)(null,e);const s=a.composeId;s&&(Object(o.d)(null,e),Tt.a.run(s)),await Vt(1),P(!0,e);const d=new Promise(t=>{a.eventManager.once(vt.AnimationEndEvent,()=>{t()})});await Promise.race([d,Vt(500)]);const l=(null===(c=a.viewState)||void 0===c?void 0:c.previewPane)&&a.viewState.previewPane.mode===D.d.Wac,f=null===(i=a.extendedViewState)||void 0===i?void 0:i.isCloudy,b=Object(X.j)("doc-SxS-jsApi-ODB-Base")||Object(X.j)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(X.j)("doc-SxS-jsApi-ODB-Basecf")||Object(X.j)("doc-SxS-jsApi-ODB-Readonly"),O=Object(X.j)("doc-SxS-jsApi-ODB-Links"),j=await D.g.import(),v=a.extendedViewState.selectionSource;j(a.viewState),k(e,n),Object(o.f)(null),Et(),a.eventManager.emit(vt.CloseEvent,v),await _t.b.importAndExecute(),Mt.b.importAndExecute(),l&&(!O||v!=M.c.ReadingPaneDocLink&&v!=M.c.ComposeDocLink?b&&f&&Wt("DocumentViewed"):Wt("LinkViewed")),Dt(u)}async function Ht(t){const{composeId:e,sxsId:n}=t,r=Object(h.a)(n);if(e&&(r.viewState.rightPaneDisplay===D.f.Hide||r.viewState.hideRightPane)){(await D.p.import())(r.viewState,D.f.Show)}}Object(c.orchestrator)(s,async t=>{const{closingSource:e,sxsId:n,shouldCloseWindow:r}=t;await Bt(e,n,r)}),Object(c.orchestrator)(d,Ht),Object(c.orchestrator)(o.d,Ht);var Gt=n(6181);Object(c.orchestrator)(w,t=>{let{parentItemId:e,attachmentId:n,isEdit:r,startTime:o}=t;if(!e||!n)throw new Error("parentItemId or attachmentId is null");Object(Gt.a)(e,n,r,o)});var zt=n(10313);Object(c.orchestrator)(S,async t=>{var e;const{readMode:n,sxsId:r}=t,o=await D.u.import(),c=Object(h.a)(r),i=(await _.g.import())(c.extendedViewState.attachmentId),a=null===(e=null==i?void 0:i.info)||void 0===e?void 0:e.allowDownload;try{const t=await Object(zt.a)(c.extendedViewState.attachmentId.Id,Object(It.a)(c.extendedViewState.attachmentId.mailboxInfo),n);o.setTextPreviewState(c.viewState,t,a,c.viewState.previewPane)}catch(t){const e=t;if(null==e?void 0:e.errorMessage)throw o.setPreviewError(c.viewState,e.errorMessage),e.error;throw t}});var $t=n(2697),qt=n(1975),Kt=n(5159),Jt=n(3325),Yt=n(4491),Xt=n(4208);const Qt=async(t,e,n)=>{const{entryPoint:r,sxsId:o}=t,c=new mt.b("AttachmentSaveToCloud"),i=Object(h.a)(o),a=i.extendedViewState.attachmentId,u=(await _.g.import())(a),s=u?u.model.Size:0,d={entryPoint:r,result:null,actionSource:M.c[i.extendedViewState.selectionSource]},l=H(a,o),f=Object(Jt.a)(u);c.addCosmosOnlyData(JSON.stringify({size:s,fileType:f})),l&&(Object(qt.B)(Object(qt.p)(l.attachmentId),.1,t=>{Object(qt.x)(l,t)},l.attachmentId),Object(qt.w)(l));T(2,a,o),Object(Yt.b)(a,null,o,t=>{d.result=t.ResultCode,c.addCustomData(d);const r=0===t.ResultCode;if(l&&(Object(qt.C)(l.attachmentId,r),Object(qt.v)(l,r,r?t.Item.Location:null,o)),0===t.ResultCode)T(3,a,o),Object(Kt.a)(a,t.Item.Location),c.end(),null==e||e();else{T(4,a,o);const e=new Error(`ResultCode: ${t.ResultCode} with exception: ${t.Exception}`);c.endWithError("ServerError",e),null==n||n(e)}return(async()=>{var t,e,n,r;const o=null===(e=null===(t=i.editState)||void 0===t?void 0:t.itemId)||void 0===e?void 0:e.Id,c=o&&Object(z.v)(o);$t.a.importAndExecute("SavedAttachment",{itemId:o&&await Object(Xt.a)(o),customProperties:{FileId:a.Id,FileType:f,Destination:"Cloud",Sender:null===(r=null===(n=(null==c?void 0:c.From)||(null==c?void 0:c.Sender))||void 0===n?void 0:n.Mailbox)||void 0===r?void 0:r.EmailAddress}})})(),!0},t=>{T(4,a,o),d.result=1,c.addCustomData(d);const e=new Error(t);c.endWithError("ServerError",e),null==n||n(e)})},Zt=async(t,e)=>new Promise((n,r)=>Qt({entryPoint:t,sxsId:e},n,r));Object(c.orchestrator)(p,Qt);var te=n(5983);var ee=async function(t){if(t){const e=(new Date).getTime()-t.startTime,n=t.itemId&&await Object(Xt.a)(t.itemId);$t.a.importAndExecute("PreviewedAttachment",{itemId:n,customProperties:{FileId:t.fileId,FileType:t.fileType,DwellTime:e,Sender:t.sender}})}};Object(c.orchestrator)(o.h,t=>{te.a.register(T);const{sigsInfo:e,sxsId:n}=t,r=Object(h.a)(n);r.sigsInfo&&ee(r.sigsInfo),L(e||null,n)}),Object(c.orchestrator)(l,async t=>{const{closingSource:e,sxsId:n}=t;await async function t(e,n){const r=Object(h.a)(e);r.viewState.previewPane&&(r.editState.mode===R.a.View?s(n,e):r.editState.mode===R.a.EnteringEdit?r.eventManager.once(vt.EnteredEditModeEvent,async()=>{await t(e,n)}):(r.editState.mode===R.a.Edit&&f(e),r.eventManager.once(vt.ExitedEditModeEvent,async r=>{r?await t(e,n):s(n,e)})))}(n,e)});var ne=n(7924),re=n(15852);async function oe(t){const e=Object(h.a)(t);for(;e.viewState.previewPane&&e.editState.mode!==R.a.View;){if(e.editState.mode!==R.a.EnteringEdit){return e.editState.mode===R.a.Edit&&f(t),await new Promise(t=>{e.eventManager.once(vt.ExitedEditModeEvent,e=>{t(e)})})}await new Promise(t=>{e.eventManager.once(vt.EnteredEditModeEvent,()=>{t()})})}return!0}async function ce(t,e){const n=[],r=await _.g.import(),o=await _.j.import();for(let c=0;c<t.length;c++){const i=e(t[c]);try{await o(i.attachmentId,!0)}catch(t){bt.h.warn(`Unable to refresh thumbnail image for ${i.attachmentId}. Got error ${t}`)}const a=r(i.attachmentId),u={downloadUrl:a.download.url,id:i.attachmentId,previewUrl:a.previewImage.url,thumbnailUrl:a.thumbnailImage.url};n.push(u)}return n}function ie(t,e){const n=Object(kt.a)(e);Object(mt.o)(t,n.customData,{cosmosOnlyData:JSON.stringify(n.cosmosOnlyData)})}async function ae(t){const e=t.id,n=await _.g.import();if(n(e)){const r=await _.i.import();await r(e,!0),x(t,n(e).previewImage.url)}}async function ue(t){const e=Object(h.a)(t);if(e.extendedViewState.isCloudy&&e.viewState.previewPane&&e.viewState.previewPane.mode===D.d.Wac&&!e.viewState.previewPane.jsApiInfo)return null;{let t=null,n=null,r=null;if(await new Promise(o=>{e.eventManager.once(vt.PreviewLoadOrErrorEvent,e=>{t=e.errorMessage,n=e.error,r=e.loadedInfo,o()})}),n)throw n;if(t)throw new Error(t);return r}}Object(c.orchestrator)(f,async t=>{const{sxsId:e}=t;await async function(t){const e=Object(h.a)(t);if(e.viewState.previewPane&&e.editState.mode===R.a.Edit&&e.viewState.previewPane.mode===D.d.Wac){if(e.extendedViewState.attachmentId){const n=e.viewState.previewPane,r={wacUrl:n.wacUrl,jsApiInfo:n.jsApiInfo,accessToken:n.accessToken,accessTokenTtl:n.accessTokenTtl,additionalParameters:n.additionalParameters,deprecatedTokenAndParameters:n.deprecatedTokenAndParameters};y(R.a.Saving,e.editState.itemId,t),(await D.o.import())(e.viewState,e.extendedViewState.isCloudy?Object(U.b)(re.a):Object(U.b)(ne.a));const o=e.extendedViewState.attachmentId;if(await Ot(o.Id,Object(It.a)(o.mailboxInfo))===ft.Success)y(R.a.View,e.editState.itemId,t);else{(await D.s.import())(e.viewState,r.wacUrl,r.jsApiInfo,r.accessToken,r.accessTokenTtl,r.additionalParameters,r.deprecatedTokenAndParameters,null,null,e.viewState.previewPane),y(R.a.Edit,e.editState.itemId,t)}}else{y(R.a.Saving,e.editState.itemId,t),(await D.o.import())(e.viewState,e.extendedViewState.isCloudy?Object(U.b)(re.a):Object(U.b)(ne.a)),y(R.a.View,e.editState.itemId,t)}e.eventManager.emit(vt.ExitedEditModeEvent,e.editState.mode!==R.a.Edit)}}(e)}),Object(c.orchestrator)(k,t=>{const{sxsId:e}=t;Object(o.b)();const n=Object(h.a)(e);n.sigsInfo&&(ee(n.sigsInfo),L(null,e))}),n.d(e,"canCloseSxS",(function(){return oe})),n.d(e,"createImageGalleryFromAttachmentViewStateIds",(function(){return ce})),n.d(e,"logUsageWithSxSCustomData",(function(){return ie})),n.d(e,"onBeforeImageGalleryItemSelected",(function(){return ae})),n.d(e,"waitForPreviewLoadOrThrowError",(function(){return ue})),n.d(e,"removeSxSViewFromDOM",(function(){return Dt})),n.d(e,"saveToCloudFromSxS",(function(){return Zt})),n.d(e,"showSxS",(function(){return o.h})),n.d(e,"closeComposeInSxS",(function(){return i})),n.d(e,"editAndReply",(function(){return a})),n.d(e,"editInDraft",(function(){return u})),n.d(e,"forceCloseSxS",(function(){return s})),n.d(e,"onChangeByImageGallery",(function(){return v})),n.d(e,"onPendingNavigation",(function(){return j})),n.d(e,"onPreviewOperationFinished",(function(){return O})),n.d(e,"onPreviewOperationStart",(function(){return b})),n.d(e,"onShowCustomPreview",(function(){return m})),n.d(e,"openComposeInSxS",(function(){return d})),n.d(e,"openSxSInANewWindow",(function(){return w})),n.d(e,"reloadTextPreview",(function(){return S})),n.d(e,"saveToCloud",(function(){return p})),n.d(e,"tryCloseSxS",(function(){return l})),n.d(e,"tryExitSxSEditMode",(function(){return f})),n.d(e,"repeatTracker",(function(){return r}))},1944:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return i}));var r=n(1699),o=n(44);function c(t){const e=(Object(r.a)(t)||"").toLowerCase();return!!t&&(Object(o.j)("cmp-prague")&&(".fluid"===e||".note"===e))}function i(t){const e=(Object(r.a)(t)||"").toLowerCase();return!!t&&(Object(o.j)("cmp-prague")&&".note"===e)}},1971:function(t,e,n){"use strict";var r=n(926),o=n(713),c=n(918),i=n(931),a=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Object(r.a)(e,Object(c.a)(t)),t=Object(o.a)(t);return e}:i.a;e.a=a},198:function(t,e,n){"use strict";var r=n(40);let o;function c(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var i=n(108);const a=500,u=[],s=[],d=[];let l=!0;function f(t,e){Object(r.g)((t,e,n)=>{l&&(e==r.b.Error&&s.push({message:t,error:n}),u.push({message:t,level:e}))}),t(O),e(O),c()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function b(t){const e=Object(i.a)(t);return l=!1,{traces:u,errors:s,network:d,usage:e}}function O(){l&&d.push(arguments)}n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return b})),n.d(e,"d",(function(){return i.b})),n.d(e,"c",(function(){return c}))},2082:function(t,e,n){"use strict";n.d(e,"b",(function(){return i}));var r=n(14),o=n(3);const c={sharingLinks:new r.ObservableMap({}),linksIdContainerMap:new r.ObservableMap({})},i=Object(o.createStore)("sharingLinkStore",c);e.a=i},2114:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.none=0]="none",t[t.refreshing=1]="refreshing",t[t.refreshFailed=2]="refreshFailed",t[t.refreshSucceeded=3]="refreshSucceeded",t[t.attachingAsACopy=4]="attachingAsACopy",t[t.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2121:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.linkIds=0]="linkIds",t[t.quotedBodyLinkIds=1]="quotedBodyLinkIds"}(r||(r={}))},2158:function(t,e,n){"use strict";function r(t){return void 0!==t.recipients}function o(t){return void 0!==t.length}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},2159:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2178),o=n(701),c=n(210);async function i(t){return function(t){if(!Object(o.a)(null==t?void 0:t.nav)){const e={nav:t.nav};return Object(c.stringify)(e)}return null}((await r.b.import())(t))}},2170:function(t){t.exports=JSON.parse('{"a":"$ja"}')},2178:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return d}));var r=n(20);const o=new r.c(()=>n.e(1355).then(n.bind(null,3023))),c=new r.b(o,t=>t.extractFileUrlFromOfficeSharePointLink),i=new r.b(o,t=>t.isLinkPrefixedWithBaseUrl),a=new r.b(o,t=>t.isSharePointLink),u=new r.b(o,t=>t.isSharePointServiceGeneratedLink),s=new r.b(o,t=>t.isOfficeSharePointLink),d=new r.b(o,t=>t.getParsedQueryStringFromUrl)},222:function(t,e,n){"use strict";var r=n(709),o="object"==typeof self&&self&&self.Object===Object&&self,c=r.a||o||Function("return this")();e.a=c},2222:function(t,e,n){"use strict";var r=n(930),o=n(1971),c=n(706);e.a=function(t){return Object(r.a)(t,c.a,o.a)}},2242:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},227:function(t,e,n){"use strict";e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},2457:function(t,e,n){"use strict";var r=n(459),o=n(2242),c=n(1053),i=n(915),a=n(552);var u=function(t,e){return t&&Object(i.a)(e,Object(a.a)(e),t)},s=n(706);var d=function(t,e){return t&&Object(i.a)(e,Object(s.a)(e),t)},l=n(966),f=n(965),b=n(918);var O=function(t,e){return Object(i.a)(t,Object(b.a)(t),e)},j=n(1971);var v=function(t,e){return Object(i.a)(t,Object(j.a)(t),e)},m=n(808),p=n(2222),w=n(800),S=Object.prototype.hasOwnProperty;var h=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&S.call(t,"index")&&(n.index=t.index,n.input=t.input),n},I=n(1044);var g=function(t,e){var n=e?Object(I.a)(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},y=/\w*$/;var x=function(t){var e=new t.constructor(t.source,y.exec(t));return e.lastIndex=t.lastIndex,e},A=n(354),k=A.a?A.a.prototype:void 0,T=k?k.valueOf:void 0;var P=function(t){return T?Object(T.call(t)):{}},E=n(967),C="[object Boolean]",L="[object Date]",R="[object Map]",M="[object Number]",_="[object RegExp]",N="[object Set]",U="[object String]",D="[object Symbol]",F="[object ArrayBuffer]",V="[object DataView]",W="[object Float32Array]",B="[object Float64Array]",H="[object Int8Array]",G="[object Int16Array]",z="[object Int32Array]",$="[object Uint8Array]",q="[object Uint8ClampedArray]",K="[object Uint16Array]",J="[object Uint32Array]";var Y=function(t,e,n){var r=t.constructor;switch(e){case F:return Object(I.a)(t);case C:case L:return new r(+t);case V:return g(t,n);case W:case B:case H:case G:case z:case $:case q:case K:case J:return Object(E.a)(t,n);case R:return new r;case M:case U:return new r(t);case _:return x(t);case N:return new r;case D:return P(t)}},X=n(968),Q=n(247),Z=n(502),tt=n(293),et="[object Map]";var nt=function(t){return Object(tt.a)(t)&&Object(w.a)(t)==et},rt=n(1021),ot=n(830),ct=ot.a&&ot.a.isMap,it=ct?Object(rt.a)(ct):nt,at=n(227),ut="[object Set]";var st=function(t){return Object(tt.a)(t)&&Object(w.a)(t)==ut},dt=ot.a&&ot.a.isSet,lt=dt?Object(rt.a)(dt):st,ft=1,bt=2,Ot=4,jt="[object Arguments]",vt="[object Function]",mt="[object GeneratorFunction]",pt="[object Object]",wt={};wt[jt]=wt["[object Array]"]=wt["[object ArrayBuffer]"]=wt["[object DataView]"]=wt["[object Boolean]"]=wt["[object Date]"]=wt["[object Float32Array]"]=wt["[object Float64Array]"]=wt["[object Int8Array]"]=wt["[object Int16Array]"]=wt["[object Int32Array]"]=wt["[object Map]"]=wt["[object Number]"]=wt[pt]=wt["[object RegExp]"]=wt["[object Set]"]=wt["[object String]"]=wt["[object Symbol]"]=wt["[object Uint8Array]"]=wt["[object Uint8ClampedArray]"]=wt["[object Uint16Array]"]=wt["[object Uint32Array]"]=!0,wt["[object Error]"]=wt[vt]=wt["[object WeakMap]"]=!1;e.a=function t(e,n,i,b,j,S){var I,g=n&ft,y=n&bt,x=n&Ot;if(i&&(I=j?i(e,b,j,S):i(e)),void 0!==I)return I;if(!Object(at.a)(e))return e;var A=Object(Q.a)(e);if(A){if(I=h(e),!g)return Object(f.a)(e,I)}else{var k=Object(w.a)(e),T=k==vt||k==mt;if(Object(Z.a)(e))return Object(l.a)(e,g);if(k==pt||k==jt||T&&!j){if(I=y||T?{}:Object(X.a)(e),!g)return y?v(e,d(I,e)):O(e,u(I,e))}else{if(!wt[k])return j?e:{};I=Y(e,k,g)}}S||(S=new r.a);var P=S.get(e);if(P)return P;S.set(e,I),lt(e)?e.forEach((function(r){I.add(t(r,n,i,r,e,S))})):it(e)&&e.forEach((function(r,o){I.set(o,t(r,n,i,o,e,S))}));var E=x?y?p.a:m.a:y?s.a:a.a,C=A?void 0:E(e);return Object(o.a)(C||e,(function(r,o){C&&(r=e[o=r]),Object(c.a)(I,o,t(r,n,i,o,e,S))})),I}},2492:function(t,e,n){"use strict";var r=n(2457),o=1,c=4;e.a=function(t){return Object(r.a)(t,o|c)}},2577:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return i}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(24),n.e(27),n.e(115),n.e(762)]).then(n.bind(null,4256))),c=new r.a(o,t=>t.loadAndInitializeFloodgateEngine),i=new r.b(o,t=>t.logFloodgateActivity)},2702:function(t,e,n){"use strict";const r="OLK_Beautified_",o="OLK_Beautified_Image",c="olkBeautifulLink",i="true",a="olkThumbnailViewLink",u="true";var s=n(3260),d=n(5);function l(t,e,n){return{name:Object(d.b)(s.a),key:"OpenInNewTab",iconProps:{iconName:"TabCenter"},onClick:()=>{(e||window).open(t,"_blank"),n&&n()}}}function f(t){var e;return"a"===t.tagName.toLowerCase()&&0===(null===(e=t.id)||void 0===e?void 0:e.indexOf(r))}function b(t){var e;return"a"===t.tagName.toLowerCase()&&0===(null===(e=t.id)||void 0===e?void 0:e.indexOf(o))}function O(t,e,n){return b(e)&&e.setAttribute(a,u),f(e)&&e.setAttribute(c,i),null}var j=n(44),v=n(1724);function m(t,e){return Object(j.j)("doc-deprecateCloudy-preview-thumbnailView")&&1===e&&Object(v.g)(t)}n.d(e,"a",(function(){return"owaAttachmentRemoveOnSend"})),n.d(e,"b",(function(){return"OWALink"})),n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return u})),n.d(e,"i",(function(){return"OWAAutoLink"})),n.d(e,"j",(function(){return"OWA"})),n.d(e,"k",(function(){return"OWAInsertLinkPlaceHolder"})),n.d(e,"l",(function(){return"x_OWAAutoLink"})),n.d(e,"m",(function(){return l})),n.d(e,"q",(function(){return O})),n.d(e,"n",(function(){return f})),n.d(e,"o",(function(){return b})),n.d(e,"p",(function(){return m}))},272:function(t,e,n){"use strict";var r,o=n(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var c=n(71);const i=Object(o.action)("addAccount",t=>({userIdentity:t.userIdentity,account:t})),a=Object(o.action)("removeAccount",t=>({userIdentity:t})),u=Object(o.action)("updateAccount",(t,e,n)=>({userIdentity:t,accountToken:e,accountTokenExpiresIn:n})),s=Object(o.action)("updateOWAConnectedAccountStatus",(t,e)=>({userIdentity:t,accountState:e})),d=Object(o.action)("connectedAccountIsInErrorState",(t,e)=>Object(c.b)({name:"connectedAccountIsInErrorState",customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})),l=Object(o.action)("connectedAccountsListRequested",t=>({isSuccess:t})),f=Object(o.action)("setAccountsStoreState",t=>({state:t}));var b,O=n(14);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(b||(b={}));var j=Object(o.createStore)("OWAAccountsStore",{accountsMap:new O.ObservableMap({}),accountsLoadedState:b.None}),v=n(266),m=n(49),p=n(914),w=n(946),S=n(550);function h(t){var e;if(Object(S.a)()){const n=Object(w.a)(Object(p.a)(t));if(n&&"OFFICE365"==(null===(e=n.mailbox)||void 0===e?void 0:e.mailboxType))return!1}else if(t==Object(m.b)())return!1;return void 0!==y(t)}var I=n(956);function g(){return[...j().accountsMap.values()]}function y(t){return j().accountsMap.get(t)}function x(){var t,e;return Object(S.a)()?(null===(t=g())||void 0===t?void 0:t.length)>1?g()[1]:null:(null===(e=g())||void 0===e?void 0:e.length)>0?g()[0]:null}function A(){return g().filter(t=>t.accountState!=r.Valid)}function k(t){return g().filter(e=>t.includes(e.accountState))}function T(t){return g().filter(e=>e.accountProviderType==t)}function P(t){return h(t)?y(t).accountProviderType:null}function E(t){return"Outlook"==t.accountProviderType?`MSAuth1.0 usertoken="${t.token}", type="MSACT"`:"Google"==t.accountProviderType||"ICloud"==t.accountProviderType||"Yahoo"==t.accountProviderType?`Bearer ${t.token}`:"Office365"==t.accountProviderType?(Object(I.a)(!1,"Office365 accounts should not use this function."),""):Object(v.a)(t.accountProviderType)}function C(t,e){return function(n){const r=y(n);return r?r[t]:e}}C("accountUniqueId","0");const L=C("accountState",r.Valid),R=()=>g().some(t=>!N(t.userIdentity)),M=C("accountProviderType",null),_=t=>"Outlook"==M(t),N=t=>L(t)==r.Valid,U=()=>g().length>0;function D(){return j().accountsLoadedState}var F=n(7),V=n(61);Object(o.mutator)(i,({account:t})=>{Object(V.o)("owaAccountAdded",{accountStatus_1:r[t.accountState]}),j().accountsMap.set(t.userIdentity,t)}),Object(o.mutator)(a,({userIdentity:t})=>{j().accountsMap.delete(t)}),Object(o.mutator)(u,({userIdentity:t,accountToken:e,accountTokenExpiresIn:n})=>{const r=j().accountsMap.get(t);r.token=e,r.tokenExpiry=Object(F.j)(Object(F.Ub)(),n)}),Object(o.mutator)(s,({userIdentity:t,accountState:e})=>{const n=j().accountsMap.get(t);n.accountState==r.Valid&&e!=r.Valid&&Object(V.o)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[e]}),n.accountState=e}),Object(o.mutator)(l,t=>{const e=t.isSuccess?b.AccountsLoadSuccessful:b.AccountsLoadError;j().accountsLoadedState=e}),Object(o.mutator)(f,t=>{j().accountsLoadedState=t.state}),n.d(e,"c",(function(){return i})),n.d(e,"v",(function(){return a})),n.d(e,"y",(function(){return u})),n.d(e,"x",(function(){return s})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return l})),n.d(e,"w",(function(){return f})),n.d(e,"n",(function(){return g})),n.d(e,"k",(function(){return y})),n.d(e,"i",(function(){return x})),n.d(e,"f",(function(){return A})),n.d(e,"g",(function(){return k})),n.d(e,"o",(function(){return T})),n.d(e,"j",(function(){return P})),n.d(e,"m",(function(){return E})),n.d(e,"l",(function(){return L})),n.d(e,"q",(function(){return R})),n.d(e,"u",(function(){return _})),n.d(e,"t",(function(){return N})),n.d(e,"p",(function(){return U})),n.d(e,"h",(function(){return D})),n.d(e,"r",(function(){return h})),n.d(e,"s",(function(){return S.a})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return b}))},293:function(t,e,n){"use strict";e.a=function(t){return null!=t&&"object"==typeof t}},311:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return i}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function c(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function i(t){return r.test(t)}},313:function(t,e,n){"use strict";var r,o=n(549),c=n(222).a["__core-js_shared__"],i=(r=/[^.]+$/.exec(c&&c.keys&&c.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var a=function(t){return!!i&&i in t},u=n(227),s=n(415),d=/^\[object .+?Constructor\]$/,l=Function.prototype,f=Object.prototype,b=l.toString,O=f.hasOwnProperty,j=RegExp("^"+b.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var v=function(t){return!(!Object(u.a)(t)||a(t))&&(Object(o.a)(t)?j:d).test(Object(s.a)(t))};var m=function(t,e){return null==t?void 0:t[e]};e.a=function(t,e){var n=m(t,e);return v(n)?n:void 0}},3344:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"DeleteItemJsonRequest:#Exchange"},t)}n.d(e,"a",(function(){return r}))},335:function(t,e,n){"use strict";var r=n(354),o=Object.prototype,c=o.hasOwnProperty,i=o.toString,a=r.a?r.a.toStringTag:void 0;var u=function(t){var e=c.call(t,a),n=t[a];try{t[a]=void 0;var r=!0}catch(t){}var o=i.call(t);return r&&(e?t[a]=n:delete t[a]),o},s=Object.prototype.toString;var d=function(t){return s.call(t)},l="[object Null]",f="[object Undefined]",b=r.a?r.a.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?f:l:b&&b in Object(t)?u(t):d(t)}},3447:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"DeleteItemRequest:#Exchange"},t)}n.d(e,"a",(function(){return r}))},3448:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(32),o=n(3344);function c(t,e){return void 0===t||t.__type||(t=Object(o.a)(t)),Object(r.a)("DeleteItem",t,e)}},354:function(t,e,n){"use strict";var r=n(222).a.Symbol;e.a=r},3595:function(t){t.exports=JSON.parse('{"a":"MYb"}')},3663:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(209);function o(t,e){let n=t.docViewAttachments.filter(t=>Object(r.e)(t.attachmentId,e));return 0===n.length&&(n=t.imageViewAttachments.filter(t=>Object(r.e)(t.attachmentId,e))),0===n.length?null:n[0]}},385:function(t,e,n){"use strict";var r=n(549),o=n(554);e.a=function(t){return null!=t&&Object(o.a)(t.length)&&!Object(r.a)(t)}},3915:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(3447),o=n(910),c=n(3448),i=n(245);function a(t,e){return Object(r.a)({ItemIds:t.map(t=>(function(t){return Object(o.a)({Id:t.Id,ChangeKey:t.ChangeKey})})(t)),DeleteType:e,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function u(t,e,n){const r=a(t,e);return Object(c.a)({Header:Object(i.b)(),Body:r},n).then(t=>t.Body.ResponseMessages.Items)}},415:function(t,e,n){"use strict";var r=Function.prototype.toString;e.a=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},5175:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(5176),o=n(5560),c=n(3595),i=n(5);function a(t){switch(t){case 2:return Object(i.b)(o.d);case 3:return Object(i.b)(o.e);case 5:return Object(i.b)(o.c);case 6:return Object(i.b)(r.a);case 7:return Object(i.b)(o.g);case 4:return Object(i.b)(o.f);case 10:return Object(i.b)(o.a);case 11:return Object(i.b)(o.b);default:return Object(i.b)(c.a)}}},5176:function(t){t.exports=JSON.parse('{"a":"LYb"}')},549:function(t,e,n){"use strict";var r=n(335),o=n(227),c="[object AsyncFunction]",i="[object Function]",a="[object GeneratorFunction]",u="[object Proxy]";e.a=function(t){if(!Object(o.a)(t))return!1;var e=Object(r.a)(t);return e==i||e==a||e==c||e==u}},550:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(121),o=n(12);function c(){return Object(r.a)("acctmonaccounts")&&Object(o.i)("acctmonaccounts")}},551:function(t,e,n){"use strict";e.a=function(t){return t}},552:function(t,e,n){"use strict";var r=n(725),o=n(944),c=n(385);e.a=function(t){return Object(c.a)(t)?Object(r.a)(t):Object(o.a)(t)}},554:function(t,e,n){"use strict";var r=9007199254740991;e.a=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},556:function(t,e,n){"use strict";var r=n(313),o=function(){try{var t=Object(r.a)(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();e.a=o},5560:function(t){t.exports=JSON.parse('{"d":"NYb","e":"OYb","c":"PYb","g":"QYb","f":"RYb","a":"SYb","b":"TYb"}')},601:function(t,e,n){"use strict";function r(t,e){for(var n,r=/\r\n|[\n\r]/g,o=1,c=e+1;(n=r.exec(t.body))&&n.index<e;)o+=1,c=e+1-(n.index+n[0].length);return{line:o,column:c}}n.d(e,"a",(function(){return r}))},6181:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(20);const o=new r.c(()=>n.e(2034).then(n.bind(null,9084))),c=new r.a(o,t=>t.previewAttachmentInPopOut).importAndExecute},701:function(t,e,n){"use strict";function r(t){return null==t||0==t.trim().length}n.d(e,"a",(function(){return r}))},703:function(t,e,n){"use strict";var r=n(301);const o=n.n(r)()("Profile",{profileId:"",profileName:"",selectedAccountSourceId:"",accountSources:[]});e.a=o},709:function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(137))},71:function(t,e,n){"use strict";var r=n(3);function o(t,e){return(e=e||{}).dp=t,e}function c(t,e,n){return Object(r.action)(t,(...r)=>{const c=e?e(...r):{},i=n?n(c,...r):{name:t};return i.name=i.name||t,i.options=i.options||{isCore:!0},o(i,c)})}function i(t){const{value:e,exactMatches:n=[0,1,2,3,4,5],buckets:r=[10,15,25,50,100]}=t;if(0===r.length)throw new Error("getAggregationBucket: buckets cannot be an empty array");if(n[0]&&e<n[0])return`<${n[0]}`;if(n.includes(e))return`${e}`;for(let t=0;t<r.length;t++)if(e<=r[t])return`${t>0?r[t-1]+1:n[n.length-1]+1||"0"}-${r[t]}`;return`${r[r.length-1]+1}+`}n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i}))},711:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return c}));var r="function"==typeof Symbol&&null!=Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Symbol&&null!=Symbol.asyncIterator?Symbol.asyncIterator:"@@asyncIterator",c="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag"},712:function(t,e,n){"use strict";var r=n(313),o=n(222),c=Object(r.a)(o.a,"Set");e.a=c},714:function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},7449:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(40);let o=null;const c={register:t=>{o=t},available:()=>!!o,run:(t,e)=>o?o(t,e):(r.d("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}},7815:function(t,e,n){"use strict";let r=null;const o={register:t=>{r=t},available:()=>!!r,run:t=>{r&&r(t)}};e.a=o},800:function(t,e,n){"use strict";var r=n(313),o=n(222),c=Object(r.a)(o.a,"DataView"),i=n(469),a=Object(r.a)(o.a,"Promise"),u=n(712),s=Object(r.a)(o.a,"WeakMap"),d=n(335),l=n(415),f=Object(l.a)(c),b=Object(l.a)(i.a),O=Object(l.a)(a),j=Object(l.a)(u.a),v=Object(l.a)(s),m=d.a;(c&&"[object DataView]"!=m(new c(new ArrayBuffer(1)))||i.a&&"[object Map]"!=m(new i.a)||a&&"[object Promise]"!=m(a.resolve())||u.a&&"[object Set]"!=m(new u.a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(t){var e=Object(d.a)(t),n="[object Object]"==e?t.constructor:void 0,r=n?Object(l.a)(n):"";if(r)switch(r){case f:return"[object DataView]";case b:return"[object Map]";case O:return"[object Promise]";case j:return"[object Set]";case v:return"[object WeakMap]"}return e});e.a=m},803:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c}));var r=n(601);function o(t){return c(t.source,Object(r.a)(t.source,t.start))}function c(t,e){var n=t.locationOffset.column-1,r=a(n)+t.body,o=e.line-1,c=t.locationOffset.line-1,u=e.line+c,s=1===e.line?n:0,d=e.column+s,l="".concat(t.name,":").concat(u,":").concat(d,"\n"),f=r.split(/\r\n|[\n\r]/g),b=f[o];if(b.length>120){for(var O=Math.floor(d/80),j=d%80,v=[],m=0;m<b.length;m+=80)v.push(b.slice(m,m+80));return l+i([["".concat(u),v[0]]].concat(v.slice(1,O+1).map((function(t){return["",t]})),[[" ",a(j-1)+"^"],["",v[O+1]]]))}return l+i([["".concat(u-1),f[o-1]],["".concat(u),b],["",a(d-1)+"^"],["".concat(u+1),f[o+1]]])}function i(t){var e=t.filter((function(t){t[0];return void 0!==t[1]})),n=Math.max.apply(Math,e.map((function(t){return t[0].length})));return e.map((function(t){var e,r=t[0],o=t[1];return a(n-(e=r).length)+e+(o?" | "+o:" |")})).join("\n")}function a(t){return Array(t+1).join(" ")}},808:function(t,e,n){"use strict";var r=n(930),o=n(918),c=n(552);e.a=function(t){return Object(r.a)(t,c.a,o.a)}},8301:function(t,e,n){"use strict";var r=n(32);function o(t,e){var n;return void 0===t||t.__type||(n=t,t=Object.assign({__type:"GetAttachmentTextPreviewRequest:#Exchange"},n)),Object(r.a)("GetAttachmentTextPreview",t,e)}n.d(e,"a",(function(){return o}))},914:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(703);function o(t){const e=Object(r.a)().accountSources.filter(e=>{var n;return(null===(n=e.mailbox)||void 0===n?void 0:n.emailAddress)===t});if(e.length>1)throw new Error("Found "+e.length+" duplicated accounts with same email address: "+t);return 1===e.length?e[0].id:null}},918:function(t,e,n){"use strict";var r=n(952),o=n(931),c=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(t){return null==t?[]:(t=Object(t),Object(r.a)(i(t),(function(e){return c.call(t,e)})))}:o.a;e.a=a},920:function(t,e,n){"use strict";var r=n(925),o=n(933);e.a=function(t){return Object(r.a)((function(e,n){var r=-1,c=n.length,i=c>1?n[c-1]:void 0,a=c>2?n[2]:void 0;for(i=t.length>3&&"function"==typeof i?(c--,i):void 0,a&&Object(o.a)(n[0],n[1],a)&&(i=c<3?void 0:i,c=1),e=Object(e);++r<c;){var u=n[r];u&&t(e,u,r,i)}return e}))}},925:function(t,e,n){"use strict";var r=n(551),o=n(935),c=n(934);e.a=function(t,e){return Object(c.a)(Object(o.a)(t,e,r.a),t+"")}},926:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},927:function(t,e,n){"use strict";var r=n(385),o=n(293);e.a=function(t){return Object(o.a)(t)&&Object(r.a)(t)}},930:function(t,e,n){"use strict";var r=n(926),o=n(247);e.a=function(t,e,n){var c=e(t);return Object(o.a)(t)?c:Object(r.a)(c,n(t))}},931:function(t,e,n){"use strict";e.a=function(){return[]}},933:function(t,e,n){"use strict";var r=n(390),o=n(385),c=n(558),i=n(227);e.a=function(t,e,n){if(!Object(i.a)(n))return!1;var a=typeof e;return!!("number"==a?Object(o.a)(n)&&Object(c.a)(e,n.length):"string"==a&&e in n)&&Object(r.a)(n[e],t)}},934:function(t,e,n){"use strict";var r=function(t){return function(){return t}},o=n(556),c=n(551),i=o.a?function(t,e){return Object(o.a)(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:c.a,a=800,u=16,s=Date.now;var d=function(t){var e=0,n=0;return function(){var r=s(),o=u-(r-n);if(n=r,o>0){if(++e>=a)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(i);e.a=d},935:function(t,e,n){"use strict";var r=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},o=Math.max;e.a=function(t,e,n){return e=o(void 0===e?t.length-1:e,0),function(){for(var c=arguments,i=-1,a=o(c.length-e,0),u=Array(a);++i<a;)u[i]=c[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=c[i];return s[e]=n(u),r(t,this,s)}}},937:function(t,e,n){"use strict";var r=function(t){return function(e,n,r){for(var o=-1,c=Object(e),i=r(e),a=i.length;a--;){var u=i[t?a:++o];if(!1===n(c[u],u,c))break}return e}}();e.a=r},938:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return"object"==r(t)&&null!==t}n.d(e,"a",(function(){return o}))},942:function(t,e,n){"use strict";var r=n(335),o=n(713),c=n(293),i="[object Object]",a=Function.prototype,u=Object.prototype,s=a.toString,d=u.hasOwnProperty,l=s.call(Object);e.a=function(t){if(!Object(c.a)(t)||Object(r.a)(t)!=i)return!1;var e=Object(o.a)(t);if(null===e)return!0;var n=d.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&s.call(n)==l}},944:function(t,e,n){"use strict";var r=n(563),o=n(726),c=Object(o.a)(Object.keys,Object),i=Object.prototype.hasOwnProperty;e.a=function(t){if(!Object(r.a)(t))return c(t);var e=[];for(var n in Object(t))i.call(t,n)&&"constructor"!=n&&e.push(n);return e}},946:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(40),o=n(703);function c(t){const e=Object(o.a)().accountSources.filter(e=>e.id===t);if(1===e.length)return e[0];e.length>1&&r.h.warn("Found more than one account with the same source id")}},952:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,c=[];++n<r;){var i=t[n];e(i,n,t)&&(c[o++]=i)}return c}},953:function(t,e,n){"use strict";n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return m}));var r=n(938),o=n(711),c=n(601),i=n(803);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){var e="function"==typeof Map?new Map:void 0;return(l=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return f(t,arguments,j(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),O(r,t)})(t)}function f(t,e,n){return(f=b()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&O(o,n.prototype),o}).apply(null,arguments)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(v,t);var e,n,i,a,l,f=(e=v,n=b(),function(){var t,r=j(e);if(n){var o=j(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return s(this,t)});function v(t,e,n,o,i,a,u){var l,b,O,j,m;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),m=f.call(this,t);var p,w=Array.isArray(e)?0!==e.length?e:void 0:e?[e]:void 0,S=n;!S&&w&&(S=null===(p=w[0].loc)||void 0===p?void 0:p.source);var h,I=o;!I&&w&&(I=w.reduce((function(t,e){return e.loc&&t.push(e.loc.start),t}),[])),I&&0===I.length&&(I=void 0),o&&n?h=o.map((function(t){return Object(c.a)(n,t)})):w&&(h=w.reduce((function(t,e){return e.loc&&t.push(Object(c.a)(e.loc.source,e.loc.start)),t}),[]));var g=u;if(null==g&&null!=a){var y=a.extensions;Object(r.a)(y)&&(g=y)}return Object.defineProperties(d(m),{name:{value:"GraphQLError"},message:{value:t,enumerable:!0,writable:!0},locations:{value:null!==(l=h)&&void 0!==l?l:void 0,enumerable:null!=h},path:{value:null!=i?i:void 0,enumerable:null!=i},nodes:{value:null!=w?w:void 0},source:{value:null!==(b=S)&&void 0!==b?b:void 0},positions:{value:null!==(O=I)&&void 0!==O?O:void 0},originalError:{value:a},extensions:{value:null!==(j=g)&&void 0!==j?j:void 0,enumerable:null!=g}}),null!=a&&a.stack?(Object.defineProperty(d(m),"stack",{value:a.stack,writable:!0,configurable:!0}),s(m)):(Error.captureStackTrace?Error.captureStackTrace(d(m),v):Object.defineProperty(d(m),"stack",{value:Error().stack,writable:!0,configurable:!0}),m)}return i=v,(a=[{key:"toString",value:function(){return m(this)}},{key:o.c,get:function(){return"Object"}}])&&u(i.prototype,a),l&&u(i,l),v}(l(Error));function m(t){var e=t.message;if(t.nodes)for(var n=0,r=t.nodes;n<r.length;n++){var o=r[n];o.loc&&(e+="\n\n"+Object(i.a)(o.loc))}else if(t.source&&t.locations)for(var c=0,a=t.locations;c<a.length;c++){var u=a[c];e+="\n\n"+Object(i.b)(t.source,u)}return e}},956:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"Assertion failed")}n.d(e,"a",(function(){return r}))},959:function(t,e,n){"use strict";var r=n(459),o=n(564),c=n(390);var i=function(t,e,n){(void 0===n||Object(c.a)(t[e],n))&&(void 0!==n||e in t)||Object(o.a)(t,e,n)},a=n(937),u=n(966),s=n(967),d=n(965),l=n(968),f=n(505),b=n(247),O=n(927),j=n(502),v=n(549),m=n(227),p=n(942),w=n(557);var S=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},h=n(915),I=n(706);var g=function(t){return Object(h.a)(t,Object(I.a)(t))};var y=function(t,e,n,r,o,c,a){var h=S(t,n),I=S(e,n),y=a.get(I);if(y)i(t,n,y);else{var x=c?c(h,I,n+"",t,e,a):void 0,A=void 0===x;if(A){var k=Object(b.a)(I),T=!k&&Object(j.a)(I),P=!k&&!T&&Object(w.a)(I);x=I,k||T||P?Object(b.a)(h)?x=h:Object(O.a)(h)?x=Object(d.a)(h):T?(A=!1,x=Object(u.a)(I,!0)):P?(A=!1,x=Object(s.a)(I,!0)):x=[]:Object(p.a)(I)||Object(f.a)(I)?(x=h,Object(f.a)(h)?x=g(h):Object(m.a)(h)&&!Object(v.a)(h)||(x=Object(l.a)(I))):A=!1}A&&(a.set(I,x),o(x,I,r,c,a),a.delete(I)),i(t,n,x)}};var x=function t(e,n,o,c,u){e!==n&&Object(a.a)(n,(function(a,s){if(u||(u=new r.a),Object(m.a)(a))y(e,n,s,o,t,c,u);else{var d=c?c(S(e,s),a,s+"",e,n,u):void 0;void 0===d&&(d=a),i(e,s,d)}}),I.a)},A=n(920),k=Object(A.a)((function(t,e,n){x(t,e,n)}));e.a=k},971:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},993:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a}));var r=n(20);const o=new r.c(()=>n.e(1337).then(n.bind(null,1586)));let c=new r.a(o,t=>t.subscribe),i=new r.a(o,t=>t.unsubscribe),a=new r.a(o,t=>t.trigger);new r.a(o,t=>t.removeResizeEventEmitter)}}]);
//# sourceMappingURL=owa.543.js.map
self.scriptsLoaded['owa.543.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.543.js'] = (new Date()).getTime();