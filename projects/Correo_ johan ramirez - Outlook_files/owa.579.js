self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.579.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[579],{14804:function(e){e.exports=JSON.parse('{"a":"i1b","b":"j1b","c":"k1b","d":"l1b"}')},14805:function(e){e.exports=JSON.parse('{"a":"e1b","b":"f1b","c":"g1b","d":"h1b"}')},14806:function(e){e.exports=JSON.parse('{"a":"X0b","b":"Y0b","c":"Z0b","d":"_0b"}')},1814:function(e,t,n){"use strict";var a=n(1841),r=n(1679);function o(){return Object(a.a)(Object(r.I)())}n.d(t,"b",(function(){return a.a})),n.d(t,"d",(function(){return a.c})),n.d(t,"c",(function(){return a.b})),n.d(t,"e",(function(){return a.d})),n.d(t,"a",(function(){return o}))},1841:function(e,t,n){"use strict";var a=n(209),r=n(1683);const o=new Map;var i=n(1871),c=n(1744),u=n(2437);function l(e){return e?d(e.tableQuery):Object(a.d)()}function d(e){const t=Object(c.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(i.a)(t):s(n)}function s(e){return Object(r.G)(e)?Object(u.a)(e):function(e){if(!e)return Object(a.d)();if(!o.has(e)){let t=Object(r.t)(e,!0);o.set(e,t)}return o.get(e)}(e)}function b(e){return{mailboxInfo:d(e)}}n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return b}))},1871:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(209);const r={};function o(e){const t=e.toLocaleLowerCase();if(!r[t]){const n={type:"GroupMailbox",userIdentity:Object(a.d)().userIdentity,mailboxSmtpAddress:e};r[t]=n}return r[t]}},1947:function(e,t,n){"use strict";var a=n(2799),r=n(3250),o=n(20),i=n(2979),c=n(2137),u=n(548);function l(e,t){return Object(u.b)(e,t,!1,{hideCancelButton:!0})}var d=n(2664),s=n(2288),b=n(1939),f=n(913),m=n(2463),O=n(29),v=n(1685),p=n(1683),j=n(283);function k(e,t){var n;if(t==Object(v.a)("msgfolderroot"))return!(null===(n=Object(O.a)().UserOptions)||void 0===n?void 0:n.IsMailRootFolderTreeCollapsed);{const n=e[t];return!n||n.IsExpanded}}async function y(e){var t;await Object(p.v)(void 0,void 0,e),Object(j.a)()||((null===(t=Object(O.a)().SessionSettings)||void 0===t?void 0:t.HasArchive)&&Object(p.z)(),Object(p.B)()),function(){const e=Object(d.c)();Object.keys(e).forEach(t=>{const{sortColumn:n,sortDirection:a}=Object(s.a)(t),r={isExpanded:k(e,t),sortColumn:n,sortOrder:a,drag:Object(b.a)(),drop:Object(f.a)()};Object(m.a)(t,r)})}()}var S=n(2574),g=n(2447),h=n(3),I=n(3158);Object(h.orchestrator)(I.a,e=>{y()});n.d(t,"c",(function(){return N})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return g.a})),n.d(t,"b",(function(){return g.b})),n.d(t,"e",(function(){return a.a}));const w=new o.c(()=>n.e(956).then(n.bind(null,19261)));Object(o.f)(r.a,w,e=>e.onNewFolderSuccessOrchestrator),Object(o.f)(S.a,w,e=>e.onNewFolderRowNotificationOrchestrator),Object(o.f)(c.a,w,e=>e.markAllAsReadOrchestrator),Object(o.f)(i.a,w,e=>e.emptyFolderStoreUpdateOrchestrator),Object(o.f)(a.a,w,e=>e.setFolderSortByOrchestrator);let N=new o.a(w,e=>e.dismissMailFolderTextField)},1972:function(e,t,n){"use strict";var a=n(14),r=n(3);let o={folderTable:new a.ObservableMap,rootFolder:null},i=Object(r.createStore)("publicFolderFavoriteStore",o)();t.a=i},2041:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"add",(function(){return u})),n.d(a,"remove",(function(){return l})),n.d(a,"removeAll",(function(){return d})),n.d(a,"getCount",(function(){return s})),n.d(a,"getTombstonedReasons",(function(){return b})),n.d(a,"clearMapForFolder",(function(){return f})),n.d(a,"removeRowsFromTombstone",(function(){return m}));var r=n(3);let o=Object(r.createStore)("tombstone",{folderTombstoneMap:{}});o();var i=n(61),c=n(699);let u=Object(c.action)("tombstoneOperations.add")((function(e,t,n){if(1==t.tableQuery.type||"spotlight"===t.tableQuery.scenarioType)return;const a=t.serverFolderId,r=o().folderTombstoneMap;a in r||(r[a]={});const i=r[a];e.forEach(e=>{let t=i[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):i[e]=[3]:i[e]=[n]})})),l=Object(c.action)("tombstoneOperations.remove")((function(e,t,n){const a=o().folderTombstoneMap;if(!(t in a))return;const r=a[t],i=r[e],c=i?i.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");i.splice(c,1),0==i.length&&delete r[e],0==Object.keys(r).length&&delete a[t]})),d=Object(c.action)("tombstoneOperations.removeAll")((function(){o().folderTombstoneMap={},Object(i.p)("TnS_RemoveAllFromTombstone")})),s=function(e,t){const n=o().folderTombstoneMap;if(!(e in n))return 0;let a=0;const r=n[e];return Object.values(r).forEach(e=>{e==t&&a++}),a},b=function(e,t){const n=o().folderTombstoneMap;if(t in n){const a=n[t][e];if(a)return a}return[]},f=Object(c.action)("tombstoneOperations.clearMapForFolder")((function(e){const t=o().folderTombstoneMap;t[e]&&(Object(i.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),m=Object(c.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){const n=o().folderTombstoneMap;if(!(t in n))return;const a=n[t];for(const t of e)t in a&&delete a[t];0==Object.keys(a).length&&delete n[t]}));t.a=a},2042:function(e,t,n){"use strict";var a=n(3);const r=Object(a.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null});var o=r(),i=n(2041),c=n(61),u=n(2891),l=n(2545);let d;n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return O}));const s=Object(a.mutatorAction)("setUndoableAction",(e,t)=>{const n=r();n.hasUndoableAction=e,n.undoableActionFolderId=t});function b(e,t){null!==e&&(d=e,s(!0,t))}function f(){d=null,s(!1,null)}function m(){return r().hasUndoableAction}function O(e){const t=new c.b("TnS_Undo");t.addCustomData([e]),o.undoableActionFolderId?i.a.clearMapForFolder(o.undoableActionFolderId):i.a.removeAll();return null!==d&&(d().then(()=>{Object(u.a)()||Object(l.a)()}),f()),t.end(),Promise.resolve()}},2108:function(e,t,n){"use strict";var a=n(20),r=n(2042),o=n(1679),i=n(1692),c=n(1685),u=n(1683),l=n(44);function d(e,t){return!(!e||Object(o.y)()||!t||!("UserMailbox"===t.type||Object(l.j)("grp-loadFolders")&&"GroupMailbox"===t.type)||Object(i.m)(e)||e==Object(c.a)("recoverableitemsdeletions")||Object(u.C)(e,"SharedMailbox"))}n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"c",(function(){return d}));const s=new a.c(()=>n.e(2070).then(n.bind(null,18900)));let b=new a.a(s,e=>e.undo)},2155:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(209);function r(e){return{type:"PublicMailbox",userIdentity:Object(a.d)().userIdentity,mailboxSmtpAddress:e}}},2165:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},2182:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));const a=350,r=270},2218:function(e,t,n){"use strict";var a=n(3),r=n(14),o=n(1683),i=n(2363),c=n(2574),u=n(1726);Object(a.mutator)(i.a,e=>{l(e.unreadCount,e.totalCount,e.folderId,e.isDeltaChange)});Object(a.mutator)(c.b,e=>{l(e.unreadCount,e.totalCount,e.folderId,!1)});function l(e,t,n,a){const r=o.d.folderTable.get(n);r&&(a?(r.UnreadCount+=e,r.totalMessageCount+=t):(r.UnreadCount=e,r.totalMessageCount=t),r.pausedTotalCount&&Object(u.b)()===n&&(r.pausedTotalCount=r.totalMessageCount),r.UnreadCount=Math.max(r.UnreadCount,0),r.totalMessageCount=Math.max(r.totalMessageCount,0))}n.d(t,"b",(function(){return s}));const d={folderNodeViewStates:new r.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null},s=Object(a.createStore)("folderViewState",d),b=s();t.a=b},222:function(e,t,n){"use strict";var a=n(709),r="object"==typeof self&&self&&self.Object===Object&&self,o=a.a||r||Function("return this")();t.a=o},2243:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1755),r=n(1761);function o(){const e=Object(a.d)();return Object(r.b)()?e<=541:e<=918}},2259:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2463),r=n(2218),o=n(1939),i=n(913),c=n(1679);function u(e){const t=c.c.getDefaultSortBy();return r.a.folderNodeViewStates.has(e)||Object(a.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(o.a)(),drop:Object(i.a)()}),r.a.folderNodeViewStates.get(e)}},227:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},2271:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(e,t)=>({itemIdToRemove:e,removeItemSource:t}))},2288:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2664),r=n(1679),o=n(3541),i=n(61);function c(e){const t=Object(a.c)()[e];if(t){const n=Object(o.getSupportedSortColumns)(e),{SortColumn:a,SortOrder:c}=t;if(n.includes(a)){let e=c;return(!c||c!=r.c.DESCENDING_SORT_DIR&&c!=r.c.ASCENDING_SORT_DIR)&&(e=r.c.getDefaultSortDirectionForSortColumn(a),Object(i.o)("getSortByFolderId_invalidSortOrder",{sortColumn:a,sortOrder:c})),{sortColumn:a,sortDirection:e}}}return r.c.getDefaultSortBy()}},2300:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},2332:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1756);function r(){return Object(a.a)().showFolderPane}},2348:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.action)("setShowListPane",(function(e){return{showListPane:e}}))},2363:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("UPDATE_FOLDER_COUNTS",(e,t,n,a)=>({unreadCount:e,totalCount:t,folderId:n,isDeltaChange:a}))},2437:function(e,t,n){"use strict";var a=n(1679),r=n(1683);function o(){const e=Object(a.I)();return e&&0==e.tableQuery.type&&Object(r.G)(e.tableQuery.folderId)}function i(){const e=Object(a.I)();return e&&0==e.tableQuery.type&&Object(r.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(3),u=n(1972),l=n(2155),d=n(14);var s=Object(c.createStore)("publicFolderUtilsStore",new d.ObservableMap),b=n(49);function f(e){if(!s().has(e)){const t=u.a.folderTable.get(e),n=null!=t.replicaList?t.replicaList[0]:Object(b.g)().SessionSettings.DefaultPublicFolderMailbox,a=Object(l.a)(n);m(e,a)}return s().get(e)}const m=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",(e,t)=>{s().set(e,t)});n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return f}))},2447:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var a=n(29),r=n(1683);const o=["drafts","junkemail","recoverableitemsdeletions"];function i(e){let t;return e&&(t=Object(r.m)().get(e)),c(t)}function c(e){var t,n;return e&&(e.distinguishedFolderType&&-1!=o.indexOf(e.distinguishedFolderType)||"ArchiveMailbox"===e.mailboxInfo.type||"SharedMailbox"===e.mailboxInfo.type)||Object(r.G)(null==e?void 0:e.id)?1:(null===(n=null===(t=Object(a.a)())||void 0===t?void 0:t.UserOptions)||void 0===n?void 0:n.GlobalListViewTypeReact)||0}},2463:function(e,t,n){"use strict";var a=n(2218),r=n(3);t.a=Object(r.mutatorAction)("setFolderViewState",(function(e,t){a.a.folderNodeViewStates.set(e,t)}))},2544:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.action)("onClientReadingPanePositionChange")},2545:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("RESTORE_ROW_FAIL")},2574:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(3);const r=Object(a.action)("onNewFolderNotification",(e,t,n,a=0,r=0,o)=>({folderId:e,parentFolderId:t,displayName:n,unreadCount:a,totalCount:r,mailboxInfo:o})),o=Object(a.action)("onUpdateFolderNotification",(e,t,n,a,r)=>({unreadCount:e,totalCount:t,folderId:n,displayName:a,parentFolderId:r}))},2664:function(e,t,n){"use strict";var a=n(2259),r=n(29),o=n(49),i=n(1703),c=n(2464);function u(e){return"inbox"!=Object(i.a)(e)||Object(c.a)(e)?p.SearchRefinerScopeCurrentFolder:p.SearchRefinerScopeAll}var l=n(1679),d=n(2182),s=n(1683),b=n(1692);function f(e){const t=Object(i.a)(e);return Object(c.a)(e)||Object(s.G)(e)?j.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?j.DateViewOnly:"deleteditems"==t||Object(b.k)(e)?j.DateView:j.ConversationView}var m=n(958),O=n(61);const v=Object(m.a)(e=>{Object(O.o)("UpdateFolderViewState",{},{isCore:!0}),o.u.importAndExecute([{key:"FolderViewState",valuetype:"StringArray",value:e}],"OWA.ViewStateConfiguration")},3e4,{leading:!1,trailing:!0});var p,j,k=n(317);function y(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?l.c.DESCENDING_SORT_DIR:l.c.ASCENDING_SORT_DIR}))}function S(){var e;const t=(null===(e=Object(r.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState)||[],n={};for(let e=0;e<t.length;e++){const a=y(t[e]);n[a.FolderId.Id]=a}return n}function g(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==l.c.DESCENDING_SORT_DIR&&t!==l.c.ASCENDING_SORT_DIR?t:t===l.c.DESCENDING_SORT_DIR?1:0}))}function h(e){let t=!1;Object(k.a)(n=>{var o;const i=(null===(o=n.ViewStateConfiguration)||void 0===o?void 0:o.FolderViewState)||[],c=Object(a.a)(e);let l=null,b=-1;for(let t=0;t<i.length;t++){const n=y(i[t]);if(n.FolderId.Id===e){l=n,b=t;break}}const m=function(e,t,n){var a;const o=n?n.sortOrder:"Ascending",i=n?n.sortColumn:1,c=!!n&&n.isExpanded;if(t)return Object.assign(Object.assign({},t),{SortOrder:o,SortColumn:i,IsExpanded:c});const l=s.d.folderTable.get(e);return l?{FolderId:{Id:l.id,ChangeKey:l.changeKey},View:f(l.id),Width:d.b,SortOrder:o,SortColumn:i,IsExpanded:c,ReadingPanePosition:null===(a=Object(r.a)().UserOptions)||void 0===a?void 0:a.GlobalReadingPanePositionReact,SearchScope:u(l.id)}:null}(e,l,c);m&&(-1!==b?(t=l!==m,t&&(i[b]=g(m))):(t=!0,i.push(g(m))))}),t&&function(){var e,t;const n=null===(e=Object(r.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState;if(n){const e=[],a=l.c.getDefaultSortBy();for(let o=0;o<n.length;o++){const i=y(n[o]),c=Object(s.m)().get(i.FolderId.Id);(!(!c||c.childFolderCount>0)||!i.IsExpanded)&&i.SearchScope===u(i.FolderId.Id)&&i.SortColumn===a.sortColumn&&i.SortOrder===a.sortDirection&&i.Width===d.b&&i.ReadingPanePosition===(null===(t=Object(r.a)().UserOptions)||void 0===t?void 0:t.GlobalReadingPanePositionReact)&&i.View===f(i.FolderId.Id)||e.push(n[o])}v(e)}}()}n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return S})),n.d(t,"e",(function(){return h})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(p||(p={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(j||(j={}))},2713:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1756);function r(){return Object(a.a)().showListPane}},2799:function(e,t,n){"use strict";var a=n(3);const r=Object(a.action)("setFolderSortBy",(e,t,n)=>({folderId:e,sortColumn:t,sortDirection:n}));t.a=r},2848:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(1998),r=n(3394);const o=()=>{const e=Object(a.a)();return i(e)},i=e=>{if(!e||!e.isInitialLoadComplete)return"Loading";const t=0==e.rowKeys.length;return 0!=e.loadErrorStatus&&(t||Object(r.a)(e))?"Error":t?"Empty":"Loaded"}},2891:function(e,t,n){"use strict";let a;function r(){a=!0}function o(){return a}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},293:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},2979:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("EMPTY_FOLDER_STORE_UPDATE",(e,t,n,a,r,o)=>({folderId:e,clientLastSyncTime:t,deletedItemsFolderId:n,disposalType:a,deleteSubFolders:r,rowKeysToExclude:o}))},3096:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1690),r=n(2926);function o(e,t){return t?a.a.items.get(e):Object(r.b)(e)}},313:function(e,t,n){"use strict";var a,r=n(549),o=n(222).a["__core-js_shared__"],i=(a=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";var c=function(e){return!!i&&i in e},u=n(227),l=n(415),d=/^\[object .+?Constructor\]$/,s=Function.prototype,b=Object.prototype,f=s.toString,m=b.hasOwnProperty,O=RegExp("^"+f.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var v=function(e){return!(!Object(u.a)(e)||c(e))&&(Object(r.a)(e)?O:d).test(Object(l.a)(e))};var p=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=p(e,t);return v(n)?n:void 0}},3158:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("SELECT_CATEGORIES_OPTIONS")},3248:function(e){e.exports=JSON.parse('{"a":"rBa","c":"sBa","e":"tBa","b":"uBa","d":"vBa"}')},3250:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.action)("onNewFolderSuccess",(e,t,n,a)=>({folderId:e,parentFolderId:t,displayName:n,mailboxInfo:a}))},3308:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",e=>({tableView:e}))},335:function(e,t,n){"use strict";var a=n(354),r=Object.prototype,o=r.hasOwnProperty,i=r.toString,c=a.a?a.a.toStringTag:void 0;var u=function(e){var t=o.call(e,c),n=e[c];try{e[c]=void 0;var a=!0}catch(e){}var r=i.call(e);return a&&(t?e[c]=n:delete e[c]),r},l=Object.prototype.toString;var d=function(e){return l.call(e)},s="[object Null]",b="[object Undefined]",f=a.a?a.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?b:s:f&&f in Object(e)?u(e):d(e)}},354:function(e,t,n){"use strict";var a=n(222).a.Symbol;t.a=a},3718:function(e){e.exports=JSON.parse('{"a":"m1b"}')},385:function(e,t,n){"use strict";var a=n(549),r=n(554);t.a=function(e){return null!=e&&Object(r.a)(e.length)&&!Object(a.a)(e)}},415:function(e,t,n){"use strict";var a=Function.prototype.toString;t.a=function(e){if(null!=e){try{return a.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},4217:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c}));var a=n(20);const r=new a.c(()=>n.e(1339).then(n.bind(null,8847)));let o=new a.b(r,e=>e.addMarkAsReadDiagnostics),i=new a.b(r,e=>e.addUnreadCountNotificationDiagnostics),c=new a.b(r,e=>e.addUnreadCountSubscriptionDiagnostics)},4488:function(e,t,n){"use strict";n.r(t);var a=n(1679),r=n(44),o={markConversationAsRead:{name:(e,t,n,a,r,o,i)=>{let c="TnS_MarkConversation";return c+=n?"Read":"Unread",a||(c+="Background"),c},options:(e,t,n,a,r,o,i)=>a?{isCore:!0}:{sessionSampleRate:10},customData:(e,t,n,r,o,i,c)=>[o,e.length,Object(a.n)(t),Object(a.Q)(t)],cosmosOnlyData:(e,t,n,r,o,i,c)=>{const u=[],l=Object(a.F)(e,t);for(const e of l)u.push(a.b.getItemIds(e,t));return JSON.stringify({itemIds:u,conversationIds:e})}},markItemReadUnread:{name:(e,t,n,a,r,o)=>{let i="TnS_MarkItem";return i+=n?"Read":"Unread",a||(i+="Background"),i},options:(e,t,n,a,r,o)=>a?{isCore:!0}:{},customData:(e,t,n,o,i,c)=>{const u=e?e.tableQuery.type:null,l=e?Object(a.n)(e):null,d=e?Object(a.Q)(e):null,s=Object(r.j)("fwk-useoutlookgateway-markItemAsRead");return[u,t.length,l,d,s]},cosmosOnlyData:(e,t,n,a,r,o)=>JSON.stringify({itemIds:t}),actionSource:(e,t,n,a,r)=>r}},i=n(699),c=n(3);var u=Object(c.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})();let l=Object(i.action)("AddMarkReadSuppressedItemIds")((function(e,t={store:u}){e.forEach(e=>t.store.suppressedItemIdsMap[e]=!0)})),d=Object(i.action)("RemoveMarkReadSuppressedItemIds")((function(e,t={store:u}){e.forEach(e=>delete t.store.suppressedItemIdsMap[e])})),s=Object(i.action)("ClearMarkReadSuppressedMap")((function(e={store:u}){e.store.suppressedItemIdsMap={}}));function b(e){for(let t=0;t<e.length;t++)if(!u.suppressedItemIdsMap[e[t]])return!1;return!0}var f=n(4217),m=n(2560),O=n(2313),v=n(9214),p=n(1814),j=n(40),k=n(61),y=n(3691);var S=n(1690);var g=n(2314),h=n(5753),I=n(702);const w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipts"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var N=n(29),R=Object(k.r)(o.markItemReadUnread,(async function(e,t,n,r,o,i){const c=function(e,t){const n=[];return e.forEach(e=>{const r=S.a.items.get(e);Object(a.X)(r)&&r&&r.IsRead!=t&&n.push(e)}),n}(t,n);if(0==c.length)return Promise.resolve();n?d(c):r?l(c):j.h.warn("Invalid scenario to implicitly mark item as unread.");const u=e?e.id:null;Object(g.a)(c,n,r,u),f.a.import().then(t=>{t(e?e.tableQuery:null,!1,n,o,c)});const s={itemIds:c};n?r?Object(m.d)("MarkAsRead",i,s):Object(m.d)("MarkAsReadImplicit",i,s):Object(m.d)("MarkAsUnread",i,s);const{mailboxInfo:b}=Object(p.e)(e.tableQuery),O=e?Object(a.F)(c,e):[];return T(e,O,c,n,b)}));async function T(e,t,n,r,o){var i;const c=(await h.c.import())(n,null===(i=a.Z.expandedConversationViewState)||void 0===i?void 0:i.forks),u="AlwaysSend"!=Object(N.a)().UserOptions.ReadReceipt;if(c.length>0)try{return await A.invokeMarkItemAsReadMutation(c,r,u,o),Promise.resolve()}catch(n){const a=e?e.serverFolderId:null;return Object(y.a)(t,a,!0),Promise.reject(n)}return Promise.resolve()}const A={invokeMarkItemAsReadMutation:async function(e,t,n,a){var r;const o=Object(I.a)(),i=await o.mutate({variables:{ids:e,isRead:t,suppressReadReceipts:n,mailboxInfo:a},mutation:w});return null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.markItemAsRead}},V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkConversationAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markConversationAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var F=n(5553),C=Object(k.r)(o.markConversationAsRead,(function(e,t,n,r,o,i,c){const u=function(e,t,n){const r=[];return e.forEach(e=>{const o=Object(a.M)(e,t);if(o){const t=0==o.unreadCount,a=o.itemIds.length,i=o.unreadCount==a;t&&n||i&&!n||r.push(e)}}),r}(c,t.id,n);if(0==u.length)return Promise.resolve();if(1==e.length&&1==t.selectedRowKeys.size){const e=a.b.getRowIdString(u[0],t),o=Object(a.M)([...t.selectedRowKeys.keys()][0],t.id);if(e==o.id){const e=o.itemIds;n?s():r?l(e):j.h.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(O.a)(e,t.id,n,r),f.a.import().then(a=>{a(t.tableQuery,!1,n,o,e)});const d={conversationIds:e};n?r?Object(m.d)("MarkAsRead",i,d):Object(m.d)("MarkAsReadImplicit",i,d):Object(m.d)("MarkAsUnread",i,d);const{mailboxInfo:b}=Object(p.e)(t.tableQuery);return Object(a.f)(t)?function(e,t,n,r){const o=[];return t.forEach(t=>{o.push(...a.b.getItemIds(t,e))}),T(e,t,o,n,r)}(t,u,n,b):function(e,t,n,r,o){const i=Object(v.a)(e),c=t.map(t=>Object(a.j)(t,e.id)),u=M.invokeMarkConversationAsReadMutation(c,n,i,o),l=Object(a.cb)(e,n,r);return Object(y.c)(u,t,i,e,l,!0)}(t,u,n,r,b)}));const M={invokeMarkConversationAsReadMutation:async function(e,t,n,a){var r;const o=e.map(e=>({id:e.conversationId,messagesAsOf:Object(F.a)(e.conversationLastSyncTimeStamp)})),i=Object(I.a)(),c=await i.mutate({variables:{conversations:o,isRead:t,folderId:n,mailboxInfo:a},mutation:V});return null===(r=null==c?void 0:c.data)||void 0===r?void 0:r.markConversationAsRead}};var x=n(2681),D=Object(i.action)("autoMarkConversationAsRead")((async function(e,t,n={items:S.a.items}){const r=Object(a.F)([e],t),o=Object(x.a)(r[0],t.id);if(!o)return;if(!Object(a.h)(t))return;const i=o.itemIds;if(!b(i)){if(0==Object.keys(u.suppressedItemIdsMap).length)await C([e],t,!0,!1,null,[],r);else for(const e of i)!b([e])&&n.items.get(e)&&await R(t,[e],!0,!1,null,[]);s()}})),E=n(4496);var _=n(1947),P=n(1838),U=n(1741),L=Object(i.action)("autoMarkItemAsRead")((async function(e,t,n){if(!Object(a.h)(t))return;if(b([e]))return;const r=Object(P.a)(e);let o;if(r){o=1==Object(_.a)(r.ParentFolderId.Id)}Object(U.a)()&&!o?async function(e,t,n,r){if(!t)return;const o=n||[...e.selectedRowKeys.keys()][0],i=a.b.getRowClientItemId(o,e),c=null==i?void 0:i.Id;c&&Object(E.a)(c,e.tableQuery.folderId).then(n=>{for(let a=0;a<n.length;a++)if(n[a][0]===t){R(e,n[a],r,!1,null,[]);break}})}(t,e,n,!0):await R(t,[e],!0,!1,null,[]),s()}));async function Q(e,t){var n;if("OnSelectionChange"!==Object(N.a)().UserOptions.PreviewMarkAsRead)return;const r=a.b.getRowIdString(e,t);switch(t.tableQuery.listViewType){case 0:if(Object(U.a)()){const r=null===(n=a.b.getRowIdToShowInReadingPane(e,t))||void 0===n?void 0:n.Id;await L(r,t,e)}else await D(r,t);break;case 1:await L(r,t)}}var B=n(1808),G=Object(i.action)("onReadingPaneClosed")((function(e,t){Object(B.s)()||j.d("onReadingPaneClosed should only be called in single line view."),Q(e,t)}));async function K(e,t,n){Object(B.s)()||n&&await Q(e,t)}function J(e,t,n){0==e.length||Object(B.s)()||1!==e.length||"Unread"===Object(a.Q)(n)||Q(e[0],t)}var $=Object(c.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",(e,t,n,a,r)=>({nodeIds:e,tableViewId:t,isReadValueToSet:n,isExplicit:a,actionSource:r})),Z=Object(i.action)("markItemAsReadFromReadingPane")((function(e,t,n,r,o){let i=[],c=null;if(t){if(Object(a.R)(t)){const n=S.a.items.get(e).ConversationId.Id;i=Object(a.F)([n],t)}else i=Object(a.F)([e],t);c=Object(a.m)(t)}R(t,[e],n,!0,o,r).then(()=>{t&&Object(y.a)(i,c)}).catch(e=>{t&&(Object(y.a)(i,c),Object(y.b)(t))})})),W=n(2495),Y=Object(i.action)("markConversationsAsReadFromTable")((function(e,t,n,r){const o=Object(a.D)(e,t.id),i=Object(W.a)(e,t);return C(o,t,n,!0,r,i,e)})),z=Object(i.action)("markItemsReadFromTable")((function(e,t,n,r,o){const i=Object(a.D)(e,t.id),c=Object(W.a)(e,t),u=R(t,i,n,r,o,c),l=Object(a.m)(t),d=Object(a.cb)(t,n,r);u.then(t=>{Object(y.a)(e,l,d)}).catch(n=>{Object(y.a)(e,l,d),Object(y.b)(t)})})),X=n(2609),q=Object(i.action)("toggleRowReadState")((function(e,t,n){const r=a.Z.tableViews.get(t),o=a.b.getUnreadCount(e,r)>0;switch(r.tableQuery.listViewType){case 0:Y([e],r,o,n);break;case 1:z([e],r,o,!0,n)}Object(X.b)()})),H=Object(i.action)("onNavigateAwayViaUpDown")((function(e,t){Q(e,t)})),ee=Object(c.action)("onKeyboardMarkAsRead",(e,t,n,a,r,o)=>({tableView:e,selectedNodeIds:t,isInVirtualSelectAllMode:n,rowKeysToActOn:a,exclusionList:r,isReadValueToSet:o})),te=n(5343),ne=n(3248),ae=n(3718),re=n(14804),oe=n(5),ie=n(7012),ce=n(14805),ue=n(14806);var le=n(805),de=n(548),se=n(7),be=n(1683),fe=n(2352),me=n(2137),Oe=n(11832),ve=n(5174),pe=n(2464),je=n(2108);const ke={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkViewAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markViewAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"markAsRead"},value:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"conversationIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"conversationIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]};var ye=Object(i.action)("markAsReadInTable")((function(e,t,n,r,o,i,c){if(o.length&&n)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(t.length&&!n)throw new Error("If not in virtual select all mode, exclusionList should be empty.");const u=i.tableQuery.folderId,l=be.d.folderTable.get(u),d=i.isInVirtualSelectAllMode&&t.length>0,s=Object(a.Q)(i),b="ContextFolder"===e||function(e){return"CommandBar"===e||"SimplifiedRibbon"===e||"MultiLineRibbon"===e||"CommandBarRibbon"===e}(e)&&n&&!i.isInCheckedMode&&!Object(a.U)(i,s),m=o.length>0&&!n,O=n&&l&&l.UnreadCount>=ie.b,v=function(e,t,n,r,o,i,c,u){if(e){const e=Object(a.P)(i);return e?Object(le.n)(e):null==n?void 0:n.UnreadCount}if(Object(a.w)(i)||t||Object(a.U)(i,c)&&u)return i.totalRowsInView-r;return o}(b,d,l,t.length,o.length,i,s,n),y=O||v>=ie.b;let S={headerText:"",bodyText:""};if(y){const e=Object(a.q)(i.tableQuery.type,i,l&&Object(be.h)(l));S=function(e,t,n,a,r,o,i,c){let u="",l="";const d=1===t,s=e||d;let b;return n<0&&(j.h.warn("totalCount in getMarkAsReadUnreadAllConfirmText should not be negative."),u=s?r?Object(oe.b)(te.e):Object(oe.b)(ne.e):r?Object(oe.b)(te.c):Object(oe.b)(ne.c)),1==n&&(u=r?Object(oe.b)(ae.a):Object(oe.b)(ne.a)),b=n<ie.a?n:"10000+",u=s?r?Object(oe.c)(Object(oe.b)(te.d),b):Object(oe.c)(Object(oe.b)(ne.d),b):r?Object(oe.c)(Object(oe.b)(te.b),b):Object(oe.c)(Object(oe.b)(ne.b),b),l=e?r?Object(oe.c)(Object(oe.b)(ce.b),a):Object(oe.c)(Object(oe.b)(ue.b),a):o||i?d?r?Object(oe.c)(Object(oe.b)(ce.d),a):Object(oe.c)(Object(oe.b)(ue.d),a):r?Object(oe.c)(Object(oe.b)(ce.c),a):Object(oe.c)(Object(oe.b)(ue.c),a):d?r?Object(oe.c)(Object(oe.b)(ce.b),a):Object(oe.c)(Object(oe.b)(ue.b),a):r?Object(oe.c)(Object(oe.b)(ce.a),a):Object(oe.c)(Object(oe.b)(ue.a),a),c&&(l=d?r?Object(oe.b)(re.b):Object(oe.b)(re.d):r?Object(oe.b)(re.a):Object(oe.b)(re.c)),{headerText:u,bodyText:l}}(b,i.tableQuery.listViewType,v,e,r,d,m,2===i.tableQuery.type)}Object(de.b)(S.headerText,S.bodyText,!y,{delayCallbackAfterAnimation:!0,okText:Object(oe.b)(fe.a)}).then(c=>{var l,d;if(c===de.a.ok)if(je.b(),n){const n=Object(N.a)().UserOptions.ReadReceipt,o="DoNotAutomaticallySend"==n||"NeverSend"==n||Object(pe.a)(u),c=Object(a.V)(u)?a.Z.inboxPausedDateTime:null;!function(e,t,n){let r="TnS_MarkAllAs";r+=t?"Read":"Unread",Object(k.o)(r,[e,Object(a.n)(n),n.isInCheckedMode])}(e,r,i),f.a.import().then(t=>{t(i.tableQuery,!0,r,e)});let s=[];0===i.tableQuery.listViewType&&(s=Object(Oe.a)(t,i.id));let b=[];switch(i.tableQuery.listViewType){case 0:b=Object(ve.a)(t,i.id);break;case 1:b=Object(a.D)(t,i.id)}Object(me.a)(i,r,b);let m=Object(a.l)(i),O=null===(l=m)||void 0===l?void 0:l.Id;O||(O=null===(d=m)||void 0===d?void 0:d.Id);const v=i.tableQuery;let j={id:O,focusedViewFilter:Object(a.r)(v.focusedViewFilter),viewFilter:Object(a.v)(v.viewFilter),markAsRead:r,clientLastSyncTime:c&&Object(se.vb)(c),conversationIdsToExclude:s,itemIdsToExclude:b,suppressReadReceipt:o,mailboxInfo:Object(p.b)(i)};Se.invokeMarkViewAsReadMutation(j)}else switch(i.tableQuery.listViewType){case 0:Y(o,i,r,e);break;case 1:z(o,i,r,!0,e)}})}));const Se={invokeMarkViewAsReadMutation:async function(e){var t;const n=Object(I.a)(),a=await n.mutate({variables:e,mutation:ke});return null===(t=null==a?void 0:a.data)||void 0===t?void 0:t.markViewAsRead}};var ge=n(1998);let he=Object(i.action)("setAutoMarkAsReadTimer")((function(e,t,n={store:u}){const r=Object(N.a)().UserOptions;if("Delayed"==r.PreviewMarkAsRead){const o=Object(ge.a)();if(!o||!Object(a.h)(o))return;n.store.markAsReadTimerTask=setTimeout(()=>{we(e,o,t)},1e3*r.MarkAsReadDelaytime)}})),Ie=Object(i.action)("clearAutoMarkAsReadTimer")((function(e={store:u}){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)}));const we=Object(i.action)("setMarkAsReadTimer:timeout")((e,t,n)=>{Ie(),n?L(e,t):1===t.tableQuery.listViewType||Object(U.a)()?L(e,t):D(e,t)});var Ne=n(2646),Re=n(20);const Te=Object(Re.e)(Ne.b,"CLONE_ON_ITEM_PART_DESELECTED",e=>{const{itemId:t,tableView:n}=e;n&&"OnSelectionChange"==Object(N.a)().UserOptions.PreviewMarkAsRead&&L(t,n)});var Ae=n(4301),Ve=n(2750),Fe=(Object(c.orchestrator)($,e=>{const t=a.Z.tableViews.get(e.tableViewId),n=[...t.selectedRowKeys.keys()],r=Object(Ae.a)(e.nodeIds,Object(Ve.a)(n[0]));R(t,r,e.isReadValueToSet,e.isExplicit,e.actionSource,null)}),n(1846)),Ce=n(8370);Object(c.orchestrator)(Fe.p,e=>{const{tableViewId:t,currentSelectedNodeIds:n,rowKey:r}=e;if("OnSelectionChange"==Object(N.a)().UserOptions.PreviewMarkAsRead&&Object(U.a)()&&1===(null==n?void 0:n.length)){const e=a.Z.tableViews.get(t);L(Object(Ce.a)(n[0],Object(Ve.a)(r)),e)}});Object(c.orchestrator)(ee,e=>{const{tableView:t,selectedNodeIds:n,isInVirtualSelectAllMode:a,rowKeysToActOn:r,exclusionList:o,isReadValueToSet:i}=e;n.length>0?$(n,t.id,i,!0,"Keyboard"):ye("Keyboard",o,a,i,r,t)});n.d(t,"onReadingPaneClosed",(function(){return G})),n.d(t,"onSingleSelectionChanged",(function(){return K})),n.d(t,"markReadOnTableViewChange",(function(){return J})),n.d(t,"markItemsAsReadBasedOnNodeIds",(function(){return $})),n.d(t,"markItemAsReadFromReadingPane",(function(){return Z})),n.d(t,"toggleRowReadState",(function(){return q})),n.d(t,"onNavigateAwayViaUpDown",(function(){return H})),n.d(t,"onKeyboardMarkAsRead",(function(){return ee})),n.d(t,"markAsReadInTable",(function(){return ye})),n.d(t,"clearAutoMarkAsReadTimer",(function(){return Ie})),n.d(t,"setAutoMarkAsReadTimer",(function(){return he})),n.d(t,"onItemPartDeselectedOrchestrator",(function(){return Te}))},5343:function(e){e.exports=JSON.parse('{"a":"$0b","c":"a1b","e":"b1b","b":"c1b","d":"d1b"}')},549:function(e,t,n){"use strict";var a=n(335),r=n(227),o="[object AsyncFunction]",i="[object Function]",c="[object GeneratorFunction]",u="[object Proxy]";t.a=function(e){if(!Object(r.a)(e))return!1;var t=Object(a.a)(e);return t==i||t==c||t==o||t==u}},551:function(e,t,n){"use strict";t.a=function(e){return e}},554:function(e,t,n){"use strict";var a=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}},556:function(e,t,n){"use strict";var a=n(313),r=function(){try{var e=Object(a.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=r},601:function(e,t,n){"use strict";function a(e,t){for(var n,a=/\r\n|[\n\r]/g,r=1,o=t+1;(n=a.exec(e.body))&&n.index<t;)r+=1,o=t+1-(n.index+n[0].length);return{line:r,column:o}}n.d(t,"a",(function(){return a}))},709:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(137))},711:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o}));var a="function"==typeof Symbol&&null!=Symbol.iterator?Symbol.iterator:"@@iterator",r="function"==typeof Symbol&&null!=Symbol.asyncIterator?Symbol.asyncIterator:"@@asyncIterator",o="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag"},714:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},798:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(14),r=n(0);function o(e){return{get:e}}function i(e,t){return Object(r.useMemo)(()=>Object(a.computed)(e),t).get()}},803:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(601);function r(e){return o(e.source,Object(a.a)(e.source,e.start))}function o(e,t){var n=e.locationOffset.column-1,a=c(n)+e.body,r=t.line-1,o=e.locationOffset.line-1,u=t.line+o,l=1===t.line?n:0,d=t.column+l,s="".concat(e.name,":").concat(u,":").concat(d,"\n"),b=a.split(/\r\n|[\n\r]/g),f=b[r];if(f.length>120){for(var m=Math.floor(d/80),O=d%80,v=[],p=0;p<f.length;p+=80)v.push(f.slice(p,p+80));return s+i([["".concat(u),v[0]]].concat(v.slice(1,m+1).map((function(e){return["",e]})),[[" ",c(O-1)+"^"],["",v[m+1]]]))}return s+i([["".concat(u-1),b[r-1]],["".concat(u),f],["",c(d-1)+"^"],["".concat(u+1),b[r+1]]])}function i(e){var t=e.filter((function(e){e[0];return void 0!==e[1]})),n=Math.max.apply(Math,t.map((function(e){return e[0].length})));return t.map((function(e){var t,a=e[0],r=e[1];return c(n-(t=a).length)+t+(r?" | "+r:" |")})).join("\n")}function c(e){return Array(e+1).join(" ")}},920:function(e,t,n){"use strict";var a=n(925),r=n(933);t.a=function(e){return Object(a.a)((function(t,n){var a=-1,o=n.length,i=o>1?n[o-1]:void 0,c=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,c&&Object(r.a)(n[0],n[1],c)&&(i=o<3?void 0:i,o=1),t=Object(t);++a<o;){var u=n[a];u&&e(t,u,a,i)}return t}))}},925:function(e,t,n){"use strict";var a=n(551),r=n(935),o=n(934);t.a=function(e,t){return Object(o.a)(Object(r.a)(e,t,a.a),e+"")}},927:function(e,t,n){"use strict";var a=n(385),r=n(293);t.a=function(e){return Object(r.a)(e)&&Object(a.a)(e)}},933:function(e,t,n){"use strict";var a=n(390),r=n(385),o=n(558),i=n(227);t.a=function(e,t,n){if(!Object(i.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(r.a)(n)&&Object(o.a)(t,n.length):"string"==c&&t in n)&&Object(a.a)(n[t],e)}},934:function(e,t,n){"use strict";var a=function(e){return function(){return e}},r=n(556),o=n(551),i=r.a?function(e,t){return Object(r.a)(e,"toString",{configurable:!0,enumerable:!1,value:a(t),writable:!0})}:o.a,c=800,u=16,l=Date.now;var d=function(e){var t=0,n=0;return function(){var a=l(),r=u-(a-n);if(n=a,r>0){if(++t>=c)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(i);t.a=d},935:function(e,t,n){"use strict";var a=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},r=Math.max;t.a=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,c=r(o.length-t,0),u=Array(c);++i<c;)u[i]=o[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=o[i];return l[t]=n(u),a(e,this,l)}}},937:function(e,t,n){"use strict";var a=function(e){return function(t,n,a){for(var r=-1,o=Object(t),i=a(t),c=i.length;c--;){var u=i[e?c:++r];if(!1===n(o[u],u,o))break}return t}}();t.a=a},938:function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return"object"==a(e)&&null!==e}n.d(t,"a",(function(){return r}))},942:function(e,t,n){"use strict";var a=n(335),r=n(713),o=n(293),i="[object Object]",c=Function.prototype,u=Object.prototype,l=c.toString,d=u.hasOwnProperty,s=l.call(Object);t.a=function(e){if(!Object(o.a)(e)||Object(a.a)(e)!=i)return!1;var t=Object(r.a)(e);if(null===t)return!0;var n=d.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==s}},953:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return p}));var a=n(938),r=n(711),o=n(601),i=n(803);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return b(e,arguments,O(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),m(a,e)})(e)}function b(e,t,n){return(b=f()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&m(r,n.prototype),r}).apply(null,arguments)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(v,e);var t,n,i,c,s,b=(t=v,n=f(),function(){var e,a=O(t);if(n){var r=O(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return l(this,e)});function v(e,t,n,r,i,c,u){var s,f,m,O,p;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),p=b.call(this,e);var j,k=Array.isArray(t)?0!==t.length?t:void 0:t?[t]:void 0,y=n;!y&&k&&(y=null===(j=k[0].loc)||void 0===j?void 0:j.source);var S,g=r;!g&&k&&(g=k.reduce((function(e,t){return t.loc&&e.push(t.loc.start),e}),[])),g&&0===g.length&&(g=void 0),r&&n?S=r.map((function(e){return Object(o.a)(n,e)})):k&&(S=k.reduce((function(e,t){return t.loc&&e.push(Object(o.a)(t.loc.source,t.loc.start)),e}),[]));var h=u;if(null==h&&null!=c){var I=c.extensions;Object(a.a)(I)&&(h=I)}return Object.defineProperties(d(p),{name:{value:"GraphQLError"},message:{value:e,enumerable:!0,writable:!0},locations:{value:null!==(s=S)&&void 0!==s?s:void 0,enumerable:null!=S},path:{value:null!=i?i:void 0,enumerable:null!=i},nodes:{value:null!=k?k:void 0},source:{value:null!==(f=y)&&void 0!==f?f:void 0},positions:{value:null!==(m=g)&&void 0!==m?m:void 0},originalError:{value:c},extensions:{value:null!==(O=h)&&void 0!==O?O:void 0,enumerable:null!=h}}),null!=c&&c.stack?(Object.defineProperty(d(p),"stack",{value:c.stack,writable:!0,configurable:!0}),l(p)):(Error.captureStackTrace?Error.captureStackTrace(d(p),v):Object.defineProperty(d(p),"stack",{value:Error().stack,writable:!0,configurable:!0}),p)}return i=v,(c=[{key:"toString",value:function(){return p(this)}},{key:r.c,get:function(){return"Object"}}])&&u(i.prototype,c),s&&u(i,s),v}(s(Error));function p(e){var t=e.message;if(e.nodes)for(var n=0,a=e.nodes;n<a.length;n++){var r=a[n];r.loc&&(t+="\n\n"+Object(i.a)(r.loc))}else if(e.source&&e.locations)for(var o=0,c=e.locations;o<c.length;o++){var u=c[o];t+="\n\n"+Object(i.b)(e.source,u)}return t}},959:function(e,t,n){"use strict";var a=n(459),r=n(564),o=n(390);var i=function(e,t,n){(void 0===n||Object(o.a)(e[t],n))&&(void 0!==n||t in e)||Object(r.a)(e,t,n)},c=n(937),u=n(966),l=n(967),d=n(965),s=n(968),b=n(505),f=n(247),m=n(927),O=n(502),v=n(549),p=n(227),j=n(942),k=n(557);var y=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},S=n(915),g=n(706);var h=function(e){return Object(S.a)(e,Object(g.a)(e))};var I=function(e,t,n,a,r,o,c){var S=y(e,n),g=y(t,n),I=c.get(g);if(I)i(e,n,I);else{var w=o?o(S,g,n+"",e,t,c):void 0,N=void 0===w;if(N){var R=Object(f.a)(g),T=!R&&Object(O.a)(g),A=!R&&!T&&Object(k.a)(g);w=g,R||T||A?Object(f.a)(S)?w=S:Object(m.a)(S)?w=Object(d.a)(S):T?(N=!1,w=Object(u.a)(g,!0)):A?(N=!1,w=Object(l.a)(g,!0)):w=[]:Object(j.a)(g)||Object(b.a)(g)?(w=S,Object(b.a)(S)?w=h(S):Object(p.a)(S)&&!Object(v.a)(S)||(w=Object(s.a)(g))):N=!1}N&&(c.set(g,w),r(w,g,a,o,c),c.delete(g)),i(e,n,w)}};var w=function e(t,n,r,o,u){t!==n&&Object(c.a)(n,(function(c,l){if(u||(u=new a.a),Object(p.a)(c))I(t,n,l,r,e,o,u);else{var d=o?o(y(t,l),c,l+"",t,n,u):void 0;void 0===d&&(d=c),i(t,l,d)}}),g.a)},N=n(920),R=Object(N.a)((function(e,t,n){w(e,t,n)}));t.a=R},971:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}}}]);
//# sourceMappingURL=owa.579.js.map
self.scriptsLoaded['owa.579.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.579.js'] = (new Date()).getTime();