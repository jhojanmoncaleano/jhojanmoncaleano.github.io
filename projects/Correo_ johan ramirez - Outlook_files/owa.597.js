self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.597.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[597,2033],{117:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(36);function o(){let t=Object(r.b)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}function i(){return o()+"/"}},121:function(t,e,n){"use strict";var r=n(2),o=n(12);const i={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1},loadThemeFromHostApp:{default:!1,opx:!0},loadCultureFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,native:!1,opx:!0},opxServiceWorker:{default:!1,opx:!0},routeOptionsStaticUrl:{default:!1,opx:!0},scenarioData:{default:!1,opx:!0},macA11y:{default:!1,macoutlook:!0},joinTeamsMeetingHandler:{default:!1,hub:!0,opx:!0},use3SPeopleSuggestions:{default:!0,macoutlook:!1},defaultCalendarColor:{default:!1,opx:!0},roomAddedHandler:{default:!1,opx:!0},roomFinderFreeBusyStyles:{default:!1,macoutlook:!0,outlookdesktop:!0},defaultSelectCalendarItemSvg:{default:!0,opx:!1},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0},ribbonFeedback:{default:!1,hub:!0},composeFrom:{default:!1,opx:!0},groupDiscoverCloseButton:{default:!1,opx:!0},updateModalProps:{default:!1,opx:!0},modalOpenedHandler:{default:!1,opx:!0},defaultOutlookThemeColor:{default:!0,opx:!1},yammerDailyDigest:{default:!1,outlookdesktop:!0},yammerDirectFollower:{default:!1,outlookdesktop:!0},yammerDiscovery:{default:!1,outlookdesktop:!0},yammerHostClientType:{default:!1,native:!0,opx:!0},linkClicked:{default:!1,outlookdesktop:!0},showMinimumThreeInsights:{default:!1,opx:!0},groupCreatedHandler:{default:!1,opx:!0},groupDeletedHandler:{default:!1,opx:!0},updateSearchAnswerOnQueryChange:{default:!1,opx:!0},insightsCountUpdatedHandler:{default:!1,opx:!0},processMeetingInsightsHandler:{default:!1,opx:!0},processEmptyYammerPublishersHandler:{default:!1,opx:!0},focusZoneCicularNavigation:{default:!1,opx:!0},componentTokenProvider:{default:!1,opx:!0,native:!0,hub:!0},hideCalendarLeftNav:{default:!1,teamshub:!0},hideAppSuiteHeader:{default:!1,hub:!0},metaOSTest:{default:!1,hub:!0},hideOfficeRail:{default:!1,hub:!0},openMailInHub:{default:!1,win32outlookhub:!0},openComposeMailInHub:{default:!1,win32outlookhub:!0},settings:{default:!0,opx:!1,hub:!1},multiAccounts:{default:!0,teams:!1,outlookdesktop:!1,widget:!1,native:!1,hub:!1},nativeDiagnostics:{default:!1,native:!0},nativeQsp:{default:!1,native:!0},moduleSwitch:{default:!1,native:!0},diagInAppSupport:{default:!1,native:!0},diagFeedbackJs:{default:!1,native:!0},diagFeedbackEmailGroup:{default:!1,native:!0},diagFeedbackNoAttachSR:{default:!1,native:!0},diagFeatureCrew:{default:!1,native:!0},diagThrottleFeedbackEmail:{default:!1,native:!0},diagToggleFeedback:{default:!1,native:!0},newOutlookToggle:{default:!1,native:!0},monarchErrorMessage:{default:!1,native:!0},noteFeedSidePanel:{default:!0,native:!1},whatsNew:{default:!0,native:!1},owaBrandingCharm:{default:!0,native:!1},appLauncher:{default:!0,native:!1},incorrectNativeEntryPoint:{default:!1,native:!0},metaOSFeedback:{default:!1,hub:!0},monarchFeedback:{default:!1,native:!0},native:{default:!1,native:!0},offlineResolvers:{default:Object(o.i)("offlineWeb"),native:!0},managedQueryLink:{default:!1,native:!0},wrongIndex:{default:!1,native:!0},outlookSuiteHeaderStrategy:{default:!1,native:!0},pauseInbox:{default:!0,native:!1},hxVersionQueryStringParam:{default:!1,native:!0},nativeServiceWorker:{default:!1,native:!0},nativeHostAttachmentHijack:{default:!1,native:!0},useNativeConversationOptions:{default:!1,native:!0},reboot:{default:!1,native:!0},calendarFolderHx:{default:!1,native:!0},skipAwaitLpcConfig:{default:!1,opx:!0},workloadScenarioSettings:{default:!0,opx:!1},ribbonDefaultToSLR:{default:!1,native:!0},ribbonPersistDefault:{default:!1,native:!0},updateHostAppIcon:{default:!1,native:!0},projectionCustomTitlebar:{default:!1,native:!0},monarchDensity:{default:!1,native:!0},toDoNewTab:{default:!1,native:!0},floodgate:{default:!0,opx:!1},meControlAccountSwitching:{default:!0,native:!1},smimeExtension:{default:!0,native:!1},platformAppSdk:{default:!1,hub:!0},resourceTokenFromHost:{default:!1,native:!0,opx:!0},useBaseTheme:{default:!1,win32outlookhub:!0,hub:!1},acctmonaccounts:{default:!1,native:!0},showOWAMailtoBanner:{default:!0,native:!1},copyLinkUsingClipboardApi:{default:!1,native:!0},outlookDesktopToMonarchPreferenceMigration:{default:!1,native:!0},nativeMessaging:{default:!1,native:!0,widget:!0},disableAppModuleKeys:{default:!1,hub:!0},nativeReactions:{default:!1,native:!0},promptRebootNativeHost:{default:!1,native:!0},openEventsInNewWindow:{default:!1,native:!0,win32outlookhub:!0},nativeFriendlyKeyboarding:{default:!1,native:!0,win32outlookhub:!0},altForKeytips:{default:!1,native:!0,win32outlookhub:!0},msalTokenFetch:{default:!0,native:!1,teams:!1,opx:!1,hub:!1},outlookNpsDialogMonarch:{default:!1,native:!0}};var u=n(131),a=n(130);const c=t=>{const e=(t=>i[t])(t);if(e){if(Object(u.a)()&&r.e in e)return e[r.e];if(Object(a.b)()&&r.h in e)return e[r.h];let t=Object(r.A)();if(t&&t in e)return e[t];if(t&&(t===r.i||t===r.k)&&r.b in e)return e[r.b];const n=Object(r.E)();return n&&n in e?e[n]:n&&(n===r.g||n===r.d||n===r.c||n===r.a||n===r.h||n===r.f||n===r.j)&&"opx"in e?e.opx:e.default}return!1};n.d(e,"a",(function(){return c}))},122:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));let r={};function o(t){r=t}function i(){return r}},130:function(t,e,n){"use strict";var r=n(138),o=n(2),i=n(8),u=n(6);function a(){return!!Object(u.f)("hostApp",Object(i.a)().location)&&Object(u.c)("hostApp").toLowerCase()==o.h}n.d(e,"a",(function(){return r.a})),n.d(e,"c",(function(){return r.b})),n.d(e,"b",(function(){return a}))},138:function(t,e,n){"use strict";let r;function o(){if(!r)throw new Error("OpxHostApi has not been initialized yet.");return r}function i(){return!!r}function u(t){r=t}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return u}))},150:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return s}));var r=n(259),o=n(11),i=n(122);const u="featureOverrides";function a(){const t=Object(o.a)(self,u);return t?Object(r.a)(t):{}}function c(){Object(o.d)(self,u)}function s(t){const e=Object(o.a)(self,u);let n=e?e.split(","):[];for(const e of t){const t=e.name.toLowerCase(),r=e.isEnabled?t:`-${t}`,o=Object(i.a)()[t],u=e.isEnabled===!o,a=new RegExp(`^-?${t}$`,"i");n=n.filter(t=>!a.test(t)),u&&n.push(r)}Object(o.e)(self,u,n.join(","))}},1575:function(t,e,n){"use strict";n.r(e);var r=n(3083);function o(t,e,n,o){return Object(r.g)(n,e,o,t)}n.d(e,"makeOwsPrimeRequest",(function(){return r.g})),n.d(e,"makePostRequest",(function(){return r.e})),n.d(e,"makePatchRequest",(function(){return r.d})),n.d(e,"makePutRequest",(function(){return r.f})),n.d(e,"makeGetRequest",(function(){return r.b})),n.d(e,"makeDeleteRequest",(function(){return r.a})),n.d(e,"makeGraphRequest",(function(){return r.c})),n.d(e,"sendOwsPrimeRequest",(function(){return o}))},164:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,o=!1;function i(e){r--,delete t[e]}this.put=function(e,n,o,u){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var a=t[e];a?clearTimeout(a.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(e),u&&u(e,n)}.bind(this),o)),t[e]=c,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(e),n},this.clear=function(){for(var i in t)clearTimeout(t[i].timeout);r=0,t=Object.create(null),o&&(e=0,n=0)},this.get=function(i){var u=t[i];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return o&&e++,u.value;o&&n++,r--,delete t[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){o=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),o=Date.now(),i=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(i)if(t[u])continue;var a=r[u],c=a.expire-o;if(c<=0){this.del(u);continue}c=c>0?c:void 0,this.put(u,a.value,c)}return this.size()}}t.exports=new r,t.exports.Cache=r},176:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(77),o=n(258),i=n(40);function u(t,e){if(!Object(o.a)()){if(e)return!1;i.d(`Attempted to read ${t} before feature flags were initialized.`)}return Object(r.a)().featureFlags.get(t.toLowerCase())||!1}},177:function(t,e,n){"use strict";function r(t,e){if(!e||0==Object.keys(e).length)return t;const n=-1!==t.indexOf("?");return(t+=n?"&":"?")+Object.keys(e).map((t,n)=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}n.d(e,"a",(function(){return r}))},178:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));let r=!1;function o(){return r}function i(t){r=t}},198:function(t,e,n){"use strict";var r=n(40);let o;function i(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var u=n(108);const a=500,c=[],s=[],f=[];let l=!0;function d(t,e){Object(r.g)((t,e,n)=>{l&&(e==r.b.Error&&s.push({message:t,error:n}),c.push({message:t,level:e}))}),t(b),e(b),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function p(t){const e=Object(u.a)(t);return l=!1,{traces:c,errors:s,network:f,usage:e}}function b(){l&&f.push(arguments)}n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p})),n.d(e,"d",(function(){return u.b})),n.d(e,"c",(function(){return i}))},210:function(t,e,n){"use strict";e.decode=e.parse=n(367),e.encode=e.stringify=n(368)},214:function(t,e,n){"use strict";var r=n(22);e.a=(t,e)=>new Date(+t+e*r.g)},22:function(t,e,n){"use strict";n.d(e,"i",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return a})),n.d(e,"l",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return f})),n.d(e,"j",(function(){return l})),n.d(e,"c",(function(){return d})),n.d(e,"k",(function(){return p})),n.d(e,"d",(function(){return b}));const r=6048e5,o=864e5,i=36e5,u=6e4,a=1e3,c=12,s=30,f=365,l=-864e13,d=864e13,p=Date.UTC(1601,0,1),b=Date.UTC(4501,0,1)},221:function(t,e,n){"use strict";var r=n(22);e.a=(t,e)=>new Date(+t+e*r.h)},249:function(t,e,n){"use strict";var r=n(29);e.a=()=>Object(r.a)().UserOptions},250:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("ADD_FOLDER_TO_DEFAULT_FOLDER_MAPPINGS",(t,e)=>({defaultFolderName:t,folderId:e}))},251:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(29),o=n(40);function i(){const t=Object(r.a)();return t&&t.SessionSettings?t.SessionSettings.LogonEmailAddress:(o.d("SessionSettings not available"),"no-smtp-address")}},258:function(t,e,n){"use strict";var r=n(77),o=n(3),i=n(14),u=n(259),a=n(6);var c=n(102),s=n(176);var f=n(150),l=n(122),d=n(299);n.d(e,"a",(function(){return b}));let p=!1;function b(){return p}const v=Object(o.action)("initializeFeatureFlags",t=>{const e=(t||[]).reduce((t,e)=>(t[e.toLowerCase()]=!0,t),{}),n=function(t=s.a){return t("ring-dogfood")?"Dogfood":t("ring-microsoft")?"Microsoft":t("ring-firstrelease")?"FirstRelease":t("ring-ww")?"WW":"Unknown"}(t=>e[t]);return m(e,function(t){return Object.keys(d.a).reduce((e,n)=>(e[n.toLowerCase()]=d.a[n].ring.indexOf(t)>-1,e),{})}(n)),Object(c.b)(n),Object(l.b)(function(t){let e={};for(let n of Object.keys(t))e[n]=t[n];return e}(e)),"Dogfood"==n&&m(e,Object(f.b)()),e["fwk-devtools"]&&m(e,function(t){for(const[e,n]of Object.entries(Object(a.d)()))if(e.toLowerCase()===t.toLowerCase())return Object(u.a)(n);return{}}("features")),e});function m(t,e){for(let n of Object.keys(e))t[n.toLowerCase()]=e[n]}Object(o.mutator)(v,t=>{Object(r.a)().featureFlags=new i.ObservableMap(t),p=!0});e.b=v},259:function(t,e,n){"use strict";function r(t){let e={};return t.split(",").forEach(t=>{let n=!0;0===t.indexOf("-")&&(n=!1,t=t.slice(1,t.length)),e[t.toLowerCase()]=n}),e}n.d(e,"a",(function(){return r}))},267:function(t,e,n){"use strict";var r=n(912);n.d(e,"a",(function(){return r.a}))},276:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var r=n(117),o=n(97),i=n(2);let u;function a(t){u=t}async function c(t){var e,n;if(Object(i.P)())return o.f.importAndExecute(Object(r.a)());const a=u&&await u(void 0,t);if(a&&a.length>0){if("bearer"===(null===(e=null==a?void 0:a.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return a.split(" ")[1];if("msauth1.0"===(null===(n=null==a?void 0:a.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return a}}},283:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(57),o=n(316);function i(t){const e=t?Object(o.a)(t):r.a.userConfiguration;return!!(null==e?void 0:e.SessionSettings)&&0!==e.SessionSettings.WebSessionType}},29:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(57);function o(){return r.a.userConfiguration}},299:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={"fwk-betterDiagnostics-panel":{ring:["Dogfood"]},"fwk-betterDiagnostics-service":{ring:["Dogfood"]},"fwk-feedbackCharm":{ring:["Dogfood","Microsoft"]}}},2997:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return a}));var r=n(2),o=n(36),i=n(49);function u(){let t=Object(r.v)("targetServer"),e="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.v)(e)}function a(){let t=function(){let t="",e=Object(o.b)().pathname.split("/").filter(t=>t.length);return e.length>=2&&e[1].match(/.+@.+/)&&(t=e[1]),t}();if(0===t.length){let e=Object(i.g)();if(null==e?void 0:e.SessionSettings){let n=e.SessionSettings.ExternalDirectoryTenantGuid,r=e.SessionSettings.UserPuid;r&&n&&(t=`PUID:${r}@${n}`)}}return 0===t.length&&(t=u()),t}},30:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(70);function o(t){return Object(r.a)(t,[r.c,r.b])}},3083:function(t,e,n){"use strict";var r=n(44),o=n(267),i=n(6),u=n(597),a=n(2997),c=n(50),s=n(154),f=n(151),l=n(391),d=n(40),p=n(81),b=n(621);const v="owsserver",m="owsapi";var O=n(2),h=n(155),g=n(156),j=n(13);n.d(e,"g",(function(){return C})),n.d(e,"c",(function(){return x})),n.d(e,"e",(function(){return T})),n.d(e,"d",(function(){return A})),n.d(e,"f",(function(){return I})),n.d(e,"b",(function(){return F})),n.d(e,"a",(function(){return R}));const w=2048;var k=null;const y=new Map([["OutlookOptions","fwk-owsprimecosmic-outlookoptions"]]);function C(t,e,n,o,i,a,c,s,f){const d="object"==typeof n&&n.customHeaders||c,p=d?Object.keys(d).reduce((t,e)=>(t[e.toLowerCase()]=d[e],t),{}):void 0;let b="object"==typeof n?Object.assign(Object.assign({},n),{customHeaders:p}):{returnFullResponse:n,correlationId:i,requestObject:a,customHeaders:p,throwServiceError:s,includeCredentials:f};if(!b.customHeaders||!b.customHeaders.authorization){void 0===b.includeCredentials&&(b.includeCredentials=!Object(r.j)("auth-authzHeaderNoCookies"));let n=Object(u.n)(),[i,a]=Object(l.getAccessTokenforResourceAsLazy)(n,"OwsGateway");return i?S(t,e,b,o,i):a.then(n=>S(t,e,b,o,n))}return S(t,e,b,o)}function S(t,e,n,l,C){var S;const{returnFullResponse:x,correlationId:T,requestObject:A,customHeaders:I,throwServiceError:F,sendPayloadAsBody:R,includeCredentials:M}=n;let D=new Headers;D.append("X-OWA-CANARY",Object(c.a)()),D.append("X-MS-AppName","owa-react"+Object(u.r)()),D.set("X-OWA-SessionId",Object(O.M)());const E={n:Object(s.a)().toString()};T&&(D.append("client-request-id",T),E.cri=T),I&&Object.keys(I).forEach(t=>{D.append(t,I[t])});const P=Object(p.b)();if(P&&(D.append(p.a,P),E.cv=P),C){const t="Authorization";if(C.length>0&&"msauth1.0"===(null===(S=null==C?void 0:C.split(" ")[0])||void 0===S?void 0:S.toLowerCase()))D.append(t,C);else{if(Object(r.j)("fwk-devTools")){var U=C.split(".");3==U.length&&0!==U[2].length||d.d(`BearerTokenIncomplete ${U.length}`)}D.append(t,`Bearer  ${C}`)}}let N={method:e,credentials:!1!==M?"same-origin":"omit",body:n.requestBody,headers:D};if(A){D.append("Content-Type","application/json");const n=JSON.stringify(A),o=t.search(/ows\/|owa\//i)>=0;if(Object(r.j)("fwk-emptyPost")&&o&&"POST"==e&&!R){const t=encodeURIComponent(n);t.length<w?D.append("X-OWA-UrlPostData",t):N.body=n}else N.body=n}Object(h.a)(D),Object(g.a)(D);const L=function(t){const e=new RegExp(/\bows\//,"i");if(t.match(e)){let e=t.split("/");if(e.length>3&&"api"==e[1]||e.length>2){return"api"==e[1]?e[3]:e[2]}}return null}(t);if(null!=L){const e=function(t){if(y.has(t)){let e=y.get(t);if(e)return Object(r.j)(e)}return!1}(L);if(e){const e=new RegExp(/\bows\//,"i");t=t.replace(e,"owsprime/")}null==l&&(l=e?"OWSPrimeCosmic"+L:"OWSPrime"+L)}let H=async function(t,e){if(!e||!e["x-anchormailbox"]){let e=Object(j.a)().getAnchorMailbox?await Object(j.a)().getAnchorMailbox():Object(a.a)();e&&e.length>0&&(t.headers.append("x-anchormailbox",e),t.headers.append("X-RoutingParameter-SessionKey",e))}return t}(N,I);const $=function(t,e){var n=function(t,e){var n=Object(u.x)(t,e),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(u.g)(r[0]),n=r.join("/"));return Object(u.a)(n)}(Object(r.j)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",t),o=Object(u.n)()+n;if(Object(r.j)("fwk-devTools")&&Object(i.f)(v)&&(Object(i.c)(m)==t||!Object(i.f)(m))&&(null==k&&(k=confirm(`A query param '${v}' is set to redirect some of calls to '${Object(i.c)(v)}'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.`)),k)){var a=t.split("/");a.length>0&&("ows"==a.shift()||"owsprime"==a.shift())&&(t=a.join("/")),o=Object(i.c)(v)+"/"+t}return Object(u.v)(o,e)}(t,E),q=Object(f.a)($,H);return Object(b.a)(N,n,q,l,$),q.then(n=>{if(x)return n;if(Object(o.a)(n.status))return n.text().then(t=>t?JSON.parse(t):{});throw new Error(`${e} request to ${t} failed, http error:${n.status}`)}).catch(t=>{if(d.h.warn(t),F){throw{stack:t.stack,message:t.message,correlationVector:P,correlationId:n.correlationId,networkError:!0}}return[]})}function x(t,e){var n,r;let o="OWSGateway";try{let t=null===(r=null===(n=JSON.parse(e))||void 0===n?void 0:n[0])||void 0===r?void 0:r.operationName;null!=t&&(o=o+"."+t)}catch(t){}return C(t,"POST",{requestBody:e,customHeaders:{"Content-Type":"application/json"},returnFullResponse:!0},o)}function T(t,e,n,r,o,i,u,a,c,s){return C(t,"POST",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,sendPayloadAsBody:u,includeCredentials:a,datapoint:s},c)}function A(t,e,n,r,o,i,u,a){return C(t,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,includeCredentials:u},a)}function I(t,e,n,r,o,i,u,a){return C(t,"PUT",r,u,n,e,o,i,a)}function F(t,e,n,r,o,i,u){return C(t,"GET",n,u,e,void 0,r,o,i)}function R(t,e,n,r,o,i,u,a){return C(t,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,includeCredentials:u},a)}},31:function(t,e,n){"use strict";function r(...t){return t.filter(t=>t).map(u).filter(t=>0!==t.length).join("/")}function o(t){return t?t.length>0&&"/"!==t[0]?"/"+t:t:"/"}function i(t){return t.length>0&&"/"!==t[t.length-1]?t+"/":t}function u(t){return t.replace(/^\/*/,"").replace(/\/*$/,"")}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i}))},311:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return u}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function u(t){return r.test(t)}},316:function(t,e,n){"use strict";var r=n(322),o=n(57);var i=n(29);function u(t){return!t||Object(r.a)(t)?Object(i.a)():function(t){return o.a.connectedAccountsUserConfigurationMap.get(t)}(t)}n.d(e,"a",(function(){return u}))},317:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),o=n(57);const i=Object(r.mutatorAction)("setUserConfiguration",t=>{t(o.a.userConfiguration)})},318:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(20);const o=new r.c(()=>n.e(945).then(n.bind(null,1060))),i=new r.a(o,t=>t.updateUserConfigurationService)},322:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(251);function o(t){return null==t||Object(r.a)()==t}},323:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("userConfigurationSet",(t,e)=>({userConfiguration:t,userIdentity:e}))},36:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));var r=n(8);function o(){return Object(r.a)().location}function i(){return window.location}},367:function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,i){e=e||"&",n=n||"=";var u={};if("string"!=typeof t||0===t.length)return u;var a=/\+/g;t=t.split(e);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var s=t.length;c>0&&s>c&&(s=c);for(var f=0;f<s;++f){var l,d,p,b,v=t[f].replace(a,"%20"),m=v.indexOf(n);m>=0?(l=v.substr(0,m),d=v.substr(m+1)):(l=v,d=""),p=decodeURIComponent(l),b=decodeURIComponent(d),r(u,p)?o(u[p])?u[p].push(b):u[p]=[u[p],b]:u[p]=b}return u};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},368:function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?i(u(t),(function(u){var a=encodeURIComponent(r(u))+n;return o(t[u])?i(t[u],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[u]))})).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var u=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},392:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(70);function o(t){return Object(r.a)(t,[r.c])}},417:function(t,e,n){"use strict";class r{constructor(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(t){this.taskList.unshift(t),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(e,"a",(function(){return r}))},44:function(t,e,n){"use strict";var r=n(77),o=n(3);var i=Object(o.action)("UPDATE_ACTIVE_FLIGHTS",t=>({featureOverrides:t}));function u(t){if(!t)return[];let e=[];return["addin","an","auth","cal","cmp","doc","eventify","fms","fwk","getstarted","grp","gsx","help","honeybee","inline","iris","lightning","lpc","mc","notes","nps","peo","people","mc","platform","playMyEmails","rp","sea","sxs","todo","tra","tri","sig","mon","usv","woven"].forEach(n=>{Object.keys(t[n]||{}).forEach(r=>{!0===t[n][r]&&e.push(`${n}-${r}`)})}),e}Object(o.mutator)(i,t=>{for(const e of t.featureOverrides)Object(r.a)().featureFlags.set(e.name.toLowerCase(),e.isEnabled)});var a=n(14),c=n(176);function s(t,e){if(Object(c.a)(t))e();else{let n=Object(a.autorun)(()=>{Object(c.a)(t)&&(e(),n())})}}var f=n(258),l=n(150);let d=Object(o.action)("setFeatureFlag<T>",(t,e)=>({feature:t,isOn:e}));Object(o.mutator)(d,(function(t){Object(r.a)().featureFlags.set(t.feature.toLowerCase(),t.isOn)})),Object(o.orchestrator)(d,(function(t){let e=t.feature,n=t.isOn;Object(l.c)([{name:e.toLowerCase(),isEnabled:n}])}));var p=d,b=n(122);function v(){const t=Object(b.a)();for(let e of Object(r.a)().featureFlags.keys())p(e,!!t[e]);Object(l.a)()}function m(){return Object.keys(Object(b.a)())}const O="fwk-uberflag",h="fwk-consumer",g="fwk-business";function j(){return y().includes(O)?1:0}function w(t){const e=y();return t&&e.includes(h)&&!e.includes(g)||!t&&e.includes(g)&&!e.includes(h)?1:0}let k;function y(){return k||(k=m().filter(t=>t===O||t===h||t===g)),k}function C(t){const e=Object(r.a)().featureFlags;return[...e.keys()].filter(n=>0==n.indexOf(t)&&e.get(n.toLowerCase()))}n.d(e,"d",(function(){return S})),n.d(e,"c",(function(){return u})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return f.b})),n.d(e,"j",(function(){return c.a})),n.d(e,"l",(function(){return p})),n.d(e,"k",(function(){return v})),n.d(e,"n",(function(){return l.c})),n.d(e,"m",(function(){return i})),n.d(e,"e",(function(){return m})),n.d(e,"a",(function(){return j})),n.d(e,"b",(function(){return w})),n.d(e,"f",(function(){return b.a})),n.d(e,"g",(function(){return C}));let S=Object(r.a)().featureFlags},455:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(317),o=n(318);function i(t,e,n){return Object(r.a)(t),o.a.importAndExecute(e,n)}},458:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(57);function o(){var t;return!!(null===(t=r.a.userConfiguration)||void 0===t?void 0:t.SessionSettings)&&0==r.a.userConfiguration.SessionSettings.WebSessionType}},460:function(t,e,n){"use strict";var r=n(250),o=n(57),i=n(3),u=n(14),a=n(323),c=n(15);const s=Object(i.mutatorAction)("setUserConfiguration",t=>{o.a.userConfiguration=t||{}}),f=Object(i.mutatorAction)("setConnectedAccountsUserConfig",(t,e)=>{o.a.connectedAccountsUserConfigurationMap||(o.a.connectedAccountsUserConfigurationMap=new u.ObservableMap({})),o.a.connectedAccountsUserConfigurationMap.set(e,t||{})});e.a=Object(c.g)((t,e)=>{const n=t.SessionSettings,o=null==n?void 0:n.DefaultFolderNames,i=null==n?void 0:n.DefaultFolderIds;n&&(delete n.DefaultFolderIds,delete n.DefaultFolderNames),e?f(t,e):(s(t),function(t,e){if(t)for(let n=0;n<t.length;n++){let o=t[n];if(!o)break;let i=null==e?void 0:e[n];i&&Object(r.a)(o,i.Id)}}(o,i)),Object(a.a)(t,e)},"uc")},464:function(t,e,n){"use strict";var r=n(249);e.a=()=>{var t;return null===(t=Object(r.a)())||void 0===t?void 0:t.WorkingHours}},465:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(29);function o(){var t;return null===(t=Object(r.a)().SessionSettings)||void 0===t?void 0:t.UserDisplayName}},466:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(29);function o(){var t;return null===(t=Object(r.a)().SessionSettings)||void 0===t?void 0:t.UserEmailAddress}},49:function(t,e,n){"use strict";var r=n(29),o=n(250);function i(){var t;return null===(t=Object(r.a)().SessionSettings)||void 0===t?void 0:t.UserCulture}var u=n(465),a=n(466);function c(){var t;return null===(t=Object(r.a)().SessionSettings)||void 0===t?void 0:t.UserProxyAddresses}function s(){var t;return null===(t=Object(r.a)().UserOptions)||void 0===t?void 0:t.DisplayDensityMode}var f=n(249),l=()=>{var t;return null===(t=Object(f.a)())||void 0===t?void 0:t.TimeZone},d=n(464);var p=n(44);const b="PremiumConsumerSetting";function v(){var t,e,n,o,i,u;if(null===(e=null===(t=Object(r.a)())||void 0===t?void 0:t.SessionSettings)||void 0===e?void 0:e.IsPremiumConsumerMailbox)return!0;if(Object(p.j)("auth-PremiumCheckUpdates")){const t=null===(o=null===(n=Object(r.a)())||void 0===n?void 0:n.PrimeSettings)||void 0===o?void 0:o.Items,e=null==t?void 0:t.filter(t=>(null==t?void 0:t.Id)===b);return null!==(u=null===(i=null==e?void 0:e[0])||void 0===i?void 0:i.Value)&&void 0!==u&&u}return!1}var m=n(316),O=n(460),h=n(57),g=n(3),j=Object(g.mutatorAction)("removeUserConfiguration",(function(t){h.a.connectedAccountsUserConfigurationMap&&h.a.connectedAccountsUserConfigurationMap.delete(t)})),w=n(323),k=n(458),y=n(40);function C(){const t=Object(r.a)();return t&&t.SessionSettings?t.SessionSettings.UserEmailAddress:(y.d("SessionSettings not available"),"no-smtp-address")}var S=n(251),x=n(322),T=n(283);function A(){const t=h.a.connectedAccountsUserConfigurationMap?[...h.a.connectedAccountsUserConfigurationMap.keys()]:[],e=Object(S.a)();return e?[e,...t]:t}function I(){var t,e,n,o;const i=[];let u=null===(e=null===(t=Object(r.a)())||void 0===t?void 0:t.PrimeSettings)||void 0===e?void 0:e.Items;if(u)for(let t of u){const e=null===(o=null===(n=t.Value)||void 0===n?void 0:n.options)||void 0===o?void 0:o[0];e&&i.push(e)}return i}var F=n(317),R=n(455),M=n(318);const D="CalendarCloudSettings";function E(){var t,e,n;const o=null===(e=null===(t=Object(r.a)())||void 0===t?void 0:t.PrimeSettings)||void 0===e?void 0:e.Items,i=null==o?void 0:o.filter(t=>(null==t?void 0:t.Id)==D),u=null===(n=null==i?void 0:i[0])||void 0===n?void 0:n.Value,a=[];return null==u||u.forEach(t=>{a.push({name:t.name,value:t.value,source:t.source})}),a}Object(g.mutator)(o.a,t=>{const e=t.defaultFolderName,n=t.folderId;if(!e)throw new Error("Input parameter defaultFolderName while setting in map must not be null.");if(!n)throw new Error("Input parameter to folderId while setting in map must not be null.");h.a.defaultFolderNameToIdMap.set(e,n),h.a.defaultFolderIdToNameMap.set(n,e)});var P=Object(g.action)("setUserConfigurationPonts",t=>({pontType:t}));Object(g.mutator)(P,t=>{var e;(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.NewEnabledPonts)&&(Object(r.a)().UserOptions.NewEnabledPonts&=~t.pontType)});n.d(e,"g",(function(){return r.a})),n.d(e,"a",(function(){return o.a})),n.d(e,"i",(function(){return i})),n.d(e,"k",(function(){return u.a})),n.d(e,"l",(function(){return a.a})),n.d(e,"n",(function(){return c})),n.d(e,"j",(function(){return s})),n.d(e,"m",(function(){return f.a})),n.d(e,"o",(function(){return l})),n.d(e,"p",(function(){return d.a})),n.d(e,"t",(function(){return v})),n.d(e,"h",(function(){return m.a})),n.d(e,"w",(function(){return O.a})),n.d(e,"v",(function(){return j})),n.d(e,"z",(function(){return w.a})),n.d(e,"q",(function(){return k.a})),n.d(e,"c",(function(){return C})),n.d(e,"b",(function(){return S.a})),n.d(e,"s",(function(){return x.a})),n.d(e,"r",(function(){return T.a})),n.d(e,"d",(function(){return A})),n.d(e,"f",(function(){return I})),n.d(e,"x",(function(){return F.a})),n.d(e,"y",(function(){return R.a})),n.d(e,"u",(function(){return M.a})),n.d(e,"e",(function(){return E}))},55:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(36);function o(){var t;const e=null===(t=Object(r.b)())||void 0===t?void 0:t.pathname;if(e){let t=e.split("/").filter(t=>!!t);return t[0]?t[0].toLowerCase():null}return null}},57:function(t,e,n){"use strict";var r=n(3),o=n(14);const i={userConfiguration:{},connectedAccountsUserConfigurationMap:new o.ObservableMap({}),defaultFolderNameToIdMap:new o.ObservableMap({}),defaultFolderIdToNameMap:new o.ObservableMap({})},u=r.createStore("owaSessionStore",i)();e.a=u},597:function(t,e,n){"use strict";var r=n(392),o=n(30),i=n(70);function u(t){return Object(i.a)(t,[i.b])}var a=n(31),c=n(55);function s(t){return Object(a.b)(Object(a.c)(Object(a.a)(Object(c.a)()||"",t)))}var f=n(921),l=n(919),d=n(177);let p,b,v;function m(){return p||(p=Object(o.a)("/calendar")+"/"),p}function O(){return b||(b=Object(o.a)("/mail")+"/"),b}function h(){return v||(v=Object(o.a)("/files")+"/"),v}var g=n(922);let j,w,k;function y(t){return j&&w===t||(w=t,j=t?Object(o.a)("/people/group/owner")+"/":Object(o.a)("/people/group/member")+"/"),j}function C(){return k||(k=Object(o.a)("/people/group/deleted")+"/"),k}function S(t){return window.location.origin+m()+"showPeek/item/"+encodeURIComponent(t)}var x=n(957),T=n(6),A=n(710);const I=Object(x.a)().split("/").slice(1).join("/")+"deeplink/";function F(t,e,n,r){n&&((r=r||{}).minus="");let o="";if(r){const t=Object(T.d)();Object(A.a)(t),Object.keys(r).filter(t=>t).forEach(e=>t[e]=r[e]),o="?"+Object(T.i)(t)}return`${`/${t}/${I}`}${e}${o}`}var R=n(178),M=n(29);const D="https://to-do.microsoft.com";function E(t,e){var n,r;const o=Object(M.a)(),i=o.UserOptions,u=null===(n=o.SessionSettings)||void 0===n?void 0:n.UserPrincipalName;let a=D,c={};if(null===(r=null==i?void 0:i.ReactOptinSettings)||void 0===r?void 0:r.TasksRedirectUrl){let t="";[a,t]=i.ReactOptinSettings.TasksRedirectUrl.split("?"),c=Object(T.g)(t),u&&(c.auth_upn=u)}return t&&(c.utm_source=t),e&&delete c.fromOwa,Object.keys(c).length>0?Object(d.a)(a,c):a}let P;function U(){return P||(P=Object(o.a)("/eventify")+"?entryPoint=owa"),P}var N=n(117);let L;function H(){return L||(L=Object(o.a)("/host")+"/"),L}n(36);n.d(e,"k",(function(){return r.a})),n.d(e,"t",(function(){return o.a})),n.d(e,"g",(function(){return u})),n.d(e,"m",(function(){return s})),n.d(e,"s",(function(){return f.a})),n.d(e,"x",(function(){return a.a})),n.d(e,"a",(function(){return a.b})),n.d(e,"b",(function(){return a.c})),n.d(e,"o",(function(){return l.a})),n.d(e,"v",(function(){return d.a})),n.d(e,"e",(function(){return m})),n.d(e,"l",(function(){return O})),n.d(e,"h",(function(){return h})),n.d(e,"p",(function(){return g.a})),n.d(e,"j",(function(){return y})),n.d(e,"i",(function(){return C})),n.d(e,"d",(function(){return S})),n.d(e,"q",(function(){return F})),n.d(e,"w",(function(){return R.a})),n.d(e,"u",(function(){return E})),n.d(e,"f",(function(){return U})),n.d(e,"n",(function(){return N.a})),n.d(e,"r",(function(){return c.a})),n.d(e,"c",(function(){return H}))},70:function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var r=n(31),o=n(36),i=n(55);const u=t=>1==t.length&&!isNaN(parseInt(t)),a=t=>!!t.match(/.+@.+/);function c(t,e){var n;let u=t;const a=null===(n=Object(o.b)())||void 0===n?void 0:n.pathname;if(a){const t=a.split("/"+Object(i.a)()+"/")[1];if(t){const n=t.split("/")[0];n&&e.filter(t=>t(n)).length>0&&(u=Object(r.a)(u,n))}}return Object(r.b)(u)}},710:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));const r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function o(t){t&&Object.keys(t).forEach(e=>{r.includes(e)&&delete t[e]})}},77:function(t,e,n){"use strict";var r=n(3);let o={featureFlags:new(n(14).ObservableMap)};e.a=Object(r.createStore)("featureFlags",o)},90:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a}));let r=!1;function o(){return r}function i(t){r=t}let u=!1;function a(t){u=t}},912:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},919:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(36),o=n(30),i=n(117);function u(t){let e=Object(r.b)(),n=Object(i.a)()+Object(o.a)("/owa")+"/",u=e.search&&e.search.length>0;n+=u?e.search:"?";let a=Object.keys(t),c=u;for(let e=0;e<a.length;e++)c?n+="&":c=!0,n+=a[e]+"="+t[a[e]];return n}},921:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(6),o=n(710);function i(){const t=Object(r.d)();Object(o.a)(t);const e=Object(r.i)(t);return e.length>0?"?"+e:""}},922:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(30);let o;function i(){return o||(o=Object(r.a)("/people")+"/"),o}},957:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(55),o=n(30);function i(t){return(Object(o.a)("/"+(t||Object(r.a)()))+"/").replace(/^\//,"")}},97:function(t,e,n){"use strict";n.d(e,"f",(function(){return u})),n.d(e,"h",(function(){return a})),n.d(e,"m",(function(){return c})),n.d(e,"n",(function(){return s})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return b})),n.d(e,"j",(function(){return v})),n.d(e,"l",(function(){return m})),n.d(e,"k",(function(){return O})),n.d(e,"o",(function(){return h})),n.d(e,"i",(function(){return g}));var r=n(4),o=n(90);n.d(e,"a",(function(){return o.a}));const i=new r.b(()=>Promise.all([n.e(15),n.e(903)]).then(n.bind(null,402))),u=new r.a(i,t=>t.getAuthTokenFromMetaOsHub),a=new r.a(i,t=>t.getOwaAuthTokenFromMetaOsHub),c=new r.a(i,t=>t.openCalendarItem),s=(new r.a(i,t=>t.composeMeeting),new r.a(i,t=>t.openMailItem)),f=new r.a(i,t=>t.composeMail),l=new r.a(i,t=>t.executeDeepLink),d=new r.a(i,t=>t.getContext),p=new r.a(i,t=>t.checkCalendarCapability),b=new r.a(i,t=>t.checkMailCapability),v=new r.a(i,t=>t.isDarkTheme),m=(new r.a(i,t=>t.registerHandlers),new r.a(i,t=>t.joinTeamsMeeting),new r.a(i,t=>t.modalOpened),new r.a(i,t=>t.submitTask),new r.a(i,t=>t.notifySuccess)),O=new r.a(i,t=>t.notifyAppLoaded),h=new r.a(i,t=>t.registerIsDarkThemeOnChangeHandler),g=new r.a(i,t=>t.initializeMetaOsCapabilities)}}]);
//# sourceMappingURL=owa.597.js.map
self.scriptsLoaded['owa.597.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.597.js'] = (new Date()).getTime();