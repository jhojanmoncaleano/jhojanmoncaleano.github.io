self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.598.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[598],{10141:function(e){e.exports=JSON.parse('{"c":"mlc","b":"nlc","a":"olc"}')},10142:function(e,t,n){var i=n(10143);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(66)(i,o);i.locals&&(e.exports=i.locals)},10143:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,"._1MWfsXJ00dfskwPk_paMMQ{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2CcS0EUh4bxpQ_ZZ_3dKfo{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre}._2zncB03h5fVc_R1eQxRXU4{color:var(--white)!important}html[dir] ._2zncB03h5fVc_R1eQxRXU4{background-color:var(--themePrimary);border-radius:2px}html[dir] ._2zncB03h5fVc_R1eQxRXU4:hover{background-color:var(--themeDark)}html[dir] ._2zncB03h5fVc_R1eQxRXU4:active{background-color:var(--themeDarker)}",""]),t.locals={container:"_1MWfsXJ00dfskwPk_paMMQ",content:"_2CcS0EUh4bxpQ_ZZ_3dKfo",button:"_2zncB03h5fVc_R1eQxRXU4"}},10891:function(e,t,n){"use strict";function i(e){return!(e.CopyAllowed&&e.ForwardAllowed&&e.ReplyAllAllowed&&e.ReplyAllowed&&e.PrintAllowed)}n.d(t,"a",(function(){return i}))},10892:function(e,t,n){var i=n(17671);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(66)(i,o);i.locals&&(e.exports=i.locals)},11233:function(e,t,n){"use strict";var i=n(20),o=n(1269),r=n(0);var a=n(6110);n.d(t,"a",(function(){return c}));const s=new i.c(()=>Promise.all([n.e(122),n.e(145),n.e(266),n.e(1232)]).then(n.bind(null,19377))),c=Object(i.d)(s,e=>e.MessageExtensionControl,(function(){return r.createElement(o.a,{iconProps:{iconName:"AddIn"}})}));Object(i.f)(a.b,s,e=>e.onComposeMessageExtensionTriggerOrchestrator)},12364:function(e){e.exports=JSON.parse('{"e":"Pkc","d":"Qkc","b":"Rkc","a":"Skc","c":"Tkc"}')},1755:function(e,t,n){"use strict";var i;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange",e[e.CalendarViewTypeChange=8]="CalendarViewTypeChange",e[e.OwaSuiteHeaderFlexPane=9]="OwaSuiteHeaderFlexPane"}(i||(i={}));var o=i,r=n(3);let a=Object(r.createStore)("OwaLayout",{browserWidthBucket:null,areDisplayAdsEnabled:!1});var s=Object(r.mutatorAction)("setBrowserWidthBucket",e=>{a().browserWidthBucket=e}),c=n(2),d=n(44);function u(e,t,n){let i=Object(c.r)(e);if(t&&(i>1900?i-=305:i>990&&(i-=165)),n&&(i-=320),Object(d.j)("mon-tri-slvWithRightReadingPane")){if(i>=3001)return 3001;if(i>=2801)return 3e3;if(i>=2601)return 2800;if(i>=2401)return 2600;if(i>=2201)return 2400;if(i>=2001)return 2200;if(i>=1801)return 2e3;if(i>=1601)return 1800}return i>=1600?1600:i>=1400?1599:i>=1366?1399:i>=1301?1365:i>=1239?1300:i>=1200?1238:i>=1080?1199:i>=1e3?1079:i>=919?999:i>=900?918:i>=866?899:i>=769?865:i>=692?768:i>=686?691:i>=580?685:i>=555?579:i>=542?554:i>=500?541:i>=419?499:418}const l=Object(r.action)("onAvailableWidthBucketChanged",(e,t)=>({availableWidthBucket:e,source:t}));var m=Object(r.mutatorAction)("setAreDisplayAdsEnabled",e=>{a().areDisplayAdsEnabled=e});function b(){return a().areDisplayAdsEnabled}var p=n(928);function f(e){window.addEventListener("resize",h),m(e),v(o.Init)}function h(){v(o.WindowResize)}function v(e){const t=u(e!=o.Init,b(),Object(p.a)());a().browserWidthBucket!=t&&(s(t),t<=418?O():g(),l(t,e))}function O(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function g(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var w=n(96);function j(){return Object(w.j)()||Object(w.c)()}function I(){const e=a().browserWidthBucket;return e||void 0}Object(r.orchestrator)(p.d,e=>{const t=u(!1,b(),e.isShown);s(t),l(t,o.OwaSuiteHeaderFlexPane)}),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return f})),n.d(t,"c",(function(){return O})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return j})),n.d(t,"a",(function(){return 48})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return I}))},1758:function(e,t,n){"use strict";n.d(t,"k",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"j",(function(){return g})),n.d(t,"g",(function(){return w}));var i,o=n(2),r=n(5),a=n(49),s=n(44);const c=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],d=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],u={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};var l;function m(){return Object(a.t)()}function b(){return Object(a.g)().IsConsumerChild}function p(){return Object(a.g)().SessionSettings.IsShadowMailbox}function f(){return void 0!==l?l:l=function(){const e=Object(a.g)(),t=Object(r.e)();if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";const n=e.AdMarket.toLowerCase();return c.indexOf(n)>-1?n:u[n.split("-")[1]]||n}()}function h(e){return null!=e?e.toUpperCase().split("-"):[]}function v(e){return h(e)[1]||"US"}function O(){return Object(o.v)("ANON")}function g(){return Object(o.v)("MUID")}function w(){return i||(i=Object(s.j)("adsexp-adAstupgrade-037")?"https://acdn.adnxs.com/ast/static/0.37.0/ast.js":"https://acdn.adnxs.com/ast/static/0.36.0/ast.js")}},1764:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var i=n(3);const o=Object(i.createStore)("CommandRibbon",{viewMode:0});t.a=o()},1766:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d}));var i=n(20),o=n(1904);n.d(t,"a",(function(){return o.a}));const r=new i.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(16),n.e(24),n.e(27),n.e(80),n.e(585)]).then(n.bind(null,2733)));let a=Object(i.d)(r,e=>e.NotificationBarHost),s=new i.a(r,e=>e.showNotification),c=new i.a(r,e=>e.dismissNotification);const d=new i.b(r,e=>e.clearNotificationBar)},17668:function(e){e.exports=JSON.parse('{"f":"Klc","d":"Llc","k":"Mlc","j":"Nlc","i":"Olc","e":"Plc","h":"Qlc","l":"Rlc","b":"Slc","c":"Tlc","g":"Ulc","a":"Vlc"}')},17669:function(e,t,n){var i=n(17670);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(66)(i,o);i.locals&&(e.exports=i.locals)},17670:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,".crOZ6HqASIV85SZgaN04O{display:block!important}._2JDdEg7MsB03ihtZlIKlQb{width:auto;height:32px}html[dir] ._2JDdEg7MsB03ihtZlIKlQb{border-radius:2px;background:transparent}html[dir] ._2JDdEg7MsB03ihtZlIKlQb:hover{background-color:var(--themeLighterAlt)}html[dir] ._2JDdEg7MsB03ihtZlIKlQb:active{background-color:var(--themeLight)}html[dir] ._2JDdEg7MsB03ihtZlIKlQb._1-_txxivppDmBHDyEQnMmW{background-color:var(--themeLighter)}._2JDdEg7MsB03ihtZlIKlQb._1-_txxivppDmBHDyEQnMmW.ms-Button .ms-Button-icon,._2JDdEg7MsB03ihtZlIKlQb._1-_txxivppDmBHDyEQnMmW.ms-Button .ms-Button-menuIcon,._2JDdEg7MsB03ihtZlIKlQb:active.ms-Button .ms-Button-icon,._2JDdEg7MsB03ihtZlIKlQb:active.ms-Button .ms-Button-menuIcon,._2JDdEg7MsB03ihtZlIKlQb:hover.ms-Button .ms-Button-icon,._2JDdEg7MsB03ihtZlIKlQb:hover.ms-Button .ms-Button-menuIcon{color:var(--themeDarker)}html[dir] ._38cd2fxA9s5359HIcruY0p{background-color:var(--themeLighterAlt)!important}.Ces9DbvnvQleJ9XqBErvr{width:230px}html[dir] .Ces9DbvnvQleJ9XqBErvr{background-color:var(--white)}._1RmXDVEJ4Sd_R3DF5S_B2k{max-height:400px;overflow-x:hidden}._1p7Tym25spa3YbXge7r6Ah{overflow:hidden}._2QzXlBDw0koPzFQulHYPXy{height:44px}html[dir=ltr] ._2QzXlBDw0koPzFQulHYPXy{padding-left:12px}html[dir=rtl] ._2QzXlBDw0koPzFQulHYPXy{padding-right:12px}html[dir] ._2QzXlBDw0koPzFQulHYPXy:hover{background-color:var(--neutralLighter)}",""]),t.locals={likeCustomButtonLabel:"crOZ6HqASIV85SZgaN04O",likeIconButtonCustom:"_2JDdEg7MsB03ihtZlIKlQb",isChecked:"_1-_txxivppDmBHDyEQnMmW",likeCustomButtonActive:"_38cd2fxA9s5359HIcruY0p",callout:"Ces9DbvnvQleJ9XqBErvr",scrollContainer:"_1RmXDVEJ4Sd_R3DF5S_B2k",personaCollection:"_1p7Tym25spa3YbXge7r6Ah",persona:"_2QzXlBDw0koPzFQulHYPXy"}},17671:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,"html[dir=ltr] ._3M8qdCPclTTpYW2iSmKxGb{padding-right:2px}html[dir=rtl] ._3M8qdCPclTTpYW2iSmKxGb{padding-left:2px}._36kt_NF29zGpQ-YGXqElhJ{width:100%;min-width:0;display:inline-block;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;position:relative;top:1px}html[dir=ltr] ._36kt_NF29zGpQ-YGXqElhJ{left:2px}html[dir=rtl] ._36kt_NF29zGpQ-YGXqElhJ{right:2px}._1REaPD80UGwWcTBTN30Z6S{height:40px}._1Yn-nuWhpARS8i0CiVKZHG{font-size:14px;color:var(--themePrimary)}html[dir] ._1Yn-nuWhpARS8i0CiVKZHG{background:transparent}._2H6ZKnUbHxb0OJk3DVFN7H{height:32px}html[dir] ._2H6ZKnUbHxb0OJk3DVFN7H{background-color:transparent;padding:0}._2H6ZKnUbHxb0OJk3DVFN7H._2VxYcpA_eddfaK5Dq9_zV6{height:28px}._2H6ZKnUbHxb0OJk3DVFN7H._3A_ICB5WWo8p-VS3tkKSqQ{height:24px}._2lDRGEhUulcqvxOS5hWjXx{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._2BccY5KAu3TwOwcFElMtGS{min-width:auto}html[dir] ._2BccY5KAu3TwOwcFElMtGS{background:transparent;margin:0 2px;border-radius:2px}html[dir] ._2BccY5KAu3TwOwcFElMtGS:hover{background-color:var(--themeLighterAlt)}html[dir] ._2BccY5KAu3TwOwcFElMtGS:active{background-color:var(--themeLight)}html[dir] ._2BccY5KAu3TwOwcFElMtGS._3STduknLPfM7K-CoVTL9Zp{background-color:var(--themeLighter)}._2BccY5KAu3TwOwcFElMtGS._3STduknLPfM7K-CoVTL9Zp.ms-Button .ms-Button-icon,._2BccY5KAu3TwOwcFElMtGS._3STduknLPfM7K-CoVTL9Zp.ms-Button .ms-Button-menuIcon,._2BccY5KAu3TwOwcFElMtGS:active.ms-Button .ms-Button-icon,._2BccY5KAu3TwOwcFElMtGS:active.ms-Button .ms-Button-menuIcon,._2BccY5KAu3TwOwcFElMtGS:hover.ms-Button .ms-Button-icon,._2BccY5KAu3TwOwcFElMtGS:hover.ms-Button .ms-Button-menuIcon{color:var(--themeDarker)}._2BccY5KAu3TwOwcFElMtGS .ms-Button-label{font-weight:600}._2MBd41pUlPCcTlDD3n4ijc{height:32px}._2BccY5KAu3TwOwcFElMtGS._3Ki_O45ZHYfy5-TTOwQTkR .ms-Button-label{display:none}._1hNtpz2z3dm2daLz9Fn2cc{width:32px}._2JDqO7PoPImwXzd06oR1Dx{width:auto}html[dir] ._79re90sT84s7tbqkuGxcv{border:1px solid var(--neutralQuaternary);border-radius:4px}.TsiQDiI4R_TVoxq51bVoS.ms-ContextualMenu-icon,._3bub3nHlVA3tpGPpmZahoQ:not(._1Yn-nuWhpARS8i0CiVKZHG){display:none}._3elxfLs8GcU_Dugz30Zho0{color:var(--themePrimary)}._1W0_9g-Tpom9_WWEdTDPQh{color:var(--neutralTertiary)}._2ZUK2xVkWD8M8UYfCb_bZ8{pointer-events:none}html[dir] ._2ZUK2xVkWD8M8UYfCb_bZ8{background-color:transparent}._1JrQ4xjjBeRMCuesxTAlak{line-height:36px}html[dir] ._1JrQ4xjjBeRMCuesxTAlak{padding:4px 0}",""]),t.locals={surfaceActionsCommandBarCharms:"_3M8qdCPclTTpYW2iSmKxGb",surfaceActionsCommandBarContainer:"_36kt_NF29zGpQ-YGXqElhJ",surfaceActionsCommandBarContainerHeight:"_1REaPD80UGwWcTBTN30Z6S",surfaceActionsCommandBarOverflowIcon:"_1Yn-nuWhpARS8i0CiVKZHG",surfaceActionsCommandBar:"_2H6ZKnUbHxb0OJk3DVFN7H",medium:"_2VxYcpA_eddfaK5Dq9_zV6",compact:"_3A_ICB5WWo8p-VS3tkKSqQ",surfaceActionsCommandBarPrimarySet:"_2lDRGEhUulcqvxOS5hWjXx",surfaceActionsCommandBarButton:"_2BccY5KAu3TwOwcFElMtGS",isChecked:"_3STduknLPfM7K-CoVTL9Zp",surfaceActionsCommandBarButtonHeight:"_2MBd41pUlPCcTlDD3n4ijc",hideLabel:"_3Ki_O45ZHYfy5-TTOwQTkR",surfaceActionsCommandBarButtonWidthHideLabel:"_1hNtpz2z3dm2daLz9Fn2cc",surfaceActionsCommandBarButtonWidthShowLabel:"_2JDqO7PoPImwXzd06oR1Dx",surfaceActionsCommandBarButtonBorder:"_79re90sT84s7tbqkuGxcv",commandBarIcon:"TsiQDiI4R_TVoxq51bVoS",commandBarMenuIcon:"_3bub3nHlVA3tpGPpmZahoQ",enabledIconButton:"_3elxfLs8GcU_Dugz30Zho0",disabledIconButton:"_1W0_9g-Tpom9_WWEdTDPQh",disabledReplyActionButton:"_2ZUK2xVkWD8M8UYfCb_bZ8",reactionButtonContainer:"_1JrQ4xjjBeRMCuesxTAlak"}},17672:function(e){e.exports=JSON.parse('{"a":"_kc"}')},17673:function(e){e.exports=JSON.parse('{"a":"Zkc"}')},1844:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var i=n(20);const o=new i.c(()=>Promise.all([n.e(20),n.e(25),n.e(27),n.e(30),n.e(33),n.e(297),n.e(739)]).then(n.bind(null,2784)));let ReactEditor=Object(i.d)(o,e=>e.ReactEditor),r=new i.b(o,e=>e.setTableHeaderRow),a=new i.b(o,e=>e.operateContent),s=new i.b(o,e=>e.focusToEditor);function c(e){s.import().then(t=>t(e))}},1898:function(e,t,n){"use strict";n.d(t,"b",(function(){return r}));var i=n(3);const o={bulkActionInformationMap:new(n(14).ObservableMap)},r=Object(i.createStore)("bulkActionStore",o),a=r();t.a=a},1904:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.PrimaryActionClicked=0]="PrimaryActionClicked",e[e.SecondaryActionClicked=1]="SecondaryActionClicked",e[e.DismissClicked=2]="DismissClicked",e[e.AutoDismissed=3]="AutoDismissed",e[e.MouseLeaveAfterTimerCompleted=4]="MouseLeaveAfterTimerCompleted",e[e.NotificationBarUnmounted=5]="NotificationBarUnmounted"}(i||(i={}))},19107:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n(12364);var r=n(4225);function a(e,t){let n="RPCSAPinned";return(null==e?void 0:e.renderedInOverflow)&&(n=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),t||n}var s=n(5552);function c(e,t){var n;t.isConversationItemPart&&Object(s.a)(null===(n=e.ConversationId)||void 0===n?void 0:n.Id,t,!1)}var d=n(42),u=n(3492);function l(e,t,n,i,o,r){return(s,l)=>{Object(u.k)(!1,n,l,a(l,r)),t?(c(i,o),e(s,l)):s.which==d.a.enter&&(s.preventDefault(),s.stopPropagation(),c(i,o),e(s,l))}}let m=null;function b(){return m||(m={},Object(u.i)().forEach(e=>{m[e.key]=e})),m}function p(e){var t;return!("GroupMailbox"!==(null===(t=null==e?void 0:e.MailboxInfo)||void 0===t?void 0:t.type))}function f(e,t){var n;return e.isConversationItemPart?null===(n=t.ConversationId)||void 0===n?void 0:n.Id:null}var h=n(1812);function v(e){return Object(h.a)(e.ParentFolderId.Id,"junkemail")}var O=n(1683);var g=n(5),w=n(1679);function j(e){var t,n;const i=Object(w.X)(e)?e:null;if(null==i)return null;const o=null===(t=i.Sender)||void 0===t?void 0:t.Mailbox;if(o){const e=I(o);if(e)return e}const r=null===(n=i.From)||void 0===n?void 0:n.Mailbox;if(r){const e=I(r);if(e)return e}return null}function I(e){return"GroupMailbox"==e.MailboxType||Object(g.k)(e.EmailAddress)?null:Object(g.k)(e.Name)?e.EmailAddress:e.Name}var k=n(5549);function C(e){return!Object(h.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(k.a)(e.Sender.Mailbox.EmailAddress)&&null!=j(e)}var A=n(10891);var x=n(911),M=n(1585),S=n(1120),B=n(53),y=n(1732),E=n(1571),P=n(311),T=n(1733),R=n(0),D=n(17668),_=n(29);const L=100;function F(e){try{if(e.LikeCount&&e.Likers){const t=Object(_.a)().SessionSettings.UserEmailAddress,n=!!e.Likers&&e.Likers.some(e=>e.EmailAddress===t);switch(e.LikeCount){case 1:return n?Object(g.b)(D.f):Object(g.c)(Object(g.b)(D.d),e.Likers[0].Name);case 2:return n?Object(g.c)(Object(g.b)(D.k),e.Likers.filter(e=>e.EmailAddress!==t)[0].Name):Object(g.c)(Object(g.b)(D.j),e.Likers[0].Name,e.Likers[1].Name);case 3:return n?Object(g.c)(Object(g.b)(D.i),e.Likers[0].Name,Object(g.b)(D.e)):Object(g.c)(Object(g.b)(D.h),e.Likers[0].Name,e.Likers[1].Name,Object(g.b)(D.e));default:return n?e.LikeCount>=L?Object(g.c)(Object(g.b)(D.l),L-1):Object(g.c)(Object(g.b)(D.b),e.Likers[0].Name,Object(g.c)(Object(g.b)(D.c),e.LikeCount-2)):e.LikeCount>=L?Object(g.c)(Object(g.b)(D.g),L-1):Object(g.c)(Object(g.b)(D.a),e.Likers[0].Name,e.Likers[1].Name,Object(g.c)(Object(g.b)(D.c),e.LikeCount-2))}}}catch(e){return null}return null}function N(e){return e.LikeCount?e.LikeCount<L?e.LikeCount.toString():L-1+"+":null}var z=n(1800),U=n(17669),K=n.n(U),H=n(10892),W=n.n(H),V=n(107),Q=n.n(V);let Z=class extends R.Component{constructor(e){super(e),this.onDismissCallOut=()=>{this.setState(Object.assign(Object.assign({},this.state),{isMouseOverButton:!1,isMouseOverLikersList:!1}))},this.onLikeClicked=e=>{const t=e;this.props.surfaceActionItem.onClick(t,this.props.surfaceActionItem),t.stopPropagation()},this.handleMouseOver=()=>{this.state.isMouseOverButton||this.setState({isMouseOverButton:!0})},this.handleMouseLeave=()=>{this.state.isMouseOverButton&&this.setState({isMouseOverButton:!1})},this.handleLikersListMouseOver=()=>{this.state.isMouseOverLikersList||this.setState({isMouseOverLikersList:!0})},this.handleLikersListMouseLeave=()=>{this.state.isMouseOverLikersList&&this.setState({isMouseOverLikersList:!1})},this.state={isMouseOverButton:!1,isMouseOverLikersList:!1}}IsLikersListShown(){return this.state.isMouseOverLikersList}render(){const{surfaceActionItem:e,message:t}=this.props,n=t.LikeCount&&t.Likers&&(this.state.isMouseOverButton||this.state.isMouseOverLikersList),i="likeButtonId"+Object(P.a)();return R.createElement(E.a,{content:e.ariaLabel},R.createElement(M.a,{id:i,role:"menuitem",ariaLabel:e.ariaLabel,ariaDescription:F(t),iconProps:e.iconProps,styles:{root:Q()(W.a.surfaceActionsCommandBarButton,K.a.likeIconButtonCustom,n&&K.a.likeCustomButtonActive),label:t.LikeCount&&K.a.likeCustomButtonLabel,rootDisabled:W.a.disabledReplyActionButton,icon:W.a.enabledIconButton,iconDisabled:W.a.disabledIconButton,menuIcon:W.a.commandBarMenuIcon},onClick:this.onLikeClicked,onMouseEnter:this.handleMouseOver,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,text:N(t)}),n&&R.createElement(S.a,{className:K.a.callout,onDismiss:this.onDismissCallOut,target:"#"+i,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(g.i)()?B.a.bottomLeftEdge:B.a.bottomRightEdge},R.createElement("div",{className:Q()(K.a.scrollContainer,"customScrollBar"),onMouseEnter:this.handleLikersListMouseOver,onMouseOver:this.handleLikersListMouseOver,onMouseLeave:this.handleLikersListMouseLeave},R.createElement("div",{className:K.a.personaCollection},t.Likers.map(e=>R.createElement(J,{key:e.EmailAddress,emailAddress:e.EmailAddress,name:e.Name,mailBoxType:e.MailboxType,disableHover:!0,clientScenario:"Liker"},R.createElement(T.a,{className:K.a.persona,key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:y.c.size32,showPersonaDetails:!0,mailboxType:e.MailboxType})))))))}};Z=Object(i.__decorate)([x.observer],Z);var G=Z;function J(e){const t=Object(z.a)(e);return R.createElement(t,null,e.children)}var Y=n(1905);var X=n(1802);var q=n(4717);var $=n(1988),ee=n(1772);var te=n(2646),ne=n(11824),ie=n(10069),oe=n(6261);var re=n(1885);var ae=n(3);const se=Object(ae.mutatorAction)("incrementLikeButtonCount",e=>{e.likeUnlikeTracker&&e.likeUnlikeTracker.likeButtonClickCount++}),ce=Object(ae.mutatorAction)("updateLikeUnlikeInProgress",(e,t)=>{e.likeUnlikeTracker&&(e.likeUnlikeTracker.likeUnlikeInProgress=t)});const de=async(e,t,n)=>{var i;const o=await Y.p.import();se(n),o(Object.assign(Object.assign({},e.ItemId),{mailboxInfo:e.MailboxInfo}),e,Object(w.I)(),(null===(i=n.likeUnlikeTracker)||void 0===i?void 0:i.likeButtonClickCount)>=5,t),ce(n,!1)};var ue=n(5076),le=n(730);var me=n(6834);var be=n(10059);var pe=n(2175);async function fe(e,t){const n=await re.g.import(),[i,o]=await n(t,e),r=[...i,...o].map(e=>e.SipUri?e.SipUri:"sip:"+e.EmailAddress);r.length>0&&pe.e.import().then(n=>n(r,t.Subject,e?3:2))}var he=n(10079);var ve=n(8700);var Oe=n(3292),ge=n(797);var we=n(699),je=Object(we.action)("toggleAmpPreference")((function(e){e.preferAmp=!e.preferAmp}));var Ie=n(2110);var ke=n(71);const Ce=Object(ae.action)("toggleUndoDarkMode",e=>Object(ke.b)({name:e.undoDarkMode?"ToggleDarkModeOn":"ToggleDarkModeOff"},{viewState:e}));Object(ae.mutator)(Ce,({viewState:e})=>{e&&(e.undoDarkMode=!e.undoDarkMode)});var Ae=n(8701),xe=n(10067);var Me=n(9147),Se=n(61);var Be=n(44),ye=n(6856),Ee=n(6857),Pe=n(6858),Te=n(6859),Re=n(3718),De=n(3248),_e=n(17672),Le=n(17673),Fe=n(7450),Ne=n(6258),ze=n(4537),Ue=n(5358),Ke=n(4297),He=n(5059),We=n(3626),Ve=n(283),Qe=n(1983),Ze=n(7892),Ge=n(2507),Je=n(11233);const Ye={Reply:(e,t)=>{const n=Object(Ke.a)(e.item,e.viewState.isConversationItemPart);t.disabled=n[0],t.onClick=function(e,t,n,i){return o=>{Object(be.a)(!1,t.isConversationItemPart,n,e,i,o)}}(e.instrumentationContext,e.viewState,e.item,e.targetWindow)},ReplyAll:(e,t)=>{const n=Object(Ke.a)(e.item,e.viewState.isConversationItemPart);t.disabled=n[1],t.onClick=function(e,t,n,i){return o=>{Object(be.a)(!0,t.isConversationItemPart,n,e,i,o)}}(e.instrumentationContext,e.viewState,e.item,e.targetWindow)},Forward:(e,t)=>{const n=Object(Ke.a)(e.item,e.viewState.isConversationItemPart);t.disabled=n[2],t.onClick=function(e,t,n){return i=>{i.stopPropagation(),re.f.importAndExecute(e,e.MailboxInfo,r.a,[t],Object(w.db)(Object(w.I)()),{targetWindow:n})}}(e.item,e.instrumentationContext,e.targetWindow)},ReplyByMeeting:(e,t)=>{t.disabled=Object(Qe.a)(e.item)||!!e.item.RightsManagementLicenseData,t.onClick=function(e){return t=>{t.stopPropagation();const n=Object(w.X)(e)?e:null;Object(he.a)(e.ItemId.Id,null,r.a,null,null==n?void 0:n.InternetMessageId)}}(e.item)},OtherReplyActions:(e,t)=>{t.onClick=Xe,t.subMenuActionKeys=["ReplyByMeeting","ReplyByIM","ReplyAllByIM","LikeUnlike"]},MessageSafety:(e,t)=>{t.onClick=Xe,t.subMenuActionKeys=["MarkJunkNotJunk","MarkAsPhishing","Block","ReportAbuse"]},ReplyByIM:(e,t)=>{t.onClick=function(e){return t=>{fe(!1,e)}}(e.item),t.disabled=!Object(pe.b)()},ReplyAllByIM:(e,t)=>{t.onClick=function(e){return t=>{fe(!0,e)}}(e.item),t.disabled=!Object(pe.b)()},MarkJunkNotJunk:(e,t)=>{const n=e.item;if(Object(Ge.g)()&&Object(O.E)(n.ParentFolderId.Id)){const i=v(n)?Object(g.b)(o.b):Object(g.b)(Te.a);t.text=i,t.ariaLabel=i,t.datapointName=v(n)?"MarkItemNotjunk":"MarkItemJunk",t.onClick=function(e,t,n){return i=>{i.stopPropagation(),Y.r.importAndExecute(e.ItemId.Id,Object(w.I)(),r.a,[t],n).then(()=>{Object(te.a)()}),X.b.importAndExecute()}}(e.item,e.instrumentationContext,e.targetWindow)}},Delete:(e,t)=>{if(!e.isItemAttachment&&Object(Ge.b)(12)){const n=e.item;t.onClick=function(e,t,n){return i=>{i.stopPropagation();const o=f(e,t);if(o){const i=Object(ne.b)(o,e);Y.j.importAndExecute([t.ItemId.Id],Object(oe.a)(t.ItemId.Id),[n],r.a,t.MailboxInfo,!0).then(()=>{Object(ie.a)(i,o)})}else Y.j.importAndExecute([t.ItemId.Id],Object(oe.a)(t.ItemId.Id),[n],r.a,t.MailboxInfo).then(()=>{Object(te.a)()})}}(e.viewState,e.item,e.instrumentationContext),t.disabled=p(e.item)&&!n.CanDelete}},MarkReadUnread:(e,t)=>{if(!e.isPopout||!p(e.item)){const n=e.item,i=n.IsRead?Object(g.b)(De.a):Object(g.b)(Re.a);t.text=i,t.ariaLabel=i,t.datapointName=n.IsRead?"MarkItemUnread":"MarkItemRead",n.IsRead||(t.iconProps.iconName="Read"),t.onClick=function(e,t){return n=>{n.stopPropagation();const i=e;Ie.c.importAndExecute(e.ItemId.Id,Object(w.I)(),!i.IsRead,[t],r.a)}}(e.item,e.instrumentationContext)}},FlagUnflag:(e,t)=>{if(Object(Ge.b)(16)){const n=e.item,i=!n.Flag||"Flagged"!=n.Flag.FlagStatus,a=i?Object(g.b)(Ee.a):Object(g.b)(o.d);t.text=a,t.ariaLabel=a,t.datapointName=i?"FlagItem":"UnflagItem",t.onClick=function(e,t){return n=>{n.stopPropagation();const i="Flagged"!=e.Flag.FlagStatus?"Flagged":"NotFlagged";Y.J.importAndExecute([e.ItemId.Id],[t],{FlagStatus:i},Object(w.J)(),r.a)}}(e.item,e.instrumentationContext)}},Print:(e,t)=>{const n=Object(We.a)(e.item);t.onClick=function(e,t){return n=>{n.stopPropagation(),Object(me.a)(Object.assign(Object.assign({},e.ItemId),{mailboxInfo:e.MailboxInfo}),r.a,t)}}(e.item,e.targetWindow),t.disabled=!n.PrintAllowed},View:(e,t)=>{t.onClick=Xe,t.subMenuActionKeys=["Popout","Translate","ShowInImmersiveReader","ViewMessageSource"]},AdvancedActions:(e,t)=>{t.onClick=Xe,t.subMenuActionKeys=["CreateRule","AssignPolicy"]},Popout:(e,t)=>{t.onClick=function(e,t){return n=>{n.stopPropagation(),Object(le.a)(t.itemId,null,null,e.MailboxInfo,async()=>{return(await ue.a.import())(Object(w.I)())})}}(e.item,e.viewState)},CreateRule:(e,t)=>{var n;const i=Object(w.X)(e.item)?e.item:null;Object(ze.a)()&&(null===(n=null==i?void 0:i.From)||void 0===n?void 0:n.Mailbox)&&Object(O.E)(null==i?void 0:i.ParentFolderId.Id)&&(t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),q.a.import().then(i=>{i(e,a(o,t),n)})}}(e.item,e.actionSource,e.targetWindow))},AddToSafeSenders:(e,t)=>{const n=e.item;C(n)&&(t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),Y.b.importAndExecute(e.Sender.Mailbox,e.ItemId.Id,a(o,t),!1,n)}}(n,e.actionSource,e.targetWindow))},MarkAsPhishing:(e,t)=>{t.onClick=function(e,t){return n=>{n.stopPropagation(),Y.q.importAndExecute(e.ItemId.Id,Object(w.I)(),r.a,t).then(()=>{Object(te.a)()}),X.b.importAndExecute()}}(e.item,e.targetWindow)},Block:(e,t)=>{const n=e.item;if(C(n)&&Object(O.E)(n.ParentFolderId.Id)){const i=Object(g.c)(Object(g.b)(ye.a),j(n));t.text=i,t.ariaLabel=i,t.onClick=function(e,t,n){return i=>{i.stopPropagation(),Y.e.importAndExecute(e.ItemId.Id,[t],r.a,n),X.b.importAndExecute()}}(e.item,e.instrumentationContext,e.targetWindow)}},ReportAbuse:(e,t)=>{Object(Be.j)("tri-reportAbuse")&&(t.onClick=function(e,t,n){return i=>{i.stopPropagation(),ve.b.importAndExecute(e,Object(w.I)(),[t],r.a,n),X.b.importAndExecute()}}(e.item,e.instrumentationContext,e.targetWindow))},Translate:(e,t)=>{const n=Object(We.a)(e.item);t.onClick=function(e,t){return n=>{var i;n.stopPropagation(),Ae.d.importAndExecute(e.ItemId.Id,Object(xe.a)(null===(i=e.ConversationId)||void 0===i?void 0:i.Id),t.isConversationItemPart,!0)}}(e.item,e.viewState),t.disabled=function(e,t){return Object(A.a)(e)||!t.TranslationData||!t.TranslationData.userLanguage||t.TranslationData.isShowingTranslation||t.TranslationData.isTranslating}(n,e.item)},ShowInImmersiveReader:(e,t)=>{t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),n&&n!==window?ge.l.importAndExecute(e.ItemId.Id,{Immersive:""}):Oe.d.importAndExecute(Object.assign(Object.assign({},e.ItemId),{mailboxInfo:e.MailboxInfo}),r.a,a(o,t))}}(e.item,e.actionSource,e.targetWindow)},ViewMessageSource:(e,t)=>{const n=e.item;Object(h.a)(n.ParentFolderId.Id,"sentitems")||(t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),Object(Se.o)("ViewMessageSource",{subActionSource:a(o,t)},{actionSource:r.a}),Object(Me.a)(e,n)}}(e.item,e.actionSource,e.targetWindow))},AssignPolicy:(e,t)=>{if(function(e,t){return!p(t)&&(Object(O.C)(e,"UserMailbox")||Object(O.C)(e,"ArchiveMailbox")||Object(O.C)(e,"SharedMailbox"))}(e.item.ParentFolderId.Id,e.item)){const n=Object(w.I)(),i=He.a.tryImportForRender();let o;i&&(o=i(null==n?void 0:n.id,"RPCSAOverflow",e.item)),t.onClick=Xe,t.subMenuProps=o}},ToggleDarkMode:(e,t)=>{const n=e.viewState.undoDarkMode,i=n?Object(g.b)(o.a):Object(g.b)(Pe.a);t.text=i,t.ariaLabel=i,t.iconProps.iconName=n?"ClearNight":"Sunny",t.datapointName=n?"ToggleDarkModeOn":"ToggleDarkModeOff",t.onClick=function(e){return t=>{t.stopPropagation(),Ce(e)}}(e.viewState),t.isPinnedOnly=!0},SetReaction:(e,t)=>{const n=e.item;Object(O.C)(n.ParentFolderId.Id,"SharedMailbox")||p(e.item)||(t.onClick=Xe,t.isPinnedOnly=!0,Object(u.o)("SetReaction",n)&&(t.onRender=t=>R.createElement(Ue.a,{commandBarItem:t,conversationId:{Id:f(e.viewState,e.item),mailboxInfo:e.item.MailboxInfo},itemId:Object.assign(Object.assign({},e.item.ItemId),{mailboxInfo:e.item.MailboxInfo}),item:e.item,instrumentationContext:e.instrumentationContext})))},Addins:(e,t)=>{t.onClick=Xe},MessageExtensions:(e,t)=>{t.onClick=Xe,t.isPinnedOnly=!0,t.onRender=e=>R.createElement("div",{onClick:Xe},R.createElement(Je.a,{messageExtensionType:"Read"}))},AddToBoard:(e,t)=>{const n=Ze.a.tryImportForRender();n&&(t.onClick=Xe,t.subMenuProps=n(e.item.ItemId.Id,e.item,"MailModuleNotificationBarHost"))},"-":(e,t)=>{t.onClick=Xe},LikeUnlike:(e,t)=>{const n=e.item;if(!Object(Ve.a)()&&!Object(O.C)(n.ParentFolderId.Id,"SharedMailbox")){if(t.onClick=function(e,t,n){return i=>{var o;i.stopPropagation(),(null===(o=n.likeUnlikeTracker)||void 0===o?void 0:o.likeUnlikeInProgress)||(ce(n,!0),de(e,t,n))}}(e.item,e.instrumentationContext,e.viewState),function(e){const t=Object(_.a)().SessionSettings.UserEmailAddress;return!!e.Likers&&e.Likers.some(e=>e.EmailAddress===t)}(n)){t.iconProps.iconName="LikeSolid";const e=Object(g.b)(o.e);t.text=e,t.ariaLabel=e}Object(u.o)("LikeUnlike",n)&&(t.onRender=e=>R.createElement(G,{surfaceActionItem:e,message:n}))}},ToggleAmp:(e,t)=>{const{preferAmp:n,ampAvailability:i}=e.viewState.ampViewState;if(Object(Ne.a)()&&i==Fe.a.AmpValidated){const i=n?Object(g.b)(Le.a):Object(g.b)(_e.a);t.text=i,t.ariaLabel=i,t.datapointName=n?"ViewAsOriginal":"ViewAsDynamic",t.onClick=function(e){return t=>{t.stopPropagation(),je(e.ampViewState)}}(e.viewState),t.isPinnedOnly=!0,n&&(t.iconProps.iconName="LightningBoltSolid")}},CustomizeActions:(e,t)=>{let n=!1;Object(Be.j)("addin-exp-customizedActionsButtonNavBar")&&((Object(Be.j)("addin-exp-awarenessNudgeCusBtn")||Object(Be.j)("addin-exp-awarenessNudge")||Object(Be.j)("addin-exp-awarenessNudgeWaterDropNudge"))&&(ee.z.importAndExecute(t),n=!0),t.onClick=function(e){return t=>{t.stopPropagation(),$.f.importAndExecute("mail","surfaceActions","readSurfaceActions"),ee.H.importAndExecute(e?"HighlightedAndClicked":"Clicked","OverFlowMenu")}}(n))}};function Xe(e){e.stopPropagation()}var qe=n(121);function $e(e,t,n){if(!e||e.hideInGroup&&p(t.item)||e.hideInSxS&&t.isItemAttachment)return null;const i=function(e,t){var n;const i=Object(u.g)(e);return{key:e,text:i,ariaLabel:i,iconProps:{iconName:null===(n=Object(u.h)(e))||void 0===n?void 0:n.iconName,className:W.a.commandBarIcon},renderButtonAs:t,iconOnly:et,datapointName:e}}(e.key,n);Ye[e.key](t,i);const o=function(e,t,n){if(!e)return null;const i=b(),o=[];return e.forEach(e=>{const r=$e(i[e],t,n);r&&o.push(r)}),o.length>0?o:null}(i.subMenuActionKeys,t,n);return i.subMenuActionKeys&&!o?null:function(e,t,n){if(!e.onClick)return null;return Object.assign(Object.assign({},e),{onClick:l(e.onClick,!0,e.datapointName,n.item,n.viewState,n.actionSource),onKeyDown:l(e.onClick,!1,e.datapointName,n.item,n.viewState,n.actionSource),subMenuProps:e.subMenuProps?e.subMenuProps:t?{items:t}:null})}(i,o,t)}const et=!Object(qe.a)("native")||!Object(Be.j)("mon-rp-showLabels");const tt=["Reply","ReplyAll","Forward","OtherReplyActions","-","Delete","MarkReadUnread","FlagUnflag","AddToBoard","AddToSafeSenders","MessageSafety","-","Print","View","-","MessageExtensions","Addins","CustomizeActions","AdvancedActions","ToggleAmp","SetReaction","ToggleDarkMode"];var nt=n(1280),it=n(12843),ot=n(14),rt=n(21),at=n(1853),st=n(4742),ct=n(6213),dt=n(8869),ut=n(4669),lt=n(2690),mt=n(11813);const bt=Object(ae.mutatorAction)("initializeLikeUnlikeTracker",e=>{e.likeUnlikeTracker={likeButtonClickCount:0,likeUnlikeInProgress:!1}});var pt=n(7832),ft=n(1741),ht=n(993),vt=n(114),Ot=n(6260),gt=n(6528),wt=n(1693),jt=n(9042),It=n(1870),kt=n(147);const Ct=n.n(kt).a.bind(W.a),At=Object(Be.j)("mon-densities"),xt=new Set(["Reply","ReplyAll","SetReaction","Forward","MessageExtensions"]);let Mt=class extends R.Component{constructor(e){super(e),this.commandBarHiddenOverflowItems=[],this.commandBarDividerKey=0,this.showAddinsFRECallout=!1,this.addinsFREShown=!1,this.isLabelActivable=!0,this.shouldHideLabel=!1,this.unpinnedAddinFRECallout=!1,this.unpinnedAddinFreShown=!1,this.forcePinnedSurfaceActions=new Set,this.onMenuClickCallback=()=>{c(this.props.item,this.props.viewState)},this.getRef=e=>{this.commandBar=e,(Object(Be.j)("addin-exp-awarenessNudgeCusBtn")||Object(Be.j)("addin-exp-awarenessNudge")||Object(Be.j)("addin-exp-awarenessNudgeWaterDropNudge"))&&e&&(this.unpinnedAddinFRECallout=!0)},this.showFREIfRenderedButtonMatches=e=>t=>{if(!Object(Be.j)("addin-exp-pinNewAdminAddinsFRECallout"))return;const n=Object(ee.r)(at.a.MessageRead);n&&t&&e.id==n&&(this.showAddinsFRECallout=!0)},this.ItemHeaderToolbarButton=Object(rt.a)(e=>R.createElement(nt.a,{theme:Object(mt.a)(At?Object(vt.e)():null)},R.createElement(M.a,Object.assign({},e,{componentRef:this.showFREIfRenderedButtonMatches(e),menuProps:e.menuProps&&Object.assign(Object.assign({},e.menuProps),{directionalHint:B.a.bottomAutoEdge}),onMenuClick:this.onMenuClickCallback,styles:Object.assign(Object.assign({},e.styles),{root:Ct(W.a.surfaceActionsCommandBarButton,!At&&W.a.surfaceActionsCommandBarButtonHeight,this.shouldHideLabel&&W.a.hideLabel,this.shouldHideLabel&&!At&&W.a.surfaceActionsCommandBarButtonWidthHideLabel,!this.shouldHideLabel&&W.a.surfaceActionsCommandBarButtonWidthShowLabel,!this.shouldHideLabel&&Object(Be.j)("mon-tri-replyButtons")&&W.a.surfaceActionsCommandBarButtonBorder),rootDisabled:W.a.disabledReplyActionButton,icon:!At&&W.a.enabledIconButton,iconDisabled:W.a.disabledIconButton,menuIcon:W.a.commandBarMenuIcon}),role:"menuitem"})))),this.ItemHeaderToolbarOverflowButton=Object(rt.a)(e=>{const t=this.ItemHeaderToolbarButton;return R.createElement(E.a,{content:Object(g.b)(dt.a)},R.createElement(t,Object.assign({},e)))}),this.onCommandBarReduceData=e=>{let{primaryItems:t,overflowItems:n,cacheKey:i}=e,o=-1;for(let e=0;e<t.length;e++){const n=t[e];if(n&&!xt.has(n.key)){o=e;break}}const r=t.length;if(-1===o&&1===r)return;let a=-1!==o?o:r-1;const s=t[a];return s.isPinnedOnly&&function(e,t){t.forEach(t=>{"View"!==t.key||t.subMenuProps.items.includes(e)||t.subMenuProps.items.push(e)})}(s,n),this.commandBarHiddenOverflowItems=[s,...this.commandBarHiddenOverflowItems],t.splice(a,1),i=this.computeCommandBarCacheKey(t),Object.assign(Object.assign({},e),{primaryItems:t,overflowItems:n,cacheKey:i})},this.onCommandBarGrowData=e=>{let{primaryItems:t,overflowItems:n,cacheKey:i}=e;const o=[];for(let e=0;e<t.length;e++){const n=t[e];"SetReaction"!==(null==n?void 0:n.key)&&"MessageExtensions"!==(null==n?void 0:n.key)||o.push(n)}const r=this.commandBarHiddenOverflowItems[0];if(r){r.isPinnedOnly&&function(e,t){t.forEach(t=>{if("View"===t.key){const n=t.subMenuProps.items.indexOf(e);n>-1&&t.subMenuProps.items.splice(n,1)}})}(r,n);const a=[];return this.commandBarHiddenOverflowItems=this.commandBarHiddenOverflowItems.slice(1),"ToggleDarkMode"===r.key?o.unshift(r):xt.has(r.key)?a.unshift(r):o.push(r),t=[...o,...t.slice(o.length+a.length-1),...a],i=this.computeCommandBarCacheKey(t),Object.assign(Object.assign({},e),{primaryItems:t,overflowItems:n,cacheKey:i})}},this.onResize=()=>{this.isLabelActivable&&(this.shouldHideLabel=this.isReadingPaneWidthBelowCollapseCutoff()),this.commandBar&&this.commandBar.remeasure()},this.state={addinsInitializedState:0},bt(this.props.viewState),this.initializeShouldHideLabel()}createCommandBarItems(){var e;this.commandBarHiddenOverflowItems=[];const t=[],n=[],i=b(),o=[];return((null===(e=this.props.customizedSubsetActionKeys)||void 0===e?void 0:e.length)>0?this.props.customizedSubsetActionKeys:tt).forEach(e=>{i[e]&&o.push(i[e])}),o.forEach(e=>{let i=null;"Addins"!==e.key?(i=$e(e,this.props,this.ItemHeaderToolbarButton),i&&this.addItemToCommandBar(i,n,t)):this.tryCreateAddinsCommandBarItems(t,n,e)}),{items:this.props.hideSurfaceButton?[]:t,overflowItems:n}}addItemToCommandBar(e,t,n){var i,o;let r=e;this.shouldAddItemToSurface(e)&&(this.addItemToCommandBarSurface(n,e),r=Object.assign({},e)),null===(o=null===(i=e.subMenuProps)||void 0===i?void 0:i.items)||void 0===o||o.forEach(e=>{this.shouldAddItemToSurface(e)&&this.addItemToCommandBarSurface(n,Object.assign({},e))}),this.addItemToCommandBarOverflow(t,r)}addItemToCommandBarSurface(e,t){const n=t.key;Object(u.j)(n)||this.forcePinnedSurfaceActions.add(n),t.isPinned=!0,Object(u.p)(n)?e.push(t):e.unshift(t)}addItemToCommandBarOverflow(e,t){var n,i,o,r;if(!t.isPinnedOnly){const a=t.key;t.onRender=null,"AddToBoard"!==a&&(null===(i=null===(n=t.subMenuProps)||void 0===n?void 0:n.items)||void 0===i||i.forEach(e=>{e.onRender=null})),t.renderedInOverflow=!0,null===(r=null===(o=t.subMenuProps)||void 0===o?void 0:o.items)||void 0===r||r.forEach(e=>{e.renderedInOverflow=!0}),"-"==a?Object(jt.b)(e,this.commandBarDividerKey++):e.push(t)}}shouldAddItemToSurface(e){if(this.props.hideSurfaceButton)return!1;const t=e.key;return Object(u.o)(t,this.props.item)||this.forcePinnedSurfaceActions.has(t)}componentDidMount(){ht.a.importAndExecute(this.onResize),this.initailizeAddinsIfNeeded()}componentWillUnmount(){ht.c.importAndExecute(this.onResize),this.deInitializeAddins()}componentDidUpdate(e){var t,n;let i=Promise.resolve();2!=this.state.addinsInitializedState||(null===(t=e.viewState)||void 0===t?void 0:t.itemId)==(null===(n=this.props.viewState)||void 0===n?void 0:n.itemId)&&e.shouldIncludeFullInfo==this.props.shouldIncludeFullInfo||(i=this.deInitializeAddins(e.viewState.itemId)),this.props.shouldIncludeFullInfo&&i.then(()=>{this.initailizeAddinsIfNeeded()}),Object(Be.j)("addin-exp-pinNewAdminAddinsFRECallout")&&this.showAddinsFRECallout&&window.requestAnimationFrame(()=>{this.showLatestNewAdminAddinFRECallout()}),(Object(Be.j)("addin-exp-awarenessNudgeCusBtn")||Object(Be.j)("addin-exp-awarenessNudge")||Object(Be.j)("addin-exp-awarenessNudgeWaterDropNudge"))&&this.unpinnedAddinFRECallout&&window.requestAnimationFrame(()=>{this.showUnpinnedAdminAddinFRECallout()})}render(){const e=!this.props.item.ParentFolderId||!Object(h.a)(this.props.item.ParentFolderId.Id,"notes");return R.createElement("div",{className:Ct(W.a.surfaceActionsCommandBarContainer,!At&&W.a.surfaceActionsCommandBarContainerHeight)},e&&this.renderCommandBar())}renderCommandBar(){if(!this.props.viewState)return null;const e=this.createCommandBarItems();this.highlightCustomizeActionButtonAndAddins(e);const t=At?st.a:"More";return R.createElement(it.a,{componentRef:this.getRef,items:e.items,overflowItems:e.overflowItems,overflowButtonProps:{id:"read_ellipses_menu",iconProps:{iconName:t},menuIconProps:{iconName:t,styles:{root:Object(g.k)(this.props.seeMoreStyles)?W.a.surfaceActionsCommandBarOverflowIcon:Ct(W.a.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(g.b)(ct.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:u.m,onDataGrown:u.l,styles:{root:Ct(W.a.surfaceActionsCommandBar,At&&Object(vt.e)()),primarySet:W.a.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(g.b)(o.c),onReduceData:this.onCommandBarReduceData,onGrowData:this.onCommandBarGrowData})}highlightCustomizeActionButtonAndAddins(e){if(Object(Be.j)("addin-exp-awarenessNudgeCusBtn")||Object(Be.j)("addin-exp-awarenessNudge")||Object(Be.j)("addin-exp-awarenessNudgeWaterDropNudge")){const t=Object(It.a)();t.shouldHighlightUnpinnedAdminAddins||setTimeout((function(){if(t.shouldHighlightUnpinnedAdminAddins){let t=!1;e.overflowItems.forEach(e=>{t&&ee.A.importAndExecute(e,at.a.MessageRead),"CustomizeActions"==e.key&&ee.z.importAndExecute(e),"addinDivider_22"==e.key&&(t=!0)})}}),2e3)}}computeCommandBarCacheKey(e){return[e.reduce((e,t)=>{const{cacheKey:n=t.key}=t;return e+n},""),"","overflow"].join(" ")}initializeShouldHideLabel(){if(!Object(Be.j)("mon-rp-showLabels")||!Object(ft.a)())return this.isLabelActivable=!1,void(this.shouldHideLabel=!0);this.isLabelActivable=!0,this.shouldHideLabel=this.isReadingPaneWidthBelowCollapseCutoff()}isReadingPaneWidthBelowCollapseCutoff(){const e=document.getElementById("ReadingPaneContainerId");if(e){if(e.getBoundingClientRect().width<r.b)return!0}return!1}tryCreateAddinsCommandBarItems(e,t,n){if(2!=this.state.addinsInitializedState)return;const i=[],o=[],r=Object(wt.g)(wt.d.SurfaceActions),a=n.key;this.props.shouldIncludeFullInfo&&Object(jt.a)(at.a.MessageRead,this.props.item,this.getFocusedItemId||this.props.item.ItemId.Id,r.readSurfaceAddins,i,o,!0,this.commandBarDividerKey,this.props.targetWindow,null,!0),[...i,...o].forEach(e=>{if(e.onClick){const t=e.onClick;e.onClick=l(t,!0,a,this.props.item,this.props.viewState,this.props.actionSource),e.onKeyDown=l(t,!1,a,this.props.item,this.props.viewState,this.props.actionSource)}}),e.unshift(...i),t.push(...o)}shouldAddinsPopulate(){const e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&this.props.shouldIncludeFullInfo,t=f(this.props.viewState,this.props.item);return e&&!Object(lt.a)(t)&&!this.props.isItemAttachment&&Object(ee.Z)(this.props.item)&&!p(this.props.item)&&!Object(Ot.a)(this.props.item)}showLatestNewAdminAddinFRECallout(){if(this.addinsFREShown)return;let e=Object(ee.r)(at.a.MessageRead);if(e){let t="New Add-in";const n=Object(ee.p)(e);n&&(t=n.DisplayName),gt.a.importAndExecute(at.a.MessageRead,e,t),this.addinsFREShown=!0}}showUnpinnedAdminAddinFRECallout(){if(this.unpinnedAddinFreShown)return;let e="WithoutCustomizeActionButton";Object(Be.j)("addin-exp-awarenessNudgeCusBtn")?e="WithCustomizeActionButton":Object(Be.j)("addin-exp-awarenessNudgeWaterDropNudge")&&(e="WaterDropCallout"),gt.b.importAndExecute(at.a.MessageRead,e,"read_ellipses_menu"),this.unpinnedAddinFreShown=!0}initailizeAddinsIfNeeded(){0==this.state.addinsInitializedState&&this.shouldAddinsPopulate()&&(this.setState({addinsInitializedState:1}),this.intializeAddinsTask=window.setTimeout(()=>{this.initializeAddins()},1))}async initializeAddins(){const e=(await ut.b.import())(this.props.item,this.props.viewState);ee.B.import().then(t=>{t(Object(ee.q)(this.props.item.ItemId.Id),e,!0,this.props.targetWindow,this.props.item.ItemId.Id).then(()=>{this.setState({addinsInitializedState:2})})})}async deInitializeAddins(e){if(clearTimeout(this.intializeAddinsTask),0==this.state.addinsInitializedState)return;(await ee.y.import())(Object(ee.q)(e||this.props.item.ItemId.Id),this.props.targetWindow),this.setState({addinsInitializedState:0})}get getFocusedItemId(){if(this.props.viewState.isConversationItemPart){const e=Object(pt.b)();return null==e?void 0:e.itemId}return null}};Object(i.__decorate)([ot.computed],Mt.prototype,"getFocusedItemId",null),Mt=Object(i.__decorate)([x.observer],Mt);var St=Mt;n.d(t,"ItemActionsMenu",(function(){return St}))},1920:function(e,t){e.exports=function(e){return e instanceof Date}},1988:function(e,t,n){"use strict";var i=n(2107),o=n(20),r=n(2252),a=n(2054);function s(){let e=Object(a.a)();return{isFullOptionsShown:e.isFullOptionsShown,areAllAllowedSubCategoriesLoaded:e.areAllAllowedSubCategoriesLoaded,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return s}));const c=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(8),n.e(11),n.e(14),n.e(16),n.e(17),n.e(19),n.e(18),n.e(24),n.e(27),n.e(30),n.e(31),n.e(40),n.e(42),n.e(60),n.e(80),n.e(92),n.e(106),n.e(115),n.e(123),n.e(473)]).then(n.bind(null,19279)));let d=new o.a(c,e=>e.mountAndShowFullOptions),u=new o.b(c,e=>e.hideFullOptions),l=new o.b(c,e=>e.confirmDirtyOptionsAndPerformAction),m=new o.b(c,e=>e.exitOptionsFullPage);var b=Object(i.a)(c,e=>e.QuickOptions);Object(o.f)(r.a,c,e=>e.mountFullOptionsOrchestrator)},1999:function(e,t,n){var i=n(1920),o=36e5,r=6e4,a=2,s=/[T ]/,c=/:/,d=/^(\d{2})$/,u=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,m=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,p=/^-?(\d{3})$/,f=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,v=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/([Z+-].*)$/,I=/^(Z)$/,k=/^([+-])(\d{2})$/,C=/^([+-])(\d{2}):?(\d{2})$/;function A(e,t,n){t=t||0,n=n||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var o=7*t+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+o),i}e.exports=function(e,t){if(i(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?a:Number(n);var x=function(e){var t,n={},i=e.split(s);c.test(i[0])?(n.date=null,t=i[0]):(n.date=i[0],t=i[1]);if(t){var o=j.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),M=function(e,t){var n,i=u[t],o=m[t];if(n=l.exec(e)||o.exec(e)){var r=n[1];return{year:parseInt(r,10),restDateString:e.slice(r.length)}}if(n=d.exec(e)||i.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(x.date,n),S=M.year,B=function(e,t){if(null===t)return null;var n,i,o,r;if(0===e.length)return(i=new Date(0)).setUTCFullYear(t),i;if(n=b.exec(e))return i=new Date(0),o=parseInt(n[1],10)-1,i.setUTCFullYear(t,o),i;if(n=p.exec(e)){i=new Date(0);var a=parseInt(n[1],10);return i.setUTCFullYear(t,0,a),i}if(n=f.exec(e)){i=new Date(0),o=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return i.setUTCFullYear(t,o,s),i}if(n=h.exec(e))return r=parseInt(n[1],10)-1,A(t,r);if(n=v.exec(e)){r=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return A(t,r,c)}return null}(M.restDateString,S);if(B){var y,E=B.getTime(),P=0;return x.time&&(P=function(e){var t,n,i;if(t=O.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*o;if(t=g.exec(e))return n=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),n%24*o+i*r;if(t=w.exec(e)){n=parseInt(t[1],10),i=parseInt(t[2],10);var a=parseFloat(t[3].replace(",","."));return n%24*o+i*r+1e3*a}return null}(x.time)),x.timezone?y=function(e){var t,n;if(t=I.exec(e))return 0;if(t=k.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=C.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(x.timezone):(y=new Date(E+P).getTimezoneOffset(),y=new Date(E+P+y*r).getTimezoneOffset()),new Date(E+P+y*r)}return new Date(e)}},2031:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(44),o=n(1700);function r(e){return Object(i.j)("tri-officeRail")&&(e===o.a.Mail||e===o.a.Calendar||e===o.a.AppHost||e===o.a.People||e===o.a.FilesHub)}},2040:function(e,t,n){"use strict";var i=n(20),o=n(1898),r=n(2682),a=n(40);function s(e){const t=o.a.bulkActionInformationMap.get(e);return!!t&&(!(t.customData&&!function(e){let t;try{t=JSON.parse(e)}catch(e){return a.d("Failed to parse bulkActionInfo.customData"),!1}return null!==t&&null!==t.Scenario}(t.customData))&&!Object(r.a)(t,e))}function c(e,t){const n=o.a.bulkActionInformationMap.get(e);return s(e)&&n.state==t}function d(e){return(c(e,u.b.Uninitialized)||c(e,u.b.Running))&&s(e)}var u=n(2088);n.d(t,"a",(function(){return m})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"g",(function(){return O})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return u.b})),n.d(t,"l",(function(){return o.a}));const l=new i.c(()=>Promise.all([n.e(1),n.e(293),n.e(1035)]).then(n.bind(null,12755))),m=Object(i.d)(l,e=>e.BulkActionSpinner);let b=new i.a(l,e=>e.subscribeToBulkActionNotification),p=new i.a(l,e=>e.onBulkActionSubmitted),f=new i.a(l,e=>e.findBulkActionItemAction),h=new i.a(l,e=>e.onBulkActionCancel),v=new i.a(l,e=>e.onBulkActionHierarchyNotification),O=new i.a(l,e=>e.onBulkActionDismiss)},2041:function(e,t,n){"use strict";var i={};n.r(i),n.d(i,"add",(function(){return c})),n.d(i,"remove",(function(){return d})),n.d(i,"removeAll",(function(){return u})),n.d(i,"getCount",(function(){return l})),n.d(i,"getTombstonedReasons",(function(){return m})),n.d(i,"clearMapForFolder",(function(){return b})),n.d(i,"removeRowsFromTombstone",(function(){return p}));var o=n(3);let r=Object(o.createStore)("tombstone",{folderTombstoneMap:{}});r();var a=n(61),s=n(699);let c=Object(s.action)("tombstoneOperations.add")((function(e,t,n){if(1==t.tableQuery.type||"spotlight"===t.tableQuery.scenarioType)return;const i=t.serverFolderId,o=r().folderTombstoneMap;i in o||(o[i]={});const a=o[i];e.forEach(e=>{let t=a[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):a[e]=[3]:a[e]=[n]})})),d=Object(s.action)("tombstoneOperations.remove")((function(e,t,n){const i=r().folderTombstoneMap;if(!(t in i))return;const o=i[t],a=o[e],s=a?a.indexOf(n):-1;if(-1==s)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");a.splice(s,1),0==a.length&&delete o[e],0==Object.keys(o).length&&delete i[t]})),u=Object(s.action)("tombstoneOperations.removeAll")((function(){r().folderTombstoneMap={},Object(a.p)("TnS_RemoveAllFromTombstone")})),l=function(e,t){const n=r().folderTombstoneMap;if(!(e in n))return 0;let i=0;const o=n[e];return Object.values(o).forEach(e=>{e==t&&i++}),i},m=function(e,t){const n=r().folderTombstoneMap;if(t in n){const i=n[t][e];if(i)return i}return[]},b=Object(s.action)("tombstoneOperations.clearMapForFolder")((function(e){const t=r().folderTombstoneMap;t[e]&&(Object(a.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),p=Object(s.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){const n=r().folderTombstoneMap;if(!(t in n))return;const i=n[t];for(const t of e)t in i&&delete i[t];0==Object.keys(i).length&&delete n[t]}));t.a=i},2042:function(e,t,n){"use strict";var i=n(3);const o=Object(i.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null});var r=o(),a=n(2041),s=n(61),c=n(2891),d=n(2545);let u;n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return f}));const l=Object(i.mutatorAction)("setUndoableAction",(e,t)=>{const n=o();n.hasUndoableAction=e,n.undoableActionFolderId=t});function m(e,t){null!==e&&(u=e,l(!0,t))}function b(){u=null,l(!1,null)}function p(){return o().hasUndoableAction}function f(e){const t=new s.b("TnS_Undo");t.addCustomData([e]),r.undoableActionFolderId?a.a.clearMapForFolder(r.undoableActionFolderId):a.a.removeAll();return null!==u&&(u().then(()=>{Object(c.a)()||Object(d.a)()}),b()),t.end(),Promise.resolve()}},2054:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(14),o=n(3);const r=Object(o.createStore)("optionsViewState",{isFullOptionsShown:!1,areAllAllowedSubCategoriesLoaded:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new i.ObservableMap,currentOptionKey:null,allowedOptions:[],dirtyOptions:[]})},2088:function(e,t,n){"use strict";var i,o;n.d(t,"a",(function(){return o})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout",e[e.Cancelling=6]="Cancelling"}(i||(i={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout"}(o||(o={})),t.b=i},2107:function(e,t,n){"use strict";var i=n(0),o=n(560),r=n(20),a=n(702);function s(e,t,n,s){return Object(r.d)(e,e=>{const n=t(e);return e=>i.createElement(o.ApolloProvider,{client:Object(a.a)()},i.createElement(n,Object.assign({},e)))},n,s)}n.d(t,"a",(function(){return s}))},2108:function(e,t,n){"use strict";var i=n(20),o=n(2042),r=n(1679),a=n(1692),s=n(1685),c=n(1683),d=n(44);function u(e,t){return!(!e||Object(r.y)()||!t||!("UserMailbox"===t.type||Object(d.j)("grp-loadFolders")&&"GroupMailbox"===t.type)||Object(a.m)(e)||e==Object(s.a)("recoverableitemsdeletions")||Object(c.C)(e,"SharedMailbox"))}n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"d",(function(){return o.c})),n.d(t,"c",(function(){return u}));const l=new i.c(()=>n.e(2070).then(n.bind(null,18900)));let m=new i.a(l,e=>e.undo)},2116:function(e,t,n){"use strict";var i=n(3);const o=Object(i.action)("onViewModeChanged",e=>({viewMode:e}));var r=n(1764),a=n(61),s=n(11),c=n(44);const d="bootstrapRibbonImport";function u(){const e=Object(r.b)().viewMode;2===e||1===e||0===e&&Object(c.j)("mon-ribbon-toolbar")?Object(s.e)(window,d,"true"):Object(s.d)(window,d)}const l=Object(i.mutatorAction)("onViewModeChangedInternal",e=>{Object(a.o)("ViewModeChanged",{from:Object(r.b)().viewMode,to:e}),Object(r.b)().viewMode=e,u()});var m=n(1693);async function b(){const e=await m.j.import();return e&&await e(m.d.Commanding)}function p(e){!async function(e){const t=await b()||Object(m.g)(m.d.Commanding),n=Object.assign(Object.assign({},t),e);m.i.importAndExecute(m.d.Commanding,n)}({viewMode:e})}Object(i.orchestrator)(o,async e=>{const{viewMode:t}=e;return l(t),p(t)});var f=n(121);const h=Object(i.mutatorAction)("initializeCommandingViewMode",e=>{let t=Object(c.j)("mon-ribbon")?(e=>{var t;let n=null===(t=e.filter(e=>(null==e?void 0:e.feature)==m.d.Commanding)[0])||void 0===t?void 0:t.viewMode;if([void 0,0,1,2].includes(n))return n})(e):0;void 0===t&&(t=Object(f.a)("ribbonDefaultToSLR")?1:0,Object(f.a)("ribbonPersistDefault")&&p(t)),Object(r.b)().viewMode=t,u()}),v=()=>{const e=r.a.viewMode;return 2===e||1===e||0===e&&Object(c.j)("mon-ribbon-toolbar")};var O=n(2177);const g=()=>{const e=r.a.viewMode;return 2===e||1===e};function w(){return r.a.viewMode}n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return O.a})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return w}))},2143:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(44),o=n(49);function r(){return Object(i.j)("mail-oneView")&&Object(o.q)()}},2164:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(44),o=n(1758),r=n(828);function a(){return Object(i.j)("auth-cloudCache")&&(Object(o.b)()||Object(o.c)())&&Object(r.a)()}},2177:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1764);const o=e=>i.a.viewMode===e},2193:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(2143),o=n(2164),r=n(2031);function a(e){return Object(o.a)()||Object(i.a)()||Object(r.a)(e)}},2252:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("mountFullOptions",(e,t,n)=>({category:e,subcategory:t,option:n}))},2545:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("RESTORE_ROW_FAIL")},2639:function(e,t,n){"use strict";var i=n(3);const o=Object(i.action)("openCalendarBoardView");var r=n(44),a=n(49);function s(){var e;return Object(r.j)("cal-sublimity")&&!(null===(e=Object(a.g)().SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}function c(){window.open("/calendar/view/board","_blank")}n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}))},2645:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("GET_FOLDER_DATA",e=>({folderId:e}))},2682:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(2751),o=n.n(i),r=n(2088),a=n(1898);function s(e,t){const n=new Date,i=new Date(e.sendTime),s=o()(n,i),c=isNaN(s),d=s>7.5,u=Object(a.b)().bulkActionInformationMap.get(t);return!(!c&&!d)||!!u&&[r.b.Cancelled,r.b.Failed,r.b.Complete].indexOf(u.state)>-1}},2683:function(e,t,n){var i=n(1999);e.exports=function(e,t){var n=i(e),o=i(t);return n.getTime()-o.getTime()}},2751:function(e,t,n){var i=n(2683),o=36e5;e.exports=function(e,t){var n=i(e,t)/o;return n>0?Math.floor(n):Math.ceil(n)}},2891:function(e,t,n){"use strict";let i;function o(){i=!0}function r(){return i}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}))},3292:function(e,t,n){"use strict";var i=n(20),o=n(3),r=n(311);const a={sessionId:Object(r.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null,token:null,subdomain:null,tokenExpiry:null};let s=Object(o.createStore)("immersivereader",a);var c=s();n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s}));const d=new i.c(()=>n.e(966).then(n.bind(null,19223)));let u=new i.a(d,e=>e.showInImmersiveReader),l=new i.a(d,e=>e.closeImmersiveReader),m=new i.a(d,e=>e.setImmersiveReaderFrameReady)},3612:function(e,t,n){"use strict";var i=n(1844);const o="_ShowEditorSettingsSource";function r(e,t){return()=>{i.c.import().then(n=>n(e,e=>(e.triggerContentChangedEvent(o,t),null)))}}var a=n(44),s=n(169);function c(){return!!Object(a.j)("mc-officeEditorProofingMasterFlight")&&(Object(s.b)()||Object(s.c)()||Object(a.j)("mc-officeEditorBXFirefoxSafari")&&(Object(s.d)()||Object(s.f)()))}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c}))},3718:function(e){e.exports=JSON.parse('{"a":"m1b"}')},4060:function(e){e.exports=JSON.parse('{"a":"plc"}')},4717:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i=n(20);const o=new i.c(()=>Promise.all([n.e(4),n.e(6),n.e(7),n.e(9),n.e(10),n.e(12),n.e(13),n.e(218),n.e(306),n.e(318),n.e(575)]).then(n.bind(null,7179)));let r=new i.b(o,e=>e.createRuleFromItem),a=new i.b(o,e=>e.createRuleFromRow)},4742:function(e,t,n){"use strict";var i=n(0),o=n(146),r=n(352);t.a="MoreHorizontalRegular";const a=Object(r.a)({Svg:e=>i.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),i.createElement("path",{d:"M5 8a1 1 0 11-2 0 1 1 0 012 0z"}),i.createElement("path",{d:"M9 8a1 1 0 11-2 0 1 1 0 012 0z"}),i.createElement("path",{d:"M12 9a1 1 0 100-2 1 1 0 000 2z"})),displayName:"MoreHorizontalRegular"});Object(o.p)({icons:{MoreHorizontalRegular:i.createElement(a,null)}})},5059:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var i=n(20);const o=new i.c(()=>n.e(656).then(n.bind(null,8193))),r=new i.b(o,e=>e.onArchiveTagForFolderChanged),a=new i.b(o,e=>e.onDeleteTagForFolderChanged),s=new i.b(o,e=>e.getRetentionPolicyMenuItem),c=new i.b(o,e=>e.getAssignPolicyPropertiesForMailContextMenu)},5076:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(20);const o=new i.c(()=>n.e(1116).then(n.bind(null,9124)));let r=new i.b(o,e=>e.preparePopoutDataForReadingPane)},6110:function(e,t,n){"use strict";var i=n(0),o=n(13067);const r={useLazyLoadQueryWithDocumentNode:n(3858).c,useSubscriptionWithDocumentNode:(e,t)=>{}};var a=n(11347),s=n(5),c=n(4);const d=new c.d(()=>n.e(1872).then(n.t.bind(null,18884,3))),u=new c.c(d,e=>e.default),l={async initializeLocalizer(e){switch(e){case a.a:return async function(e){const t=await e.import();return await Promise.all(Object.values(t).map(e=>Object(s.h)(e))),{resolveString:(e,n)=>Object(s.b)(t[e])}}(u);default:throw new Error(`Unrecognized string group: ${e}`)}}};var m=n(13068),b=n(3);const p=Object(b.action)("onM365AppTrigger",e=>({command:e})),f=Object(b.action)("onComposeMessageExtensionTrigger",e=>({command:e})),h=Object(b.action)("onModuleTrigger",e=>({command:e})),v={trigger:e=>(e.entity.type===m.c.m365_app?p(e):e.entity.type.toString().includes("outlook_")?h(e):e.entity.type===m.c.m365_messageextension&&f(e),Promise.resolve())},O=e=>{const{children:t}=e,n={commanding:v,graphql:r,localization:l};return i.createElement(o.a.Provider,{value:n},t)};O.displayName="NovaContextProvider",n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return f}))},6528:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i=n(20);const o=new i.c(()=>Promise.all([n.e(4),n.e(8),n.e(18),n.e(22),n.e(31),n.e(36),n.e(40),n.e(43),n.e(42),n.e(60),n.e(80),n.e(92),n.e(106),n.e(115),n.e(133),n.e(123),n.e(182),n.e(221),n.e(262),n.e(340),n.e(273),n.e(354),n.e(480)]).then(n.bind(null,9013))),r=new i.a(o,e=>e.showAdminInstalledNewAddinFRECallout),a=new i.a(o,e=>e.showUnpinnedAdminAddinFRECallout)},730:function(e,t,n){"use strict";var i=n(3);const o=Object(i.action)("POPOUT_READING_PANE",(e,t,n,i,o)=>({itemId:e,conversationId:t,internetMessageId:n,mailboxInfo:i,data:o}));t.a=o},7892:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(20);const o=new i.c(()=>n.e(396).then(n.bind(null,11101))),r=new i.b(o,e=>e.getSpacesContextMenuItems)},828:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(36),o=n(55);function r(){var e;const t=null===(e=Object(i.b)())||void 0===e?void 0:e.pathname;if(t){const e=t.split("/"+Object(o.a)()+"/")[1];if(e){const t=e.split("/")[0];if(t&&!isNaN(parseInt(t)))return!0}}return!1}},8869:function(e){e.exports=JSON.parse('{"a":"nYb"}')},9042:function(e,t,n){"use strict";var i=n(3);var o=Object(i.createStore)("AddinsSurfaceActionsStore",{isAddinObserverLoaded:!1})(),r=n(699),a=Object(r.action)("setAddinObserverLoaded ")((function(){o.isAddinObserverLoaded=!0})),s=n(1772);let c;s.u.import().then(e=>{c=e,a()});var d=n(123),u=n(1853),l=n(1683),m=n(3492),b=n(44);function p(e,t){const n=e.length;n>0&&e[n-1].displayName!=m.a&&e.push({key:`addinDivider_${t}`,displayName:m.a,itemType:d.a.Divider,onClick:null})}function f(e,t,n,i,r,a,m,f,h,v,O,g,w){let j;g=g||function(e){if(!e||!e.ParentFolderId)return!1;const t=e.ParentFolderId.Id;return Object(l.C)(t,"SharedMailbox")}(t);const I=e==u.a.MessageRead?Object(s.q)(n):Object(s.n)(n),k=function(e,t,n,i){return o.isAddinObserverLoaded&&c?c(e,t,n,i).get():null}(e,g,I,h);j=k?k.sectionProps.items:[];let C=!0;j.forEach(t=>{Object(s.l)(I,t,h);const n=t;if(n.iconOnly=!0,v&&(n.className=v),n.disabled=!!w,i.indexOf(t.key)>=0){let e=n;O&&(e=Object.assign({},n)),null!=e.name&&null!=e.title&&e.name.trim()!=e.title.trim()&&(e.name=e.ariaLabel),e.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach(e=>{e.isPinned=!0}),n?e.unshift(t):e.push(t)}(r,e,m)}(-1==i.indexOf(t.key)||O)&&(C&&(p(a,f++),C=!1),n.renderedInOverflow=!0,n.subMenuProps&&n.subMenuProps.items.forEach(e=>{e.renderedInOverflow=!0}),(n.itemType!==d.a.Divider||0!==a.length&&a[a.length-1].itemType!==d.a.Divider)&&((Object(b.j)("addin-exp-awarenessNudgeCusBtn")||Object(b.j)("addin-exp-awarenessNudge")||Object(b.j)("addin-exp-awarenessNudgeWaterDropNudge"))&&s.A.importAndExecute(n,e),a.push(n)))})}n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}))},9147:function(e,t,n){"use strict";var i=n(599),o=n(1572),r=n(498),a=n(932),s=n(302),c=n(21),d=n(5),u=n(4060),l=n(10140),m=n(1752),b=n(705);function p(e){return Object(m.a)(e.ItemId.Id,Object(b.a)({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",e.MailboxInfo).then(e=>!e||e instanceof Error?null:e.MimeContent)}var f=n(283),h=n(0),v=n(149),O=n(10141),g=n(107),w=n.n(g),j=n(10142),I=n.n(j);n.d(t,"a",(function(){return C}));const k=Object(c.a)((function(e,t){const[n,s]=h.useState("");h.useImperativeHandle(t,()=>({setContent(e){null!==e&&0!==e.length||(e=Object(d.b)(O.a)),s(e)}}),[]);const c=()=>{e.onClose()};return h.createElement(o.a,{hidden:!1,dialogContentProps:{showCloseButton:!1,title:Object(f.a)()?Object(d.b)(O.c):Object(d.b)(O.b),type:r.a.normal},modalProps:{containerClassName:I.a.container},onDismiss:c},h.createElement("div",{className:w()(I.a.content,"allowTextSelection"),tabIndex:-1},n),h.createElement(a.a,null,h.createElement(i.a,{onClick:c,className:I.a.button},Object(d.b)(u.a))))}),{forwardRef:!0});function C(e,t){var n;const i=(t||window).document,o=i.createElement("div");o.id="ViewMessageSourceDialog",i.body.appendChild(o);const r=h.createRef();v.render(h.createElement(s.b,{window:t||window},h.createElement(k,{onClose:()=>{v.unmountComponentAtNode(o),i.body.removeChild(o)},ref:r})),o),Object(f.a)()?(null===(n=e.MimeContent)||void 0===n?void 0:n.Value)?r.current.setContent(atob(e.MimeContent.Value)):p(e).then(t=>{e.MimeContent=t,r.current.setContent(atob(e.MimeContent.Value))}):Object(l.a)(e).then(e=>{r.current.setContent(e)})}}}]);
//# sourceMappingURL=owa.598.js.map
self.scriptsLoaded['owa.598.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.598.js'] = (new Date()).getTime();