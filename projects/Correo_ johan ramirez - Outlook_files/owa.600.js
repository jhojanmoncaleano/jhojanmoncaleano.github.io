self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.600.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[600],{1e3:function(e){e.exports=JSON.parse('{"a":"BYb"}')},1001:function(e){e.exports=JSON.parse('{"a":"AYb"}')},1002:function(e){e.exports=JSON.parse('{"a":"Fma"}')},1003:function(e){e.exports=JSON.parse('{"a":"Ema"}')},1004:function(e){e.exports=JSON.parse('{"a":"Dma"}')},1005:function(e){e.exports=JSON.parse('{"a":"Cma"}')},1009:function(e){e.exports=JSON.parse('{"a":"vma"}')},1010:function(e){e.exports=JSON.parse('{"a":"uma"}')},1011:function(e){e.exports=JSON.parse('{"a":"ama"}')},1012:function(e){e.exports=JSON.parse('{"a":"$la"}')},1013:function(e){e.exports=JSON.parse('{"a":"_la"}')},1014:function(e){e.exports=JSON.parse('{"a":"Zla"}')},1015:function(e){e.exports=JSON.parse('{"a":"Yla"}')},1016:function(e){e.exports=JSON.parse('{"a":"Xla"}')},1017:function(e){e.exports=JSON.parse('{"a":"Wla"}')},1018:function(e){e.exports=JSON.parse('{"a":"Vla"}')},1019:function(e){e.exports=JSON.parse('{"a":"Ula"}')},1020:function(e){e.exports=JSON.parse('{"a":"Tla"}')},10308:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(40);class i{constructor(e=5,t=5e3){this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=()=>{this.throttleCallbacks.length=0,this.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}watchDogAction(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))}traceInfo(e){a.h.info(`ThrottleRequests:active=${this.activeRequests};throttled=${this.throttleCallbacks.length};processed=${this.processedRequests};lastProcessed=${this.lastProcessedRequests};info=${e}`)}processNextRequest(){if(this.processedRequests++,0===this.throttleCallbacks.length)this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.");else{this.throttleCallbacks.shift()(!1),this.traceInfo("Process next.")}}registerCallback(e){if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval(()=>{this.watchDogAction()},this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))}unregisterCallback(e){const t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)}}},10877:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(20);const i=new a.c(()=>Promise.all([n.e(6),n.e(8),n.e(116),n.e(134),n.e(130),n.e(848)]).then(n.bind(null,12748))),r=new a.b(i,e=>e.openBotConversation),s=new a.b(i,e=>e.openCortanaConversation);new a.a(i,e=>e.setEditorInterface)},17700:function(e,t,n){var a=n(17701);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(66)(a,i);a.locals&&(e.exports=a.locals)},17701:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,".YHuTLR0ArejsCKCCDtUvI{-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] .YHuTLR0ArejsCKCCDtUvI{border-width:1px;border-style:dashed;border-color:var(--themePrimary)}",""]),t.locals={imagePlaceholder:"YHuTLR0ArejsCKCCDtUvI"}},17702:function(e){e.exports=JSON.parse('{"a":"Akc","c":"Bkc","b":"Ckc","g":"Dkc","f":"Ekc","e":"Fkc","h":"Gkc","d":"Hkc","i":"Ikc","j":"Jkc"}')},17703:function(e){e.exports=JSON.parse('{"a":"Lkc","b":"Mkc","c":"Nkc"}')},17704:function(e){e.exports=JSON.parse('{"a":"Kkc"}')},17705:function(e,t,n){var a=n(17706);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(66)(a,i);a.locals&&(e.exports=a.locals)},17706:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,"html[dir] .e7RD5OqJ5eTaFCmmUQNhE{margin-top:12px}html[dir=ltr] .e7RD5OqJ5eTaFCmmUQNhE{margin-left:52px}html[dir=rtl] .e7RD5OqJ5eTaFCmmUQNhE{margin-right:52px}._3gCYwk0lDIK2EfckwxKl4W{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3fpj87EnIj38wOaoGqJcxK{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3fpj87EnIj38wOaoGqJcxK{margin-top:8px}._3fpj87EnIj38wOaoGqJcxK ._2PapeCuGRS-nixm3gyA25I{font-size:8px}",""]),t.locals={container:"e7RD5OqJ5eTaFCmmUQNhE",cardArea:"_3gCYwk0lDIK2EfckwxKl4W",bodyToggleButton:"_3fpj87EnIj38wOaoGqJcxK",icon:"_2PapeCuGRS-nixm3gyA25I"}},19130:function(e,t,n){"use strict";n.r(t);var a=n(9065);async function i(e){var t,n,i;if(null===(t=e.AdaptiveCardData)||void 0===t?void 0:t.cardDetails)return e.AdaptiveCardData.cardDetails;return(null!==(i=await Object(a.d)([null===(n=e.ItemId)||void 0===n?void 0:n.Id]))&&void 0!==i?i:[[]])[0]}var r=n(0),s=n(21),o=n(40),c=n(61),d=n(7),l=n(2883),u=n(3491),h=n(5231),p=n(5006),m=n(3);var b=Object(m.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:o.h.warn("[ActionableMessageDebug] setShowBodyWithMessageCard: viewState undefined")}));var g=Object(m.mutatorAction)("updateShowCardLoading",(function(e,t){e.showCardLoading=t})),f=n(2377),A=n(1724),C=n(5),v=n(10308),O=n(17700),y=n.n(O);const x=/url\("(.*)"\)/g,S=new v.a(5,5e3);var I=(e,t,n)=>{const a=e.querySelectorAll('img[src^="cid:"]');if(a)for(let e=0;e<a.length;e++)j(a[e],t,n);const i=e.querySelectorAll("div[style*='background-image: url(\"cid:']");if(i)for(let e=0;e<i.length;e++)M(i[e],t,n)};const j=(e,t,n)=>{const a=e.src;if(a&&0===a.indexOf("cid:")){e.src=h.a,e.setAttribute("originalSrc",a),e.classList.add(y.a.imagePlaceholder);const i=w(a,t,n);if(i){const t=t=>{t||(e.src=i)};e.onload=t=>{e.classList.remove(y.a.imagePlaceholder),S.processNextRequest()},e.onerror=t=>{let n=t.target;e.classList.remove(y.a.imagePlaceholder),S.processNextRequest(),o.h.info("[ActionableMessageDebug] imageSrcError: image cannot be loaded for src: "+n.src)},S.registerCallback(t)}}},M=(e,t,n)=>{let a=e.style.backgroundImage;var i=x.exec(a);if(i&&i.length>1&&i[1]){const a=w(i[1],t,n);a&&(e.style.backgroundImage=Object(C.c)('url("{0}")',a))}},w=(e,t,n)=>{if(!t.Attachments)return null;const a=k(e.substring("cid:".length));let i;for(let e=0;e<t.Attachments.length;e++){const n=t.Attachments[e];if(a===k(n.Name)||a===k(n.ContentId)){i=n.AttachmentId;break}}if(!i)return o.h.warn("[ActionableMessageDebug] fixSrcForImage: attachment id not found for cid: "+a),null;const r=Object(f.b)(Object.assign(Object.assign({},i),{mailboxInfo:n}),1);return r||(o.h.warn("[ActionableMessageDebug] fixSrcForImage: could not create attachment url for image with cid: "+a+" and attachment id: "+i),null)},k=e=>{if(Object(A.g)(e)){const t=Object(A.b)(e);return e.substring(0,e.length-t.length)}return e};var D=n(10061),T=n(2432);class P extends T.Action{getJsonTypeName(){return"DisplayAppointmentForm"}parse(e){super.parse(e),this.itemId=e.itemId,this.isPrimary=e.isPrimary}}const N="Action.InvokeAddInCommand",E="Action.PinAddInCommand",R="Action.DisplayReplyAllForm",J="Action.DisplayAppointmentForm",z="Action.DisplayMessageForm",F="Action.StartBotConversation";class q extends T.Action{getJsonTypeName(){return z}parse(e){super.parse(e),this.itemId=e.itemId,this.isPrimary=e.isPrimary}}class L extends T.Action{getJsonTypeName(){return"DisplayReplyAllForm"}parse(e){super.parse(e),this.isPrimary=e.isPrimary}}class _ extends T.Action{constructor(){super(),this.addinId="",this.desktopCommandId="",this.initializationContext=""}parse(e){super.parse(e),this.isPrimary=e.isPrimary,this.addinId=e.addInId?e.addInId:e.addinid,this.desktopCommandId=e.desktopCommandId?e.desktopCommandId:e.desktopcommandid,this.initializationContext=e.initializationContext?JSON.stringify(e.initializationContext):JSON.stringify(e.initializationcontext)}getJsonTypeName(){return N}}class H extends T.Action{constructor(){super(),this.productId="",this.newPinnedStatus=!1}parse(e){super.parse(e),this.isPrimary=e.isPrimary,this.productId=e.productId,this.newPinnedStatus=e.newPinnedStatus}getJsonTypeName(){return E}}class W extends T.Action{constructor(){super(),this.botId="",this.initialMessage="",this.botName=""}parse(e){super.parse(e),this.isPrimary=e.isPrimary,this.botId=e.botId,this.botName=e.botName,this.initialMessage=e.initialMessage}getJsonTypeName(){return F}}var G=n(1772),B=n(1853),U=n(1693),Y=n(10877),$=n(1885),V=n(730),K=n(9079),Q=n(44),X=n(1747),Z=n(1840);const ee="MessageCardInvokeAddinCommandClicked",te="MessageCardPinAddinCommandClicked",ne="DisplayAppointmentFormClicked",ae="DisplayMessageFormClicked",ie=Object.freeze({evt:"ActionCardHttpPostActionClicked",tel:"ShowCardClick"}),re=Object.freeze({evt:"SingleClickHttpPostActionClicked",tel:"SingleClick"}),se=Object.freeze({evt:"AutoInvokeActionClicked",tel:"AutoInvoke"}),oe="actionContext";var ce={registerActions:function(){T.AdaptiveCard.actionTypeRegistry.registerType(N,()=>new _),T.AdaptiveCard.actionTypeRegistry.registerType(E,()=>new H),T.AdaptiveCard.actionTypeRegistry.registerType(R,()=>new L),T.AdaptiveCard.actionTypeRegistry.registerType(J,()=>new P),T.AdaptiveCard.actionTypeRegistry.registerType(z,()=>new q),Object(Q.j)("mc-botConversation")&&T.AdaptiveCard.actionTypeRegistry.registerType(F,()=>new W)},executeAction:function(e,t,n,a,i,r,s,c){const d={id:e.id,type:e.getJsonTypeName()},l={cardDetails:t,elementDetails:d,messageContext:i,actionContext:e[oe],eventName:void 0};if(e instanceof L){o.h.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);const t=X.HtmlSanitizer.sanitizeHtml(e.title);$.m.importAndExecute({referenceItemOrId:i.itemId,mailboxInfo:i.mailboxInfo,isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:i.conversationId,body:t})}else if(e instanceof P){o.h.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),l.eventName=ne,r.logTelemetry(l);const t=`/calendar/item/${encodeURIComponent(e.itemId)}`;window.open(t,"_blank")}else if(e instanceof q)o.h.info("[AdaptiveCard] DisplayMessageFormAction executed"),l.eventName=ae,r.logTelemetry(l),Object(V.a)(e.itemId);else if(e instanceof H&&Object(Q.j)("addin-pinThroughAM")){o.h.info("[AdaptiveCard] PinAddinCommandAction executed"),l.eventName=te,r.logTelemetry(l),function(e){let t=Object(Z.u)().Extensions;for(const n of t)if(n.Id===e.productId){let t={readMode:null!=n.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=n.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=n.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=n.ExtensionPointCollection.AppointmentAttendeeCommandSurface};U.l.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,t);break}}(e)}else if(e instanceof _){o.h.info("[AdaptiveCard] InvokeAddinCommandAction executed"),l.eventName=ee,r.logTelemetry(l);const t=e,n=Object(G.q)(i.itemId);G.D.import().then(e=>{e(n,t.addinId.toLowerCase(),t.desktopCommandId,B.a.MessageRead,c,t.initializationContext)})}else if(e instanceof W){const{botId:n,botName:a}=e,s=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);o.h.info("[ActionableMessageDebug] StartBotConversation executed with message: "+n),Y.a.import().then(e=>e(i.mailboxInfo,{friendlyBotName:a,botId:n,botData:s,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")),r.logTelemetry(l)}else{if(!(e instanceof T.OpenUrlAction))return!1;{const t=new URL(e.url);if("mailto:"===t.protocol.toLowerCase()){const{composeInitProps:e}=Object(K.a)(t.href);$.k.importAndExecute(e,2)}}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return function(e){const t=new L;return t.title=e.name,t.htmlBody=e.htmlBody,t}(e);case"invokeaddincommand":return function(e){const t=new _;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e);case"pinaddincommand":return function(e){const t=new H;return t.title=e.name,t.productId=e.productId,t.newPinnedStatus=e.newPinnedStatus,t}(e)}return null},processAutoInvokeAction:function(e,t){if(Object(Q.j)("mc-botConversation")&&e.type===F){const t=new W;return t.parse(e),t}return null},registerHostCapabilities:null},de=n(17702),le=n(7114),ue=n(17703),he=n(17704),pe=n(394);var me=()=>Object(Q.j)("rp-actionableMessages-ACv2-support");const be="messageCardContext";var ge,fe=n(2561),Ae=n(49),Ce=n(8866);!function(e){e.Completed="Completed",e.Failed="Failed"}(ge||(ge={}));var ve=ge;var Oe=e=>{let t=e?6e3:1e4;const n=Object(h.j)();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t};var ye=(e,t,n)=>{const a=e.action,i={type:"invoke",name:"adaptiveCard/action",localTimezone:"",localTimestamp:"",value:{action:{type:"Action.Execute",id:a.id,verb:a.verb,data:a.data},trigger:e.trigger},from:{id:t},channelData:n};return e.authCode&&(i.value.state=e.authCode),i};var xe=e=>{"string"==typeof e&&(e={buttons:[{type:"signin",value:e}]});const t=new fe.Authentication;return t.parse(e),t};class Se extends fe.ChannelAdapter{constructor(e,t,n,a,i){super(),this.url=e,this.parseCardFromStringOrObject=e=>u.e.import().then(t=>t(this.cardDetails,this.cardDetails.connectorSenderGuid,e.newCardPayload,e.newCardSignature,!0,this.cardDetails.cardId)),this.isActionInShowCard=e=>{for(;e.parent;){if(e instanceof fe.AdaptiveCard)return!0;e=e.parent}return!1},this.cardDetails=t,this.messageContext=n,this.onCardDetailsUpdated=a,this.telemetryHandler=i}parseResponse(e,t){const n=t&&e.status===ve.Completed;let a;return a=e.displayMessage?e.displayMessage:e.errorMessage?e.errorMessage:n?Object(C.b)(Ce.a):Object(C.b)(le.a),{status:n?ve.Completed:ve.Failed,displayMessage:a,newCardPayload:e.refreshCardSerialized,newCardSignature:e.refreshCardSignature,loginUrl:e.loginUrl,oAuthCard:e.oAuthCard}}getActionTelemetryEventName(e){return e.trigger===fe.ActivityRequestTrigger.Automatic?se:e.action.parent&&this.isActionInShowCard(e.action.parent)?ie:re}getTelemetryDataFromAnalytics(e,t,n){const a=Object(p.d)(this.telemetryHandler.getTelemetryDetailsForEvent(this.cardDetails,e,t,n),!1);if(a.messageCardContext)try{a.messageCardContext=JSON.parse(a.messageCardContext)}catch(e){}if(a.messageCardExtensionContext)try{a.messageCardExtensionContext=JSON.parse(a.messageCardExtensionContext)}catch(e){}if(a.actionContext)try{a.actionContext=JSON.parse(a.actionContext)}catch(e){}return a}getActionExecuteChannelData(e,t){return{connectorSenderGuid:this.cardDetails.connectorSenderGuid,inputParameters:[],senderAddress:this.messageContext.senderAddress,smtpAddressesSerialized:this.cardDetails.smtpAddressesSerialized,adaptiveCardSignature:this.cardDetails.cardSignature,adaptiveCardHash:this.cardDetails.cardHash,clientTelemetry:this.getTelemetryDataFromAnalytics(e,null,t)}}async sendRequestAsync(e){var t,n,a;const i={actionType:"undefined",TAT:-2,TFT:-2,SRT:-2},r={};try{Object(h.n)(r,i,u.a.ActionExecStart);const s=Object(Ae.g)(),o=null===(t=s.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,c=null===(n=s.SessionSettings)||void 0===n?void 0:n.UserEmailAddress;Object(h.n)(r,i,u.a.TokenFetchStart);const d=await Object(l.a)();if(!d){const e=new Error(`Token is empty: ${d}`);throw e.name="EmptyTokenError",e}Object(h.n)(r,i,u.a.TokenFetchEnd);const p=this.getActionTelemetryEventName(e);i.actionType=p.tel;const m={id:e.action.id,type:e.action.getJsonTypeName()},b=this.getActionExecuteChannelData(p.evt,m),g=ye(e,o||c,b),f=e.trigger===fe.ActivityRequestTrigger.Automatic,A=Oe(f),C=Object(h.c)(new Headers);C.set("Content-Type","application/json"),C.set("Authorization",`Bearer ${d}`);const v={method:"POST",headers:C,body:JSON.stringify(g)};Object(h.n)(r,i,u.a.ServerRequestStart);let O=await Object(h.e)(this.url,v,A);const y=await O.json();Object(h.n)(r,i,u.a.ServerRequestEnd);const x=this.parseResponse(y,O.ok);if(x.newCardPayload){const e=await this.parseCardFromStringOrObject(x);this.cardDetails=e,this.onCardDetailsUpdated([e])}let S;return Object(h.n)(r,i,u.a.ActionExecEnd),f||this.telemetryHandler.logTelemetryProvider(this.cardDetails,"HttpPostActionExecuted",null,m,i),S=O.ok&&x.status===ve.Completed?new fe.SuccessResponse(e,x.newCardPayload?x.newCardPayload:x.displayMessage):x.oAuthCard||x.loginUrl?new fe.LoginRequestResponse(e,xe(null!==(a=x.oAuthCard)&&void 0!==a?a:x.loginUrl)):new fe.ErrorResponse(e,new fe.ActivityRequestError(ve.Failed,x.displayMessage)),S}catch(t){return i.actionType="Exception",Object(h.n)(r,i,u.a.ActionExecEnd),this.telemetryHandler.logTelemetryProvider(this.cardDetails,"HttpPostActionExecuted",null,{id:"Exception",type:"Exception"},i),new fe.ErrorResponse(e,new fe.ActivityRequestError(ve.Failed,Object(C.b)(le.a)))}}}var Ie=n(1882);class je extends fe.Action{internalParse(e,t){super.internalParse(e,t),this.itemId=e.itemId}getJsonTypeName(){return J}}class Me extends fe.Action{internalParse(e,t){super.internalParse(e,t),this.itemId=e.itemId}getJsonTypeName(){return z}}class we extends fe.Action{getJsonTypeName(){return R}}class ke extends fe.Action{constructor(){super(...arguments),this.addinId="",this.desktopCommandId="",this.initializationContext=""}internalParse(e,t){super.internalParse(e,t),this.addinId=e.addInId?e.addInId:e.addinid,this.desktopCommandId=e.desktopCommandId?e.desktopCommandId:e.desktopcommandid,this.initializationContext=e.initializationContext?JSON.stringify(e.initializationContext):JSON.stringify(e.initializationcontext)}getJsonTypeName(){return N}}class De extends fe.Action{constructor(){super(...arguments),this.productId="",this.newPinnedStatus=!1}internalParse(e,t){super.internalParse(e,t),this.productId=e.productId,this.newPinnedStatus=e.newPinnedStatus}getJsonTypeName(){return E}}var Te={registerActions:function(){fe.GlobalRegistry.actions.register(N,ke),fe.GlobalRegistry.actions.register(E,De),fe.GlobalRegistry.actions.register(R,we),fe.GlobalRegistry.actions.register(J,je),fe.GlobalRegistry.actions.register(z,Me)},executeAction:function(e,t,n,a,i){const r={cardDetails:t,elementDetails:{id:e.id,type:e.getJsonTypeName()},messageContext:n,actionContext:e[oe],eventName:void 0};if(e instanceof we){o.h.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);const t=X.HtmlSanitizer.sanitizeHtml(e.title);$.m.importAndExecute({referenceItemOrId:n.itemId,mailboxInfo:n.mailboxInfo,isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:n.conversationId,body:t})}else if(e instanceof je){o.h.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),r.eventName=ne,a.logTelemetry(r);const t=`/calendar/item/${encodeURIComponent(e.itemId)}`;window.open(t,"_blank")}else if(e instanceof Me)o.h.info("[AdaptiveCard] DisplayMessageFormAction executed"),r.eventName=ae,a.logTelemetry(r),Object(V.a)(e.itemId);else if(e instanceof De&&Object(Q.j)("addin-pinThroughAM")){o.h.info("[AdaptiveCard] PinAddinCommandAction executed"),r.eventName=te,a.logTelemetry(r),function(e){let t=Object(Z.u)().Extensions;for(const n of t)if(n.Id===e.productId){let t={readMode:null!=n.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=n.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=n.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=n.ExtensionPointCollection.AppointmentAttendeeCommandSurface};U.l.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,t);break}}(e)}else if(e instanceof ke){o.h.info("[AdaptiveCard] InvokeAddinCommandAction executed"),r.eventName=ee,a.logTelemetry(r);const t=e,s=Object(G.q)(n.itemId);G.D.import().then(e=>{e(s,t.addinId.toLowerCase(),t.desktopCommandId,B.a.MessageRead,i,t.initializationContext)})}}},Pe=n(17705),Ne=n.n(Pe),Ee=Object(s.a)((function(e){const t=r.useContext(Ie.a);r.useEffect(()=>(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper mount"),()=>{S.clearQueue(),o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper unmount")}),[]),r.useEffect(()=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper update"),O()}),r.useEffect(()=>(m.current=setTimeout(()=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper card load timed out"),Object(c.o)("actionableMessageContentLoadTimeout"),Object(p.e)(p.b.CardLoadTimeout,p.a.Standard),f.current=!0,P(!0)},4e3),()=>clearTimeout(m.current)),[]);const n=r.useRef({loadStartTime:Object(d.Vb)()}),s=r.useRef([]),m=r.useRef(),f=r.useRef(),[A,v]=r.useState(null),O=async()=>{const{item:t}=e,{cardFetchStatus:r}=t.AdaptiveCardData;if(r===u.d.Loading)return void o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt");n.current.fetchStartTime=Object(d.Vb)();const{cardDetails:s}=t.AdaptiveCardData;if(s&&s.length>0)return o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+s[0].cardId),void(n.current.fetchEndTime=Object(d.Vb)());const l=new c.b("MCActionableCardGetProperty");try{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),Object(a.g)([t],u.d.Loading);const e=await i(t);e&&e.length>0?(Object(a.g)([t],u.d.Loaded),l.end(),n.current.fetchEndTime=Object(d.Vb)(),o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+e[0].cardId),Object(a.a)(t,e)):(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),Object(a.g)([t],u.d.NotLoaded),P(!0),l.endWithError("ServerError"))}catch(e){o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),o.h.warn("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+e.message),Object(a.g)([t],u.d.NotLoaded),P(!0),l.endWithError("ClientError")}},y=e=>e.filter(e=>!e.isContextual),x=a=>{const i=y(a),c=Object(D.a)(e.item);let d={onUndo:()=>(()=>{const{darkModeContentHandler:t,undoDarkMode:n}=e;t&&n&&(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(s.current),s.current=[])})(),onApply:t=>(t=>{const{undoDarkMode:n,darkModeContentHandler:a}=e;if(t&&a&&!n)if(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),a.cssSelector){a.handler(t),s.current.push(t);const e=t.querySelectorAll(a.cssSelector);if(e)for(let t=0;t<e.length;t++){const n=e.item(t);a.handler(n),s.current.push(n)}}else o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")})(t)};const m=new u.c(p.g,c,n.current);let b;if(i&&i.length>0&&(b=me()?i[0]:i[i.length-1]),b&&(t=>{var n;let a=!0,i=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return i||(i=null==t?void 0:t.connectorSenderGuid),i&&(a=!Object(h.l)(i,e.isDarkMode)),a})(b)){o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+b.cardId);const n=new Se(Object(h.h)(c),b,c,M,m);return r.createElement("div",{className:Ne.a.container},r.createElement(u.b,{key:b.cardId,cardDetails:b,isDarkMode:e.isDarkMode,isActionableMessageV2Enabled:me(),snackBarTimeout:Object(h.i)(),v2SnackBarTimeout:Object(h.k)(),showMessageBodyCallback:j,undoDarkMode:e.undoDarkMode,actionProviders:[ce,h.b],adjustCardElementBeforeRenderCallback:w,fixImagesBeforeRenderCallback:k,onCardRendered:T,onCardDetailsUpdated:M,getClientAuthToken:l.a,actionableMessageContentHandler:d,actionableMessageCardStrings:{format:C.c,placeholder:{textInput:Object(C.b)(de.g),numberInput:Object(C.b)(de.f),dateInput:Object(C.b)(de.e),timeInput:Object(C.b)(de.h),choiceSetInput:Object(C.b)(de.d)},error:{generic:Object(C.b)(le.a)},warning:{invalidInput:Object(C.b)(de.i),missingRequiredInput:Object(C.b)(de.j),inputNumberNotNumeric:Object(C.b)(ue.c),inputNumberLessThanMin:Object(C.b)(ue.a),inputNumberMoreThanMax:Object(C.b)(ue.b),requiredField:Object(C.b)(he.a)},information:{actionInProgress:Object(C.b)(de.a),authenticationFlowAcknowledgeMessage:Object(C.b)(de.c),authenticationFlowAcknowledgeButtonText:Object(C.b)(de.b)},datePicker:Object.assign(Object.assign({},Object(pe.a)()),{isRequiredErrorMessage:Object(C.b)(he.a)})},telemetryHandler:m,httpChannelAdapter:n,isTrustedDomain:h.m,actionProviderV2:Te,targetWindow:t}))}return o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails - Did not find expected number of cards on the message"),j(!0),r.createElement("div",null)},j=t=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),b(e.viewState,t),t&&g(e.viewState,!1),P(t)},M=t=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper updateCardOnItem"),Object(a.f)(e.item,t)},w=(t,n)=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper fixInlineImages"),Object(h.f)(t,e.item.MailboxInfo,n),I(t,e.item,e.item.MailboxInfo)},k=(t,n)=>{Object(h.f)(t,e.item.MailboxInfo,n)},T=t=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),A!==t&&(v(t),P(!1)),e.viewState.showCardLoading&&g(e.viewState,!1)},P=t=>{o.h.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),m.current&&(clearTimeout(m.current),m.current=null);const{viewState:n}=e;g(n,!1),t&&b(n,!0)},N=e.item.AdaptiveCardData.cardDetails;return o.h.info(`[ActionableMessageDebug] ActionableMessageMailWrapper render. itemId: ${e.item.ItemId.Id}. CardDetails: ${(null==N?void 0:N[0])?N[0].cardId:"undefined"}`),N&&N.length>0?0!==(e=>{let t=y(e);return t=t.filter(e=>(function(e){const{card:t}=e;if(t&&t.hasOwnProperty(be)){const{messageCardContext:n}=t;return!!n&&"Transaction"===e.card.messageCardContext.oamAppName}return!1})(e)),t})(N).length?(P(!0),null):(e=>(f.current&&P(!0),!f.current&&r.createElement("div",{className:Ne.a.cardArea},x(e))))(N):null}));n.d(t,"getCardDetails",(function(){return i})),n.d(t,"ActionableMessageMailWrapper",(function(){return Ee})),n.d(t,"doesActionableMessageEnabled",(function(){return h.d}))},2004:function(e,t,n){"use strict";function a(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=void 0,t.getTargetWindow=a,t.default=function(e,t){var n=a(e),i=n&&n[t],r=window,s=r&&r[t];return s&&e instanceof s||i&&e instanceof i}},253:function(e){e.exports=JSON.parse('{"l":"bma","i":"cma","n":"dma","k":"ema","m":"fma","j":"gma","d":"hma","b":"ima","f":"jma","g":"kma","e":"lma","a":"mma","c":"nma","o":"oma","s":"pma","r":"qma","p":"rma","q":"sma","h":"tma"}')},394:function(e,t,n){"use strict";var a=n(977),i=n(978),r=n(979),s=n(980),o=n(981),c=n(982),d=n(983),l=n(994),u=n(995),h=n(996),p=n(997),m=n(998),b=n(999),g=n(1e3),f=n(1001),A=n(1002),C=n(1003),v=n(1004),O=n(1005),y=n(253),x=n(992),S=n(1009),I=n(1010),j=n(1011),M=n(1012),w=n(1013),k=n(1014),D=n(1015),T=n(1016),P=n(1017),N=n(1018),E=n(1019),R=n(1020),J=n(5),z=n(14),F=()=>q.get();const q=Object(z.computed)(()=>({months:[Object(J.b)(O.a),Object(J.b)(v.a),Object(J.b)(C.a),Object(J.b)(A.a),Object(J.b)(f.a),Object(J.b)(g.a),Object(J.b)(b.a),Object(J.b)(m.a),Object(J.b)(p.a),Object(J.b)(h.a),Object(J.b)(u.a),Object(J.b)(l.a)],shortMonths:[Object(J.b)(R.a),Object(J.b)(E.a),Object(J.b)(N.a),Object(J.b)(P.a),Object(J.b)(T.a),Object(J.b)(D.a),Object(J.b)(k.a),Object(J.b)(w.a),Object(J.b)(M.a),Object(J.b)(j.a),Object(J.b)(I.a),Object(J.b)(S.a)],days:[Object(J.b)(d.a),Object(J.b)(c.a),Object(J.b)(o.a),Object(J.b)(s.a),Object(J.b)(r.a),Object(J.b)(i.a),Object(J.b)(a.a)],shortDays:[Object(J.b)(y.d),Object(J.b)(y.b),Object(J.b)(y.f),Object(J.b)(y.g),Object(J.b)(y.e),Object(J.b)(y.a),Object(J.b)(y.c)],goToToday:Object(J.b)(x.a),prevMonthAriaLabel:Object(J.b)(y.l),nextMonthAriaLabel:Object(J.b)(y.i),prevYearAriaLabel:Object(J.b)(y.n),nextYearAriaLabel:Object(J.b)(y.k),prevYearRangeAriaLabel:Object(J.b)(y.m),nextYearRangeAriaLabel:Object(J.b)(y.j),monthPickerHeaderAriaLabel:Object(J.b)(y.o),yearPickerHeaderAriaLabel:Object(J.b)(y.s),weekNumberFormatString:Object(J.b)(y.r),selectedDateFormatString:Object(J.b)(y.p),todayDateFormatString:Object(J.b)(y.q),dayMarkedAriaLabel:Object(J.b)(y.h)}));var L=n(49),_=(e,t)=>e?e.tz:t||Object(L.o)(),H=n(7),W=(e,t)=>Object(H.Vb)(e,t.getFullYear(),t.getMonth(),t.getDate());n.d(t,"a",(function(){return F})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return W}))},5575:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r}));const a=Object.freeze({Start:"A0",AddingGciPayload:"A1",AddedGciPayload:"A2",AddGciPayloadToStore:"A3",GciUpdateFetchStatus:"A4",PrefetchStart:"A5",CardAblInStore:"A6",AddingPrefetchCardToStore:"A7",CannotAddCardData:"A8",PrefetchSuccess:"A9",PrefetchFailed:"A10",PrefetchUpdFetchStatusNotLoaded:"A11",PrefetchFinish:"A12",Finish:"A13"}),i=Object.freeze({ItemArrayLengthMismatch:"A0",NoCardAfterFetch:"A1",MailStoreNotFound:"A2",CardNotPresentInStore:"A3"}),r=Object.freeze({AddCardDuplicate:"AMA_W0",JsonParseIssue:"AMA_W1",NoCardPresent:"AMA_W2",FetchCatchBlock:"AMA_W3",FetchNoExtProp:"AMA_W4"})},6029:function(e,t,n){"use strict";var a=n(813),i=n(1279),r=n(829),s=a.rotr64_hi,o=a.rotr64_lo,c=a.shr64_hi,d=a.shr64_lo,l=a.sum64,u=a.sum64_hi,h=a.sum64_lo,p=a.sum64_4_hi,m=a.sum64_4_lo,b=a.sum64_5_hi,g=a.sum64_5_lo,f=i.BlockHash,A=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function C(){if(!(this instanceof C))return new C;f.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=A,this.W=new Array(160)}function v(e,t,n,a,i){var r=e&n^~e&i;return r<0&&(r+=4294967296),r}function O(e,t,n,a,i,r){var s=t&a^~t&r;return s<0&&(s+=4294967296),s}function y(e,t,n,a,i){var r=e&n^e&i^n&i;return r<0&&(r+=4294967296),r}function x(e,t,n,a,i,r){var s=t&a^t&r^a&r;return s<0&&(s+=4294967296),s}function S(e,t){var n=s(e,t,28)^s(t,e,2)^s(t,e,7);return n<0&&(n+=4294967296),n}function I(e,t){var n=o(e,t,28)^o(t,e,2)^o(t,e,7);return n<0&&(n+=4294967296),n}function j(e,t){var n=s(e,t,14)^s(e,t,18)^s(t,e,9);return n<0&&(n+=4294967296),n}function M(e,t){var n=o(e,t,14)^o(e,t,18)^o(t,e,9);return n<0&&(n+=4294967296),n}function w(e,t){var n=s(e,t,1)^s(e,t,8)^c(e,t,7);return n<0&&(n+=4294967296),n}function k(e,t){var n=o(e,t,1)^o(e,t,8)^d(e,t,7);return n<0&&(n+=4294967296),n}function D(e,t){var n=s(e,t,19)^s(t,e,29)^c(e,t,6);return n<0&&(n+=4294967296),n}function T(e,t){var n=o(e,t,19)^o(t,e,29)^d(e,t,6);return n<0&&(n+=4294967296),n}a.inherits(C,f),e.exports=C,C.blockSize=1024,C.outSize=512,C.hmacStrength=192,C.padLength=128,C.prototype._prepareBlock=function(e,t){for(var n=this.W,a=0;a<32;a++)n[a]=e[t+a];for(;a<n.length;a+=2){var i=D(n[a-4],n[a-3]),r=T(n[a-4],n[a-3]),s=n[a-14],o=n[a-13],c=w(n[a-30],n[a-29]),d=k(n[a-30],n[a-29]),l=n[a-32],u=n[a-31];n[a]=p(i,r,s,o,c,d,l,u),n[a+1]=m(i,r,s,o,c,d,l,u)}},C.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,a=this.h[0],i=this.h[1],s=this.h[2],o=this.h[3],c=this.h[4],d=this.h[5],p=this.h[6],m=this.h[7],f=this.h[8],A=this.h[9],C=this.h[10],w=this.h[11],k=this.h[12],D=this.h[13],T=this.h[14],P=this.h[15];r(this.k.length===n.length);for(var N=0;N<n.length;N+=2){var E=T,R=P,J=j(f,A),z=M(f,A),F=v(f,A,C,w,k),q=O(f,A,C,w,k,D),L=this.k[N],_=this.k[N+1],H=n[N],W=n[N+1],G=b(E,R,J,z,F,q,L,_,H,W),B=g(E,R,J,z,F,q,L,_,H,W);E=S(a,i),R=I(a,i),J=y(a,i,s,o,c),z=x(a,i,s,o,c,d);var U=u(E,R,J,z),Y=h(E,R,J,z);T=k,P=D,k=C,D=w,C=f,w=A,f=u(p,m,G,B),A=h(m,m,G,B),p=c,m=d,c=s,d=o,s=a,o=i,a=u(G,B,U,Y),i=h(G,B,U,Y)}l(this.h,0,a,i),l(this.h,2,s,o),l(this.h,4,c,d),l(this.h,6,p,m),l(this.h,8,f,A),l(this.h,10,C,w),l(this.h,12,k,D),l(this.h,14,T,P)},C.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},6588:function(e,t,n){"use strict";var a=n(3491),i=n(3),r=n(5575);const s=Object(i.mutatorAction)("addCardDetailsOnItem",(function(e,t,n){if(e.AdaptiveCardData){const{cardDetails:a}=e.AdaptiveCardData;if(a&&a.length>0)return void(null==n||n.push([r.c.AddCardDuplicate,!1]));e.AdaptiveCardData.cardDetails=t}else null==n||n.push([r.a.CardNotPresentInStore,!0]),e.AdaptiveCardData={cardDetails:t,cardFetchStatus:t?a.d.Loaded:a.d.NotLoaded}}));t.a=s},6589:function(e,t,n){"use strict";var a=n(3);const i=Object(a.mutatorAction)("updateCardFetchStatusForItems",(function(e,t){for(const n of e)n.AdaptiveCardData.cardFetchStatus=t}));t.a=i},7026:function(e,t,n){"use strict";var a=n(8745),i=n(1752),r=n(2760),s=n(705),o=n(245),c=n(5172),d=n(5575);const l=()=>Object(o.a)(c.e,c.d,"String");t.a=async(e,t)=>{try{const n=Object(s.a)({BaseShape:"IdOnly",AdditionalProperties:[l()]}),o=await Object(i.a)(e,n);if(o&&!(o instanceof Error)){let e=[];for(const n of o){const i=Object(r.a)(n,null,c.d);i?e.push(Object(a.a)(i,null!=t?t:[])):e.push(null)}return e}}catch(e){null==t||t.push([d.c.FetchCatchBlock,!1])}return null==t||t.push([d.c.FetchNoExtProp,!1]),null}},730:function(e,t,n){"use strict";var a=n(3);const i=Object(a.action)("POPOUT_READING_PANE",(e,t,n,a,i)=>({itemId:e,conversationId:t,internetMessageId:n,mailboxInfo:a,data:i}));t.a=i},7882:function(e,t,n){var a=t;a.utils=n(813),a.common=n(1279),a.sha=n(7883),a.ripemd=n(7887),a.hmac=n(7888),a.sha1=a.sha.sha1,a.sha256=a.sha.sha256,a.sha224=a.sha.sha224,a.sha384=a.sha.sha384,a.sha512=a.sha.sha512,a.ripemd160=a.ripemd.ripemd160},7883:function(e,t,n){"use strict";t.sha1=n(7884),t.sha224=n(7885),t.sha256=n(1066),t.sha384=n(7886),t.sha512=n(6029)},7884:function(e,t,n){"use strict";var a=n(813),i=n(1279),r=n(1287),s=a.rotl32,o=a.sum32,c=a.sum32_5,d=r.ft_1,l=i.BlockHash,u=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}a.inherits(h,l),e.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var n=this.W,a=0;a<16;a++)n[a]=e[t+a];for(;a<n.length;a++)n[a]=s(n[a-3]^n[a-8]^n[a-14]^n[a-16],1);var i=this.h[0],r=this.h[1],l=this.h[2],h=this.h[3],p=this.h[4];for(a=0;a<n.length;a++){var m=~~(a/20),b=c(s(i,5),d(m,r,l,h),p,n[a],u[m]);p=h,h=l,l=s(r,30),r=i,i=b}this.h[0]=o(this.h[0],i),this.h[1]=o(this.h[1],r),this.h[2]=o(this.h[2],l),this.h[3]=o(this.h[3],h),this.h[4]=o(this.h[4],p)},h.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},7885:function(e,t,n){"use strict";var a=n(813),i=n(1066);function r(){if(!(this instanceof r))return new r;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}a.inherits(r,i),e.exports=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h.slice(0,7),"big"):a.split32(this.h.slice(0,7),"big")}},7886:function(e,t,n){"use strict";var a=n(813),i=n(6029);function r(){if(!(this instanceof r))return new r;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}a.inherits(r,i),e.exports=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h.slice(0,12),"big"):a.split32(this.h.slice(0,12),"big")}},7887:function(e,t,n){"use strict";var a=n(813),i=n(1279),r=a.rotl32,s=a.sum32,o=a.sum32_3,c=a.sum32_4,d=i.BlockHash;function l(){if(!(this instanceof l))return new l;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function u(e,t,n,a){return e<=15?t^n^a:e<=31?t&n|~t&a:e<=47?(t|~n)^a:e<=63?t&a|n&~a:t^(n|~a)}function h(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function p(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}a.inherits(l,d),t.ripemd160=l,l.blockSize=512,l.outSize=160,l.hmacStrength=192,l.padLength=64,l.prototype._update=function(e,t){for(var n=this.h[0],a=this.h[1],i=this.h[2],d=this.h[3],l=this.h[4],A=n,C=a,v=i,O=d,y=l,x=0;x<80;x++){var S=s(r(c(n,u(x,a,i,d),e[m[x]+t],h(x)),g[x]),l);n=l,l=d,d=r(i,10),i=a,a=S,S=s(r(c(A,u(79-x,C,v,O),e[b[x]+t],p(x)),f[x]),y),A=y,y=O,O=r(v,10),v=C,C=S}S=o(this.h[1],i,O),this.h[1]=o(this.h[2],d,y),this.h[2]=o(this.h[3],l,A),this.h[3]=o(this.h[4],n,C),this.h[4]=o(this.h[0],a,v),this.h[0]=S},l.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h,"little"):a.split32(this.h,"little")};var m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],b=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},7888:function(e,t,n){"use strict";var a=n(813),i=n(829);function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(a.toArray(t,n))}e.exports=r,r.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},r.prototype.update=function(e,t){return this.inner.update(e,t),this},r.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},8745:function(e,t,n){"use strict";var a=n(5172),i=n(311),r=n(5575),s=n(7882),o=n.n(s);const c=(e,t,n,a,s,c,d)=>{let l,u;try{if("string"==typeof n){l=JSON.parse(n);const e=o.a.sha256().update(n).digest();u=btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}else l=n}catch(e){return s.push([r.c.JsonParseIssue,!1]),null}return Object.assign(Object.assign({},e),{connectorSenderGuid:t,isAdaptiveCard:void 0===c?"AdaptiveCard"===l.type:c,cardSignature:a,card:l,cardHash:u,cardId:d||Object(i.a)()})};t.a=(e,t)=>{let n;try{n=JSON.parse(e)}catch(e){return t.push([r.c.JsonParseIssue,!1]),[]}const i={smtpAddressesSerialized:n.SmtpAddressesSerialized,providerAccountUniqueId:n.ProviderAccountUniqueId,messageCardExtensionContext:n.MessageCardExtensionContext},s=[];if(n.AdaptiveCardV2Serialized){const e=c(i,n.ConnectorSenderGuidV2?n.ConnectorSenderGuidV2:a.a,n.AdaptiveCardSerializedV2,n.AdaptiveCardSignatureV2,t,!0);e&&s.push(e)}if(n.AdaptiveCardSerialized){const e=c(i,n.ConnectorSenderGuid?n.ConnectorSenderGuid:a.a,n.AdaptiveCardSerialized,n.AdaptiveCardSignature,t,!0);e&&s.push(e)}else{if(!n.MessageCardSerialized)return t.push([r.c.NoCardPresent,!1]),[];{const e=c(i,n.ConnectorSenderGuid?n.ConnectorSenderGuid:a.a,n.MessageCardSerialized,n.MessageCardSignature,t,!1);e&&s.push(e)}}return s.concat(((e,t,n)=>{const i=[];return Object.keys(e).map(s=>{if(e.hasOwnProperty(s)&&0===s.indexOf(a.c)){const o=e[s];try{const r=JSON.parse(o),s=c(t,e.ConnectorSenderGuid?e.ConnectorSenderGuid:a.a,r.card,null,n);s.isContextual=!0,s.key=r.id,s.highlightTerm=r.text,i.push(s)}catch(e){n.push([r.c.JsonParseIssue,!1])}}}),i})(n,i,t))}},9065:function(e,t,n){"use strict";var a=n(20),i=n(6588),r=n(3);var s=Object(r.mutatorAction)("updateCardDetailsOnItem",(function(e,t){e.AdaptiveCardData.cardDetails=t})),o=n(6589),c=n(7026),d=n(7007),l=n(2760),u=n(5172);var h=e=>{return!!Object(l.a)(e,null,u.d)};n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return i.a})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return o.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"b",(function(){return d.a})),n.d(t,"c",(function(){return h}));const p=new a.c(()=>Promise.all([n.e(116),n.e(130),n.e(2053)]).then(n.bind(null,19409))),m=new a.b(p,e=>e.prefetchActionableMessageForItems)},977:function(e){e.exports=JSON.parse('{"a":"Sla"}')},978:function(e){e.exports=JSON.parse('{"a":"TLa"}')},979:function(e){e.exports=JSON.parse('{"a":"SLa"}')},980:function(e){e.exports=JSON.parse('{"a":"RLa"}')},981:function(e){e.exports=JSON.parse('{"a":"QLa"}')},982:function(e){e.exports=JSON.parse('{"a":"PLa"}')},983:function(e){e.exports=JSON.parse('{"a":"OLa"}')},992:function(e){e.exports=JSON.parse('{"a":"wma"}')},994:function(e){e.exports=JSON.parse('{"a":"HYb"}')},995:function(e){e.exports=JSON.parse('{"a":"GYb"}')},996:function(e){e.exports=JSON.parse('{"a":"FYb"}')},997:function(e){e.exports=JSON.parse('{"a":"EYb"}')},998:function(e){e.exports=JSON.parse('{"a":"DYb"}')},999:function(e){e.exports=JSON.parse('{"a":"CYb"}')}}]);
//# sourceMappingURL=owa.600.js.map
self.scriptsLoaded['owa.600.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.600.js'] = (new Date()).getTime();