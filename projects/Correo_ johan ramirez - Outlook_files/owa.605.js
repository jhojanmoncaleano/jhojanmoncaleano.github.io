self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.605.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[605],{10073:function(e,t,n){var a=n(10074);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(66)(a,r);a.locals&&(e.exports=a.locals)},10074:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,"._2uuSN_W2PUZUCI7j-1hdRM{font-size:12px;font-weight:400}html[dir] ._2uuSN_W2PUZUCI7j-1hdRM{margin-top:20px;margin-bottom:20px}.XD_OxCfYiT_-8jfUrVzYX{vertical-align:middle}._3347b-MJgpuaz5oKXfCTJI{color:var(--neutralSecondary);vertical-align:middle}html[dir=ltr] ._3347b-MJgpuaz5oKXfCTJI{margin-left:7px}html[dir=rtl] ._3347b-MJgpuaz5oKXfCTJI{margin-right:7px}html[dir] ._6isp2U65BClj4lXNx6HmH{margin-top:5px}._2FzwNNMh24XRH7yMo-ab01{color:var(--neutralPrimary)}",""]),t.locals={panel:"_2uuSN_W2PUZUCI7j-1hdRM",attachIcon:"XD_OxCfYiT_-8jfUrVzYX",attachmentCountLabel:"_3347b-MJgpuaz5oKXfCTJI",attachmentCollectionContainer:"_6isp2U65BClj4lXNx6HmH",attachmentCollectionLabel:"_2FzwNNMh24XRH7yMo-ab01"}},10303:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(3029);function r(e,t,n,r,o,i,c,l){return u=>{const s=u.AttachmentId;let d=-1;const m=e.filter((e,t)=>e.Id===s&&(d=t,!0));if(m.length>0){e.splice(d,1);const n=o(m[0]),r=0===u.ResultCode;Object(a.b)(n,r,r?u.Item.Location:null,c),l&&l(m[0],r),0!==u.ResultCode&&(t.operationFailed=!0,u.Exception&&(t.error=u.Exception))}return 0===e.length&&(i(t.operationFailed),n.addCustomData([r,!t.operationFailed,u.ResultCode]),t.error?n.endWithError("ServerError",new Error(t.error)):n.end(),!0)}}function o(e,t,n,r,o,i,c){return(l,u,s)=>{e.forEach(e=>{const t=r(e);Object(a.b)(t,!1,null,i),c&&c(e,!1)}),o(!0),t.addCustomData([n,!1,u]),t.endWithError(s,new Error(l))}}},10377:function(e){e.exports=JSON.parse('{"a":"qab"}')},10732:function(e){e.exports=JSON.parse('{"a":"gXb"}')},10733:function(e,t,n){var a=n(17179);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(66)(a,r);a.locals&&(e.exports=a.locals)},10734:function(e){e.exports=JSON.parse('{"a":"$Wb"}')},1707:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"j",(function(){return h}));var a=n(20);const r=new a.c(()=>n.e(995).then(n.bind(null,2907))),o=new a.b(r,e=>e.clearSearchBox),i=new a.b(r,e=>e.endSearchSession),c=new a.b(r,e=>e.onBackspacePressedSearchInput),l=new a.b(r,e=>e.onDownArrowPressedSearchInput),u=new a.b(r,e=>e.onLeftArrowPressedSearchInput),s=new a.b(r,e=>e.onUpArrowPressedSearchInput),d=new a.b(r,e=>e.removeSuggestionPillFromSearchBox),m=new a.b(r,e=>e.setIsSuggestionsDropdownVisible),b=new a.b(r,e=>e.setShowSearchBoxInCompactMode),h=new a.b(r,e=>e.updateIsSuggestionSetComplete)},17177:function(e){e.exports=JSON.parse('{"a":"hXb"}')},17178:function(e){e.exports=JSON.parse('{"c":"dXb","a":"eXb","b":"fXb"}')},17179:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,"._1wWH3mTE8kohMo-I3csgHE{top:-9px;position:relative}._3z1yatsJo55PvlF5pifSys{top:-3px}._3z1yatsJo55PvlF5pifSys,._33jeo7MJqUtmwcqzpuSv_D{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._33jeo7MJqUtmwcqzpuSv_D{top:-5px}._2kFmhCV0AxPjt76UdSIJ4x{top:-7px;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._3T4noM2fKCWxRzS46YXdnR{font-size:11px;font-weight:400;color:var(--neutralSecondary)}html[dir] ._3T4noM2fKCWxRzS46YXdnR{padding:0}html[dir=ltr] ._3T4noM2fKCWxRzS46YXdnR{margin-right:6px}html[dir=rtl] ._3T4noM2fKCWxRzS46YXdnR{margin-left:6px}._3OQpFaK91zn-NpBLpV6iu2{color:var(--neutralSecondary);font-size:12px}html[dir] ._3OQpFaK91zn-NpBLpV6iu2{padding:0}html[dir=ltr] ._3OQpFaK91zn-NpBLpV6iu2{margin-right:6px}html[dir=rtl] ._3OQpFaK91zn-NpBLpV6iu2{margin-left:6px}._2fwIiNLFvkwCTEgngIAWAA,.i021ni6HfkxtEWiGgYCju{color:var(--neutralSecondary);font-size:11px}html[dir] ._2fwIiNLFvkwCTEgngIAWAA,html[dir] .i021ni6HfkxtEWiGgYCju{padding:0}html[dir=ltr] ._2fwIiNLFvkwCTEgngIAWAA,html[dir=ltr] .i021ni6HfkxtEWiGgYCju{margin-right:6px}html[dir=rtl] ._2fwIiNLFvkwCTEgngIAWAA,html[dir=rtl] .i021ni6HfkxtEWiGgYCju{margin-left:6px}._1mQM1aPYhoddEQpRwIRPhH:hover{color:var(--themePrimary)}._2811Q-Z8MUEUhVYY89wy6s{font-size:12px}html[dir=ltr] ._2811Q-Z8MUEUhVYY89wy6s{margin-left:2px}html[dir=rtl] ._2811Q-Z8MUEUhVYY89wy6s{margin-right:2px}._1Hp5-7GsNoVskp5oVDLivX{color:var(--neutralPrimary);font-size:12px}html[dir=ltr] ._1Hp5-7GsNoVskp5oVDLivX{margin-left:2px}html[dir=rtl] ._1Hp5-7GsNoVskp5oVDLivX{margin-right:2px}._6IT2T6QN_uITLhz2fDBMh,.ZmjbSrsbUSihR-OdTEE9V{color:var(--neutralPrimary);font-size:10px}html[dir=ltr] ._6IT2T6QN_uITLhz2fDBMh,html[dir=ltr] .ZmjbSrsbUSihR-OdTEE9V{margin-left:2px}html[dir=rtl] ._6IT2T6QN_uITLhz2fDBMh,html[dir=rtl] .ZmjbSrsbUSihR-OdTEE9V{margin-right:2px}._3SwMid161hF_oYmLFsiNKu{font-size:12px}html[dir=ltr] ._3SwMid161hF_oYmLFsiNKu{margin-left:2px}html[dir=rtl] ._3SwMid161hF_oYmLFsiNKu{margin-right:2px}._3A-8Fr3bU_ZOarlzkR8wVe{color:var(--neutralPrimary);font-size:12px}html[dir=ltr] ._3A-8Fr3bU_ZOarlzkR8wVe{margin-left:2px}html[dir=rtl] ._3A-8Fr3bU_ZOarlzkR8wVe{margin-right:2px}._2hXBJVuDN3-EHKa9H32BuU,._1tb2e53xVfepKqKj3j_hwE{color:var(--neutralPrimary);font-size:10px}html[dir=ltr] ._2hXBJVuDN3-EHKa9H32BuU,html[dir=ltr] ._1tb2e53xVfepKqKj3j_hwE{margin-left:2px}html[dir=rtl] ._2hXBJVuDN3-EHKa9H32BuU,html[dir=rtl] ._1tb2e53xVfepKqKj3j_hwE{margin-right:2px}.Klt6YJQJ-p6k74h2FRRW{font-size:14px;color:var(--themePrimary)}html[dir=ltr] .Klt6YJQJ-p6k74h2FRRW{margin-left:2px}html[dir=rtl] .Klt6YJQJ-p6k74h2FRRW{margin-right:2px}._3bQrNaLRMjX0DorxWdqSXG{color:var(--neutralPrimary);font-size:12px}html[dir=ltr] ._3bQrNaLRMjX0DorxWdqSXG{margin-left:2px}html[dir=rtl] ._3bQrNaLRMjX0DorxWdqSXG{margin-right:2px}._2TOB5Y8tr5L-Nr_cNeRlk_,._2JpmD8krALJGbiWnmczHzB{color:var(--neutralPrimary);font-size:10px}html[dir=ltr] ._2TOB5Y8tr5L-Nr_cNeRlk_,html[dir=ltr] ._2JpmD8krALJGbiWnmczHzB{margin-left:2px}html[dir=rtl] ._2TOB5Y8tr5L-Nr_cNeRlk_,html[dir=rtl] ._2JpmD8krALJGbiWnmczHzB{margin-right:2px}.gVkO0sZ430EYlDDVRFAW{position:relative}",""]),t.locals={attachmentWellBar:"_1wWH3mTE8kohMo-I3csgHE",attachmentWellBarDensityFull:"_3z1yatsJo55PvlF5pifSys",attachmentWellBarDensityMedium:"_33jeo7MJqUtmwcqzpuSv_D",attachmentWellBarDensityCompact:"_2kFmhCV0AxPjt76UdSIJ4x",barButton:"_3T4noM2fKCWxRzS46YXdnR",barButtonFull:"_3OQpFaK91zn-NpBLpV6iu2",barButtonCompact:"_2fwIiNLFvkwCTEgngIAWAA",barButtonMedium:"i021ni6HfkxtEWiGgYCju",barButtonHover:"_1mQM1aPYhoddEQpRwIRPhH",downloadAllButton:"_2811Q-Z8MUEUhVYY89wy6s",downloadAllButtonFull:"_1Hp5-7GsNoVskp5oVDLivX",downloadAllButtonCompact:"_6IT2T6QN_uITLhz2fDBMh",downloadAllButtonMedium:"ZmjbSrsbUSihR-OdTEE9V",saveToCloudButton:"_3SwMid161hF_oYmLFsiNKu",saveToCloudButtonFull:"_3A-8Fr3bU_ZOarlzkR8wVe",saveToCloudButtonCompact:"_2hXBJVuDN3-EHKa9H32BuU",saveToCloudButtonMedium:"_1tb2e53xVfepKqKj3j_hwE",chevronButton:"Klt6YJQJ-p6k74h2FRRW",chevronButtonFull:"_3bQrNaLRMjX0DorxWdqSXG",chevronButtonCompact:"_2TOB5Y8tr5L-Nr_cNeRlk_",chevronButtonMedium:"_2JpmD8krALJGbiWnmczHzB",chevronButtonOuter:"gVkO0sZ430EYlDDVRFAW"}},17180:function(e){e.exports=JSON.parse('{"b":"aXb","a":"bXb","c":"cXb"}')},17181:function(e){e.exports=JSON.parse('{"g":"TWb","f":"UWb","h":"VWb","b":"WWb","c":"XWb","d":"YWb","e":"ZWb","a":"_Wb"}')},17182:function(e){e.exports=JSON.parse('{"a":"SWb"}')},17183:function(e,t,n){var a=n(17184);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(66)(a,r);a.locals&&(e.exports=a.locals)},17184:function(e,t,n){(t=e.exports=n(65)(!1)).push([e.i,"html[dir] ._1tMXlIxtti272uD_qPCcOA{margin-top:10px}html[dir] ._1tMXlIxtti272uD_qPCcOA._1BODD2GFB3_OzaHOP2r-Ts{margin-top:8px}html[dir] ._2IyrVwrunZPchTaywzD0f2{margin-bottom:10px;border-bottom:1px solid var(--neutralLight)}._1Q4W9BtakAO_4Cq8WsBYjp{width:100%;overflow:hidden}._3u_BJLyKKt7Vl6ErSE-TtK{min-height:133px;max-height:133px}._1nn6ot_jaLn5NmheVnPT0F{min-height:132px;max-height:132px}.LAQ1CmY9BBptOKsh7R_9T{min-height:117px;max-height:117px}._1IiPg4SYIOLWaNfonxCPO6{min-height:102px;max-height:102px}._7PCLH-q_N9UUTGaosYwm2{min-height:65px;max-height:65px}._2ORVGuKvCzSzEDlCK3DZ7U{min-height:59px;max-height:59px}._3MsZa4lsKbcbh-sNe8h9JE{min-height:55px;max-height:55px}._Y1yV9rIl4YRuWz9rijwx{min-height:51px;max-height:51px}.RHawS_GicPjq7xaGO6lQZ{height:auto}",""]),t.locals={attachmentWell:"_1tMXlIxtti272uD_qPCcOA",unstackedReadingPane:"_1BODD2GFB3_OzaHOP2r-Ts",attachmentWellInCompose:"_2IyrVwrunZPchTaywzD0f2",oneRowView:"_1Q4W9BtakAO_4Cq8WsBYjp",oneRowViewImageHeight:"_3u_BJLyKKt7Vl6ErSE-TtK",oneRowViewImageHeightFull:"_1nn6ot_jaLn5NmheVnPT0F",oneRowViewImageHeightMedium:"LAQ1CmY9BBptOKsh7R_9T",oneRowViewImageHeightCompact:"_1IiPg4SYIOLWaNfonxCPO6",oneRowViewDocHeight:"_7PCLH-q_N9UUTGaosYwm2",oneRowViewDocHeightFull:"_2ORVGuKvCzSzEDlCK3DZ7U",oneRowViewDocHeightMedium:"_3MsZa4lsKbcbh-sNe8h9JE",oneRowViewDocHeightCompact:"_Y1yV9rIl4YRuWz9rijwx",allowShowMultipleRows:"RHawS_GicPjq7xaGO6lQZ"}},17185:function(e,t,n){e.exports=n.p+"../resources/images/attach-91ee4c9d6406386b1dcf60138a873730.svg"},1728:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3),r=n(14);const o=Object(a.createStore)("groupsStore",{groups:new r.ObservableMap})},1743:function(e,t,n){"use strict";const a={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"};let r=0;function o(e="id"){return`${e}${r++}`}function i(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;let t={},n=Object.keys(e);for(let a=0;a<n.length;a++){switch(n[a]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=i(e.controls);break;case"describedBy":t["aria-describedby"]=i(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=i(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=i(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=i(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=i(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=i(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}))},1744:function(e,t,n){"use strict";var a=n(20),r=n(1679),o=n(44);function i(){return c(Object(r.I)())}function c(e){let t=null;return e&&(2===e.tableQuery.type?t=e.tableQuery.folderId:Object(o.j)("grp-loadFolders")&&3===e.tableQuery.type&&(t=e.tableQuery.groupId)),t}function l(){const e=Object(r.I)();return e&&(2==e.tableQuery.type||Object(o.j)("grp-loadFolders")&&3==e.tableQuery.type)}function u(e){return!!e&&(2==e.type||s(e)||Object(o.j)("grp-loadFolders")&&3==e.type)}function s(e){if(!e||1!=e.type)return!1;return"Group"==e.searchScope.kind}function d(e){if(2==e.type)return e.folderId;if(Object(o.j)("grp-loadFolders")&&3==e.type)return e.groupId;if(s(e)){return e.searchScope.groupId}return null}function m(){const e=Object(r.I)();return e&&u(e.tableQuery)}function b(){return Object(o.j)("grp-loadFolders")&&l()}n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return f})),n.d(t,"n",(function(){return w})),n.d(t,"m",(function(){return g})),n.d(t,"k",(function(){return S})),n.d(t,"j",(function(){return O})),n.d(t,"l",(function(){return j})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return b}));const h=new a.c(()=>Promise.all([n.e(17),n.e(18),n.e(42),n.e(121),n.e(589)]).then(n.bind(null,19394))),p=new a.b(h,e=>e.getGroupDisplayName),f=new a.b(h,e=>e.getGroupDisplayNameFromTableView),w=new a.b(h,e=>e.isPrivateUnjoinedGroup),g=new a.b(h,e=>e.isJoinedGroup),S=new a.b(h,e=>e.getRetentionPolicyTagsForGroup),O=new a.b(h,e=>e.getRetentionPolicyTagListForGroupTableQuery),j=new a.b(h,e=>e.isGroupOwner)},1745:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={FavoriteNode:"favoritenode",InboxRule:"inboxrule",MessageRule:"messagerule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",RibbonCustomizerButton:"ribboncustomizerbutton",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton",CalendarNode:"calendarnode",CalendarGroupNode:"calendargroupnode",CalendarItem:"calendaritem"}},1757:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1728);function r(e){const t=Object(a.a)().groups.get(e.toLowerCase());return t?t.groupDetails:null}},1775:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3),r=n(1823);const o=Object(a.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:r.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1783:function(e,t,n){"use strict";var a;!function(e){e[e.None=0]="None",e[e.Executing=1]="Executing",e[e.Succeed=2]="Succeed",e[e.FailureNotice=3]="FailureNotice",e[e.FailureRetry=4]="FailureRetry"}(a||(a={})),t.a=a},1784:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(14),r=n(3);const o=()=>({alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new a.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,alterationDisplayText:"",traceIdToLogicalIdMap:new a.ObservableMap,tableViewId:null,isScopePickerVisible:!1,filters:[],placeholderIdToIsRenderedMap:new a.ObservableMap}),i={scenarioStores:new a.ObservableMap},c=Object(r.createStore)("commonSearchStore",i);t.b=c},1785:function(e,t,n){"use strict";var a=n(1715);function r(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function o(e,t,n){t&&(e||n)&&Object(a.b)(t,r(e,n))}function i(e,t){var n;const a=null!=t?t:{},r=(null===(n=a.headers)||void 0===n?void 0:n.set)?new Headers(a.headers):new Headers;return a.datapoint=a.datapoint||{},a.datapoint.mailbox=a.datapoint.mailbox||"Explicit",o(e,r),Object.assign(Object.assign({},a),{headers:r})}var c=n(272),l=n(1718),u=n(56),s=n(294),d=n.n(s);async function m(e){return Object(u.b)().then(async t=>{if(e)if(Object(c.r)(e.userIdentity)){const n=await Object(l.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);d()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=r(e.mailboxSmtpAddress);d()(t,n)}return t})}function b(){return Object(u.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function h(e=null){return Object(c.r)(e)?b().then(t=>{return Object(l.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var p=n(50);function f(e,t,n,a){let r=new Headers;return n&&r.set("X-OWA-CANARY",Object(p.a)()),t&&r.set("X-OWA-ActionName",t),(e||a)&&(a?o(e,r,a):o(e,r)),r}n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return f}))},1805:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3),r=n(14);const o=Object(a.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new r.ObservableMap})},1821:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1842);function r(e){switch(e){case a.a.Mail:return"Mail";case a.a.Calendar:return"Calendar";case a.a.FilesHub:return"FilesHub";case a.a.FilesPicker:return"FilesPicker";case a.a.Spaces:return"Spaces";case a.a.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},1823:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.Private=0]="Private",e[e.Public=1]="Public"}(a||(a={}))},1833:function(e,t,n){"use strict";var a=n(3),r=n(14);Object(a.createStore)("personaPhotoStore",{personaPhotoUrls:new r.ObservableMap})();n(1922),n(1823);var o=n(1728),i=n(1775),c=n(1757);function l(e){const t=Object(o.a)().groups.get(e.toLowerCase());return!!t&&!t.groupDetailsError}var u=n(1852),s=n(1960),d=n(1805);const m=Object(a.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(e,t,n,a){if(2==t){const t=Object(c.a)(e);Object(u.a)(t,"Site")[0].Url=n,Object(u.a)(t,"Files")[0].Url=a}}));var b=n(1951);function h(e){return e=e.toLocaleLowerCase(),Object(d.a)().groupSiteStatus.has(e)?Object(d.a)().groupSiteStatus.get(e):0}const p=e=>{const t="string"==typeof e?Object(c.a)(e):e;return t?t.ExternalDirectoryObjectId:null};n(1783),n(1941),n(1942),n(1952),n(1953);var f=n(2228),w=n(2229),g=n(2246),S=n(2207),O=n(2208),j=n(5);function v(e){const t=e.groupDetails?e.groupDetails.AccessType:e.basicInformation?e.basicInformation.AccessType:null;if(t){if(1===t)return Object(j.b)(S.a);if(3===t)return Object(j.b)(O.a)}return""}function x(e){const t=e.groupDetails?e.groupDetails.AccessType:e.basicInformation?e.basicInformation.AccessType:null;if(t){if(1===t)return Object(j.b)(g.b);if(3===t)return Object(j.b)(g.c)}return""}function I(e){let t=0;return e.members?t=e.members.totalCount:e.groupDetails&&(t=e.groupDetails.MemberCount),t?t>1?Object(j.c)(Object(j.b)(w.a),t.toString()):Object(j.c)(Object(j.b)(f.a),t.toString()):Object(j.b)(g.a)}n.d(t,"j",(function(){return o.a})),n.d(t,"l",(function(){return i.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"m",(function(){return l})),n.d(t,"f",(function(){return u.a})),n.d(t,"g",(function(){return u.b})),n.d(t,"c",(function(){return s.a})),n.d(t,"i",(function(){return d.a})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return b.b})),n.d(t,"h",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return x})),n.d(t,"k",(function(){return I}))},1842:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces",e[e.FileSuggestions=6]="FileSuggestions"}(a||(a={})),t.b=a},1852:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(1757);const r=(e,t)=>{const n="string"==typeof e?Object(a.a)(e):e;if(!n||!n.GroupResources)return null;const r=n.GroupResources.filter(e=>e.Name===t);return!r||r.length<1?null:r},o=(e,t)=>{const n=r(e,t);return n&&0!=n.length?n[0].Url:null}},1882:function(e,t,n){"use strict";var a=n(0);const r=a.createContext(window);t.a=r},1887:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},1919:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.action)("START_SEARCH",(e,t,n=!1,a=[],r,o="All")=>({actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:a,searchProvider:r,filter:o}))},1921:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3);const r=Object(a.action)("SEARCH_SESSION_STARTED",(e,t,n)=>({actionSource:e,shouldStartSearch:t,scenarioId:n}))},1922:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var a=n(44),r=n(1775),o=n(49);function i(){return(Object(a.j)("grp-shareable-crud")||Object(r.a)().isSensitivityLabelsEnabled)&&!Object(o.r)()}function c(){return Object(a.j)("grp-shareable-crud-smtpEdit")&&Object(a.j)("grp-cardReloadAfterEditingSmtp")}},1941:function(e,t,n){"use strict";var a=n(3),r=n(1990);const o=Object(a.mutatorAction)("setFollowButtonState",(function(e,t){r.a.groupActionState.set(e.toLowerCase(),t)}));t.a=o},1942:function(e,t,n){"use strict";var a=n(3),r=n(1991);const o=Object(a.mutatorAction)("setJoinButtonState",(function(e,t){r.a.groupActionState.set(e.toLowerCase(),t)}));t.a=o},1951:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var a=n(3),r=n(1805);const o=Object(a.mutatorAction)("setGroupSiteStatus",(function(e,t){e=e.toLocaleLowerCase(),Object(r.a)().groupSiteStatus.has(e)&&t==Object(r.a)().groupSiteStatus.get(e)||Object(r.a)().groupSiteStatus.set(e,t)}));t.a=o},1952:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1783),r=n(1990);function o(e){e=e.toLowerCase();const t=r.a.groupActionState;return t.has(e)?t.get(e):a.a.None}},1953:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1783),r=n(1991);function o(e){e=e.toLowerCase();const t=r.a.groupActionState;return t.has(e)?t.get(e):a.a.None}},1956:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3),r=n(71);const o=Object(a.action)("GET_SUGGESTIONS",e=>Object(r.b)({name:"Search_SuggestionsE2E"},{scenarioId:e}))},1960:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1887);const r=()=>Object(a.a)().smtpAddress},1966:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1821),r=n(1784);function o(e){return Object(r.b)().scenarioStores.get(Object(a.a)(e))||Object(r.a)()}},1990:function(e,t,n){"use strict";var a=n(3),r=n(14);t.a=Object(a.createStore)("followButtonStore",{groupActionState:new r.ObservableMap})()},1991:function(e,t,n){"use strict";var a=n(3),r=n(14);t.a=Object(a.createStore)("joinButtonStore",{groupActionState:new r.ObservableMap})()},2207:function(e){e.exports=JSON.parse('{"a":"n0b"}')},2208:function(e){e.exports=JSON.parse('{"a":"j0b"}')},2228:function(e){e.exports=JSON.parse('{"a":"i0b"}')},2229:function(e){e.exports=JSON.parse('{"a":"o0b"}')},2246:function(e){e.exports=JSON.parse('{"b":"k0b","c":"l0b","a":"m0b"}')},2334:function(e,t,n){"use strict";n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return i})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return l})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"r",(function(){return f})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return g})),n.d(t,"j",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"i",(function(){return j})),n.d(t,"a",(function(){return v}));var a=n(20);const r=new a.c(()=>Promise.all([n.e(0),n.e(9),n.e(10),n.e(12),n.e(13),n.e(17),n.e(20),n.e(24),n.e(25),n.e(26),n.e(47),n.e(50),n.e(54),n.e(103),n.e(339),n.e(500)]).then(n.bind(null,4099))),o=new a.a(r,e=>e.onSmimeItemAttachmentOpened),i=new a.a(r,e=>e.mergeSmimeDecodedMessageProperties),c=(new a.b(r,e=>e.fetchAndDecodeSmimeMessage),new a.b(r,e=>e.setSmimePropertiesInDraftMessage)),l=new a.b(r,e=>e.trySetSmimeProperties),u=new a.b(r,e=>e.tryAddSmimeProperties),s=new a.b(r,e=>e.createMailResponseBodyContent),d=new a.b(r,e=>e.downloadSmimeAttachment),m=new a.b(r,e=>e.getMergedSmimeViewState),b=new a.b(r,e=>e.getMergedSmimeViewStateForDraft),h=new a.b(r,e=>e.isSmimeItemDecoding),p=new a.b(r,e=>e.previewSmimeAttachment),f=new a.b(r,e=>e.updateSmimeAttachmentIds),w=new a.b(r,e=>e.createSmimeAttachmentsFromFiles),g=new a.b(r,e=>e.createSmimeAttachmentsViaSmimeQueueManager),S=new a.b(r,e=>e.initializeAttachmentStateForSmimeAttachments),O=new a.b(r,e=>e.getAttachmentsForSmimeResponse),j=new a.b(r,e=>e.getSmimeAttachmentsForRequest),v=Object(a.d)(r,e=>e.SignatureDetails)},4736:function(e){e.exports=JSON.parse('{"a":"P$a"}')},6646:function(e){e.exports=JSON.parse('{"a":"P9a"}')},7445:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c}));var a=n(20);const r=new a.c(()=>n.e(2092).then(n.bind(null,11078))),o=new a.a(r,e=>e.prefetchAllWacResources),i=new a.a(r,e=>e.prefetchWacResourcesForAttachments),c=new a.a(r,e=>e.prefetchWacResourcesForFiles)},8994:function(e,t,n){"use strict";n.r(t);var a=n(21),r=n(1743),o=n(61),i=n(11117),c=n(1829),l=n(1738),u=n(6094),s=n(3015),d=n(699),m=Object(d.action)("setCanOverrideAllowShowMultipleRows")((function(e,t){e.canOverrideAllowShowMultipleRows=t})),b=Object(d.action)("setDidViewOverflowOneRow")((function(e,t){e.didViewOverflowOneRow=t})),h=n(7040),p=n(3963),f=n(11236),w=n(1745),g=n(5),S=n(1741),O=n(1882),j=n(993),v=n(9029),x=n(1859),I=n(3169),A=n(4563),V=n(3168),C=n(2209),_=n(209),y=n(40),R=n(44);const W=500;function k(e,t,n,a,r,i){var c;const u=Object(C.a)(i);if(u.pendingNavigation&&Object(_.e)(u.pendingNavigation.toAttachmentId,e)&&u.pendingNavigation.triggerTime+W>=(new Date).getTime())return A.a.PendingNavigation;if(!Object(I.a)(i))return A.a.None;const s=u.extendedViewState.attachmentId,d=null===(c=u.pendingPreviewOperation)||void 0===c?void 0:c.attachmentId;return Object(_.e)(s,e)?u.editState.mode===V.a.View||u.editState.mode===V.a.EnteringEdit?function(e,t,n,a,r,i){const c=Object(l.a)(e);if(c&&1===c.type){if(Object(R.j)("doc-SxS-jsApi-ODB-BaseNoEditString"))return!1;const e=Object(C.a)(i).viewState.previewPane;return e&&!1===e.readOnly}if(!c){const i=e?e.Id:"UNDEFINED";y.h.warn("AttachmentModel not found in getAttachmentPreviewMode"),Object(o.o)("AttchmentModelMissingInRenderAttachmentWell",{attachmentId:i,composeId:t,isInitialized:n,isReadOnly:a,isGroup:r},{isCore:!0})}return!1}(e,t,n,a,r,i)?A.a.Edit:A.a.Selected:u.editState.mode===V.a.Saving?Object(_.e)(d,e)?A.a.SelectedAndSaving:A.a.NotSelectedAndSaving:A.a.Edit:Object(_.e)(d,e)?A.a.SelectedAndPending:A.a.None}var B=n(7445),M=n(0),N=n(1270),F=n(3166),T=n(1744),E=n(1833),D=n(50),P=n(597);var L=n(17177),z=Object(d.action)("setAllowShowMultipleRows")((function(e,t){e.allowShowMultipleRows=t})),H=n(17178),G=n(10732),U=n(1724);function J(e,t,n){const a=e.docViewAttachments.length+e.imageViewAttachments.length;let r=0;if(!(e.docViewAttachments.some(e=>e.isCloudy)||e.imageViewAttachments.some(e=>e.isCloudy))){const t=function(e,t){const n=Object(l.a)(t.attachmentId);return e+(null==n?void 0:n.model.Size)};r=e.docViewAttachments.reduce(t,0),r=e.imageViewAttachments.reduce(t,r)}const o=t&&!n;if(r>0){const e=o?Object(g.b)(H.c):Object(g.b)(H.a),t=Object(U.i)(r);return Object(g.c)(e,a,t)}{const e=o?Object(g.b)(H.b):Object(g.b)(G.a);return Object(g.c)(e,a)}}function Y(e,t){return e.some(e=>Object(_.e)(e.attachmentId,t))}function X(e,t){return e.canOverrideAllowShowMultipleRows?e.allowShowMultipleRows||function(e,t){return!!t&&(Y(e.docViewAttachments,t)||Y(e.imageViewAttachments,t))}(e,t):e.allowShowMultipleRows}var K=n(114),Q=n(10733),q=n.n(Q),Z=n(147),$=n.n(Z);const ee=$.a.bind(q.a);var te=Object(a.a)((function(e){const t=t=>{z(e.attachmentWellViewState,!0)},n=t=>{z(e.attachmentWellViewState,!1),m(e.attachmentWellViewState,!1)},a=e.attachmentWellViewState.didViewOverflowOneRow,o=X(e.attachmentWellViewState,e.attachmentIdBeingPreviewed),i=J(e.attachmentWellViewState,a,o),c={iconProps:{}},l=Object(R.j)("mon-attachment-ux-redesign");function u(e){if(!l)return q.a.barButton;switch(e){case"full":return q.a.barButtonFull;case"medium":return q.a.barButtonMedium;case"compact":return q.a.barButtonCompact;default:return q.a.barButton}}let s,d;return a?(o?(c.onClick=n,c.iconProps.iconName="DoubleChevronUp",d={role:r.a.button,expanded:!0}):(c.onClick=t,c.iconProps.iconName="DoubleChevronDown",d={role:r.a.button,expanded:!1}),c.disabled=!1,s=ee(u(Object(K.e)()),q.a.barButtonHover,q.a.chevronButtonOuter)):(c.disabled=!0,s=ee(u(Object(K.e)()))),M.createElement(M.Fragment,null,M.createElement(N.a,Object.assign({},Object(r.b)(d),{className:s,disabled:c.disabled,iconProps:{iconName:c.iconProps.iconName,styles:{root:ee(function(e){if(!l)return q.a.chevronButton;switch(e){case"full":return q.a.chevronButtonFull;case"medium":return q.a.chevronButtonMedium;case"compact":return q.a.chevronButtonCompact;default:return q.a.chevronButton}}(Object(K.e)()))}},onClick:c.onClick}),i))})),ne=n(17180),ae=n(4736),re=n(17181),oe=n(10734),ie=n(6646),ce=n(10377),le=n(266),ue=n(1932),se=n(4104),de=n(283),me=n(701);function be(e,t,n){const a=Object(g.b)(oe.a);switch(n){case 1:return Object(de.a)()?Object(g.c)(Object(g.b)(re.g),Object(ue.g)(),a):t?Object(g.b)(re.f):Object(g.c)(Object(g.b)(re.h),Object(g.b)(ie.a));case 3:return t?Object(g.b)(re.b):Object(g.c)(Object(g.b)(re.c),Object(de.a)()?a:Object(g.b)(ie.a));case 2:if(t)return Object(g.b)(re.d);let r=function(e){const t=Object(se.c)(e);return t?t.folderName:(Object(se.b)(e),null)}(e);return Object(me.a)(r)&&(r=Object(g.b)(ce.a)),Object(g.c)(Object(g.b)(re.e),r);case 4:return Object(g.b)(re.a);case 0:throw new Error("Unsupported SaveAllToCloudStatus: "+n);default:return Object(le.a)(n),""}}var he=n(1975),pe=n(4491);function fe(e,t){return we(e.docViewAttachments,t)||we(e.imageViewAttachments,t)}function we(e,t){const[n]=e.filter(e=>Object(_.e)(e.attachmentId,t));return n}var ge=n(10303);async function Se(e,t,n,a){return new Promise((r,i)=>{const c=[];let l={operationFailed:!1,error:void 0};const u=new o.b("AttachmentSaveAllToCloud");!function(e,t){const n=e.totalClassicAttachmentSize/256;Oe(e.docViewAttachments,t,n),Oe(e.imageViewAttachments,t,n)}(e,c);const s=Object(ge.b)(c,l,u,e.totalClassicAttachmentSize,t=>fe(e,t),n,a,he.C),d=Object(ge.a)(c,u,e.totalClassicAttachmentSize,t=>fe(e,t),n,a,he.C);Object(pe.b)(null,t,a,s,d,(e,t,n)=>{r([e,t,n,c])})})}function Oe(e,t,n){e.forEach(e=>{t.push(e.attachmentId),Object(he.w)(e),Object(he.B)(n,.1,t=>{Object(he.x)(e,t)},e.attachmentId)})}var je=Object(d.action)("setSaveAllToCloudStatus")((function(e,t){e.saveAllToCloudStatus=t})),ve=n(32);function xe(e,t){return n={itemId:e},a=t,Object(ve.a)("CancelSaveAttachmentsToCloud",n,a);var n,a}var Ie=n(1810),Ae=n(700);const Ve=$.a.bind(q.a);var Ce=Object(a.a)((function(e){const t=M.useRef(),n=M.useRef(),a=M.useRef(),r=M.useRef(),i=t=>{je(e.attachmentWellViewState,t?3:2)},c=e.attachmentWellViewState.imageViewAttachments.concat(e.attachmentWellViewState.docViewAttachments),l=c.length>1,u=c.every(he.t)&&l;const s=Object(R.j)("mon-attachment-ux-redesign"),d={barButton:!s,barButtonFull:s&&"full"===Object(K.e)(),barButtonMedium:s&&"medium"===Object(K.e)(),barButtonCompact:s&&"compact"===Object(K.e)()},m={downloadAllButtonFull:s&&"full"===Object(K.e)(),downloadAllButtonMedium:s&&"medium"===Object(K.e)(),downloadAllButtonCompact:s&&"compact"===Object(K.e)()},b=s?{iconName:"Cloud",styles:{root:Ve(m)}}:{},h=Ve(d,q.a.barButtonHover);return M.createElement("span",null,(t=>{var n;return!!t&&(0==e.attachmentWellViewState.saveAllToCloudStatus&&("GroupMailbox"!=(null===(n=e.parentItemId.mailboxInfo)||void 0===n?void 0:n.type)||!Object(de.a)()))})(u)&&M.createElement(N.a,{iconProps:b,className:h,onClick:async c=>{je(e.attachmentWellViewState,1),Object(o.o)("AttachmentWellSaveAllToCloud",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize]),[t.current,n.current,a.current,r.current]=await Se(e.attachmentWellViewState,e.parentItemId,i,e.sxsId)}},(()=>{var t;const n="GroupMailbox"===(null===(t=e.parentItemId.mailboxInfo)||void 0===t?void 0:t.type);if(Object(de.a)())return Object(g.b)(ne.b);if(n)return Object(g.b)(ne.a);{const e=Object(g.b)(ne.c);return Object(g.c)(e,Object(ue.g)())}})()),(()=>{const t=e.attachmentWellViewState.saveAllToCloudStatus;return 1===t||3===t||2===t||4===t})()&&M.createElement(N.a,{iconProps:b,className:h,disabled:!0},be(e.parentItemId.mailboxInfo.mailboxSmtpAddress,"GroupMailbox"===(null===(p=e.parentItemId.mailboxInfo)||void 0===p?void 0:p.type),e.attachmentWellViewState.saveAllToCloudStatus)),(()=>1===e.attachmentWellViewState.saveAllToCloudStatus)()&&M.createElement(N.a,{iconProps:b,className:h,onClick:i=>{xe(e.parentItemId.Id,Object(Ae.a)(e.parentItemId.mailboxInfo)).then(o=>{o&&(Ie.k.importAndExecute(n.current,a.current),Object(pe.a)(t.current),r.current.forEach(t=>{const n=fe(e.attachmentWellViewState,t);Object(he.A)(n,0,5),Object(he.C)(t,!1)}),je(e.attachmentWellViewState,4))}),Object(o.o)("AttachmentWellCancelSaveAllToCloud",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize])}},Object(g.b)(ae.a)));var p}));var _e=n(2532);const ye=$.a.bind(q.a);var Re=Object(a.a)((function(e){const t=M.useRef(),n=M.useRef(),a=M.useRef(),r=r=>{let i;for(let c=0;c<r.length;c++){i=r[c];const u=Object(l.a)(i.attachmentId);if(u&&u.info&&u.info.allowDownload||(a.current=!1,u||e.isDraft||Object(o.o)("AttachmentBarMissingModel",{id:i.attachmentId.Id})),!a.current)break;i.isCloudy?t.current++:n.current++}},i=e.attachmentWellViewState.imageViewAttachments.length+e.attachmentWellViewState.docViewAttachments.length>1;t.current=0,n.current=0,a.current=!0;const u=e.attachmentWellViewState.docViewAttachments.some(e=>{const t=Object(l.a)(e.attachmentId);return t&&Object(c.c)(t.model)});r(e.attachmentWellViewState.imageViewAttachments),r(e.attachmentWellViewState.docViewAttachments);const s=a.current&&n.current>1&&0===t.current&&!u,d=Object(R.j)("mon-attachment-ux-redesign"),m={barButton:!d,barButtonFull:d&&"full"===Object(K.e)(),barButtonMedium:d&&"medium"===Object(K.e)(),barButtonCompact:d&&"compact"===Object(K.e)()},b={downloadAllButtonFull:d&&"full"===Object(K.e)(),downloadAllButtonMedium:d&&"medium"===Object(K.e)(),downloadAllButtonCompact:d&&"compact"===Object(K.e)()},h={attachmentWellBar:!d,attachmentWellBarDensityFull:d&&"full"===Object(K.e)(),attachmentWellBarDensityMedium:d&&"medium"===Object(K.e)(),attachmentWellBarDensityCompact:d&&"compact"===Object(K.e)()},p=d?{iconName:"Download",styles:{root:ye(b)}}:{};return M.createElement("span",{className:ye(h)},i&&M.createElement(te,{attachmentWellViewState:e.attachmentWellViewState,attachmentIdBeingPreviewed:e.attachmentIdBeingPreviewed}),s&&M.createElement(N.a,{className:ye(m,q.a.barButtonHover),onClick:t=>{let n=null;const a="service.svc/s/GetAllAttachmentsAsZip?id="+encodeURIComponent(e.parentItemId.Id);if(Object(R.j)("doc-attachment-downloadAllFromDownloadDomain"))n=Object(_e.d)(e.parentItemId,a,!0);else{const e=Object(T.d)()?Object(E.c)()+"/":"";n=`${Object(P.t)("/owa/")}/${e}${a}&X-OWA-CANARY=${Object(D.a)()}`}Object(F.a)(n,!1),Object(o.o)("AttachmentWellDownloadAll",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize])},iconProps:p},Object(g.b)(L.a)),!u&&M.createElement(Ce,{attachmentWellViewState:e.attachmentWellViewState,parentItemId:e.parentItemId,sxsId:e.sxsId}))}));var We=n(17182),ke=n(17183),Be=n.n(ke);const Me=$.a.bind(Be.a);var Ne=Object(a.a)((function(e){const t=M.useContext(O.a),n=Object(x.k)(t);let a=!1,d=3;M.useEffect(()=>(setTimeout(()=>{const t=(e.attachmentWellViewState.docViewAttachments||[]).map(e=>e.attachmentId);B.b.importAndExecute(t)},2e3),j.a.importAndExecute(E),()=>{a=!0,j.c.importAndExecute(E)}),[]),M.useEffect(()=>{D()});const h=M.useRef(),w=M.useRef(),I=M.useRef({}),A=t=>{const{attachmentWellViewState:n,parentItemId:a,infoBar:r,onAttachmentDeletedCallback:o,isDeletionDisabled:i}=e,l=n.imageViewAttachments.slice(0),s=n.docViewAttachments.slice(0);if(!i)if(Object(c.b)(t.attachmentId.Id))Object(v.b)(n,t,a,r,o);else{const e=(e,n,a)=>{o(e,n,a),setTimeout(()=>{_(t,l,s)},0)};Object(u.b)(n,t,a,r,e)}},V=(t,n,a,r)=>{Object(p.a)(e.attachmentWellViewState,t,n,a,r)},C=t=>{const n=Object(l.a)(t.attachmentId);e.onAttachmentDeletedCallback(e.parentItemId,t.attachmentId,n.model),Object(s.a)(e.attachmentWellViewState,t)},_=async(t,a,r)=>{var o;const i=a.indexOf(t),c=r.indexOf(t);i>-1&&a.splice(i,1),c>-1&&r.splice(c,1);const l=function(e,t,n,a){return n>-1?0===e.length?t[0]:n<e.length?e[n]:e[n-1]:0===t.length?e[e.length-1]:a<t.length?t[a]:t[a-1]}(a,r,i,c);if(Object(x.o)(t.attachmentId,n)){(await x.u.import())("deleteAttachment",n)}(null===(o=null==l?void 0:l.attachmentId)||void 0===o?void 0:o.Id)&&I.current[l.attachmentId.Id]?I.current[l.attachmentId.Id]():e.onLostFocus&&e.onLostFocus()},y=e=>{h.current=e},W=e=>{w.current=e},N=()=>{m(e.attachmentWellViewState,!0)},F=async()=>{let t;return t=e.linksContainerId?e.linksContainerId:e.parentItemId.Id,Object(f.a)(e.attachmentWellViewState,t)},T=()=>X(e.attachmentWellViewState,Object(x.l)(n).extendedViewState.attachmentId),E=()=>{d=3,D()},D=()=>{setTimeout(()=>{a?Object(o.o)("CheckWhetherWellViewOverflowOneRowWhenUnmouted",{allowedRetryTimes:d}):P()},1+1e3*(3-d))},P=()=>{let t=!1;if(e.attachmentWellViewState.imageViewAttachments.length>0)if(Ee(h.current)){if(Te(h.current))return void b(e.attachmentWellViewState,!0)}else t=!0;if(e.attachmentWellViewState.docViewAttachments.length>0)if(Ee(w.current)){if(Te(w.current))return void b(e.attachmentWellViewState,!0);t||b(e.attachmentWellViewState,!1)}else t=!0;t&&(--d>=0?(Object(o.o)("AttachmentWellRetryToCheckWhetherViewOverflowOneRow"),D()):Object(o.o)("AttachmentWellRetryToCheckWhetherViewOverflowOneRowFailed"))},L=(e,t)=>{I.current[e]=t},{attachmentWellViewState:z}=e,H={attachmentWellInCompose:!e.attachmentWellViewState.isReadOnly};if(e.attachmentWellViewState.imageViewAttachments.length+e.attachmentWellViewState.docViewAttachments.length===0)return null;{const t=Object(R.j)("mon-attachment-ux-redesign"),a={allowShowMultipleRows:T()},o={oneRowViewImageHeight:!t&&!T(),oneRowViewImageHeightFull:t&&!T()&&"full"===Object(K.e)(),oneRowViewImageHeightMedium:t&&!T()&&"medium"===Object(K.e)(),oneRowViewImageHeightCompact:t&&!T()&&"compact"===Object(K.e)()},c={oneRowViewDocHeight:!t&&!T(),oneRowViewDocHeightFull:t&&!T()&&"full"===Object(K.e)(),oneRowViewDocHeightMedium:t&&!T()&&"medium"===Object(K.e)(),oneRowViewDocHeightCompact:t&&!T()&&"compact"===Object(K.e)()};return M.createElement("div",{tabIndex:-1,className:Me([Be.a.attachmentWell,H,"disableTextSelection",Object(S.a)()&&Be.a.unstackedReadingPane]),onClick:Fe},z.imageViewAttachments.length>0?M.createElement("div",{role:r.a.listbox,"aria-label":Object(g.b)(We.a),className:Me(Be.a.oneRowView,a,o),ref:y},z.imageViewAttachments.map(t=>M.createElement(i.c,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:A,onReplaceAttachment:V,onDragStart:De,instrumentationContext:e.instrumentationContext,onBeforePreview:N,isImage:!0,parentItemId:e.parentItemId,isDraft:e.isDraft,previewMode:k(t.attachmentId,z.composeId,z.isInitialized,z.isReadOnly,!!z.groupId,n),moveAttachmentToInlineHandler:e.moveAttachmentToInlineHandler,createImageGallery:F,registerFocusFunction:L,onConvertClassicToLink:e.onConvertClassicToLink,deleteAttachmentFromWellHandler:C}))):null,z.docViewAttachments.length>0?M.createElement("div",{role:r.a.listbox,"aria-label":Object(g.b)(We.a),className:Me(Be.a.oneRowView,a,c),ref:W},e.attachmentWellViewState.docViewAttachments.map(t=>M.createElement(i.c,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:A,onReplaceAttachment:V,onDragStart:De,instrumentationContext:e.instrumentationContext,onBeforePreview:N,isImage:!1,parentItemId:e.parentItemId,isDraft:e.isDraft,previewMode:k(t.attachmentId,z.composeId,z.isInitialized,z.isReadOnly,!!z.groupId,n),createImageGallery:F,registerFocusFunction:L,referenceAttachmentsSupported:e.referenceAttachmentsSupported,onConvertClassicToLink:e.onConvertClassicToLink,deleteAttachmentFromWellHandler:C}))):null,z.isReadOnly&&z.imageViewAttachments.length+z.docViewAttachments.length>0?M.createElement(Re,{attachmentWellViewState:z,parentItemId:e.parentItemId,isDraft:e.isDraft,attachmentIdBeingPreviewed:Object(x.l)(n).extendedViewState.attachmentId,sxsId:n}):null)}}));function Fe(e){e.stopPropagation()}function Te(e){return!!e&&e.children.length>0&&e.scrollHeight>2*e.children[0].clientHeight}function Ee(e){return!!e&&e.children.length>0}function De(e){const t=Object(h.a)(e);return{itemType:w.a.Attachment,attachmentFile:t}}var Pe=n(17185),Le=n.n(Pe);const ze="{0}; ";var He=n(10073),Ge=n.n(He);var Ue=function(e){const{attachmentWellViewState:t}=e;if(t.imageViewAttachments.length+t.docViewAttachments.length===0)return null;{const e=Le.a;return M.createElement("div",{className:Ge.a.panel},M.createElement("div",null,M.createElement("img",{src:e,className:Ge.a.attachIcon}),M.createElement("span",{className:Ge.a.attachmentCountLabel},J(t,!1,!1))),M.createElement("div",{className:Ge.a.attachmentCollectionContainer},M.createElement("span",{className:Ge.a.attachmentCollectionLabel},function(e){let t="";return[...e.docViewAttachments,...e.imageViewAttachments].forEach(e=>{const n=Object(l.a)(e.attachmentId);n&&(t+=Object(g.c)(ze,n.model.Name))}),t}(t))))}};n.d(t,"AttachmentWellView",(function(){return Ne})),n.d(t,"AttachmentWellPrintView",(function(){return Ue}))},913:function(e,t,n){"use strict";function a(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return a}))}}]);
//# sourceMappingURL=owa.605.js.map
self.scriptsLoaded['owa.605.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.605.js'] = (new Date()).getTime();