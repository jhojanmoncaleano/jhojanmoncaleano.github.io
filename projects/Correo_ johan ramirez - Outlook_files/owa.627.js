self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.627.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[627,2033],{10087:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1820),o=n(3099);function i(){const e=Object(o.a)();return Object(r.c)(e)}},14855:function(e){e.exports=JSON.parse('{"g":"J0b","a":"K0b","b":"L0b","c":"M0b","e":"N0b","j":"O0b","d":"P0b","f":"Q0b","h":"R0b","i":"S0b"}')},164:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,c){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var u={value:n,expire:o+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),c&&c(t,n)}.bind(this),o)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var c=e[i];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return o&&t++,c.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(i)if(e[c])continue;var a=r[c],u=a.expire-o;if(u<=0){this.del(c);continue}u=u>0?u:void 0,this.put(c,a.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1744:function(e,t,n){"use strict";var r=n(20),o=n(1679),i=n(44);function c(){return a(Object(o.I)())}function a(e){let t=null;return e&&(2===e.tableQuery.type?t=e.tableQuery.folderId:Object(i.j)("grp-loadFolders")&&3===e.tableQuery.type&&(t=e.tableQuery.groupId)),t}function u(){const e=Object(o.I)();return e&&(2==e.tableQuery.type||Object(i.j)("grp-loadFolders")&&3==e.tableQuery.type)}function s(e){return!!e&&(2==e.type||d(e)||Object(i.j)("grp-loadFolders")&&3==e.type)}function d(e){if(!e||1!=e.type)return!1;return"Group"==e.searchScope.kind}function l(e){if(2==e.type)return e.folderId;if(Object(i.j)("grp-loadFolders")&&3==e.type)return e.groupId;if(d(e)){return e.searchScope.groupId}return null}function f(){const e=Object(o.I)();return e&&s(e.tableQuery)}function g(){return Object(i.j)("grp-loadFolders")&&u()}n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"n",(function(){return h})),n.d(t,"m",(function(){return I})),n.d(t,"k",(function(){return v})),n.d(t,"j",(function(){return y})),n.d(t,"l",(function(){return w})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return g}));const b=new r.c(()=>Promise.all([n.e(17),n.e(18),n.e(42),n.e(121),n.e(589)]).then(n.bind(null,19394))),m=new r.b(b,e=>e.getGroupDisplayName),p=new r.b(b,e=>e.getGroupDisplayNameFromTableView),h=new r.b(b,e=>e.isPrivateUnjoinedGroup),I=new r.b(b,e=>e.isJoinedGroup),v=new r.b(b,e=>e.getRetentionPolicyTagsForGroup),y=new r.b(b,e=>e.getRetentionPolicyTagListForGroupTableQuery),w=new r.b(b,e=>e.isGroupOwner)},1814:function(e,t,n){"use strict";var r=n(1841),o=n(1679);function i(){return Object(r.a)(Object(o.I)())}n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"c",(function(){return r.b})),n.d(t,"e",(function(){return r.d})),n.d(t,"a",(function(){return i}))},1841:function(e,t,n){"use strict";var r=n(209),o=n(1683);const i=new Map;var c=n(1871),a=n(1744),u=n(2437);function s(e){return e?d(e.tableQuery):Object(r.d)()}function d(e){const t=Object(a.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(c.a)(t):l(n)}function l(e){return Object(o.G)(e)?Object(u.a)(e):function(e){if(!e)return Object(r.d)();if(!i.has(e)){let t=Object(o.t)(e,!0);i.set(e,t)}return i.get(e)}(e)}function f(e){return{mailboxInfo:d(e)}}n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return f}))},1867:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function o(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},1871:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(209);const o={};function i(e){const t=e.toLocaleLowerCase();if(!o[t]){const n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};o[t]=n}return o[t]}},1891:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(i||(i={}))},1892:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"v",(function(){return a})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"k",(function(){return I})),n.d(t,"m",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"q",(function(){return w})),n.d(t,"n",(function(){return O})),n.d(t,"u",(function(){return S})),n.d(t,"a",(function(){return j})),n.d(t,"s",(function(){return C})),n.d(t,"t",(function(){return T}));var r=n(20);const o=new r.c(()=>n.e(1204).then(n.bind(null,2783)));let i=new r.a(o,e=>e.logEntityClicked);const c=new r.a(o,e=>e.logResponseReceived);let a=new r.a(o,e=>e.logSessionEnd),u=new r.a(o,e=>e.logResponseRendered);const s=new r.a(o,e=>e.logSearchBoxStateChanged);let d=new r.a(o,e=>e.logSearchResultInteraction),l=new r.a(o,e=>e.logResponseNeverRendered);const f=new r.a(o,e=>e.flushNonRenderedResponseReceivedItemsFromCache),g=new r.a(o,e=>e.logCachedContentRendered);let b=new r.a(o,e=>e.logFeedback);const m=new r.a(o,e=>e.logClientLayout),p=new r.a(o,e=>e.logClientDataSource),h=new r.a(o,e=>e.logEntitiesFromFilePicker),I=new r.a(o,e=>e.logResponseRecievedV2),v=new r.a(o,e=>e.logResultsRendered),y=new r.a(o,e=>e.logSearchEntityActions),w=new r.a(o,e=>e.logSearchFeedbackActions),O=new r.a(o,e=>e.logSearchActions);let S=new r.a(o,e=>e.logSecondaryEntityActionClicked);const j=new r.a(o,e=>e.clearProcessedTraceIds),C=new r.a(o,e=>e.logSearchSuggestionsClientLayoutEvent),T=new r.a(o,e=>e.logSearchSuggestionsResultsRenderedEvent)},1897:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"s",(function(){return i})),n.d(t,"q",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"n",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"d",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"p",(function(){return h})),n.d(t,"m",(function(){return I})),n.d(t,"r",(function(){return v})),n.d(t,"o",(function(){return y})),n.d(t,"l",(function(){return w}));const r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",c=".p7m",a="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",l=57,f=78,g="IPM.Note.SMIME.MultipartSigned",b="smime-",m="image",p="OwaToSmime",h="SmimeToOwa",I="en-US",v=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],y="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",w="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},19132:function(e,t,n){"use strict";n.r(t);var r=n(3),o=Object(r.action)("onCacheUpdated",(e,t)=>({interactionType:e,triageContext:t})),i=Object(r.action)("onNudgedSpotlightItemRemoved",e=>({rowKey:e})),c=Object(r.action)("onSpotlightDismissedFromRP",e=>({rowKey:e}));const a=Object(r.action)("onSpotlightDismissedFromRPProcessed",e=>({rowKey:e}));var u,s=Object(r.action)("onSpotlightItemsFetched",(e,t,n)=>({spotlightItems:e,isConversationView:t,requestStartTime:n})),d=n(2317);!function(e){e[e.Unknown=0]="Unknown",e[e.Weak=1]="Weak",e[e.Strong=2]="Strong"}(u||(u={}));var l=e=>{switch(e){case"CreateRule":case"MarkAsRead":case"MarkAsReadImplicit":case"MarkAsUnread":case"Snooze":return u.Weak;case"Block":case"Categorize":case"Delete":case"Flag":case"FlagCleared":case"FlagComplete":case"Forward":case"Ignore":case"Like":case"MarkAsJunk":case"MarkAsPhishing":case"Move":case"Pin":case"Reaction":case"Reply":case"ReplyAll":case"ReportAbuse":case"Unpin":return u.Strong;default:return u.Unknown}},f=n(2521),g=n(61),b=n(1892),m=n(1835),p=n(29);const h=[],I=e=>{const{UserPuid:t,ExternalDirectoryTenantGuid:n}=Object(p.a)().SessionSettings;b.p.importAndExecute(m.c.ContextualInsights,t,n,Object(d.a)().logicalId,null,Object(f.a)(e).referenceId,"EntityClicked"),Object(g.o)("Spotlight_ItemClicked")},v=()=>{const{logicalId:e,requestStartTime:t,spotlightItems:n}=Object(d.a)();-1===h.indexOf(e)&&(h.push(e),b.m.importAndExecute(m.c.ContextualInsights,e,null,Date.now()-t),Object(g.o)("Spotlight_SetRendered",{hasSpotlightItems:n.length>0,logicalId:e}))};var y=n(2522),w=n(7),O=n(311),S=n(1679),j=n(8316),C=n(6);var T,A=n(11);!function(e){e[e.Acknowledged=0]="Acknowledged",e[e.Dismissed=1]="Dismissed"}(T||(T={}));const R=(e,t)=>{const n=M(e);for(const e of t)n.push(e);Object(A.e)(window,F(e),JSON.stringify(n))},k=e=>{const{spotlightCacheType:t,itemId:n,conversationId:r,rowKey:o}=e,i=M(t);for(const e of i)if(n&&e.itemId===n||r&&e.conversationId===r||o&&e.rowKey===o)return!0;return!1},x=(e,t)=>{const n=M(e),r=[];for(const e of n){const{itemId:n,conversationId:o,rowKey:i}=e;for(const e of t){const{itemId:t,conversationId:c,rowKey:a}=e;if(n&&n===t||o&&o===c||i&&i===a){r.push(e);break}}}Object(A.e)(window,F(e),JSON.stringify(r))},M=e=>{const t=Object(A.a)(window,F(e));return t?JSON.parse(t):[]},F=e=>e===T.Acknowledged?"acknowledgedSpotlightItems":"dismissedSpotlightItems";Object(r.mutator)(s,e=>{const{spotlightItems:t,isConversationView:n,requestStartTime:r}=e,o=E(),i=t.concat(o),c=[],a=i.concat(o).filter(e=>{const t=n?e.conversationId:e.itemId;return!(c.indexOf(t)>-1)&&(c.push(t),!0)});(e=>{x(T.Acknowledged,e),x(T.Dismissed,e)})(a);const u=a.filter(e=>!e.isDismissed);Object(d.a)().spotlightItems=u,Object(d.a)().logicalId=Object(O.a)(),Object(d.a)().requestStartTime=r,0===u.length&&v()}),Object(r.mutator)(a,e=>{const t=e.rowKey,n=Object(d.a)().spotlightItems;for(let e=0;e<n.length;e++){if(n[e].rowKey===t){n.splice(e,1);break}}}),Object(r.mutator)(o,e=>{if(!Object(y.a)())return;const{triageContext:t={},interactionType:n}=e;let{itemIds:r=[],conversationIds:o=[],rowKeys:i=[]}=t;if(r=r.filter(e=>!!e),o=o.filter(e=>!!e),i=i.filter(e=>!!e),0!==r.length||0!==o.length||0!==i.length)switch(l(n)){case u.Weak:P({itemIds:r,conversationIds:o,rowKeys:i,actionCategory:u.Weak});break;case u.Strong:P({itemIds:r,conversationIds:o,rowKeys:i,actionCategory:u.Strong});break;case u.Unknown:}}),Object(r.mutator)(j.a,()=>{Object(d.a)().spotlightItems=[]}),Object(r.mutator)(i,e=>{const{rowKey:t}=e,n=Object(d.a)().spotlightItems;for(let e=0;e<n.length;e++)if(n[e].rowKey===t){n.splice(e,1);break}});const P=e=>{const{itemIds:t,conversationIds:n,rowKeys:r,actionCategory:o}=e,i=Object(d.a)().spotlightItems;i.map((e,c)=>{(t.indexOf(e.itemId)>-1||n.indexOf(e.conversationId)>-1||r.indexOf(e.rowKey)>-1)&&(o===u.Weak?e.isAcknowledged=!0:o===u.Strong&&i.splice(c,1))})},E=()=>{const e=[],t=Object(C.c)("testSpotlight");if(t){const n=Object(S.I)(),r=parseInt(t);for(let t=0;t<r;t++){const r=n.rowKeys[t],o=S.b.getItemIds(r,n)[0],i=S.b.getConversationId(r,n);r&&e.push({rowKey:r,itemId:o,conversationId:i,isAcknowledged:k({spotlightCacheType:T.Acknowledged,itemId:o,conversationId:i,rowKey:r}),isDismissed:k({spotlightCacheType:T.Dismissed,itemId:o,conversationId:i,rowKey:r}),reason:0,senderName:S.b.getLastSenderMailbox(r,n).Name,referenceId:"00000000-0000-0000-0000-000000000000",dateTimeReceived:Object(w.Vb)(S.b.getLastDeliveryTimeStamp(r,n))})}}return e};var D=Object(r.action)("onSpotlightFilterLoaded",e=>({actionSource:e}));Object(r.mutator)(D,()=>{Object(d.a)().spotlightItems.map(e=>e.isAcknowledged=!0)});var K=n(2754),L=n(1820);function N(e){const{spotlightTableQuery:t}=Object(d.a)();t&&Object(K.a)([e],Object(L.c)(t),"Spotlight",!1)}var U=n(2402);Object(r.orchestrator)(U.h,e=>{const{nudgedRows:t}=e,n=Object(d.a)().spotlightItems;t.map(e=>{n.map(t=>{t.rowKey!==e.rowKey&&t.itemId!==e.itemId&&t.conversationId!==e.conversationId||(N(e.rowKey),i(e.rowKey))})})});var _=n(1930);function B(e){const{itemId:t,conversationId:n,rowKey:r}=e,o=Object(d.a)().spotlightItems.filter(e=>t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r);return o.length>0?o[0]:null}Object(r.orchestrator)(c,e=>{const{rowKey:t}=e;R(T.Dismissed,[{rowKey:t}]);const{conversationId:n,itemId:r,referenceId:o}=Object(f.a)(t),i=Object(p.a)().SessionSettings;b.p.importAndExecute(_.b.ContextualInsights,i.UserPuid,i.ExternalDirectoryTenantGuid,Object(d.a)().logicalId,null,o,"SpotlightDismissed");const c=Object(S.I)();c&&Object(g.o)("Spotlight_ItemDismissed",{isImportantFilter:"spotlight"===c.tableQuery.scenarioType,conversationId:Object(S.R)(c)?n:null,itemId:Object(S.R)(c)?null:r}),N(t),a(t)}),Object(r.orchestrator)(D,e=>{Object(g.o)("Spotlight_FilterLoaded",[e.actionSource])});var V=n(2560);Object(r.orchestrator)(V.d,e=>{if(!Object(y.a)())return;const{triageContext:t={},interactionType:n}=e;let{itemIds:r=[],conversationIds:i=[],rowKeys:c=[]}=t;if(r=r.filter(e=>!!e),i=i.filter(e=>!!e),c=c.filter(e=>!!e),0===r.length&&0===i.length&&0===c.length)return;const a=[],s=l(n)===u.Strong?T.Dismissed:T.Acknowledged;r.map(e=>{const t=B({itemId:e});t&&!k({spotlightCacheType:s,itemId:e,rowKey:t.rowKey})&&(R(s,[{itemId:e,rowKey:t.rowKey}]),H(a,t.referenceId,n))}),i.map(e=>{const t=B({conversationId:e});t&&!k({spotlightCacheType:s,conversationId:e,rowKey:t.rowKey})&&(R(s,[{conversationId:e,rowKey:t.rowKey}]),H(a,t.referenceId,n))}),c.map(e=>{const t=B({rowKey:e});t&&!k({spotlightCacheType:s,rowKey:e})&&(R(s,[{rowKey:e}]),H(a,t.referenceId,n))}),o(n,t)}),Object(r.orchestrator)(D,()=>{G()});const G=()=>{const e=Object(d.a)().spotlightItems.map(e=>{const{itemId:t,conversationId:n,rowKey:r}=e;return{itemId:t,conversationId:n,rowKey:r}});R(T.Acknowledged,e)},H=(e,t,n)=>{t&&-1===e.indexOf(t)&&(((e,t)=>{if(!e)return;const{UserPuid:n,ExternalDirectoryTenantGuid:r}=Object(p.a)().SessionSettings;b.p.importAndExecute(m.c.ContextualInsights,n,r,Object(d.a)().logicalId,null,e,t),Object(g.o)("Spotlight_ItemInteraction",{interactionType:t})})(t,n),e.push(t))};function Q(e,t){var n,r,o,i,c;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationTopic:e.Subject,FlagStatus:null===(n=e.Flag)||void 0===n?void 0:n.FlagStatus,FolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},GlobalItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],GlobalMessageCount:1,GlobalUnreadCount:e.IsRead?0:1,HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,HasIrm:null,Importance:e.Importance,ItemClasses:e.ItemClasses||["IPM.Note"],ItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],LastDeliveryOrRenewTime:e.DateTimeReceived,LastDeliveryTime:e.DateTimeReceived,LastModifiedTime:e.DateTimeLastModified,MessageCount:1,ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,SenderSMTPAddress:null===(o=null===(r=e.Sender)||void 0===r?void 0:r.EmailAddress)||void 0===o?void 0:o.Address,UniqueSenders:[null===(c=null===(i=e.Sender)||void 0===i?void 0:i.EmailAddress)||void 0===c?void 0:c.Name],UnreadCount:e.IsRead?0:1,InstanceKey:t}}function z(e,t){var n;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationIndex:e.ConversationIndex,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,LastModifiedTime:e.DateTimeLastModified,DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:e.Flag&&{FlagStatus:e.Flag.FlagStatus,CompleteDate:e.Flag.CompleteDate,DueDate:e.Flag.DueDate,StartDate:e.Flag.StartDate},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,Sender:e.Sender&&{Mailbox:{EmailAddress:e.Sender.EmailAddress.Address,Name:e.Sender.EmailAddress.Name,RoutingType:"SMTP"}},Sensitivity:e.Sensitivity,Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,InstanceKey:t}}var W=Object(r.mutatorAction)("onSpotlightRowsAppendedToTable",e=>{Object(d.a)().spotlightTableQuery=e}),q=n(298),J=n(1986),$=n(2190),X=n(2038),Y=n(44),Z=n(121),ee=n(209);const te=(e,t)=>{const n=Object(S.F)([e],t);return n.length>0?n[0]:null},ne=e=>{if(!e||0===e.length)return 0;for(const t of e)if(t.Id.indexOf("SpotlightReason")>-1)switch(t.Value){case"ActionRequired":return 1;case"AffectsSchedule":return 2;case"AtMentioned":return 4;case"ReplyRequired":return 8;case"NewMeetingCreated":return 64;case"UpcomingMeetingTimeChanged":return 128;case"MeetingCanceled":return 256;case"NewMeetingTimeProposed":return 512;case"UltraFocused":return 1024;case"ReplyToYourEmail":return 2048;default:return 0}return 0};var re=n(2997),oe=n(2825),ie=n(1685),ce=n(391),ae=n(597);const ue=async()=>{let[e,t]=Object(ce.getAccessTokenforResourceAsLazy)(window.location.origin,"OwaMailSpotlight");return e||(e=await t),e||""},se=(e,t,n)=>{const r={method:"POST"};r.headers=new Headers,r.headers.set("Authorization",Object(ce.buildAuthorizationHeader)(t)),r.headers.set("Content-Type","application/json;charset=utf-8"),r.headers.set("X-Client-LocalTime",(new Date).toISOString()),r.headers.set("client-request-id",e);const o=Object(re.b)();o&&r.headers.append("X-AnchorMailbox",o);const i={EntityRequests:[{EntityType:"Message",Context:{EntityContext:[{"@type":"Microsoft.OutlookServices.MailFolder",id:Object(ie.a)("inbox")}]}}],Scenario:{Name:"ContextualInsights"}};return r.body=JSON.stringify(i),r};var de=async e=>{const t=await ue(),n=se(Object(O.a)(),t,Object(S.R)(e));return await fetch(Object(ae.v)("/search/api/v1/recommendations",Object(oe.a)()),n)},le=n(10087),fe=n(958);let ge=null;const be=async e=>{const t=Object(le.a)(),n=new g.b("SpotlightService",{sessionSampleRate:20}),r=Date.now(),o=await de(t);n.end();const i=await async function(e,t,n,r){var o,i,c,a,u,s,d,l,f;const g=[],p=[],h=Object(S.R)(t),I=[],v=await e.json(),y=(null===(a=null===(c=null===(i=null===(o=null==v?void 0:v.EntitySets)||void 0===o?void 0:o[0])||void 0===i?void 0:i.ResultSets)||void 0===c?void 0:c[0])||void 0===a?void 0:a.Results)||[];b.k.importAndExecute(m.c.ContextualInsights,null===(u=null==v?void 0:v.Instrumentation)||void 0===u?void 0:u.TraceId,n.getData(q.a.e2eTimeElapsed),e.status);let O=!1,j=[];if(Object(Y.j)("fwk-immutable-ids")||Object(Z.a)("native")){const e=y.map(e=>{var t;return null===(t=e.Source.ItemId)||void 0===t?void 0:t.Id}),t=Object(ee.d)().userIdentity;Object(X.c)(e,t)&&(j=await Object($.b)(e,Object(X.b)(t),t,$.a.Spotlight),j.length===y.length&&(O=!0))}let C=0;for(const e of y){const n=null===(s=e.Source.ConversationId)||void 0===s?void 0:s.Id,r=O?j[C++]:null===(d=e.Source.ItemId)||void 0===d?void 0:d.Id,o=te(h?n:r,t);if(o){if(h){if(I.indexOf(n)>-1)continue;I.push(n)}Object(U.g)(o,t.id)||(k({spotlightCacheType:T.Dismissed,itemId:r,conversationId:n,rowKey:o})||(h?p.push(Q(e.Source,o)):p.push(z(e.Source,o))),g.push({conversationId:n,itemId:r,rowKey:o,isAcknowledged:k({spotlightCacheType:T.Acknowledged,itemId:r,conversationId:n,rowKey:o}),isDismissed:k({spotlightCacheType:T.Dismissed,itemId:r,conversationId:n,rowKey:o}),reason:ne(e.Source.SingleValueExtendedProperties),senderName:null===(f=null===(l=e.Source.Sender)||void 0===l?void 0:l.EmailAddress)||void 0===f?void 0:f.Name,referenceId:e.ReferenceId,dateTimeReceived:Object(w.Vb)(e.DateTimeReceived),isTeachingMomentTarget:!1}))}}let A=null,R=null;for(let e=0;e<g.length;e++){const t=g[e];(!A||t.dateTimeReceived>A.dateTimeReceived)&&(A=t,R=e)}null!==R&&(g[R].isTeachingMomentTarget=!0);const x=Object.assign(Object.assign({},t.tableQuery),{scenarioType:"spotlight"});return Object(J.c)(Object(L.c)(x),p,p.length,"SpotlightLoad",null,null,!0),W(x),r&&r(Object(L.c)(x),!0,e.status.toString(),!1),g}(o,t,n,e);s(i,Object(S.R)(t),r)},me=Object(fe.a)(be,1e4,{maxWait:2e4,trailing:!0});var pe=e=>{Object(y.a)()&&(ge?me(e):(be(e),ge=setInterval(()=>{be(e)},36e5)))};function he(){return Object(d.a)().logicalId}function Ie(){return Object(d.a)().spotlightItems.filter(e=>!e.isAcknowledged).length}function ve(){return Object(d.a)().spotlightItems.length}var ye=n(1690);function we(e){var t,n;const r=Object(f.a)(e);if(!r)return null;const o=Object(ye.b)().items.get(r.itemId);return o?JSON.stringify({messageBody:(null===(t=o.UniqueBody)||void 0===t?void 0:t.Value)||(null===(n=o.NormalizedBody)||void 0===n?void 0:n.Value)||"",itemId:o.ItemId.Id}):null}var Oe=n(14855),Se=n(5);function je(e){switch(e){case 1:return Object(Se.b)(Oe.a);case 2:return Object(Se.b)(Oe.b);case 4:return Object(Se.b)(Oe.c);case 64:return Object(Se.b)(Oe.e);case 128:return Object(Se.b)(Oe.j);case 256:return Object(Se.b)(Oe.d);case 512:return Object(Se.b)(Oe.f);case 1024:return Object(Se.b)(Oe.i);case 2048:return Object(Se.b)(Oe.h);case 8:case 0:case 16:default:return Object(Se.b)(Oe.g)}}function Ce(e){Te(),D(e)}const Te=()=>{const{spotlightTableQuery:e}=Object(d.a)();if(!e)return;const t=Object(L.c)(e),n=M(T.Dismissed).map(e=>e.rowKey).filter(e=>t.rowKeys.includes(e));n.length>0&&Object(K.a)(n,t,"Spotlight",!1)};n.d(t,"fetchSpotlightItems",(function(){return pe})),n.d(t,"onSpotlightDismissedFromRP",(function(){return c})),n.d(t,"getSpotlightLogicalId",(function(){return he})),n.d(t,"getSpotlightItem",(function(){return B})),n.d(t,"getUnacknowledgedSpotlightCount",(function(){return Ie})),n.d(t,"getSpotlightCount",(function(){return ve})),n.d(t,"getSpotlightDonationJson",(function(){return we})),n.d(t,"getSpotlightReasonString",(function(){return je})),n.d(t,"loadImportantTable",(function(){return Ce})),n.d(t,"logSpotlightItemClicked",(function(){return I})),n.d(t,"logSpotlightResultsRendered",(function(){return v}))},1930:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},1939:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},1946:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return a}))},1950:function(e,t,n){"use strict";function r(e,t){const n=Math.pow(2,32);if(e>=n||t>=n){const r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1958:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1972:function(e,t,n){"use strict";var r=n(14),o=n(3);let i={folderTable:new r.ObservableMap,rootFolder:null},c=Object(o.createStore)("publicFolderFavoriteStore",i)();t.a=c},198:function(e,t,n){"use strict";var r=n(40);let o;function i(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var c=n(108);const a=500,u=[],s=[],d=[];let l=!0;function f(e,t){Object(r.g)((e,t,n)=>{l&&(t==r.b.Error&&s.push({message:e,error:n}),u.push({message:e,level:t}))}),e(b),t(b),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function g(e){const t=Object(c.a)(e);return l=!1,{traces:u,errors:s,network:d,usage:t}}function b(){l&&d.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return c.b})),n.d(t,"c",(function(){return i}))},1983:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2183);function o(e){return e&&Object(r.b)(e.ItemClass)}},2023:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="IPM.Note.SMIME"},2038:function(e,t,n){"use strict";var r;!function(e){e.EwsId="ews",e.EwsImmutableId="ewsimmutable"}(r||(r={}));var o=n(44),i=n(3),c=Object(i.createStore)("immutableId",{IsImmutableIdFeatureOnForConnectedAccount:!1});var a=n(272);function u(e){return Object(a.r)(e)?c().IsImmutableIdFeatureOnForConnectedAccount?r.EwsImmutableId:r.EwsId:Object(o.j)("fwk-immutable-ids")?r.EwsImmutableId:r.EwsId}function s(e){const t=[],n=[],r=[];return null==e||e.forEach((e,o)=>{"string"==typeof e&&(e.indexOf("@")>-1?r.push({id:e,idx:o}):!function(e){return!!e&&e.length<90}(e)?n.push({id:e,idx:o}):t.push({id:e,idx:o}))}),[t,n,r]}function d(e,t){const[n,o]=s(e),i=u(t);return i===r.EwsImmutableId&&o.length>0||i===r.EwsId&&n.length>0}const l=Object(i.mutatorAction)("setIsImmutableIdFeatureOnForConnectedAccount",e=>{c().IsImmutableIdFeatureOnForConnectedAccount=e});n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return r}))},2050:function(e,t,n){"use strict";var r=n(1825),o=n(598);function i(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var a=n(1958),u=n(1703);var s=n(1685),d=n(1946),l=n(1688),f=n(1965);n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return O}));const g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(d.b)({folderId:Object(s.a)(l.k),kind:"PrimaryMailbox"}));const t=Object(f.b)("UserMailbox");for(let n of t)e.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(o.a)({Id:e.folderId}),[(i={FolderScope:c({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},i))];var i}},b={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(d.a)({folderId:Object(s.a)(l.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(s.a)(l.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(o.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(a={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},a))]:[i({FolderScope:c({BaseFolderId:n})})];var a}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},p={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(a.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},h={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},I={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v=e=>{switch(e.kind){case"PrimaryMailbox":return g;case"ArchiveMailbox":return b;case"SharedFolders":return m;case"Group":return p;case"Calendar":return h;case"PublicFolder":return I;default:throw new Error("Unregistered search scope")}},y=e=>v(e).getKey(e),w=e=>v(e).getSearchScopeList(),O=e=>v(e).getSearchScopeType(e)},210:function(e,t,n){"use strict";t.decode=t.parse=n(367),t.encode=t.stringify=n(368)},2137:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(e,t,n)=>({tableView:e,markAsRead:t,rowIdsToExclude:n}))},2145:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(0),n.e(34),n.e(783)]).then(n.bind(null,3288)));let i=new r.a(o,e=>e.logLocalContentDataSource),c=new r.a(o,e=>e.logLocalContentLayout),a=new r.a(o,e=>e.clearLocalContentInstrumentationCache),u=new r.b(o,e=>e.getLocalContentId);const s=new r.b(o,e=>e.substrateSearchInitOperation),d=(new r.b(o,e=>e.substrateSearchPostSuggestionsService),new r.b(o,e=>e.deleteSubstrateSearchHistoryService)),l=new r.b(o,e=>e.exportSubstrateSearchHistoryService)},2151:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const r=1,o=16},2155:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(209);function o(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},2156:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2048),o=n(2288),i=n(1679),c=n(1703),a=n(2307);function u(e,t,n,u,s,d,l){const f=s||"All",g=l||Object(o.a)(e),b=null==u?function(e){if("inbox"!==Object(c.a)(e))return-1;if(!Object(a.a)())return-1;return 0}(e):u;let m;switch(t){case 0:m=Object(r.e)(e,Object(i.T)(n));break;case 1:m=Object(r.f)()}return{folderId:e,focusedViewFilter:b,listViewType:t,viewFilter:f,sortBy:g,requestShapeName:m,type:0,categoryName:d,scenarioType:n}}},2182:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r=350,o=270},2183:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(1897),o=n(2023);function i(e){return e&&0===e.indexOf(r.e)}function c(e){return e&&0===e.indexOf(o.a)&&!i(e)}function a(e){return e&&0===e.indexOf(o.a)}function u(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},2190:function(e,t,n){"use strict";var r,o=n(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(r||(r={})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return r}));const i=new o.d(()=>n.e(1043).then(n.bind(null,19314))),c=(e,t)=>{const n=new o.a(e,t);return(...e)=>n.importAndExecute(...e)},a=c(i,e=>e.convertIdsToTargetFormat),u=c(i,e=>e.translateRestImmutableIdsToEwsIds),s=c(i,e=>e.translateEwsIdsToEwsImmutableIds),d=c(i,e=>e.translateEwsIdsToRestImmutableIds);c(i,e=>e.translateEwsImmutableIdsToEwsIds)},2225:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2050);function o(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},2244:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},2271:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(e,t)=>({itemIdToRemove:e,removeItemSource:t}))},2307:function(e,t,n){"use strict";var r=n(29);function o(){var e;return!!(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.IsFocusedInboxEnabled)}n.d(t,"a",(function(){return o}))},2315:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},2322:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(e,t)=>({status:e,sxsId:t})),i=n(2315),c=n(2244);function a(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}function u(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}function s(e){const t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}function d(e){const t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function l(e){return!!e.RecurrenceId}n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return i.a})),n.d(t,"f",(function(){return c.a})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l}))},2336:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);let o=Object(r.action)("USERMAIL_INTERACTION",(e,t,n)=>({interactionType:e,instrumentationContexts:t,triageContext:n}))},2437:function(e,t,n){"use strict";var r=n(1679),o=n(1683);function i(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)}function c(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var a=n(3),u=n(1972),s=n(2155),d=n(14);var l=Object(a.createStore)("publicFolderUtilsStore",new d.ObservableMap),f=n(49);function g(e){if(!l().has(e)){const t=u.a.folderTable.get(e),n=null!=t.replicaList?t.replicaList[0]:Object(f.g)().SessionSettings.DefaultPublicFolderMailbox,r=Object(s.a)(n);b(e,r)}return l().get(e)}const b=Object(a.mutatorAction)("addPublicFolderMailboxInfoToStore",(e,t)=>{l().set(e,t)});n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return g}))},2464:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1683);function o(e){return Object(r.C)(e,"SharedMailbox")}},2560:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(20),o=n(2336);n.d(t,"d",(function(){return o.a}));const i=new r.c(()=>n.e(1253).then(n.bind(null,4641)));let c=new r.a(i,e=>e.onKeyboardUpDown),a=new r.a(i,e=>e.onOpenEmail),u=new r.a(i,e=>e.onKeyboardToggleSelect)},2754:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(e,t,n,r=!0)=>({rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}))},276:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(117),o=n(97),i=n(2);let c;function a(e){c=e}async function u(e){var t,n;if(Object(i.P)())return o.f.importAndExecute(Object(r.a)());const a=c&&await c(void 0,e);if(a&&a.length>0){if("bearer"===(null===(t=null==a?void 0:a.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return a.split(" ")[1];if("msauth1.0"===(null===(n=null==a?void 0:a.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return a}}},2821:function(e,t,n){"use strict";var r=n(20),o=n(1679),i=n(1814),c=n(1692),a=n(1703),u=n(2023);var s=n(1983),d=n(44);function l(e,t){if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;const n=c.u.items.get(e.ItemId.Id);return!(Object(s.a)(e)||(null==n?void 0:n.RightsManagementLicenseData))&&(!(null==n||!n.shouldShowAttachmentPreviews)||!!(e.HasAttachments||Object(d.j)("doc-linkDiscovery-shadowCalling")&&e.HasProcessedSharepointLink)&&(m.importAndExecute(Object(i.d)(t),e.ConversationId,e.ItemId.Id),!0))}let f=function(e,t,n={listViewStore:o.Z}){const r=1==t.type,c=e.ConversationId,s=n.listViewStore.conversationItems.get(c.Id),l=Object(d.j)("doc-linkDiscovery-shadowCalling")&&e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;if((null==(f=e)?void 0:f.ItemClasses)&&f.ItemClasses.length>0&&f.ItemClasses.some(e=>0===e.indexOf(u.a))||e.HasIrm)return!1;var f;let g,b;if(r){if(null==s?void 0:s.shouldShowAttachmentPreviews)return!0;b=!!e.HasAttachments||l,g=b}else{if(!e.HasAttachmentPreviews&&!l)return!1;s&&!l?(g=s.globalItemIds.length!=e.GlobalItemIds.length,b=s.shouldShowAttachmentPreviews):(g=!0,b=!0)}return g&&m.importAndExecute(Object(i.d)(t),e.ConversationId,null),b};n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l}));const g=new r.c(()=>n.e(970).then(n.bind(null,19322))),b=new r.a(g,e=>e.getPreviews),m=new r.a(g,e=>e.add),p=new r.a(g,e=>e.getAttachmentsForConversationWell),h=new r.a(g,e=>e.removeAttachmentPreviewsForRow)},2997:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var r=n(2),o=n(36),i=n(49);function c(){let e=Object(r.v)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.v)(t)}function a(){let e=function(){let e="",t=Object(o.b)().pathname.split("/").filter(e=>e.length);return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}();if(0===e.length){let t=Object(i.g)();if(null==t?void 0:t.SessionSettings){let n=t.SessionSettings.ExternalDirectoryTenantGuid,r=t.SessionSettings.UserPuid;r&&n&&(e=`PUID:${r}@${n}`)}}return 0===e.length&&(e=c()),e}},3099:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n(2288),o=n(2156),i=n(1947),c=n(1685),a=n(2307);function u(){const e=Object(c.a)("inbox"),t=Object(i.a)(e),n=Object(r.a)(e);return Object(o.a)(e,t,"mail",-1,null,null,n)}function s(){let e=u();return e.focusedViewFilter=0,e}function d(){let e=u();return e.focusedViewFilter=1,e}function l(){return Object(a.a)()?s():u()}},311:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function c(e){return r.test(e)}},367:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var c={};if("string"!=typeof e||0===e.length)return c;var a=/\+/g;e=e.split(t);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var s=e.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var l,f,g,b,m=e[d].replace(a,"%20"),p=m.indexOf(n);p>=0?(l=m.substr(0,p),f=m.substr(p+1)):(l=m,f=""),g=decodeURIComponent(l),b=decodeURIComponent(f),r(c,g)?o(c[g])?c[g].push(b):c[g]=[c[g],b]:c[g]=b}return c};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},368:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(c(e),(function(c){var a=encodeURIComponent(r(c))+n;return o(e[c])?i(e[c],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[c]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var c=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},456:function(e,t,n){"use strict";var r=n(335),o=n(293),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(o.a)(e)&&Object(r.a)(e)==i}},612:function(e,t,n){"use strict";var r=/\s/;var o=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},i=/^\s+/;var c=function(e){return e?e.slice(0,o(e)+1).replace(i,""):e},a=n(227),u=n(456),s=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return s;if(Object(a.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(a.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=c(e);var n=l.test(e);return n||f.test(e)?g(e.slice(2),n?2:8):d.test(e)?s:+e}},8316:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("onSpotlightDisabled");n.d(t,"a",(function(){return o}))},958:function(e,t,n){"use strict";var r=n(227),o=n(222),i=function(){return o.a.Date.now()},c=n(612),a="Expected a function",u=Math.max,s=Math.min;t.a=function(e,t,n){var o,d,l,f,g,b,m=0,p=!1,h=!1,I=!0;if("function"!=typeof e)throw new TypeError(a);function v(t){var n=o,r=d;return o=d=void 0,m=t,f=e.apply(r,n)}function y(e){var n=e-b;return void 0===b||n>=t||n<0||h&&e-m>=l}function w(){var e=i();if(y(e))return O(e);g=setTimeout(w,function(e){var n=t-(e-b);return h?s(n,l-(e-m)):n}(e))}function O(e){return g=void 0,I&&o?v(e):(o=d=void 0,f)}function S(){var e=i(),n=y(e);if(o=arguments,d=this,b=e,n){if(void 0===g)return function(e){return m=e,g=setTimeout(w,t),p?v(e):f}(b);if(h)return clearTimeout(g),g=setTimeout(w,t),v(b)}return void 0===g&&(g=setTimeout(w,t)),f}return t=Object(c.a)(t)||0,Object(r.a)(n)&&(p=!!n.leading,l=(h="maxWait"in n)?u(Object(c.a)(n.maxWait)||0,t):l,I="trailing"in n?!!n.trailing:I),S.cancel=function(){void 0!==g&&clearTimeout(g),m=0,o=b=d=g=void 0},S.flush=function(){return void 0===g?f:O(i())},S}}}]);
//# sourceMappingURL=owa.627.js.map
self.scriptsLoaded['owa.627.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.627.js'] = (new Date()).getTime();