self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.652.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[652,2033],{10309:function(n){n.exports=JSON.parse('{"a":"jca"}')},164:function(n,t,e){"use strict";function r(){var n=Object.create(null),t=0,e=0,r=0,i=!1;function o(t){r--,delete n[t]}this.put=function(t,e,i,c){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var a=n[t];a?clearTimeout(a.timeout):r++;var u={value:e,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){o(t),c&&c(t,e)}.bind(this),i)),n[t]=u,e},this.del=function(t){var e=!0,r=n[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(e=!1)):e=!1,e&&o(t),e},this.clear=function(){for(var o in n)clearTimeout(n[o].timeout);r=0,n=Object.create(null),i&&(t=0,e=0)},this.get=function(o){var c=n[o];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return i&&t++,c.value;i&&e++,r--,delete n[o]}else i&&e++;return null},this.size=function(){return r},this.memsize=function(){var t,e=0;for(t in n)e++;return e},this.debug=function(n){i=n},this.hits=function(){return t},this.misses=function(){return e},this.keys=function(){return Object.keys(n)},this.exportJson=function(){var t={};for(var e in n){var r=n[e];t[e]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,e){var r=JSON.parse(t),i=Date.now(),o=e&&e.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(o)if(n[c])continue;var a=r[c],u=a.expire-i;if(u<=0){this.del(c);continue}u=u>0?u:void 0,this.put(c,a.value,u)}return this.size()}}n.exports=new r,n.exports.Cache=r},1699:function(n,t,e){"use strict";function r(n){if(!n)return null;const t=n.lastIndexOf(".");return t>0?n.substr(t).toLowerCase():null}function i(n){const t=r(n);return t?t.replace(".",""):null}function o(n){var t;return(null===(t=i(n))||void 0===t?void 0:t.substring(0,4))||""}e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return i})),e.d(t,"c",(function(){return o}))},1702:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n[n.Base64InlineImage=0]="Base64InlineImage",n[n.Cloud=1]="Cloud",n[n.Local=2]="Local",n[n.MailItem=3]="MailItem",n[n.Uri=4]="Uri",n[n.AttachmentItem=5]="AttachmentItem",n[n.CloudSuggestion=6]="CloudSuggestion",n[n.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",n[n.Inline=8]="Inline",n[n.Smime=9]="Smime",n[n.FilesHub=10]="FilesHub",n[n.GroupFilesHub=11]="GroupFilesHub",n[n.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",n[n.Unknown=13]="Unknown",n[n.ContextualSuggestion=14]="ContextualSuggestion",n[n.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",n[n.SmartDoc=16]="SmartDoc",n[n.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1719:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"i",(function(){return o})),e.d(t,"d",(function(){return c})),e.d(t,"c",(function(){return a})),e.d(t,"g",(function(){return u})),e.d(t,"b",(function(){return s})),e.d(t,"h",(function(){return d})),e.d(t,"f",(function(){return f})),e.d(t,"e",(function(){return l}));var r=e(3);const i=Object(r.action)("ADD_SHARING_LINK",(n,t,e,r,i,o,c,a,u,s,d,f,l)=>({linkId:n,url:t,sharingLinkIds:e,response:r,source:i,providerType:o,linksContainerId:c,unwrappedUrl:a,creationDateTime:u,thumbnailUrl:s,previewUrl:d,shareId:f,fromQuotedBody:l})),o=Object(r.action)("SHARING_LINK_REMOVED",(n,t,e,r,i)=>({linkId:n,sharingLinkIds:t,fileName:e,providerType:r,linksContainerId:i})),c=Object(r.action)("DELETE_LINK",(n,t)=>({linkId:n,targetWindow:t})),a=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(n,t,e,r)=>({linkId:n,providerId:t,isTryAgain:e,targetWindow:r})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(n,t,e,r)=>({linkId:n,recipientInfos:t,composeId:e,isCalendar:r})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(n,t)=>({linkId:n,linkIdContainer:t})),d=Object(r.action)("REMOVE_SHARING_LINK_FROM_CONTAINER",(n,t)=>({linkId:n,linkIdContainer:t})),f=Object(r.action)("ON_FLUID_LINK_CREATED",(n,t,e,r,i)=>({linkId:n,containerId:t,owaSource:e,url:r,viewStateId:i})),l=Object(r.action)("ON_EXISTING_FLUID_LINK_PROCESSED",(n,t,e,r,i)=>({linkId:n,containerId:t,owaSource:e,url:r,viewStateId:i}))},1724:function(n,t,e){"use strict";var r=e(1699),i=e(1959),o=e(5);function c(n){let t;return n>=1073741824?(n/=1073741824,t=Object(o.b)(i.b)):n>=1048576?(n/=1048576,t=Object(o.b)(i.d)):n>=1024?(n/=1024,t=Object(o.b)(i.c)):t=Object(o.b)(i.a),Object(o.c)(t,Math.round(n))}var a=e(1799),u=e(44);const s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(n){if(!Object(u.j)("doc-attachment-documentThumbnail"))return!1;const t=Object(r.a)(n);return!!t&&s.indexOf(t.toLowerCase())>=0}var f;function l(n){switch(n){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return f.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return f.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return f.PowerPoint;default:return null}}!function(n){n[n.Word=0]="Word",n[n.Excel=1]="Excel",n[n.PowerPoint=2]="PowerPoint"}(f||(f={}));var m=e(1762);e.d(t,"b",(function(){return r.a})),e.d(t,"c",(function(){return r.b})),e.d(t,"d",(function(){return r.c})),e.d(t,"i",(function(){return c})),e.d(t,"g",(function(){return a.a})),e.d(t,"h",(function(){return d})),e.d(t,"f",(function(){return l})),e.d(t,"e",(function(){return m.b})),e.d(t,"a",(function(){return f}))},1738:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(1940);function i(n){if(!n)return null;return Object(r.a)().attachments.get(n.Id)}},1751:function(n,t,e){"use strict";e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return i})),e.d(t,"c",(function(){return o})),e.d(t,"e",(function(){return c})),e.d(t,"d",(function(){return a}));const r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",c="ReferenceAttachment:#Exchange",a="LinkAttachment:#Exchange"},1754:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(316);function i(n){var t;return null===(t=Object(r.a)(n))||void 0===t?void 0:t.AttachmentPolicy}},1762:function(n,t,e){"use strict";function r(n){return function(n){const t=o.exec(n);return t&&t.length>1&&i[t[1].toLowerCase()]}(n||"")}e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return c}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function c(n){let t="";return Object.entries(i).forEach(e=>{e[1]===n&&(t=e[0])}),t}},1779:function(n,t,e){"use strict";e.d(t,"e",(function(){return i})),e.d(t,"f",(function(){return o})),e.d(t,"g",(function(){return c})),e.d(t,"c",(function(){return a})),e.d(t,"b",(function(){return u})),e.d(t,"a",(function(){return s})),e.d(t,"d",(function(){return d}));var r=e(3);const i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(n,t)=>({linkId:n,sharingDialogResponse:t})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(n,t)=>({linkId:n,newPermission:t})),c=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(n,t,e,r)=>({linkId:n,newLinkUrl:t,oldLinkUrl:e,expirationDate:r})),a=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(n,t)=>({linkId:n,actionStatus:t})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(n,t,e,r,i,o,c,a,u)=>({linkId:n,sharingUrl:t,currentUrl:e,canonicalUrl:r,newPermissionLevel:i,providerType:o,composeId:c,recipientInfos:a,isCalendar:u})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(n,t)=>({linkId:n,linkModel:t})),d=Object(r.action)("TOKEN_UNAVAILABLE",n=>({linkId:n}))},1791:function(n,t,e){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(n){let t=null;const e=r.exec(n);if(e){const n=e[1],r=e[2];let i=null;try{i=atob(r)}catch(n){}if(i){const e=new ArrayBuffer(i.length),r=new Uint8Array(e);for(let n=0;n<i.length;n++)r[n]=i.charCodeAt(n);t=new File([e],"image.png",{type:n})}}return t}var o=e(1702),c=e(1724);function a(n){return n.map(n=>({fileType:o.a.Uri,name:n.name,type:Object(c.b)(n.url)||"",size:0,uri:n.url}))}var u=e(40);function s(n,t,e){if(n.length!=t.length)return u.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let i=0;i<n.length;i++){const c={fileType:o.a.MailItem,name:n[i],size:(null==e?void 0:e[i])||0,itemId:t[i]};r.push(c)}return r}function d(n,t,e){const r=[],i={fileType:o.a.MailItem,name:n,size:e||0,mimeContent:t};return r.push(i),r}function f(n){if(!n)return null;let t=[];for(var e=0;e<n.length;e++){const r=n[e],i={fileType:o.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}function l(n){if(!n)return null;const t=[];for(let e=0;e<n.length;e++){const r=n[e],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function m(n){var t,e;if(null===n)return null;return{fileType:o.a.Cloud,name:n.Name,size:n.Size,providerId:n.AttachmentProviderId,providerType:n.ProviderType,location:n.Location,providerEndpointUrl:n.ProviderEndpointUrl,isFolder:1===n.Type,fileId:n.Id,fileParentId:n.ParentId,thumbnailUrl:(null===(t=n.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(e=n.Preview)||void 0===e?void 0:e.Url)||"",type:n.MimeType}}function p(n){if(null===n)return null;return{attachmentItemId:n.Id,name:n.Name,size:n.Size,fileType:o.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var h=e(1865);function b(n){switch(n?n.toLowerCase():null){case h.d.ONE_DRIVE_PRO.toLowerCase():return 0;case h.d.GDRIVE.toLowerCase():return 5;case h.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case h.d.DROPBOX.toLowerCase():return 2;case h.d.BOX.toLowerCase():return 3;case h.d.WOPI_BOX.toLowerCase():return 7;case h.d.WOPI_EGNYTE.toLowerCase():return 8;case h.d.MAILBOX.toLowerCase():return 4;case h.d.FACEBOOK.toLowerCase():return 6;default:return null}}e.d(t,"f",(function(){return i})),e.d(t,"j",(function(){return a})),e.d(t,"i",(function(){return s})),e.d(t,"h",(function(){return d})),e.d(t,"g",(function(){return f})),e.d(t,"d",(function(){return l})),e.d(t,"e",(function(){return m})),e.d(t,"c",(function(){return p})),e.d(t,"b",(function(){return b})),e.d(t,"a",(function(){return o.a}))},1799:function(n,t,e){"use strict";e.d(t,"a",(function(){return u})),e.d(t,"b",(function(){return s}));var r=e(1699),i=e(1762),o=e(169);const c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],a=[".tiff",".tif"];function u(n,t,e=!0){return s(Object(r.a)(n)||Object(i.a)(t),e)}function s(n,t=!0){return!!n&&(c.indexOf(n.toLowerCase())>=0||t&&a.indexOf(n.toLowerCase())>=0&&(Object(o.c)()||Object(o.f)()))}},1810:function(n,t,e){"use strict";var r=e(20);var i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};e.d(t,"j",(function(){return c})),e.d(t,"k",(function(){return a})),e.d(t,"b",(function(){return u})),e.d(t,"c",(function(){return s})),e.d(t,"g",(function(){return d})),e.d(t,"h",(function(){return f})),e.d(t,"e",(function(){return l})),e.d(t,"i",(function(){return m})),e.d(t,"f",(function(){return p})),e.d(t,"d",(function(){return h})),e.d(t,"a",(function(){return i}));const o=new r.c(()=>Promise.all([e.e(0),e.e(663)]).then(e.bind(null,19157))),c=new r.a(o,n=>n.subscribe),a=new r.a(o,n=>n.unsubscribe),u=new r.b(o,n=>n.getChannelId),s=new r.a(o,n=>n.getChannelReady),d=new r.a(o,n=>n.retryDisconnectionWithMinimumReconnectInterval),f=new r.a(o,n=>n.setup),l=new r.a(o,n=>n.handleNotification),m=new r.a(o,n=>n.NotificationManager.stopConnection),p=new r.a(o,n=>n.initializeNotificationManager),h=new r.b(o,n=>n.getNotificationEmitter)},1822:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(1751);function i(n){return(n.__type||n.OwsTypeName)===r.e}},1826:function(n,t,e){"use strict";e.d(t,"a",(function(){return o}));var r=e(2082),i=e(1830);function o(n){const t=Object(r.a)(),e=Object(i.b)(n);return t.sharingLinks.get(e)}},1830:function(n,t,e){"use strict";e.d(t,"b",(function(){return o})),e.d(t,"c",(function(){return c})),e.d(t,"a",(function(){return a}));var r=e(44);const i="_ODSPPSL";function o(n){return Object(r.j)("doc-link-savePermission")&&n&&-1!==n.indexOf(i)?n.substring(0,n.length-i.length):n}function c(n){return!!Object(r.j)("doc-link-savePermission")&&n.lastIndexOf(i)===n.length-i.length}function a(n,t){return!Object(r.j)("doc-link-savePermission")||2!==t&&1!==t?n:n+i}},1865:function(n,t,e){"use strict";e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return i})),e.d(t,"c",(function(){return o})),e.d(t,"e",(function(){return c})),e.d(t,"f",(function(){return a})),e.d(t,"g",(function(){return u})),e.d(t,"h",(function(){return s})),e.d(t,"i",(function(){return d})),e.d(t,"j",(function(){return f})),e.d(t,"k",(function(){return l})),e.d(t,"l",(function(){return m})),e.d(t,"d",(function(){return p}));const r="Box",i="Dropbox",o="Facebook",c="GDrive",a="Mailbox",u="MailMessage",s="OneDriveConsumer",d="OneDrivePro",f="WopiBox",l="WopiDropbox",m="WopiEgnyte",p={BOX:r,DROPBOX:i,FACEBOOK:o,GDRIVE:c,MAILBOX:a,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:f,WOPI_EGNYTE:m}},1866:function(n,t,e){"use strict";var r=e(2318),i=e(699);const o=Object(i.action)("addInfoBarMessage")((function(n,t,e){if(n){-1==n.infoBarIds.indexOf(t)?n.infoBarIds.push(t):n.infoBarIds=[...n.infoBarIds];const i=n.infoBarHostKey;e&&(r.b[i]||(r.b[i]={}),r.b[i][t]=e)}}));t.a=o},1881:function(n,t,e){"use strict";var r,i=e(20),o=e(1719),c=e(1779),a=e(2158);!function(n){n.PasteHtml="PasteHtml",n.InsertLinkFromToolbar="InsertLinkFromToolbar",n.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",n.AutoLink="AutoLink",n.ReplyOrForward="ReplyOrForward",n.LinkContextMenu="LinkContextMenu",n.Undo="Undo",n.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",n.RestoreCursor="RestoreCursor",n.ShareLinkCompose="ShareLinkCompose",n.NewFluidFile="NewFluidFile",n.Unknown="Unknown"}(r||(r={}));var u=e(1944),s=e(2170),d=e(2121),f=e(1830),l=e(1826);const m=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function p(n){const t=Object(l.a)(n);return t&&-1!==m.indexOf(t.source)}var h=e(2114);function b(n){const t=Object(l.a)(n);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:p(n)?"newLink":"oldLink"}:null}var I=e(2082);function g(){return Object(I.a)().sharingLinks.size}var O=e(2159);e.d(t,"t",(function(){return w})),e.d(t,"D",(function(){return A})),e.d(t,"K",(function(){return j})),e.d(t,"G",(function(){return C})),e.d(t,"E",(function(){return S})),e.d(t,"B",(function(){return L})),e.d(t,"H",(function(){return y})),e.d(t,"I",(function(){return T})),e.d(t,"J",(function(){return k})),e.d(t,"v",(function(){return x})),e.d(t,"s",(function(){return E})),e.d(t,"A",(function(){return R})),e.d(t,"u",(function(){return N})),e.d(t,"F",(function(){return P})),e.d(t,"C",(function(){return _})),e.d(t,"y",(function(){return M})),e.d(t,"x",(function(){return F})),e.d(t,"w",(function(){return D})),e.d(t,"z",(function(){return U})),e.d(t,"P",(function(){return v})),e.d(t,"d",(function(){return o.a})),e.d(t,"e",(function(){return o.b})),e.d(t,"f",(function(){return o.c})),e.d(t,"h",(function(){return o.d})),e.d(t,"R",(function(){return o.h})),e.d(t,"T",(function(){return o.i})),e.d(t,"M",(function(){return o.f})),e.d(t,"N",(function(){return o.g})),e.d(t,"L",(function(){return o.e})),e.d(t,"U",(function(){return c.e})),e.d(t,"V",(function(){return c.f})),e.d(t,"W",(function(){return c.g})),e.d(t,"S",(function(){return c.c})),e.d(t,"g",(function(){return c.b})),e.d(t,"Q",(function(){return a.b})),e.d(t,"a",(function(){return r})),e.d(t,"o",(function(){return u.a})),e.d(t,"q",(function(){return u.b})),e.d(t,"O",(function(){return s.a})),e.d(t,"c",(function(){return d.a})),e.d(t,"i",(function(){return f.a})),e.d(t,"j",(function(){return f.b})),e.d(t,"r",(function(){return f.c})),e.d(t,"p",(function(){return p})),e.d(t,"b",(function(){return h.a})),e.d(t,"m",(function(){return l.a})),e.d(t,"l",(function(){return b})),e.d(t,"k",(function(){return g})),e.d(t,"n",(function(){return O.a}));const v=new i.c(()=>Promise.all([e.e(0),e.e(26),e.e(94),e.e(643)]).then(e.bind(null,19118))),w=new i.b(v,n=>n.addRecipientsIntoLink),A=new i.b(v,n=>n.removeRecipientsFromLink),j=new i.b(v,n=>n.updateRecipientPermissionInfos),C=new i.b(v,n=>n.setGetPermissionInfoFailure),S=new i.b(v,n=>n.resetSharingRecipientsInfo),L=new i.b(v,n=>n.ignoreSharingTip),y=new i.b(v,n=>n.setLinkActionStatus),T=new i.b(v,n=>n.updateLinkContainerIdOfLink),k=new i.b(v,n=>n.updateLinkIds),x=new i.b(v,n=>n.createLinksIdContainer),E=new i.b(v,n=>n.addLinkIdToLinksIdContainer),R=new i.b(v,n=>n.getSharingTipRecipientInfo),N=new i.b(v,n=>n.createCloudFileFromSharingLink),P=new i.b(v,n=>n.retrieveImageUrlsForImageFile),_=new i.b(v,n=>n.imageLinkPreviewCondition),M=new i.b(v,n=>n.getLinksIdContainer),F=new i.b(v,n=>n.getAllLinksContainerIds),D=new i.b(v,n=>n.doesLinksIdContainerExist),U=new i.b(v,n=>n.getSharingLinkInfo)},1893:function(n,t,e){"use strict";e.d(t,"a",(function(){return c}));var r=e(2318),i=e(3);const o=Object(i.mutatorAction)("removeInfoBarMessages",(n,t,e)=>{t>=0&&n.infoBarIds.splice(t,1);const i=n.infoBarHostKey;r.b[i]&&(delete r.b[i][e],0===Object.keys(r.b[i]).length&&delete r.b[i])});function c(n,t){if(n){const e=Array.isArray(t)?t:t?[t]:n.infoBarIds?[...n.infoBarIds]:[];for(const t of e){const e=n.infoBarIds&&n.infoBarIds.indexOf(t);o(n,e,t)}}}},1944:function(n,t,e){"use strict";e.d(t,"a",(function(){return o})),e.d(t,"b",(function(){return c}));var r=e(1699),i=e(44);function o(n){const t=(Object(r.a)(n)||"").toLowerCase();return!!n&&(Object(i.j)("cmp-prague")&&(".fluid"===t||".note"===t))}function c(n){const t=(Object(r.a)(n)||"").toLowerCase();return!!n&&(Object(i.j)("cmp-prague")&&".note"===t)}},1959:function(n){n.exports=JSON.parse('{"b":"Mda","d":"Nda","c":"Oda","a":"Pda"}')},198:function(n,t,e){"use strict";var r=e(40);let i;function o(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}var c=e(108);const a=500,u=[],s=[],d=[];let f=!0;function l(n,t){Object(r.g)((n,t,e)=>{f&&(t==r.b.Error&&s.push({message:n,error:e}),u.push({message:n,level:t}))}),n(p),t(p),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function m(n){const t=Object(c.a)(n);return f=!1,{traces:u,errors:s,network:d,usage:t}}function p(){f&&d.push(arguments)}e.d(t,"a",(function(){return l})),e.d(t,"b",(function(){return m})),e.d(t,"d",(function(){return c.b})),e.d(t,"c",(function(){return o}))},2082:function(n,t,e){"use strict";e.d(t,"b",(function(){return c}));var r=e(14),i=e(3);const o={sharingLinks:new r.ObservableMap({}),linksIdContainerMap:new r.ObservableMap({})},c=Object(i.createStore)("sharingLinkStore",o);t.a=c},210:function(n,t,e){"use strict";t.decode=t.parse=e(367),t.encode=t.stringify=e(368)},2114:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n[n.none=0]="none",n[n.refreshing=1]="refreshing",n[n.refreshFailed=2]="refreshFailed",n[n.refreshSucceeded=3]="refreshSucceeded",n[n.attachingAsACopy=4]="attachingAsACopy",n[n.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2158:function(n,t,e){"use strict";function r(n){return void 0!==n.recipients}function i(n){return void 0!==n.length}e.d(t,"b",(function(){return r})),e.d(t,"a",(function(){return i}))},2159:function(n,t,e){"use strict";e.d(t,"a",(function(){return c}));var r=e(2178),i=e(701),o=e(210);async function c(n){return function(n){if(!Object(i.a)(null==n?void 0:n.nav)){const t={nav:n.nav};return Object(o.stringify)(t)}return null}((await r.b.import())(n))}},2170:function(n){n.exports=JSON.parse('{"a":"$ja"}')},2178:function(n,t,e){"use strict";e.d(t,"a",(function(){return o})),e.d(t,"c",(function(){return c})),e.d(t,"e",(function(){return a})),e.d(t,"f",(function(){return u})),e.d(t,"d",(function(){return s})),e.d(t,"b",(function(){return d}));var r=e(20);const i=new r.c(()=>e.e(1355).then(e.bind(null,3023))),o=new r.b(i,n=>n.extractFileUrlFromOfficeSharePointLink),c=new r.b(i,n=>n.isLinkPrefixedWithBaseUrl),a=new r.b(i,n=>n.isSharePointLink),u=new r.b(i,n=>n.isSharePointServiceGeneratedLink),s=new r.b(i,n=>n.isOfficeSharePointLink),d=new r.b(i,n=>n.getParsedQueryStringFromUrl)},2318:function(n,t,e){"use strict";e.d(t,"b",(function(){return r})),e.d(t,"a",(function(){return i}));const r={};function i(n,t){var e;const i=n.infoBarHostKey;return null===(e=r[i])||void 0===e?void 0:e[t]}},267:function(n,t,e){"use strict";var r=e(912);e.d(t,"a",(function(){return r.a}))},276:function(n,t,e){"use strict";e.d(t,"b",(function(){return a})),e.d(t,"a",(function(){return u}));var r=e(117),i=e(97),o=e(2);let c;function a(n){c=n}async function u(n){var t,e;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const a=c&&await c(void 0,n);if(a&&a.length>0){if("bearer"===(null===(t=null==a?void 0:a.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return a.split(" ")[1];if("msauth1.0"===(null===(e=null==a?void 0:a.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return a}}},3072:function(n,t,e){"use strict";e.r(t);var r=e(1881),i=e(3);function o(n,t){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}function c(n,t){t&&!n.includes(t)&&n.push(t)}Object(i.mutator)(r.d,n=>{c(n.sharingLinkIds,n.linkId)}),Object(i.mutator)(r.T,n=>{o(n.sharingLinkIds,n.linkId)}),Object(i.mutator)(r.e,n=>{c(n.linkIdContainer,n.linkId)}),Object(i.mutator)(r.R,n=>{o(n.linkIdContainer,n.linkId)});var a=e(5547);Object(i.mutator)(a.a,n=>{const{attachmentWell:t,message:e}=n;t.announcedComponentMessage=e});const u=Object(i.action)("addInlineAttachment",(n,t)=>({attachmentWell:n,inlineAttachment:t}));Object(i.mutator)(u,n=>{const{attachmentWell:t,inlineAttachment:e}=n;t.inlineAttachments.push(e)});var s=e(10309),d=e(5);const f=Object(i.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",(n,t,e,r,i)=>({attachmentWellViewState:n,parentItemId:t,recipientInfo:e,infoBarIds:r,infoBar:i}));var l=e(3663),m=e(3963),p=e(1738);function h(n){const t=n.docViewAttachments.concat(n.imageViewAttachments);return(e=t,e.filter(n=>n.isCloudy).map(n=>(function(n,t){if(1!==n.type)return null;const e=n.model;return{id:n.id,name:e.Name,supportsDownsell:t,currentPermissionLevel:e.PermissionType,sharingInfo:n.info.sharingInfo,sharingRecipientsInfo:{recipientPermissionInfos:[]},sharingTipsIgnored:[],typeOfLink:"referenceAttachment"}})(Object(p.a)(n.attachmentId),n.strategy.isConvertCloudyToClassicSupported))).filter(n=>{var t;return null===(t=n.sharingInfo)||void 0===t?void 0:t.getSharingInfoSucceeded});var e}var b=e(61),I=e(1866),g=e(1893),O=e(1975),v=e(2247);function w(n,t,e,r){return A(n,h(t),e,[],null,r,!0,null)}function A(n,t,e,r,i,o,c,a){let u;for(let s=0;s<n.length;s++){const d=j(n[s],t,e,r,i,o,c,a);d&&(u=d)}if("function"==typeof u){const n=u(null);if((null==n?void 0:n.messageParts)&&n.messageParts.length>0&&"string"==typeof n.messageParts[0])return n.messageParts[0]}else if("object"==typeof u&&u.length>0)return u[0];return null}function j(n,t,e,r,i,o,c,a){const u=o(t,n,e,c,a);return Object(g.a)(i,[n]),u&&(Object(I.a)(i,n,u),r.push(n)),u}Object(i.orchestrator)(f,async n=>{const{attachmentWellViewState:t,parentItemId:e,recipientInfo:r,infoBarIds:i,infoBar:o}=n,c=h(t),a=new b.b("AttachmentRefreshSharingTips"),u=[];A(Object(v.d)(),c,r,u,o,await v.f.import(),!1,n=>{const r=Object(l.a)(t,n);if(r){const n=Object(p.a)(r.attachmentId);return{text:Object(d.b)(s.a),action:()=>{const i=n.model;Object(b.o)("SharingTipsConvertToClassic"),Object(O.f)(r,e.Id,i.AttachLongPathName,i.PermissionType,(n,e,r,i)=>{Object(m.a)(t,n,e,r,i)},1)}}}return null}),function(n,t){const e=Object(v.d)(),r=n.filter(n=>-1!==e.indexOf(n)),i=t.filter(n=>-1===r.indexOf(n)),o=r.filter(n=>-1===t.indexOf(n));0!==i.length&&Object(b.o)("AttachmentSharingTipAdded",i);0!==o.length&&Object(b.o)("AttachmentSharingTipsRemoved",o)}(i,u),Promise.resolve().then(()=>a.end())});Object(i.orchestrator)(a.a,n=>{const{attachmentWell:t,message:e}=n;null!==e&&setTimeout(()=>{Object(a.a)(t,null)},2e3)});var C=e(6603),S=e(2045),L=e(2017);var y=e(3822),T=e(3306),k=e(1822),x=e(3350);const E=Object(i.mutatorAction)("storeAndInitializeAttachment",(n,t,e)=>{const r=!!t.parentItemIdMap;n.IsInline&&!Object(k.a)(n)&&n.ContentId&&""!=n.ContentId&&"unknown"!=n.ContentId.toLowerCase()?t.inlineAttachments.push(Object(O.i)(n.AttachmentId,n.AttachmentId.Id,!0,4)):Object(y.a)(n)&&!r?t.imageViewAttachments.push(e):t.docViewAttachments.push(e)});var R=Object(b.r)({name:"AttachmentWellInitialization",customData:(n,t,e,r,i,o,c,a,u,s)=>({hasAttachments:n&&n.length>0,isCompose:i}),options:{sessionSampleRate:1}},(function(n,t,e,r,i,o,c,a,u,s){if(!n)return;const d=function(n){return n?Object(O.o)().filter(t=>!n.includes(t)):null}(o);e.isInitialized||n.forEach(n=>{!function(n,t,e,r,i,o,c,a){if("application/x-sharing-metadata-xml"===n.ContentType)return;if(c&&Object(T.a)(n))return;const u=Object(O.h)(Object.assign(Object.assign({},n.AttachmentId),{mailboxInfo:t}),n,e.isReadOnly,!0,r,c,a,null,i,!0);if(E(n,e,u),u.isCloudy){const n=Object(p.a)(u.attachmentId);n.requiresFetchingSharingInformation&&o&&Object(O.m)(n)}else Object(x.a)(e,n.Size)}(n,t,e,r,d,c,u,s)}),N(e,a,d)}));const N=Object(i.mutatorAction)("initializeAttachments",(n,t,e)=>{t&&n.docViewAttachments.forEach(n=>{(function(n){const t=Object(p.a)(n);if(null==t?void 0:t.model){return"IPM.Appointment"===t.model.EmbeddedItemClass}return!1})(n.attachmentId)&&function(n){n.previewMethod=L.a.Unsupported,n.supportedOpenActions=n.supportedOpenActions.filter(n=>n!==S.a.Preview)}(n.strategy)}),n.supportedMenuActions=e,n.isInitialized=!0});var P=e(699),_=Object(P.action)("reinitializeAttachments")((function(n,t,e,r,i,o,c,a,u){n&&(e.docViewAttachments=[],e.imageViewAttachments=[],e.inlineAttachments=[],e.isInitialized=!1,R(n,t,e,r,!1,i,o,c,a,u))})),M=e(4081);function F(n,t){const e=Object(M.a)(!1,void 0===t,n);if(t){const{attachments:n,mailboxInfo:r,parentItemId:i}=t;R(n,r,e,!0,!0,null,i)}return e}var D=e(4019);function U(n,t){const e=Object(M.a)(!0,!1,"");return Object.assign(Object.assign({},e),{parentItemIdMap:n,itemReceivedTimeMap:t,isVisible:!1,maxHeight:0})}var B=e(3893),z=e(2034),V=e(2653);var W=(n,t,e,r)=>{if(n){const{docViewAttachments:i,imageViewAttachments:o,inlineAttachments:c}=n,a=[...i,...o,...c.filter(n=>{const r=Object(p.a)(n.attachmentId);if((null==r?void 0:r.model)&&"HTML"===e){const n=t;return n&&!Object(V.l)(n,r.model)}return!1})];return r?a.filter(n=>Object(z.b)(n.attachmentId.Id)):a.filter(n=>!Object(z.b)(n.attachmentId.Id))}return[]},H=e(4066),K=e(3459),G=e(3592),X=e(6094),J=e(1791),$=e(1910);async function Q(n,t,e,r,i,o,c){const a=await $.c.import(),u=r.filter(n=>!function(n){return!Object(k.a)(n)&&n.IsInline}(n)).map(a),s=u.filter(n=>n.fileType===J.a.Cloud),d=u.filter(n=>n.fileType===J.a.AttachmentItem);d.length>0&&q(e,n,t,d,i,!1,!1,o,c),s.length>0&&q(e,n,t,s,i,!1,!0,o,c)}function q(n,t,e,r,i,o,c,a,u){const s={isInline:o,isHiddenInline:!1},d=c?Object.assign(Object.assign({},s),{shouldShare:!0}):Object.assign(Object.assign({},s),{shouldShare:!1});$.f.import().then(o=>{o(n,t,r,i,d,null,a,u,null,e)})}var Y=e(7040),Z=Object(i.mutatorAction)("mergeToConversationAttachmentWell",(function(n,t,e,r){n&&(n.docViewAttachments.forEach(n=>{nn(n,t,e,r)}),n.imageViewAttachments.forEach(n=>{nn(n,t,e,r)}))}));function nn(n,t,e,r){t.parentItemIdMap[n.attachmentId.Id]||(t.docViewAttachments.push(Object.assign({},n)),t.parentItemIdMap[n.attachmentId.Id]=e,t.itemReceivedTimeMap[n.attachmentId.Id]=r)}var tn=Object(i.mutatorAction)("sortConversationAttachmentWell",(function(n,t){n.docViewAttachments=n.docViewAttachments.sort((e,r)=>(t?1:-1)*(new Date(n.itemReceivedTimeMap[e.attachmentId.Id]).getTime()-new Date(n.itemReceivedTimeMap[r.attachmentId.Id]).getTime()))})),en=e(2377),rn=e(1829),on=e(5159),cn=e(3015);function an(n,t,e){if(Object(p.a)(t.attachmentId)&&n.imageViewAttachments.indexOf(t)>=0){Object(cn.a)(n,t,!1,!1),Object(rn.o)(t.attachmentId,e),Object(rn.p)(t.attachmentId,!0);const r=Object(en.b)(t.attachmentId,1);Object(on.a)(t.attachmentId,r);const i=Object(O.i)(t.attachmentId,t.attachmentId.Id,!1);i.status=3,u(n,i)}}var un=e(6604);e.d(t,"refreshSharingTipsAttachmentWell",(function(){return f})),e.d(t,"addAttachmentIntoWellBeforeUpload",(function(){return C.a})),e.d(t,"initializeAttachments",(function(){return R})),e.d(t,"reinitializeAttachments",(function(){return _})),e.d(t,"getAttachmentWellForCompose",(function(){return F})),e.d(t,"getAttachmentWellInitialValue",(function(){return M.a})),e.d(t,"getAvailableLocalAttachmentSize",(function(){return D.a})),e.d(t,"getConversationAttachmentWellInitialValue",(function(){return U})),e.d(t,"getMaxClassicAttachmentsSize",(function(){return B.a})),e.d(t,"getAllValidAttachments",(function(){return W})),e.d(t,"createAttachmentFullViewStateAndStoreBackingModel",(function(){return H.a})),e.d(t,"setInlineAttachmentStatus",(function(){return K.a})),e.d(t,"createAttachmentFullViewState",(function(){return G.a})),e.d(t,"createAttachmentsViaQueueManager",(function(){return X.a})),e.d(t,"deleteAttachmentViaQueueManager",(function(){return X.b})),e.d(t,"createAttachmentsFromRecentAttachments",(function(){return Q})),e.d(t,"createAttachmentFileFromExistingMailboxAttachment",(function(){return Y.a})),e.d(t,"mergeToConversationAttachmentWell",(function(){return Z})),e.d(t,"sortConversationAttachmentWell",(function(){return tn})),e.d(t,"convertImageViewAttachmentToInlineAttachment",(function(){return an})),e.d(t,"getLastCloudyAttachmentsSharingIssueForBlockOnSend",(function(){return w})),e.d(t,"uploadLocalFile",(function(){return un.a}))},311:function(n,t,e){"use strict";e.d(t,"a",(function(){return o})),e.d(t,"b",(function(){return c}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function c(n){return r.test(n)}},3306:function(n,t,e){"use strict";e.d(t,"a",(function(){return u}));var r=e(1897);const i=(n,t)=>n.substring(0,t.length)===t,o=(n,t)=>n.substring(n.length-t.length)===t,c=n=>n.ContentType&&(i(n.ContentType,r.s)||i(n.ContentType,r.j)),a=n=>n.ContentType&&n.ContentType===r.h;function u(n){return(null==n?void 0:n.Name)&&o(n.Name,r.q)&&(c(n)||a(n))}},359:function(n,t){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},3663:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(209);function i(n,t){let e=n.docViewAttachments.filter(n=>Object(r.e)(n.attachmentId,t));return 0===e.length&&(e=n.imageViewAttachments.filter(n=>Object(r.e)(n.attachmentId,t))),0===e.length?null:e[0]}},367:function(n,t,e){"use strict";function r(n,t){return Object.prototype.hasOwnProperty.call(n,t)}n.exports=function(n,t,e,o){t=t||"&",e=e||"=";var c={};if("string"!=typeof n||0===n.length)return c;var a=/\+/g;n=n.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var s=n.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var f,l,m,p,h=n[d].replace(a,"%20"),b=h.indexOf(e);b>=0?(f=h.substr(0,b),l=h.substr(b+1)):(f=h,l=""),m=decodeURIComponent(f),p=decodeURIComponent(l),r(c,m)?i(c[m])?c[m].push(p):c[m]=[c[m],p]:c[m]=p}return c};var i=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)}},368:function(n,t,e){"use strict";var r=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}};n.exports=function(n,t,e,a){return t=t||"&",e=e||"=",null===n&&(n=void 0),"object"==typeof n?o(c(n),(function(c){var a=encodeURIComponent(r(c))+e;return i(n[c])?o(n[c],(function(n){return a+encodeURIComponent(r(n))})).join(t):a+encodeURIComponent(r(n[c]))})).join(t):a?encodeURIComponent(r(a))+e+encodeURIComponent(r(n)):""};var i=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function o(n,t){if(n.map)return n.map(t);for(var e=[],r=0;r<n.length;r++)e.push(t(n[r],r));return e}var c=Object.keys||function(n){var t=[];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&t.push(e);return t}},3893:function(n,t,e){"use strict";e.d(t,"a",(function(){return a}));var r=e(3052),i=e(14),o=e(29);const c=25*r.b;function a(){return u.get()}const u=Object(i.computed)(()=>{const n=Object(o.a)();return n&&n.SessionSettings?(n.SessionSettings.MaxMessageSizeInKb-2048)*r.a:c})},4081:function(n,t,e){"use strict";e.d(t,"a",(function(){return o}));var r=e(3893);let i;function o(n,t,e){return i||(i=Object(r.a)()),{composeId:e,allowShowMultipleRows:!n,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:t,isReadOnly:n,groupId:null,maxTotalClassicAttachmentSize:i,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[],announcedComponentMessage:null}}},700:function(n,t,e){"use strict";function r(n,t){return n?Object.assign({mailboxInfo:n},t):null!=t?t:void 0}e.d(t,"a",(function(){return r}))},701:function(n,t,e){"use strict";function r(n){return null==n||0==n.trim().length}e.d(t,"a",(function(){return r}))},912:function(n,t,e){"use strict";function r(n){return n>=200&&n<300}e.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.652.js.map
self.scriptsLoaded['owa.652.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.652.js'] = (new Date()).getTime();