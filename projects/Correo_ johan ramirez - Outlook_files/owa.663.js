self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.663.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[663,2033],{117:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r}));var i=n(36);function o(){let t=Object(i.b)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}function r(){return o()+"/"}},121:function(t,e,n){"use strict";var i=n(2),o=n(12);const r={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1},loadThemeFromHostApp:{default:!1,opx:!0},loadCultureFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,native:!1,opx:!0},opxServiceWorker:{default:!1,opx:!0},routeOptionsStaticUrl:{default:!1,opx:!0},scenarioData:{default:!1,opx:!0},macA11y:{default:!1,macoutlook:!0},joinTeamsMeetingHandler:{default:!1,hub:!0,opx:!0},use3SPeopleSuggestions:{default:!0,macoutlook:!1},defaultCalendarColor:{default:!1,opx:!0},roomAddedHandler:{default:!1,opx:!0},roomFinderFreeBusyStyles:{default:!1,macoutlook:!0,outlookdesktop:!0},defaultSelectCalendarItemSvg:{default:!0,opx:!1},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0},ribbonFeedback:{default:!1,hub:!0},composeFrom:{default:!1,opx:!0},groupDiscoverCloseButton:{default:!1,opx:!0},updateModalProps:{default:!1,opx:!0},modalOpenedHandler:{default:!1,opx:!0},defaultOutlookThemeColor:{default:!0,opx:!1},yammerDailyDigest:{default:!1,outlookdesktop:!0},yammerDirectFollower:{default:!1,outlookdesktop:!0},yammerDiscovery:{default:!1,outlookdesktop:!0},yammerHostClientType:{default:!1,native:!0,opx:!0},linkClicked:{default:!1,outlookdesktop:!0},showMinimumThreeInsights:{default:!1,opx:!0},groupCreatedHandler:{default:!1,opx:!0},groupDeletedHandler:{default:!1,opx:!0},updateSearchAnswerOnQueryChange:{default:!1,opx:!0},insightsCountUpdatedHandler:{default:!1,opx:!0},processMeetingInsightsHandler:{default:!1,opx:!0},processEmptyYammerPublishersHandler:{default:!1,opx:!0},focusZoneCicularNavigation:{default:!1,opx:!0},componentTokenProvider:{default:!1,opx:!0,native:!0,hub:!0},hideCalendarLeftNav:{default:!1,teamshub:!0},hideAppSuiteHeader:{default:!1,hub:!0},metaOSTest:{default:!1,hub:!0},hideOfficeRail:{default:!1,hub:!0},openMailInHub:{default:!1,win32outlookhub:!0},openComposeMailInHub:{default:!1,win32outlookhub:!0},settings:{default:!0,opx:!1,hub:!1},multiAccounts:{default:!0,teams:!1,outlookdesktop:!1,widget:!1,native:!1,hub:!1},nativeDiagnostics:{default:!1,native:!0},nativeQsp:{default:!1,native:!0},moduleSwitch:{default:!1,native:!0},diagInAppSupport:{default:!1,native:!0},diagFeedbackJs:{default:!1,native:!0},diagFeedbackEmailGroup:{default:!1,native:!0},diagFeedbackNoAttachSR:{default:!1,native:!0},diagFeatureCrew:{default:!1,native:!0},diagThrottleFeedbackEmail:{default:!1,native:!0},diagToggleFeedback:{default:!1,native:!0},newOutlookToggle:{default:!1,native:!0},monarchErrorMessage:{default:!1,native:!0},noteFeedSidePanel:{default:!0,native:!1},whatsNew:{default:!0,native:!1},owaBrandingCharm:{default:!0,native:!1},appLauncher:{default:!0,native:!1},incorrectNativeEntryPoint:{default:!1,native:!0},metaOSFeedback:{default:!1,hub:!0},monarchFeedback:{default:!1,native:!0},native:{default:!1,native:!0},offlineResolvers:{default:Object(o.i)("offlineWeb"),native:!0},managedQueryLink:{default:!1,native:!0},wrongIndex:{default:!1,native:!0},outlookSuiteHeaderStrategy:{default:!1,native:!0},pauseInbox:{default:!0,native:!1},hxVersionQueryStringParam:{default:!1,native:!0},nativeServiceWorker:{default:!1,native:!0},nativeHostAttachmentHijack:{default:!1,native:!0},useNativeConversationOptions:{default:!1,native:!0},reboot:{default:!1,native:!0},calendarFolderHx:{default:!1,native:!0},skipAwaitLpcConfig:{default:!1,opx:!0},workloadScenarioSettings:{default:!0,opx:!1},ribbonDefaultToSLR:{default:!1,native:!0},ribbonPersistDefault:{default:!1,native:!0},updateHostAppIcon:{default:!1,native:!0},projectionCustomTitlebar:{default:!1,native:!0},monarchDensity:{default:!1,native:!0},toDoNewTab:{default:!1,native:!0},floodgate:{default:!0,opx:!1},meControlAccountSwitching:{default:!0,native:!1},smimeExtension:{default:!0,native:!1},platformAppSdk:{default:!1,hub:!0},resourceTokenFromHost:{default:!1,native:!0,opx:!0},useBaseTheme:{default:!1,win32outlookhub:!0,hub:!1},acctmonaccounts:{default:!1,native:!0},showOWAMailtoBanner:{default:!0,native:!1},copyLinkUsingClipboardApi:{default:!1,native:!0},outlookDesktopToMonarchPreferenceMigration:{default:!1,native:!0},nativeMessaging:{default:!1,native:!0,widget:!0},disableAppModuleKeys:{default:!1,hub:!0},nativeReactions:{default:!1,native:!0},promptRebootNativeHost:{default:!1,native:!0},openEventsInNewWindow:{default:!1,native:!0,win32outlookhub:!0},nativeFriendlyKeyboarding:{default:!1,native:!0,win32outlookhub:!0},altForKeytips:{default:!1,native:!0,win32outlookhub:!0},msalTokenFetch:{default:!0,native:!1,teams:!1,opx:!1,hub:!1},outlookNpsDialogMonarch:{default:!1,native:!0}};var a=n(131),c=n(130);const u=t=>{const e=(t=>r[t])(t);if(e){if(Object(a.a)()&&i.e in e)return e[i.e];if(Object(c.b)()&&i.h in e)return e[i.h];let t=Object(i.A)();if(t&&t in e)return e[t];if(t&&(t===i.i||t===i.k)&&i.b in e)return e[i.b];const n=Object(i.E)();return n&&n in e?e[n]:n&&(n===i.g||n===i.d||n===i.c||n===i.a||n===i.h||n===i.f||n===i.j)&&"opx"in e?e.opx:e.default}return!1};n.d(e,"a",(function(){return u}))},122:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return r}));let i={};function o(t){i=t}function r(){return i}},130:function(t,e,n){"use strict";var i=n(138),o=n(2),r=n(8),a=n(6);function c(){return!!Object(a.f)("hostApp",Object(r.a)().location)&&Object(a.c)("hostApp").toLowerCase()==o.h}n.d(e,"a",(function(){return i.a})),n.d(e,"c",(function(){return i.b})),n.d(e,"b",(function(){return c}))},138:function(t,e,n){"use strict";let i;function o(){if(!i)throw new Error("OpxHostApi has not been initialized yet.");return i}function r(){return!!i}function a(t){i=t}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a}))},150:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return s}));var i=n(259),o=n(11),r=n(122);const a="featureOverrides";function c(){const t=Object(o.a)(self,a);return t?Object(i.a)(t):{}}function u(){Object(o.d)(self,a)}function s(t){const e=Object(o.a)(self,a);let n=e?e.split(","):[];for(const e of t){const t=e.name.toLowerCase(),i=e.isEnabled?t:`-${t}`,o=Object(r.a)()[t],a=e.isEnabled===!o,c=new RegExp(`^-?${t}$`,"i");n=n.filter(t=>!c.test(t)),a&&n.push(i)}Object(o.e)(self,a,n.join(","))}},164:function(t,e,n){"use strict";function i(){var t=Object.create(null),e=0,n=0,i=0,o=!1;function r(e){i--,delete t[e]}this.put=function(e,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=t[e];c?clearTimeout(c.timeout):i++;var u={value:n,expire:o+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){r(e),a&&a(e,n)}.bind(this),o)),t[e]=u,n},this.del=function(e){var n=!0,i=t[e];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&r(e),n},this.clear=function(){for(var r in t)clearTimeout(t[r].timeout);i=0,t=Object.create(null),o&&(e=0,n=0)},this.get=function(r){var a=t[r];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&e++,a.value;o&&n++,i--,delete t[r]}else o&&n++;return null},this.size=function(){return i},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){o=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var i=t[n];e[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var i=JSON.parse(e),o=Date.now(),r=n&&n.skipDuplicates;for(var a in i)if(i.hasOwnProperty(a)){if(r)if(t[a])continue;var c=i[a],u=c.expire-o;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}t.exports=new i,t.exports.Cache=i},176:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(77),o=n(258),r=n(40);function a(t,e){if(!Object(o.a)()){if(e)return!1;r.d(`Attempted to read ${t} before feature flags were initialized.`)}return Object(i.a)().featureFlags.get(t.toLowerCase())||!1}},19157:function(t,e,n){"use strict";n.r(e);let i=[],o=!1;const r=()=>i,a=t=>i.push(t),c=()=>i=[],u=t=>o=t,s=()=>o;var d=n(2651);var l={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};let f,b;function h(){return f||(f=new d.a),f}function p(t){h().emit(l.ChannelData,t)}function m(t){h().emit(l.TraceWarn,t)}let g=!1;function v(){return g||j(),Object.keys(b).map(t=>b[t].refs[0].subscription)}function O(t){return g||j(),S(t)?b[t].refs:[]}function k(t){return b[t]}function S(t){return t in b}function j(){b={},g=!0}function w(t){try{t()}catch(t){e=t,h().emit(l.TraceError,e)}var e}var y=n(32);function C(t){return Object.assign({__type:"SubscriptionData:#Exchange"},t)}function T(t,e){var n;if(void 0===t.request||t.request.__type||(t.request=(n=t.request,Object.assign({__type:"NotificationSubscribeJsonRequest:#Exchange"},n))),void 0!==t.subscriptionData)for(var i=0;i<t.subscriptionData.length;i++)void 0===t.subscriptionData[i]||t.subscriptionData[i].__type||(t.subscriptionData[i]=C(t.subscriptionData[i]));return Object(y.a)("SubscribeToNotification",t,e)}var I=n(245);const R="Reload";function x(t){h().emit(l.NotificationData,t);let e=O(t.id).map(t=>t.callback);for(let n of e)w(()=>{n(t)})}function A(t){return{id:t,EventType:R}}function D(){let t=v();for(let e of t){x(A(e.subscriptionId))}}const N=3,E=8,M=3e5,_=500;async function F(t){t.requiresExplicitSubscribe&&(S(t.subscriptionId)||(h().emit(l.SubscriptionRemoved,t),await async function(t){try{await function(t,e){if(void 0!==t.subscriptionData)for(var n=0;n<t.subscriptionData.length;n++)void 0===t.subscriptionData[n]||t.subscriptionData[n].__type||(t.subscriptionData[n]=C(t.subscriptionData[n]));return Object(y.a)("UnsubscribeToNotification",t,e)}({subscriptionData:[{SubscriptionId:t.subscriptionId,Parameters:t.subscriptionParameters}]})}catch(t){m(`Subscription unsubscribe failed: ${t.message}`)}}(t)))}function L(t){let e=k(t.subscriptionId);0!==e.pendingRetryHandle&&(window.clearTimeout(e.pendingRetryHandle),e.pendingRetryHandle=0),e.status=2,G(t,e),a(t),s()||(window.setTimeout(async()=>{let t=r();c(),u(!1),await async function(t){try{let e=await T({request:{Header:Object(I.b)()},subscriptionData:t.map(t=>({SubscriptionId:t.subscriptionId,Parameters:t.subscriptionParameters}))});H(t,(t,n)=>{let i=e.filter(t=>t.SubscriptionId===n.subscriptionId);0!==i.length?function(t,e,n){if(t.SuccessfullyCreated){if(n.retries>0){let t=O(e.subscriptionId);for(let e=0;e<t.length;e++){let n=t[e];n.subscription.onReconnected&&w(n.subscription.onReconnected)}}n.retries=0,n.pendingRetryHandle=0,n.status=3,G(e,n,"")}else U(e,n,t.ErrorInfo)}(i[0],n,t):P(n,t,new Error(`${n.subscriptionId} not in subscription responses`))})}catch(e){H(t,(t,n)=>{P(n,t,e)})}}(t)},_),u(!0))}function P(t,e,n){U(t,e,n.message)}function U(t,e,n){if(function(t){let e=A(t),n=O(t);for(let t of n)!0!==t.subscription.noSubscriptionFailureReload&&w(()=>{t.callback(e)})}(t.subscriptionId),0===e.retries){let e=O(t.subscriptionId);for(let t=0;t<e.length;t++){let i=e[t];i.subscription.onDisconnected&&w(()=>{i.subscription.onDisconnected(n)})}}e.retries+=1,e.status=1,e.retries<N?L(t):e.retries<E&&(e.pendingRetryHandle=window.setTimeout(()=>{e.pendingRetryHandle=0,L(t)},M)),G(t,e,n)}function H(t,e){t.map(t=>{let n=k(t.subscriptionId);n&&e(n,t)})}function G(t,e,n){h().emit(l.SubscriptionUpdated,t,e,n)}var z=n(61);function B(t,e){!function(t,e){g||j(),S(t.subscriptionId)||(b[t.subscriptionId]={refs:[],status:0,retries:0,pendingRetryHandle:0}),b[t.subscriptionId].refs.push({subscription:t,callback:e})}(t,e),function(t){if(!t.requiresExplicitSubscribe)return;let e=k(t.subscriptionId);0===e.status?(h().emit(l.SubscriptionAdded,t),L(t)):G(t,e)}(t),Object(z.o)("SignalRNotification",{SubscriptionId:t.subscriptionId,Action:"Subscribe"})}function W(t,e){!function(t,e){if(!S(t.subscriptionId))return void m(`Tried to remove ${t.subscriptionId} from the subscription tracker when it didn't exist`);let n=b[t.subscriptionId].refs;for(let t=0;t<n.length;t++)if(n[t].callback===e){n.splice(t,1);break}0===n.length&&(0!==b[t.subscriptionId].pendingRetryHandle&&window.clearTimeout(b[t.subscriptionId].pendingRetryHandle),delete b[t.subscriptionId])}(t,e),F(t),Object(z.o)("SignalRNotification",{SubscriptionId:t.subscriptionId,Action:"Unsubscribe"})}var q=n(311);let Q,V,J;const Y=()=>(Q||(Q=Object(q.a)()),Q),K=()=>{void 0===V&&(V=new Promise(t=>{J=t}))},Z=()=>(K(),V),X=()=>{K(),J()};var tt=n(50),et=n(44);function nt(t,e){var n;return void 0===t||t.__type||(n=t,t=Object.assign({__type:"ChannelRoundTripNotificationRequest:#Exchange"},n)),Object(y.a)("SendChannelRoundTripNotification",t,e)}const it=-1,ot=6e4,rt=3e5,at=9e5;let ct,ut=!1,st=it,dt=it;function lt(){if(!Object(et.j)("auth-SignalRActivityTimer"))return;dt!==it&&window.clearTimeout(dt),st!==it&&window.clearTimeout(st);let t=Math.floor(Math.random()*(at-rt+1)+rt);dt=window.setInterval(ht,t)}function ft(){dt!==it&&window.clearTimeout(dt),st!==it&&window.clearTimeout(st)}function bt(){ct()}function ht(){p("Channel inactive, starting liveness round-trip check"),nt({}),st=window.setTimeout(bt,ot)}function pt(){p("Received liveness round-trip payload, channel still live"),window.clearTimeout(st),lt()}var mt=n(121),gt=n(516);class vt{constructor(t,e,n,i){this.PENDING_GET_ID="pg",this.RELOAD_ALL_ID="ReloadAllNotification",this.NO_TIMER=-1,this.RECONNECT_FAILOVER_STAGGER_RANGE=6e4,this.RECONNECT_RECYCLE_STAGGER_RANGE=3e4,this.connection=t,this.connectionOptions=e,this.managerStore=n,this.managerConfig=i}getConnectionState(){return this.connection.state}setConnectionCallbacks(){this.connection.received(this.connectionMessageReceivedHandler.bind(this)),this.connection.error(this.connectionErrorHandler.bind(this)),this.connection.disconnected(this.connectionDisconnectedHandler.bind(this)),this.connection.stateChanged(this.connectionStateChangedHandler.bind(this))}async setConnectionQueryParameters(){this.connection.qs=Object.assign({UA:"0",cid:this.managerStore.channelId,"X-OWA-CANARY":Object(tt.a)(),app:this.managerConfig.appName},this.managerConfig.getNotificationToken&&this.managerConfig.getNotificationToken.bind(this)&&{access_token:await this.getNotificationToken()})}setConnectionQueryParametersSync(){this.connection.qs=Object.assign({UA:"0",cid:this.managerStore.channelId,"X-OWA-CANARY":Object(tt.a)(),app:this.managerConfig.appName},this.managerConfig.getNotificationToken&&this.managerConfig.getNotificationToken.bind(this)&&{access_token:this.getNotificationTokenFromCache()})}startConnection(){this.managerStore.giveUpReconnecting=!1,this.managerStore.reconnectScheduled=!1,this.connection.start(this.connectionOptions)}connectionMessageReceivedHandler(t){lt();let e=t;for(let t of e)t.id===this.PENDING_GET_ID?this.handlePendingGetNotification(t):t.id===this.RELOAD_ALL_ID?(D(),p("reload all"),this.managerStore.mark++):(x(t),this.managerStore.mark++)}handlePendingGetNotification(t){switch("update"!==t.data&&p(t.data),t.data){case"alive1":this.handleAliveNotification(t);break;case"reinitSubscriptions":v().map(t=>{L(t)}),p("reinit subscriptions");break;case"validateSubscriptions":p(`validate subscriptions:${function(t){let e=[];if(null!=t){let n={};for(let e=0;e<t.length;++e)null!=t[e]&&(n[t[e]]=!0);let i=v();for(let t=0;t<i.length;++t){3!=k(i[t].subscriptionId).status||n[i[t].subscriptionId]||(e.push(i[t].subscriptionId),L(i[t]))}}return e}(t.subscriptionIds).join("|")}`);break;case"update":this.checkMarksAndHandleMismatch(t);break;case"backendConnectionDropped":this.handleBackendConnectionDropped(),p("backend connection dropped");break;case"diagnostic":p(`diagnostic: ${t.message}`)}}handleAliveNotification(t){2===this.managerStore.state&&p("alive1 when channel was already ready"),p(`channel ids: local ${this.managerStore.channelId} server ${t.cid}`),p(`client mark: ${this.managerStore.mark}, server mark: ${t.mark}`),this.managerStore.channelId=t.cid,this.managerStore.state=2,this.setConnectionQueryParametersSync(),this.checkMarksAndHandleMismatch(t),this.managerStore.mark=0,X()}checkMarksAndHandleMismatch(t){t.mark!==this.managerStore.mark&&(p(`mark mismatch local: ${this.managerStore.mark}, server: ${t.mark}`),D(),this.managerStore.mark=t.mark)}connectionErrorHandler(t){ft(),t.context&&(401===t.context.status||440===t.context.status?(p("session timed out"),this.managerStore.giveUpReconnecting=!0,this.managerConfig.handleSessionTimeout&&this.managerConfig.handleSessionTimeout.bind(this)&&this.managerConfig.handleSessionTimeout(),Object(mt.a)("componentTokenProvider")&&(this.managerStore.giveUpReconnecting=!1,this.setConnectionQueryParametersSync())):449===t.context.status&&(p("Canary cookie expiration"),this.setConnectionQueryParametersSync()))}stopConnection(){this.managerStore?(p("connection stopped"),ft(),this.managerStore.state=3,this.managerStore.giveUpReconnecting=!0,this.connection.stop()):p("attempting to stop connection before initialization")}handleBackendConnectionDropped(){this.stopConnection(),this.managerStore.reconnectTimeout=this.managerConfig.backoffMaximum,this.retryConnectionWithBackOff("ChannelReconnectConnectionDropped",this.RECONNECT_FAILOVER_STAGGER_RANGE)}connectionDisconnectedHandler(t=!1){ft(),1==this.managerStore.state?this.managerStore.state=0:2!=this.managerStore.state&&4!=this.managerStore.state||(this.managerStore.state=3),t&&(this.managerStore.reconnectTimeout=Math.abs(this.managerConfig.minimumReconnectInterval)),!0!==this.managerStore.giveUpReconnecting&&this.retryConnectionWithBackOff("ChannelReconnectConnectionDisconnected",t?0:this.RECONNECT_RECYCLE_STAGGER_RANGE)}connectionStateChangedHandler(t){switch(t.newState){case 1:0===this.managerStore.state?(this.managerStore.state=1,p("channel initialized")):3===this.managerStore.state&&(this.managerStore.state=4,p("channel reconnecting")),this.managerStore.reconnectTimeout=Math.abs(this.managerConfig.minimumReconnectInterval),this.startChannelReadyTimer();break;case 4:case 2:ft(),1===this.managerStore.state?(this.managerStore.state=0,p("channel uninitialized")):2===this.managerStore.state&&(this.managerStore.state=4,p("channel reconnecting")),this.stopChannelReadyTimer()}}retryConnectionWithBackOff(t,e){let n=Math.abs(this.managerStore.reconnectTimeout);n+=Math.floor(Math.random()*e),p(`retrying connection with backoff ${n}`),Object(et.j)("auth-notificationChannelTelemetry")&&Object(z.o)(t,{domain:window.location.hostname,delay:n},{isCore:!0}),window.setTimeout(this.startConnection.bind(this),n),this.managerStore.reconnectTimeout=Math.min(2*Math.abs(this.managerStore.reconnectTimeout),Math.abs(this.managerConfig.backoffMaximum)),this.managerStore.reconnectScheduled=!0}startChannelReadyTimer(){this.managerStore.checkReadyTimer=window.setTimeout(this.checkIfChannelIsReady.bind(this),this.managerConfig.readyCheckTimeout)}stopChannelReadyTimer(){this.managerStore.checkReadyTimer!==this.NO_TIMER&&(window.clearTimeout(this.managerStore.checkReadyTimer),this.managerStore.checkReadyTimer=this.NO_TIMER)}checkIfChannelIsReady(){2!==this.managerStore.state&&(p("ready check timer expired"),this.stopConnection(),this.retryConnectionWithBackOff("ChannelReconnectNotReady",0))}reloadHandlers(){D()}handleLivenessFailure(){D(),Object(z.o)("ChannelLivenessFailure",{domain:window.location.hostname},{isCore:!0}),p("restarting channel due to liveness check failure"),this.stopConnection(),this.startConnection(),lt()}getNotificationTokenFromCache(){let[t]=this.managerConfig.getNotificationToken(this.managerConfig.sourceId,this.managerConfig.email);return t}async getNotificationToken(){let[t,e]=this.managerConfig.getNotificationToken(this.managerConfig.sourceId,this.managerConfig.email);return t||(t=await e),t}retryDisconnection(){this.managerStore&&(this.managerStore.giveUpReconnecting=!1,this.managerStore.reconnectScheduled=!1,this.connectionDisconnectedHandler(!0))}async init(){this.managerStore.channelId=Y(),this.setConnectionCallbacks(),await this.setConnectionQueryParameters();let t=this.connection.stop.bind(this.connection);var e;this.connection.stop=(e,n)=>{t(!0,n)},e=this.handleLivenessFailure.bind(this),ut||(ut=!0,ct=e,B({subscriptionId:"RoundTrip",requiresExplicitSubscribe:!1,subscriptionParameters:{},noSubscriptionFailureReload:!0},pt)),$.signalR.ajaxDefaults.timeout=6e4,$.signalR.transports.serverSentEvents.timeOut=6e4,Object(et.j)("auth-notificationChannelTelemetry")&&Object(z.o)("ChannelInitialization",{domain:window.location.hostname},{isCore:!0}),this.startConnection()}}class Ot{static getSourceId(){return Object(mt.a)("native")?Object(gt.i)():"OWADefault"}static async initializeSignalR(t,e,n,i){let o=i.sourceId?i.sourceId:Ot.getSourceId();if(Ot.connectionInstances.has(o)){let t=Ot.connectionInstances.get(o);4===t.getConnectionState()&&(await t.init(),D())}else{let r=new vt(t,e,n,i);await r.init(),Ot.connectionInstances.set(o,r),D()}}static stopConnection(){let t=Ot.getSourceId();if(Ot.connectionInstances.has(t)){Ot.connectionInstances.get(t).stopConnection()}}static retryDisconnection(){let t=Ot.getSourceId();if(Ot.connectionInstances.has(t)){Ot.connectionInstances.get(t).retryDisconnection()}}}Ot.connectionInstances=new Map;var kt=n(391),St=n(597),jt=n(2);async function wt(t){window.owaLogSignalRError=(t,e)=>{Object(et.j)("auth-reportSignalRError")&&Object(z.o)("ChannelInitNetworkFailure",e,{isCore:!0})};const e=(await n.e(2022).then(n.t.bind(null,18950,7))).default;window.$=e,window.jQuery=e,await n.e(2074).then(n.bind(null,18951)),Object(mt.a)("componentTokenProvider")&&null==t.getNotificationToken&&(t.getNotificationToken=(t,e)=>(function(t,e){let n=Object(St.n)()+Object(St.t)("/owa")+"/notificationchannel/";e&&Object(et.j)("auth-SignalRRoutingHint")&&(n=Object(St.n)()+Object(St.t)("/owa")+"/"+e+"/notificationchannel/");return Object(kt.getAccessTokenforResourceAsLazy)(n,"OwaNotifications",void 0,void 0,void 0,void 0,void 0,t)})(t,e)),null==t.appName&&(t.appName=Object(jt.m)());let i={state:0,channelId:null,mark:0,reconnectTimeout:t.minimumReconnectInterval,reconnectScheduled:!1,giveUpReconnecting:!1,checkReadyTimer:-1,notificationInactivityTimer:-1},o=$.signalR.transports._logic.getUrl;$.signalR.transports._logic.getUrl=(t,e,n,i,r)=>(t.appRelativeUrl=t.url,o(t,e,n,i,r));let r=$.connection(t.channelEndpoint),a={transport:[$.signalR.transports.serverSentEvents.name,$.signalR.transports.foreverFrame.name],pingInterval:t.pingInterval};await Ot.initializeSignalR(r,a,i,t)}function yt(){Ot.retryDisconnection()}function Ct(){window.owaNotification={subscribe:B,unsubscribe:W,getChannelId:Y},window.dispatchEvent(new Event("owaNotificationLoaded"))}n.d(e,"setup",(function(){return Ct})),n.d(e,"subscribe",(function(){return B})),n.d(e,"unsubscribe",(function(){return W})),n.d(e,"getChannelId",(function(){return Y})),n.d(e,"getChannelReady",(function(){return Z})),n.d(e,"NotificationEventType",(function(){return l})),n.d(e,"initializeNotificationManager",(function(){return wt})),n.d(e,"retryDisconnectionWithMinimumReconnectInterval",(function(){return yt})),n.d(e,"getNotificationEmitter",(function(){return h})),n.d(e,"handleNotification",(function(){return x})),n.d(e,"NotificationManager",(function(){return Ot}))},198:function(t,e,n){"use strict";var i=n(40);let o;function r(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var a=n(108);const c=500,u=[],s=[],d=[];let l=!0;function f(t,e){Object(i.g)((t,e,n)=>{l&&(e==i.b.Error&&s.push({message:t,error:n}),u.push({message:t,level:e}))}),t(h),e(h),r()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function b(t){const e=Object(a.a)(t);return l=!1,{traces:u,errors:s,network:d,usage:e}}function h(){l&&d.push(arguments)}n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return b})),n.d(e,"d",(function(){return a.b})),n.d(e,"c",(function(){return r}))},210:function(t,e,n){"use strict";e.decode=e.parse=n(367),e.encode=e.stringify=n(368)},214:function(t,e,n){"use strict";var i=n(22);e.a=(t,e)=>new Date(+t+e*i.g)},22:function(t,e,n){"use strict";n.d(e,"i",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return c})),n.d(e,"l",(function(){return u})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return d})),n.d(e,"j",(function(){return l})),n.d(e,"c",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"d",(function(){return h}));const i=6048e5,o=864e5,r=36e5,a=6e4,c=1e3,u=12,s=30,d=365,l=-864e13,f=864e13,b=Date.UTC(1601,0,1),h=Date.UTC(4501,0,1)},221:function(t,e,n){"use strict";var i=n(22);e.a=(t,e)=>new Date(+t+e*i.h)},231:function(t,e,n){"use strict";var i=n(20),o=n(3),r=Object(o.action)("ADD_ACCOUNT",t=>({accountSource:t})),a=Object(o.action)("SET_LOAD_STATE",t=>({loadState:t})),c=(Object(o.action)("ON_SELECTED_ACCOUNT_CHANGED",(t,e)=>({selectedAccountSourceId:t,selectedEmailAddress:e})),Object(o.action)("UPDATE_ACCOUNT",t=>({accountSource:t}))),u=n(40),s=n(268);function d(t){const e=Object(s.a)().sources.filter(e=>e.sourceId===t);return e.length>1&&Object(u.e)("DuplicateSourceIdFoundInStore"),e[0]}function l(){return d(Object(s.a)().selectedSourceId)}function f(){return Object(s.a)().sources.filter(t=>t.characteristics.supportsMail)}var b=n(507);Object(o.mutator)(r,t=>{const e=Object(s.a)();if(d(t.accountSource.sourceId))throw new Error("Found duplicated account in the store.");e.sources.push(t.accountSource),e.selectedSourceId||(e.selectedSourceId=t.accountSource.sourceId),e.globalSettingsSourceId||(e.globalSettingsSourceId=t.accountSource.sourceId)}),Object(o.mutator)(a,t=>{Object(s.a)().loadState=t.loadState}),Object(o.mutator)(c,t=>{const e=Object(s.a)();e.sources=e.sources.map(e=>e.sourceId===t.accountSource.sourceId?t.accountSource:e)});n.d(e,"j",(function(){return p})),n.d(e,"k",(function(){return m})),n.d(e,"e",(function(){return r})),n.d(e,"l",(function(){return a})),n.d(e,"m",(function(){return c})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return l})),n.d(e,"g",(function(){return s.a})),n.d(e,"h",(function(){return f})),n.d(e,"a",(function(){return b.a})),n.d(e,"b",(function(){return b.b})),n.d(e,"c",(function(){return b.c})),n.d(e,"d",(function(){return b.d}));const h=new i.c(()=>n.e(2030).then(n.bind(null,19310))),p=new i.b(h,t=>t.removeAccountById),m=(new i.b(h,t=>t.setGlobalSettingsAccount),new i.b(h,t=>t.setSelectedAccount))},245:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return s}));var i=n(370),o=n(463),r=n(462),a=n(452),c=n(13);function u(t){return t||(t=Object(c.a)().timezone),t?Object(i.a)({RequestServerVersion:"V2018_01_08",TimeZoneContext:Object(o.a)({TimeZoneDefinition:Object(r.a)({Id:t})})}):Object(i.a)({RequestServerVersion:"V2018_01_08"})}function s(t,e,n){return Object(a.a)({PropertySetId:t,PropertyName:e,PropertyType:n})}},258:function(t,e,n){"use strict";var i=n(77),o=n(3),r=n(14),a=n(259),c=n(6);var u=n(102),s=n(176);var d=n(150),l=n(122),f=n(299);n.d(e,"a",(function(){return h}));let b=!1;function h(){return b}const p=Object(o.action)("initializeFeatureFlags",t=>{const e=(t||[]).reduce((t,e)=>(t[e.toLowerCase()]=!0,t),{}),n=function(t=s.a){return t("ring-dogfood")?"Dogfood":t("ring-microsoft")?"Microsoft":t("ring-firstrelease")?"FirstRelease":t("ring-ww")?"WW":"Unknown"}(t=>e[t]);return m(e,function(t){return Object.keys(f.a).reduce((e,n)=>(e[n.toLowerCase()]=f.a[n].ring.indexOf(t)>-1,e),{})}(n)),Object(u.b)(n),Object(l.b)(function(t){let e={};for(let n of Object.keys(t))e[n]=t[n];return e}(e)),"Dogfood"==n&&m(e,Object(d.b)()),e["fwk-devtools"]&&m(e,function(t){for(const[e,n]of Object.entries(Object(c.d)()))if(e.toLowerCase()===t.toLowerCase())return Object(a.a)(n);return{}}("features")),e});function m(t,e){for(let n of Object.keys(e))t[n.toLowerCase()]=e[n]}Object(o.mutator)(p,t=>{Object(i.a)().featureFlags=new r.ObservableMap(t),b=!0});e.b=p},259:function(t,e,n){"use strict";function i(t){let e={};return t.split(",").forEach(t=>{let n=!0;0===t.indexOf("-")&&(n=!1,t=t.slice(1,t.length)),e[t.toLowerCase()]=n}),e}n.d(e,"a",(function(){return i}))},2651:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i{constructor(){this.eventDictionary={}}on(t,e,n){return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:e,callbackThis:n}),this}emit(t,...e){return(this.eventDictionary[t]||[]).slice().forEach(t=>t.callback.apply(t.callbackThis,e)),this}off(t,e){let n=this.eventDictionary[t];if(n){let i=n.filter(t=>t.callback!==e);i.length?this.eventDictionary[t]=i:delete this.eventDictionary[t]}return this}once(t,e,n){const i=this,o=(...r)=>(i.off(t,o),e.apply(n,r));return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:o,callbackThis:n}),this}}},268:function(t,e,n){"use strict";n.d(e,"b",(function(){return o}));var i=n(3);const o={loadState:n(507).b.Loading,selectedSourceId:"",globalSettingsSourceId:"",sources:[]},r=Object(i.createStore)("AccountSourceList",o);e.a=r},276:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var i=n(117),o=n(97),r=n(2);let a;function c(t){a=t}async function u(t){var e,n;if(Object(r.P)())return o.f.importAndExecute(Object(i.a)());const c=a&&await a(void 0,t);if(c&&c.length>0){if("bearer"===(null===(e=null==c?void 0:c.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return c.split(" ")[1];if("msauth1.0"===(null===(n=null==c?void 0:c.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return c}}},29:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(57);function o(){return i.a.userConfiguration}},299:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const i={"fwk-betterDiagnostics-panel":{ring:["Dogfood"]},"fwk-betterDiagnostics-service":{ring:["Dogfood"]},"fwk-feedbackCharm":{ring:["Dogfood","Microsoft"]}}},311:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));const i=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function r(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function a(t){return i.test(t)}},367:function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,r){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var c=/\+/g;t=t.split(e);var u=1e3;r&&"number"==typeof r.maxKeys&&(u=r.maxKeys);var s=t.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var l,f,b,h,p=t[d].replace(c,"%20"),m=p.indexOf(n);m>=0?(l=p.substr(0,m),f=p.substr(m+1)):(l=p,f=""),b=decodeURIComponent(l),h=decodeURIComponent(f),i(a,b)?o(a[b])?a[b].push(h):a[b]=[a[b],h]:a[b]=h}return a};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},368:function(t,e,n){"use strict";var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,c){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(a(t),(function(a){var c=encodeURIComponent(i(a))+n;return o(t[a])?r(t[a],(function(t){return c+encodeURIComponent(i(t))})).join(e):c+encodeURIComponent(i(t[a]))})).join(e):c?encodeURIComponent(i(c))+n+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function r(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},370:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"JsonRequestHeaders:#Exchange"},t)}n.d(e,"a",(function(){return i}))},392:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(70);function o(t){return Object(i.a)(t,[i.c])}},417:function(t,e,n){"use strict";class i{constructor(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(t){this.taskList.unshift(t),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(e,"a",(function(){return i}))},44:function(t,e,n){"use strict";var i=n(77),o=n(3);var r=Object(o.action)("UPDATE_ACTIVE_FLIGHTS",t=>({featureOverrides:t}));function a(t){if(!t)return[];let e=[];return["addin","an","auth","cal","cmp","doc","eventify","fms","fwk","getstarted","grp","gsx","help","honeybee","inline","iris","lightning","lpc","mc","notes","nps","peo","people","mc","platform","playMyEmails","rp","sea","sxs","todo","tra","tri","sig","mon","usv","woven"].forEach(n=>{Object.keys(t[n]||{}).forEach(i=>{!0===t[n][i]&&e.push(`${n}-${i}`)})}),e}Object(o.mutator)(r,t=>{for(const e of t.featureOverrides)Object(i.a)().featureFlags.set(e.name.toLowerCase(),e.isEnabled)});var c=n(14),u=n(176);function s(t,e){if(Object(u.a)(t))e();else{let n=Object(c.autorun)(()=>{Object(u.a)(t)&&(e(),n())})}}var d=n(258),l=n(150);let f=Object(o.action)("setFeatureFlag<T>",(t,e)=>({feature:t,isOn:e}));Object(o.mutator)(f,(function(t){Object(i.a)().featureFlags.set(t.feature.toLowerCase(),t.isOn)})),Object(o.orchestrator)(f,(function(t){let e=t.feature,n=t.isOn;Object(l.c)([{name:e.toLowerCase(),isEnabled:n}])}));var b=f,h=n(122);function p(){const t=Object(h.a)();for(let e of Object(i.a)().featureFlags.keys())b(e,!!t[e]);Object(l.a)()}function m(){return Object.keys(Object(h.a)())}const g="fwk-uberflag",v="fwk-consumer",O="fwk-business";function k(){return w().includes(g)?1:0}function S(t){const e=w();return t&&e.includes(v)&&!e.includes(O)||!t&&e.includes(O)&&!e.includes(v)?1:0}let j;function w(){return j||(j=m().filter(t=>t===g||t===v||t===O)),j}function y(t){const e=Object(i.a)().featureFlags;return[...e.keys()].filter(n=>0==n.indexOf(t)&&e.get(n.toLowerCase()))}n.d(e,"d",(function(){return C})),n.d(e,"c",(function(){return a})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return d.b})),n.d(e,"j",(function(){return u.a})),n.d(e,"l",(function(){return b})),n.d(e,"k",(function(){return p})),n.d(e,"n",(function(){return l.c})),n.d(e,"m",(function(){return r})),n.d(e,"e",(function(){return m})),n.d(e,"a",(function(){return k})),n.d(e,"b",(function(){return S})),n.d(e,"f",(function(){return h.a})),n.d(e,"g",(function(){return y}));let C=Object(i.a)().featureFlags},452:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"ExtendedPropertyUri:#Exchange"},t)}n.d(e,"a",(function(){return i}))},462:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"TimeZoneDefinitionType:#Exchange"},t)}n.d(e,"a",(function(){return i}))},463:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"TimeZoneContext:#Exchange"},t)}n.d(e,"a",(function(){return i}))},507:function(t,e,n){"use strict";var i,o,r,a;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return a})),function(t){t[t.Loading=0]="Loading",t[t.Loaded=1]="Loaded",t[t.Error=2]="Error"}(i||(i={})),function(t){t[t.AAD=0]="AAD",t[t.MSA=1]="MSA"}(o||(o={})),function(t){t.UserMailbox="UserMailbox",t.GroupMailbox="GroupMailbox",t.TeamsMailbox="TeamsMailbox",t.PublicMailbox="PublicMailbox",t.SharedMailbox="SharedMailbox",t.ArchiveMailbox="ArchiveMailbox"}(r||(r={})),function(t){t.Office365="Office365",t.OutlookDotCom="Outlook",t.Goolge="Google",t.ICloud="ICloud",t.Yahoo="Yahoo"}(a||(a={}))},516:function(t,e,n){"use strict";n(707);var i=n(231),o=n(40);function r(t){if(t){const e=Object(i.g)().sources.filter(e=>{var n;return(null===(n=null==e?void 0:e.m365mailbox)||void 0===n?void 0:n.userIdentity)===t});return 0===e.length&&Object(o.e)("SourceIdNotFoundForUserIdentity"),e[0].sourceId}const e=Object(i.i)();return e||Object(o.e)("NoSelectedAccountForDefaultUserIdentity"),e.sourceId}n(12);let a={};function c(t){a=Object.assign(Object.assign({},a),t)}async function u(t){return a.addM365Account||Object(o.e)("NoPluggableMethodAddM365Account"),a.addM365Account(t)}async function s(t){return a.addOutlookDotComAccount||Object(o.e)("NoPluggableMethodAddOutlookDotComAccount"),a.addOutlookDotComAccount(t)}async function d(t){return a.removeAccount||Object(o.e)("NoPluggableMethodRemoveAccount"),a.removeAccount(t)}function l(){let t=Object(i.i)();return t||Object(o.e)("NoAccountSelected"),t.sourceId}async function f(t){Object(i.f)(t)||Object(o.e)("SelectedAccountNotFound"),await async function(t){if(a.preSelectAccount)return a.preSelectAccount(t)}(t),(await i.k.import())(t)}var b,h,p,m;!function(t){t.Mailbox="MAILBOX"}(b||(b={})),function(t){t.Microsoft365="MICROSOFT365",t.OutlookDotCom="OUTLOOKDOTCOM"}(h||(h={})),function(t){t.GetAuthTokenFailed="INVALIDCREDENTIALS",t.CouldNotConnect="CONNECTFAILED",t.DuplicateAccount="DUPLICATE"}(p||(p={})),function(t){t.AccountNotFound="NOT_FOUND"}(m||(m={}));const g="main",v="m365",O=":";function k(t,e,n){return t+O+e+O+n}function S(t){const e=Object(i.f)(t);return e?{type:e.m365mailbox.type,userIdentity:e.m365mailbox.userIdentity,mailboxSmtpAddress:e.m365mailbox.emailAddress}:void 0}function j(t,e){const n=Object.assign(Object.assign({},e.characteristics),{isMicrosoft365Hosted:!0}),o=e.mailbox?Object.assign(Object.assign({},e.mailbox),{type:i.d.UserMailbox,logonEmailAddress:e.mailbox.loginAddress,authProviderType:e.authProviderType===h.Microsoft365?i.c.AAD:i.c.MSA}):void 0;return{sourceId:t,sourceType:e.authProviderType===h.Microsoft365?i.a.Office365:i.a.OutlookDotCom,displayName:e.displayName,characteristics:n,m365mailbox:o}}function w(t){const e=k(g,v,t.mailbox.userIdentity);return Object(i.f)(e)||Object(i.e)(j(e,t)),e}function y(t){const e=k(g,v,t.mailbox.userIdentity);return Object(i.f)(e)&&Object(i.m)(j(e,t)),e}n.d(e,"j",(function(){return r})),n.d(e,"n",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return s})),n.d(e,"k",(function(){return d})),n.d(e,"i",(function(){return l})),n.d(e,"l",(function(){return f})),n.d(e,"e",(function(){return w})),n.d(e,"h",(function(){return S})),n.d(e,"m",(function(){return y})),n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return m})),n.d(e,"d",(function(){return b})),n.d(e,"c",(function(){return h}))},57:function(t,e,n){"use strict";var i=n(3),o=n(14);const r={userConfiguration:{},connectedAccountsUserConfigurationMap:new o.ObservableMap({}),defaultFolderNameToIdMap:new o.ObservableMap({}),defaultFolderIdToNameMap:new o.ObservableMap({})},a=i.createStore("owaSessionStore",r)();e.a=a},597:function(t,e,n){"use strict";var i=n(392),o=n(30),r=n(70);function a(t){return Object(r.a)(t,[r.b])}var c=n(31),u=n(55);function s(t){return Object(c.b)(Object(c.c)(Object(c.a)(Object(u.a)()||"",t)))}var d=n(921),l=n(919),f=n(177);let b,h,p;function m(){return b||(b=Object(o.a)("/calendar")+"/"),b}function g(){return h||(h=Object(o.a)("/mail")+"/"),h}function v(){return p||(p=Object(o.a)("/files")+"/"),p}var O=n(922);let k,S,j;function w(t){return k&&S===t||(S=t,k=t?Object(o.a)("/people/group/owner")+"/":Object(o.a)("/people/group/member")+"/"),k}function y(){return j||(j=Object(o.a)("/people/group/deleted")+"/"),j}function C(t){return window.location.origin+m()+"showPeek/item/"+encodeURIComponent(t)}var T=n(957),I=n(6),R=n(710);const x=Object(T.a)().split("/").slice(1).join("/")+"deeplink/";function A(t,e,n,i){n&&((i=i||{}).minus="");let o="";if(i){const t=Object(I.d)();Object(R.a)(t),Object.keys(i).filter(t=>t).forEach(e=>t[e]=i[e]),o="?"+Object(I.i)(t)}return`${`/${t}/${x}`}${e}${o}`}var D=n(178),N=n(29);const E="https://to-do.microsoft.com";function M(t,e){var n,i;const o=Object(N.a)(),r=o.UserOptions,a=null===(n=o.SessionSettings)||void 0===n?void 0:n.UserPrincipalName;let c=E,u={};if(null===(i=null==r?void 0:r.ReactOptinSettings)||void 0===i?void 0:i.TasksRedirectUrl){let t="";[c,t]=r.ReactOptinSettings.TasksRedirectUrl.split("?"),u=Object(I.g)(t),a&&(u.auth_upn=a)}return t&&(u.utm_source=t),e&&delete u.fromOwa,Object.keys(u).length>0?Object(f.a)(c,u):c}let _;function F(){return _||(_=Object(o.a)("/eventify")+"?entryPoint=owa"),_}var L=n(117);let P;function U(){return P||(P=Object(o.a)("/host")+"/"),P}n(36);n.d(e,"k",(function(){return i.a})),n.d(e,"t",(function(){return o.a})),n.d(e,"g",(function(){return a})),n.d(e,"m",(function(){return s})),n.d(e,"s",(function(){return d.a})),n.d(e,"x",(function(){return c.a})),n.d(e,"a",(function(){return c.b})),n.d(e,"b",(function(){return c.c})),n.d(e,"o",(function(){return l.a})),n.d(e,"v",(function(){return f.a})),n.d(e,"e",(function(){return m})),n.d(e,"l",(function(){return g})),n.d(e,"h",(function(){return v})),n.d(e,"p",(function(){return O.a})),n.d(e,"j",(function(){return w})),n.d(e,"i",(function(){return y})),n.d(e,"d",(function(){return C})),n.d(e,"q",(function(){return A})),n.d(e,"w",(function(){return D.a})),n.d(e,"u",(function(){return M})),n.d(e,"f",(function(){return F})),n.d(e,"n",(function(){return L.a})),n.d(e,"r",(function(){return u.a})),n.d(e,"c",(function(){return U}))},707:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));var i=n(121),o=n(12);function r(){return Object(i.a)("acctmonaccounts")&&Object(o.i)("acctmonaccounts")}function a(){return r()||!Object(i.a)("acctmonaccounts")&&Object(o.i)("accountsapi")}},710:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));const i=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function o(t){t&&Object.keys(t).forEach(e=>{i.includes(e)&&delete t[e]})}},77:function(t,e,n){"use strict";var i=n(3);let o={featureFlags:new(n(14).ObservableMap)};e.a=Object(i.createStore)("featureFlags",o)},919:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(36),o=n(30),r=n(117);function a(t){let e=Object(i.b)(),n=Object(r.a)()+Object(o.a)("/owa")+"/",a=e.search&&e.search.length>0;n+=a?e.search:"?";let c=Object.keys(t),u=a;for(let e=0;e<c.length;e++)u?n+="&":u=!0,n+=c[e]+"="+t[c[e]];return n}},921:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(6),o=n(710);function r(){const t=Object(i.d)();Object(o.a)(t);const e=Object(i.i)(t);return e.length>0?"?"+e:""}},922:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(30);let o;function r(){return o||(o=Object(i.a)("/people")+"/"),o}},957:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(55),o=n(30);function r(t){return(Object(o.a)("/"+(t||Object(i.a)()))+"/").replace(/^\//,"")}}}]);
//# sourceMappingURL=owa.663.js.map
self.scriptsLoaded['owa.663.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.663.js'] = (new Date()).getTime();