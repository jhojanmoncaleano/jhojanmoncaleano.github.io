self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.670.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[670],{10127:function(t,e,n){var r=n(15e3);"string"==typeof r&&(r=[[t.i,r,""]]);var i={transform:void 0};n(66)(r,i);r.locals&&(t.exports=r.locals)},15e3:function(t,e,n){(e=t.exports=n(65)(!1)).push([t.i,'._2EnQH_qnZa3tsseoz2OksO{display:inline-block;position:relative;vertical-align:top;cursor:pointer}html[dir] ._2EnQH_qnZa3tsseoz2OksO{background:var(--neutralLighter);border-radius:2px}html[dir=ltr] ._2EnQH_qnZa3tsseoz2OksO{margin:0 4px 0 0}html[dir=rtl] ._2EnQH_qnZa3tsseoz2OksO{margin:0 0 0 4px}html[dir] ._2EnQH_qnZa3tsseoz2OksO .ms-Image{border-radius:2px}.YW7SdZqiKR_Pr5gy0q5uY,._3OsbPUfbnUODkp6XOjt9Jf{height:48px;width:132px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-line-pack:start;align-content:flex-start;-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] .YW7SdZqiKR_Pr5gy0q5uY,html[dir] ._3OsbPUfbnUODkp6XOjt9Jf{padding:8px;background:var(--white);border-radius:2px;border:solid 1px var(--neutralTertiaryAlt)}.YW7SdZqiKR_Pr5gy0q5uY._2lac5JBzXedVN9vyCmQEUp,._2lac5JBzXedVN9vyCmQEUp._3OsbPUfbnUODkp6XOjt9Jf{height:36px}html[dir] .YW7SdZqiKR_Pr5gy0q5uY:hover,html[dir] ._3OsbPUfbnUODkp6XOjt9Jf:hover{background:var(--neutralLighterAlt);border-color:var(--neutralTertiary)}html[dir] .YW7SdZqiKR_Pr5gy0q5uY:active,html[dir] ._3OsbPUfbnUODkp6XOjt9Jf:active{background:var(--neutralLighter)}._3OsbPUfbnUODkp6XOjt9Jf{height:28px}html[dir] ._3OsbPUfbnUODkp6XOjt9Jf{padding:4px 8px}._3OsbPUfbnUODkp6XOjt9Jf._3RBDMyvD7nR62F64Cu9urx,._3OsbPUfbnUODkp6XOjt9Jf._2lac5JBzXedVN9vyCmQEUp{height:24px}._yOeB2zh3x1wGEcu4--2t{-ms-flex-wrap:wrap;flex-wrap:wrap;display:-webkit-box;display:-ms-flexbox;display:flex}._3KSZG0_mb3de4yh7ubmRuf{width:64px;height:48px}._3KSZG0_mb3de4yh7ubmRuf._3RBDMyvD7nR62F64Cu9urx,._3KSZG0_mb3de4yh7ubmRuf._2lac5JBzXedVN9vyCmQEUp{width:48px;height:36px}.GHq-XW_x-6qhgF4J84OpM{font-size:30px;color:var(--neutralTertiaryAlt)}html[dir] .GHq-XW_x-6qhgF4J84OpM{background:transparent}.GHq-XW_x-6qhgF4J84OpM+div{display:none}.jGabA1JObx3WyLsOF0_lW{height:100%;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir] .jGabA1JObx3WyLsOF0_lW{border:solid 1px var(--neutralTertiaryAlt);border-radius:2px;background:var(--white)}html[dir] .jGabA1JObx3WyLsOF0_lW:hover{background:var(--neutralLighterAlt);border-color:var(--neutralTertiary)}html[dir] .jGabA1JObx3WyLsOF0_lW:active{border-color:var(--neutralTertiary);background:var(--neutralLighter)}html[dir] .jGabA1JObx3WyLsOF0_lW>span>div{margin:-1px}._18ukPNYK4IqWXU7HFUbm_i{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir=ltr] ._18ukPNYK4IqWXU7HFUbm_i{margin-right:4px}html[dir=rtl] ._18ukPNYK4IqWXU7HFUbm_i{margin-left:4px}.WPnCNwu9eVjpi6Qth6jDy,._1YG0Z7C0qvbOP7WVsVp7K_{font-size:12px;font-weight:400;width:94px}._1YG0Z7C0qvbOP7WVsVp7K_{text-decoration:underline}._3diIn4mkDOFXDmYIbfXht-,._3A1yEKoFPCIvk-r7RQ_TUJ{font-size:10px;max-width:94px}html[dir=ltr] ._3A1yEKoFPCIvk-r7RQ_TUJ{margin-left:20px}html[dir=rtl] ._3A1yEKoFPCIvk-r7RQ_TUJ{margin-right:20px}._2amwvZ1h3bQB70bAlLM6Ue{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] ._2amwvZ1h3bQB70bAlLM6Ue{border-width:1px;border-style:solid;padding:0 4px;background:var(--neutralTertiary)}html[dir=ltr] ._2amwvZ1h3bQB70bAlLM6Ue{left:0}html[dir=rtl] ._2amwvZ1h3bQB70bAlLM6Ue{right:0}',""]),e.locals={attachmentView:"_2EnQH_qnZa3tsseoz2OksO",attachmentDocView:"YW7SdZqiKR_Pr5gy0q5uY",shortAttachmentDocView:"_3OsbPUfbnUODkp6XOjt9Jf",medium:"_2lac5JBzXedVN9vyCmQEUp",compact:"_3RBDMyvD7nR62F64Cu9urx",twoRowView:"_yOeB2zh3x1wGEcu4--2t",attachmentImageView:"_3KSZG0_mb3de4yh7ubmRuf",placeholder:"GHq-XW_x-6qhgF4J84OpM",imageContainerDiv:"jGabA1JObx3WyLsOF0_lW",iconCompactMode:"_18ukPNYK4IqWXU7HFUbm_i",infoCompactModeFirstLine:"WPnCNwu9eVjpi6Qth6jDy",infoCompactModeFirstLineLink:"_1YG0Z7C0qvbOP7WVsVp7K_",infoCompactModeSecondLine:"_3diIn4mkDOFXDmYIbfXht-",infoCompactModeSecondLineSingleRow:"_3A1yEKoFPCIvk-r7RQ_TUJ",dragPreview:"_2amwvZ1h3bQB70bAlLM6Ue"}},1699:function(t,e,n){"use strict";function r(t){if(!t)return null;const e=t.lastIndexOf(".");return e>0?t.substr(e).toLowerCase():null}function i(t){const e=r(t);return e?e.replace(".",""):null}function a(t){var e;return(null===(e=i(t))||void 0===e?void 0:e.substring(0,4))||""}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a}))},1702:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Base64InlineImage=0]="Base64InlineImage",t[t.Cloud=1]="Cloud",t[t.Local=2]="Local",t[t.MailItem=3]="MailItem",t[t.Uri=4]="Uri",t[t.AttachmentItem=5]="AttachmentItem",t[t.CloudSuggestion=6]="CloudSuggestion",t[t.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",t[t.Inline=8]="Inline",t[t.Smime=9]="Smime",t[t.FilesHub=10]="FilesHub",t[t.GroupFilesHub=11]="GroupFilesHub",t[t.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",t[t.Unknown=13]="Unknown",t[t.ContextualSuggestion=14]="ContextualSuggestion",t[t.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",t[t.SmartDoc=16]="SmartDoc",t[t.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1715:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach(n=>t.set(n,e[n]))}function i(t){let e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},1718:function(t,e,n){"use strict";var r=n(1787),i=n(272),a=n(1686),o=n(61),c=n(7),u=n(40);const s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",m="X-OWA-ExplicitLogonUser";async function f(t,e){const n={},f=Object(i.k)(t);if(e?(n[s]=e,n[m]=e):f&&(n[s]=f.anchorMailbox),Object(i.s)())return u.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(f){if(f.accountState==i.b.AccessRevoked)return null;if(f.accountState==i.b.AccountDeprovisioned||f.accountState==i.b.AccountNotFound)return Object(i.d)(f.accountState,f.accountProviderType),null}if(f){let e,i=f.token,s=Object(a.g)(f.tokenExpiry);!s&&i||(Object(o.o)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(f.tokenExpiry,Object(c.Ub)()),isTokenExpired_1:s,isTokenInvalid_2:!i},{isCore:!0}),i=await r.a.importAndExecute(f.accountId,t,i),u.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+t+i),i||(i="")),"Outlook"==f.accountProviderType?(e=`MSAuth1.0 usertoken="${i}", type="MSACT"`,n[l]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType&&"Yahoo"!=f.accountProviderType||(e=`Bearer ${i}`,n[l]=2..toString()),n[d]=e}return n}var b=n(1715),h=n(914);async function p(t,e){var n;const r=Object(b.a)();if(r.headers=await async function(t,e){var n;const r=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,i=await f(t.mailboxInfo.userIdentity,w(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null);return Object(b.b)(r,i),r}(t,e),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},Object(i.s)()){const e=Object(h.a)(null===(n=null==t?void 0:t.mailboxInfo)||void 0===n?void 0:n.userIdentity);u.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+e),r.sourceId=e,r.datapoint.mailbox="Connected"}else r.datapoint.mailbox="Connected";return r}function w(t,e){const n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&u.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return w}))},1721:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("triggerReInitializeAccount",t=>({userIdentity:t}))},1724:function(t,e,n){"use strict";var r=n(1699),i=n(1959),a=n(5);function o(t){let e;return t>=1073741824?(t/=1073741824,e=Object(a.b)(i.b)):t>=1048576?(t/=1048576,e=Object(a.b)(i.d)):t>=1024?(t/=1024,e=Object(a.b)(i.c)):e=Object(a.b)(i.a),Object(a.c)(e,Math.round(t))}var c=n(1799),u=n(44);const s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(t){if(!Object(u.j)("doc-attachment-documentThumbnail"))return!1;const e=Object(r.a)(t);return!!e&&s.indexOf(e.toLowerCase())>=0}var l;function m(t){switch(t){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return l.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return l.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return l.PowerPoint;default:return null}}!function(t){t[t.Word=0]="Word",t[t.Excel=1]="Excel",t[t.PowerPoint=2]="PowerPoint"}(l||(l={}));var f=n(1762);n.d(e,"b",(function(){return r.a})),n.d(e,"c",(function(){return r.b})),n.d(e,"d",(function(){return r.c})),n.d(e,"i",(function(){return o})),n.d(e,"g",(function(){return c.a})),n.d(e,"h",(function(){return d})),n.d(e,"f",(function(){return m})),n.d(e,"e",(function(){return f.b})),n.d(e,"a",(function(){return l}))},1738:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1940);function i(t){if(!t)return null;return Object(r.a)().attachments.get(t.Id)}},1751:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return c}));const r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",a="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1762:function(t,e,n){"use strict";function r(t){return function(t){const e=a.exec(t);return e&&e.length>1&&i[e[1].toLowerCase()]}(t||"")}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function o(t){let e="";return Object.entries(i).forEach(n=>{n[1]===t&&(e=n[0])}),e}},1787:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(20),i=n(1721);n.d(e,"b",(function(){return i.a}));const a=new r.c(()=>n.e(1045).then(n.bind(null,2021))),o=new r.a(a,t=>t.getAndUpdateAccessToken)},1799:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return s}));var r=n(1699),i=n(1762),a=n(169);const o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(t,e,n=!0){return s(Object(r.a)(t)||Object(i.a)(e),n)}function s(t,e=!0){return!!t&&(o.indexOf(t.toLowerCase())>=0||e&&c.indexOf(t.toLowerCase())>=0&&(Object(a.c)()||Object(a.f)()))}},1822:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1751);function i(t){return(t.__type||t.OwsTypeName)===r.e}},1865:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return d})),n.d(e,"j",(function(){return l})),n.d(e,"k",(function(){return m})),n.d(e,"l",(function(){return f})),n.d(e,"d",(function(){return b}));const r="Box",i="Dropbox",a="Facebook",o="GDrive",c="Mailbox",u="MailMessage",s="OneDriveConsumer",d="OneDrivePro",l="WopiBox",m="WopiDropbox",f="WopiEgnyte",b={BOX:r,DROPBOX:i,FACEBOOK:a,GDRIVE:o,MAILBOX:c,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:l,WOPI_EGNYTE:f}},19270:function(t,e,n){"use strict";n.r(e);var r=n(1932),i=n(4227),a=n(1846),o=n(1679),c=n(4116),u=n(2495),s=n(1692),d=n(1859),l=n(797),m=n(3),f=n(44),b=n(3537),h=n(6575);Object(m.orchestrator)(a.d,t=>{if(t.mailListItemSelectionSource===s.b.MailListItemRichPreview){const e=Object(c.getRowIdString)(t.rowKey,t.tableView),n=Object(d.l)(t.sxsId).attachmentViewStateIdFromListView,a=o.Z.attachmentViewStates.get(n),s=Object(u.a)([t.rowKey],t.tableView);l.h.importAndExecute(l.p),async function(t,e,n,a,o){const c=Object(h.a)(t.attachmentId);let u;if(Object(f.j)("doc-SxS-jsApi-ODB-Links")&&c){const e=await b.a.import();u=await e(t,r.c.MailList,o,null)}c&&u||Object(i.b)(t,r.c.MailList,e[0],t.parentItemId,!1,null,async()=>{return(await d.r.import())(n.rowAttachmentPreviewWellViews.get(a).imageViewStateIds,t=>n.attachmentViewStates.get(t))},null,o)}(a,s,o.Z,e,window)}});const p=Object(m.action)("onAttachmentViewStateIdChange",(t,e)=>({attachmentViewStateId:t,sxsId:e}));Object(m.mutator)(p,t=>{const{attachmentViewStateId:e,sxsId:n}=t;Object(d.l)(n).attachmentViewStateIdFromListView=e});var w=n(21),O=n(1738),g=n(0),v=n(3634),x=n(2789),j=n(114),I=n(10127),y=n.n(I),S=n(147),A=n.n(S);const k=A.a.bind(y.a);function _(t){const e=3===(t=Object.assign({attachment:Object(O.a)(t.attachmentViewState.attachmentId)},t)).attachment.type,n=t.isShortDocView,r=Object(f.j)("mon-densities");let i=Object(j.e)();return n?g.createElement("div",{className:k(r&&i,y.a.shortAttachmentDocView)},g.createElement(v.d,{attachmentId:t.attachmentViewState.attachmentId,className:y.a.iconCompactMode,iconSize:0}),g.createElement(v.a,{attachmentViewState:t.attachmentViewState,attachment:t.attachment,firstLineStyle:e?y.a.infoCompactModeFirstLineLink:y.a.infoCompactModeFirstLine,secondLineStyle:y.a.infoCompactModeSecondLineSingleRow,isShortDocView:n,highlightAttachmentName:E})):g.createElement("div",{className:k(r&&i,y.a.attachmentDocView)},g.createElement(v.d,{attachmentId:t.attachmentViewState.attachmentId,className:y.a.iconCompactMode,iconSize:0}),g.createElement("div",{className:y.a.twoRowView},g.createElement(v.a,{attachmentViewState:t.attachmentViewState,attachment:t.attachment,firstLineStyle:e?y.a.infoCompactModeFirstLineLink:y.a.infoCompactModeFirstLine,secondLineStyle:y.a.infoCompactModeSecondLine,isShortDocView:n,highlightAttachmentName:E})))}function E(t){Object(x.a)(t)}var P=n(1724),C=n(2565);const D=A.a.bind(y.a);var U=Object(w.a)((function(t){const e=Object(O.a)(t.attachmentViewState.attachmentId).model.Name;let n=null;const r=Object(C.g)(e),i=r.small;let a={className:y.a.placeholder,iconName:"Photo2"};Object(P.h)(e)&&(n=i,a={className:D(r.small,a.className),iconName:void 0});let o=48;const c=Object(j.e)();return Object(f.j)("mon-densities")&&"full"!=c&&(o=36),g.createElement("span",null,g.createElement("div",{className:y.a.imageContainerDiv},g.createElement(v.e,{attachmentViewState:t.attachmentViewState,placeHolder:a,fileIconCssClass:n,imageLoadErrorCSSClass:i,thumbnailWidth:64,thumbnailHeight:o})))})),V=n(7441),L=n(1978),M=n(1745),T=n(3137);const R=A.a.bind(y.a);var F=Object(w.a)((function(t){const e={get(){const t={onClick:n};return Object(T.a)(t)}},n=e=>{p(t.attachmentViewStateId,null),t.onPreviewClick(e)},r={attachmentImageView:t.isImage},i=Object(f.j)("mon-densities"),a=Object(O.a)(t.attachmentViewState.attachmentId);return g.createElement("div",Object.assign({},e.get(),{onClick:n,title:a.model.Name,className:R(i&&Object(j.e)(),y.a.attachmentView,r)}),g.createElement(L.b,{canDrag:()=>!!Object(O.a)(t.attachmentViewState.attachmentId),getDragData:()=>{const e=Object(O.a)(t.attachmentViewState.attachmentId).model,n=Object(V.a)(e);return{itemType:M.a.Attachment,attachmentFile:n}},getDragPreview:()=>{const e=document.createElement("div");return e.className=y.a.dragPreview,e.innerText=Object(O.a)(t.attachmentViewState.attachmentId).model.Name,e},xOffset:-12,yOffset:5},t.isImage?g.createElement(U,{attachmentViewState:t.attachmentViewState}):g.createElement(_,{attachmentViewState:t.attachmentViewState,isShortDocView:t.isShortDocView})))}));n.d(e,"AttachmentCompactView",(function(){return F}))},1959:function(t){t.exports=JSON.parse('{"b":"Mda","d":"Nda","c":"Oda","a":"Pda"}')},2036:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(5),i=n(283),a=n(50),o=n(2199),c=n(96),u=n(2),s=n(30),d=n(2039),l=n(2037);function m(t,e,n,m=!1,f=null){if(!t||!t.Id||!t.mailboxInfo)return null;const b=Object(d.b)(t.mailboxInfo),h=null==b?void 0:b.downloadUrlBase,p=Object(l.a)(t.mailboxInfo);if(f=f||Object(r.c)(e,encodeURIComponent(t.Id)),!h||m&&"Firefox"===Object(c.a)().browser){const t=o.e+f+"&X-OWA-CANARY="+Object(a.a)();return Object(s.a)(t)}let w="{0}{1}/{2}";Object(i.a)()&&(w+="&isc=1");let O=Object(r.c)(w,h,p,f);return n&&(O+="&token="+(null==b?void 0:b.downloadToken),O+="&X-OWA-CANARY="+Object(a.a)()),O+="&owa="+window.location.hostname,O+="&scriptVer="+Object(u.u)()||!1,O}},2037:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(209),i=n(272);function a(t){if("ArchiveMailbox"==t.type)return Object(r.a)();const e=t.userIdentity&&Object(i.r)(t.userIdentity),n="GroupMailbox"===t.type;return e&&!n?Object(r.b)(t.mailboxSmtpAddress)+t.userIdentity:"UserMailbox"===t.type?Object(r.a)():t.mailboxSmtpAddress}},2039:function(t,e,n){"use strict";var r=n(272);const i={};function a(t){return i[t]}function o(t,e){const n=i[t];i[t]=Object.assign(Object.assign({},n),e)}var c=n(49),u=n(707),s=n(61),d=n(914),l=n(807),m=n(32);var f=n(40),b=n(1718),h=n(1715);const p=Object(l.b)({timeBetweenRetryInMS:()=>3e4});async function w(t){const e=async()=>{try{let e={};return Object(u.b)()?e={sourceId:Object(d.a)(null==t?void 0:t.userIdentity)}:Object(r.r)(t.userIdentity)&&(e=await async function(t){let e={};e.headers=new Headers;const n=await Object(b.a)(t);return Object(h.b)(e.headers,n),e}(t.userIdentity)),function(t){return Object(m.a)("GetAttachmentDownloadToken",{},t)}(e)}catch(t){throw f.h.warn(`Unable to get the download token ${t}`),t.networkError=!0,t}},n=a(t.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){o(t.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:r}=p(async()=>{n++;const r=await e();f.h.info("update new token"),o(t.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),i=new s.c("AttachmentRefreshDownloadToken");try{await r(),i.addCustomData([n]),i.end()}catch(e){f.h.warn(`Retry to refresh token failed: ${e}`),i.addCustomData([n]),i.endWithError("ServerError",e),o(t.userIdentity,{isRefreshingDownloadToken:!1})}}}function O(t){const e=Object(r.r)(t.userIdentity)?Object(c.h)(t.userIdentity):Object(c.g)(),n=null==e?void 0:e.ApplicationSettings;if(n){const e=n.DownloadUrlBase;o(t.userIdentity,{downloadUrlBase:e,downloadToken:n.FirstDownloadToken}),e&&function(t,e){e=e<1?1:e,Object(u.b)()&&w(t),setInterval(()=>{w(t)},6e4*e)}(t,n.DownloadTokenRefreshMinutes)}}var g=n(266);function v(t){const e=Object(r.j)(null==t?void 0:t.userIdentity),n=a(null==t?void 0:t.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(e){case null:case"Office365":case"Outlook":O(t);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(g.a)(e)}const i=a(t.userIdentity);return i||(Object(s.o)("FilesUrlDataNotFound",{accountProviderType:e}),f.h.warn("Unable to get the url data")),i}function x(t){if(!t)return null;const e=v(t);return null==e?void 0:e.downloadToken}n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return x}))},2112:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(945);function i(t){var e;return null===(e=r.a.projections)||void 0===e?void 0:e.filter(e=>e.tabId==t||e.window==t)[0]}},2199:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return s})),n.d(e,"h",(function(){return d}));const r="/owa/",i="service.svc/s/GetFileAttachment?id={0}",a="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",o="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",u="service.svc/s/GetAttachmentThumbnail?id={0}",s="pdfprint.aspx?id={0}",d="pdfprint.aspx?id={0}&location={1}"},2206:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a}));var r=n(2065);function i(t){return o(t.type)}function a(t){return o(Object(r.a)(t))}function o(t){return 1===t||3===t}},2251:function(t,e,n){"use strict";var r=n(266),i=n(5),a=n(50),o=n(2199);const c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var u=n(2036),s=n(30);function d(t,e,n,d,l=0,m=0,f=!0,b=null,h=null){let p;switch(n){case 0:p=o.f;break;case 3:p=o.h;break;case 1:if(!function(t){if(!t)return!1;let e=null;const n=t.lastIndexOf(".");return n>0&&(e=t.substr(n).toLowerCase()),!!e&&c.indexOf(e.toLowerCase())>=0}(b))return null;p=o.g;break;default:Object(r.a)(n)}let w=d?m:l;!w&&l&&(w=l);let O=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(p,encodeURIComponent(t.Id),encodeURIComponent(e)),w);const g=Object(u.a)(t,p,!0,3===n,O);if(g)return g;let v=Object(i.c)("{0}{1}{2}",o.e,h,O);if(f){v=`${v}&X-OWA-CANARY=${Object(a.a)()}`}return Object(s.a)(v)}function l(t,e,n=!1,a=!0){let c;switch(e){case 0:c=o.a;break;case 1:c=o.b;break;case 2:c=o.d;break;case 3:c=o.c;break;default:return Object(r.a)(e)}if(!Object(i.k)(c)){const r=Object(u.a)(t,c,a,3===e);return Object(i.c)("{0}{1}{2}",r,n?"&isDownload=true":"","&animation=true")}return null}n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return l}))},2268:function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"f",(function(){return s}));var r=n(3);const i=Object(r.action)("tryProcessOneDriveLink",(t,e,n,r,i)=>({element:t,itemId:e,allElements:n,fromQuotedBody:r,itemClass:i})),a=Object(r.action)("tryUndoProcessOneDriveLink",t=>({elements:t})),o=Object(r.action)("TRY_MANAGE_ONE_DRIVE_LINKS_STATE",t=>({itemId:t})),c=Object(r.action)("previewLinkInSxS",(t,e,n,r,i)=>({wacUrlGetter:t,itemId:e,targetWindow:n,selectionSource:r,isMailMessage:i})),u=Object(r.action)("PREVIEW_BEAUTIFUL_LINK_IMAGE_IN_SXS_FROM_READING_PANE",(t,e,n,r,i)=>({linkId:t,readOnly:e,window:n,parentItemId:r,isMailMessage:i})),s=Object(r.action)("VERIFY_LINK_DATA",(t,e,n,r)=>({linksContainerId:t,linkSharingInformation:e,allElements:n,fromQuotedBody:r}))},2334:function(t,e,n){"use strict";n.d(e,"m",(function(){return a})),n.d(e,"l",(function(){return o})),n.d(e,"o",(function(){return c})),n.d(e,"q",(function(){return u})),n.d(e,"p",(function(){return s})),n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return l})),n.d(e,"g",(function(){return m})),n.d(e,"h",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"n",(function(){return h})),n.d(e,"r",(function(){return p})),n.d(e,"c",(function(){return w})),n.d(e,"d",(function(){return O})),n.d(e,"j",(function(){return g})),n.d(e,"f",(function(){return v})),n.d(e,"i",(function(){return x})),n.d(e,"a",(function(){return j}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(0),n.e(9),n.e(10),n.e(12),n.e(13),n.e(17),n.e(20),n.e(24),n.e(25),n.e(26),n.e(47),n.e(50),n.e(54),n.e(103),n.e(339),n.e(500)]).then(n.bind(null,4099))),a=new r.a(i,t=>t.onSmimeItemAttachmentOpened),o=new r.a(i,t=>t.mergeSmimeDecodedMessageProperties),c=(new r.b(i,t=>t.fetchAndDecodeSmimeMessage),new r.b(i,t=>t.setSmimePropertiesInDraftMessage)),u=new r.b(i,t=>t.trySetSmimeProperties),s=new r.b(i,t=>t.tryAddSmimeProperties),d=new r.b(i,t=>t.createMailResponseBodyContent),l=new r.b(i,t=>t.downloadSmimeAttachment),m=new r.b(i,t=>t.getMergedSmimeViewState),f=new r.b(i,t=>t.getMergedSmimeViewStateForDraft),b=new r.b(i,t=>t.isSmimeItemDecoding),h=new r.b(i,t=>t.previewSmimeAttachment),p=new r.b(i,t=>t.updateSmimeAttachmentIds),w=new r.b(i,t=>t.createSmimeAttachmentsFromFiles),O=new r.b(i,t=>t.createSmimeAttachmentsViaSmimeQueueManager),g=new r.b(i,t=>t.initializeAttachmentStateForSmimeAttachments),v=new r.b(i,t=>t.getAttachmentsForSmimeResponse),x=new r.b(i,t=>t.getSmimeAttachmentsForRequest),j=Object(r.d)(i,t=>t.SignatureDetails)},2377:function(t,e,n){"use strict";var r=n(266),i=n(2532),a=n(50),o=n(2686);function c(t,e,n,a,c=!0){var u;const{Name:s,OriginalPermissionType:d,PermissionType:l}=e,m=Object(o.a)(e),f="GroupMailbox"===(null===(u=null==t?void 0:t.mailboxInfo)||void 0===u?void 0:u.type)?t.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(t,m,n,a,l,d,c,s,f);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:i.b(t,m,1,a,l,d,c,s,f);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function u(t,e,n=!1,r=!0){return i.a(t,e,n,r)}function s(t,e,n,r,o=!1){const s=n?c(t,e,1,r,!1):u(t,1,o,!1);if(n)return{url:s,init:{credentials:"include",headers:new Headers}};{const e=i.c(t.mailboxInfo),n=new Headers;return n.set("X-Token",e),n.set("X-OWA-CANARY",Object(a.a)()),{url:s,init:{headers:n}}}}function d(t,e,n,r,i,a=!1){return r?c(t,e,n,i):u(t,n,a)}n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return s}))},2532:function(t,e,n){"use strict";var r=n(2251);n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return r.b}));var i=n(2039);n.d(e,"c",(function(){return i.a}));var a=n(2037);n.d(e,"e",(function(){return a.a}));var o=n(2036);n.d(e,"d",(function(){return o.a}))},2686:function(t,e,n){"use strict";function r(t){let e=null;return e=t.AttachLongPathName,e||(e=t.WebUrl),e}n.d(e,"a",(function(){return r}))},2789:function(t,e,n){"use strict";var r=n(1998),i=n(2510),a=function(t){const e=Object(r.a)();e&&Object(i.a)(t,e.highlightTerms,!1,!0)};n.d(e,"a",(function(){return a}))},3051:function(t,e,n){"use strict";function r(t,e){(e||window).open(t,"_blank")}n.d(e,"a",(function(){return r}))},3166:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3051),i=n(61);const a=t=>{t.stopPropagation()};function o(t,e,n,o){var c;if(Object(i.o)("downloadFileFromUrl",{urlLength:t.length}),e)Object(r.a)(t);else{const e=document.createElement("a");e.style.display="none",e.href=t,e.download=o||"",e.referrerPolicy="origin",n||(n=(null===(c=document.activeElement)||void 0===c?void 0:c.parentElement)||document.body),n.appendChild(e),e.addEventListener("click",a),e.click(),e.removeEventListener("click",a),n.removeChild(e)}}},3460:function(t,e,n){"use strict";var r=n(1738),i=n(3665),a=n(699);e.a=Object(a.action)("refreshDownloadUrl")((function(t,e,n=!1){const a=Object(r.a)(t),o=Object(i.a)(t,a.model,e,n);a.download.url=o}))},3537:function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return l}));var r=n(20),i=n(2268);n.d(e,"h",(function(){return i.b})),n.d(e,"g",(function(){return i.a})),n.d(e,"i",(function(){return i.f}));const a=new r.c(()=>Promise.all([n.e(294),n.e(822)]).then(n.bind(null,6099))),o=new r.b(a,t=>t.tryProcessOneDriveLink),c=new r.b(a,t=>t.tryUndoProcessOneDriveLink),u=new r.b(a,t=>t.tryManageOneDriveLinksState),s=new r.b(a,t=>t.docLinkHadPreviewInfo),d=(new r.b(a,t=>t.forceGetWacInfoOperation),new r.b(a,t=>t.getValidDocLinkPreviewInfo),new r.b(a,t=>t.forceGetValidDocLinkPreviewInfo)),l=new r.b(a,t=>t.checkSafelinkAndOpenLinkInSxS)},3634:function(t,e,n){"use strict";n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return s}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(0),n.e(26),n.e(29),n.e(47),n.e(299),n.e(642)]).then(n.bind(null,6111))),a=Object(r.d)(i,t=>t.AttachmentThumbnailView),o=Object(r.d)(i,t=>t.AttachmentIconView),c=Object(r.d)(i,t=>t.AttachmentDocInfoView),u=Object(r.d)(i,t=>t.AttachmentDocView),s=Object(r.d)(i,t=>t.AttachmentIconDensityView)},3665:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1865),i=n(2206),a=n(2377);function o(t,e,n,o=!1){if(Object(i.b)(e))switch(e.ProviderType){case r.b:return function(t){const e=t.AttachLongPathName,n=e.lastIndexOf("?");return`${e.substring(0,n)}?dl=1`}(e)}return Object(a.a)(t,e,0,Object(i.b)(e),n,o)}},4084:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(3166),i=n(707),a=n(1829),o=n(3460),c=n(1738),u=n(2334);async function s(t,e,n){const s=Object(c.a)(t);if(s)if(Object(i.b)()&&Object(o.a)(s.id,!0,!0),Object(a.c)(s.model))(await u.e.import())(s.model);else{const t=s.download.url;t&&Object(r.a)(t,e,n)}}},4227:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return c}));var r=n(20),i=n(4084);n.d(e,"a",(function(){return i.a}));const a=new r.c(()=>n.e(899).then(n.bind(null,8306))),o=new r.a(a,t=>t.clickAttachment).importAndExecute,c=new r.a(a,t=>t.previewAttachment)},6575:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1738),i=n(2065);function a(t){const e=Object(r.a)(t),n=Object(i.a)(null==e?void 0:e.model);return 3===n}},7441:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1702),i=n(1751),a=n(1822);function o(t){const e=t.AttachmentId.Id||"";if(Object(a.a)(t)){const n=t;return{fileType:r.a.Cloud,name:n.Name,size:n.Size,providerId:"",providerType:4,location:n.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:n.AttachmentThumbnailUrl,previewUrl:n.AttachmentPreviewUrl,fileId:e,fileParentId:"",type:n.__type}}return{attachmentItemId:e,name:t.Name,size:t.Size,fileType:r.a.AttachmentItem,type:i.c}}},807:function(t,e,n){"use strict";function r(t={}){!function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||(()=>6e4)}(t);const{maximumAttempts:e,timeBetweenRetryInMS:n}=t;return t=>{let r=0,i=!1;const a=(o,c)=>{i?c(new Error("The function retry was cancelled")):(r++,t().then(t=>o(t)).catch(t=>{e&&r>=e?c(t):setTimeout(()=>a(o,c),n(r))}))};return{retriableFunc:()=>new Promise((t,e)=>a(t,e)),cancel:()=>i=!0}}}function i(t){return e=>Math.pow(2,e)*t}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},945:function(t,e,n){"use strict";n.d(e,"b",(function(){return i}));var r=n(3);const i=Object(r.createStore)("popoutParent",{projections:[],isAvailable:!1}),a=i();e.a=a}}]);
//# sourceMappingURL=owa.670.js.map
self.scriptsLoaded['owa.670.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.670.js'] = (new Date()).getTime();