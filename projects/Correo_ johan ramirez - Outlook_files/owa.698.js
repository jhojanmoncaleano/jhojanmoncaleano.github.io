self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.698.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[698],{10108:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(){var e;return null===(e=r.a.userConfiguration)||void 0===e?void 0:e.GroupsSets}},1686:function(e,t,n){"use strict";var r=n(3);const i=Object(r.action)("initializeOwaObservableDateTime"),o=Object(r.action)("observableNowChanged"),a=Object(r.action)("observableTodayChanged");var s=n(7),u=n(14),c=Object(r.createStore)("ObservableDateTime",{now:0,today:0});const d=Object(u.computed)(()=>Object(s.qc)(c().now)),l=()=>d.get(),p=Object(u.computed)(()=>Object(s.qc)(c().today)),b=()=>p.get(),f=e=>Object(s.Jb)(e,l()),m=e=>Object(s.Hb)(e,l()),v=e=>O(e,s.Jb),g=e=>O(e,s.Kb),O=(e,t)=>t(Object(s.bc)(Object(s.qc)(e)),b());function h(e){if(!e)return"";const t=Object(s.qc)(e);return function(e,t){const n=Object(s.bc)(e);if(Object(s.Lb)(n,t))return s.ab;const r=e=>Object(s.Rb)(n,Object(s.e)(t,-e),t);if(r(3))return s.ib;if(r(30))return s.hb;return s.Y}(t,b())(t)}function y(e){if(!e)return"";const t=Object(s.qc)(e);return function(e,t){const n=Object(s.bc)(e);if(Object(s.Lb)(n,t))return s.T;return s.U}(t,b())(t)}function j(e){if(!e)return"";return function(e,t){const n=Object(s.bc)(e);return Object(s.Lb)(n,t)?Object(s.ab)(e):D(n,t,2)?Object(s.lb)(e):D(n,t,7)?Object(s.H)(Object(s.bb)(e),Object(s.ab)(e)):Object(s.H)(Object(s.J)(e),Object(s.ab)(e))}(Object(s.qc)(e),b())}function D(e,t,n){return Object(s.Rb)(e,Object(s.e)(t,-n),t)}const S=Object(r.action)("updateTimes"),k=Object(r.action)("setNow"),T=Object(r.action)("setToday",e=>({today:e}));Object(r.mutator)(k,()=>{c().now=Object(s.oc)()}),Object(r.mutator)(T,({today:e})=>{c().today=e});var N=n(22),A=n(75);let I=!1;Object(r.orchestrator)(i,()=>{if(S(),!I){const e=Object(s.Ub)(),t=Object(s.dc)(Object(s.h)(e,1)),n=Object(s.w)(t,e);setTimeout(()=>setInterval(S,N.g),n),document&&document.addEventListener("visibilitychange",S),I=!0}}),Object(r.orchestrator)(A.m,()=>{S()}),Object(r.orchestrator)(S,()=>{k();const e=Object(s.Cb)(Object(s.pc)()),t=c().today!=e;t&&T(e),o(),t&&a()}),n.d(t,"d",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return b})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return v})),n.d(t,"h",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return j}))},1715:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function i(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},1718:function(e,t,n){"use strict";var r=n(1787),i=n(272),o=n(1686),a=n(61),s=n(7),u=n(40);const c="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",p="X-OWA-ExplicitLogonUser";async function b(e,t){const n={},b=Object(i.k)(e);if(t?(n[c]=t,n[p]=t):b&&(n[c]=b.anchorMailbox),Object(i.s)())return u.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(b){if(b.accountState==i.b.AccessRevoked)return null;if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.d)(b.accountState,b.accountProviderType),null}if(b){let t,i=b.token,c=Object(o.g)(b.tokenExpiry);!c&&i||(Object(a.o)("getAndUpdateAccessToken",{tokenExpiry:Object(s.y)(b.tokenExpiry,Object(s.Ub)()),isTokenExpired_1:c,isTokenInvalid_2:!i},{isCore:!0}),i=await r.a.importAndExecute(b.accountId,e,i),u.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+i),i||(i="")),"Outlook"==b.accountProviderType?(t=`MSAuth1.0 usertoken="${i}", type="MSACT"`,n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType&&"Yahoo"!=b.accountProviderType||(t=`Bearer ${i}`,n[l]=2..toString()),n[d]=t}return n}var f=n(1715),m=n(914);async function v(e,t){var n;const r=Object(f.a)();if(r.headers=await async function(e,t){var n;const r=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,i=await b(e.mailboxInfo.userIdentity,g(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(f.b)(r,i),r}(e,t),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},Object(i.s)()){const t=Object(m.a)(null===(n=null==e?void 0:e.mailboxInfo)||void 0===n?void 0:n.userIdentity);u.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+t),r.sourceId=t,r.datapoint.mailbox="Connected"}else r.datapoint.mailbox="Connected";return r}function g(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&u.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return g}))},1721:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},1745:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={FavoriteNode:"favoritenode",InboxRule:"inboxrule",MessageRule:"messagerule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",RibbonCustomizerButton:"ribboncustomizerbutton",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton",CalendarNode:"calendarnode",CalendarGroupNode:"calendargroupnode",CalendarItem:"calendaritem"}},1775:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),i=n(1823);const o=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:i.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1785:function(e,t,n){"use strict";var r=n(1715);function i(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function o(e,t,n){t&&(e||n)&&Object(r.b)(t,i(e,n))}function a(e,t){var n;const r=null!=t?t:{},i=(null===(n=r.headers)||void 0===n?void 0:n.set)?new Headers(r.headers):new Headers;return r.datapoint=r.datapoint||{},r.datapoint.mailbox=r.datapoint.mailbox||"Explicit",o(e,i),Object.assign(Object.assign({},r),{headers:i})}var s=n(272),u=n(1718),c=n(56),d=n(294),l=n.n(d);async function p(e){return Object(c.b)().then(async t=>{if(e)if(Object(s.r)(e.userIdentity)){const n=await Object(u.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);l()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=i(e.mailboxSmtpAddress);l()(t,n)}return t})}function b(){return Object(c.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function f(e=null){return Object(s.r)(e)?b().then(t=>{return Object(u.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var m=n(50);function v(e,t,n,r){let i=new Headers;return n&&i.set("X-OWA-CANARY",Object(m.a)()),t&&i.set("X-OWA-ActionName",t),(e||r)&&(r?o(e,i,r):o(e,i)),i}n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return v}))},1787:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20),i=n(1721);n.d(t,"b",(function(){return i.a}));const o=new r.c(()=>n.e(1045).then(n.bind(null,2021))),a=new r.a(o,e=>e.getAndUpdateAccessToken)},1810:function(e,t,n){"use strict";var r=n(20);var i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return i}));const o=new r.c(()=>Promise.all([n.e(0),n.e(663)]).then(n.bind(null,19157))),a=new r.a(o,e=>e.subscribe),s=new r.a(o,e=>e.unsubscribe),u=new r.b(o,e=>e.getChannelId),c=new r.a(o,e=>e.getChannelReady),d=new r.a(o,e=>e.retryDisconnectionWithMinimumReconnectInterval),l=new r.a(o,e=>e.setup),p=new r.a(o,e=>e.handleNotification),b=new r.a(o,e=>e.NotificationManager.stopConnection),f=new r.a(o,e=>e.initializeNotificationManager),m=new r.b(o,e=>e.getNotificationEmitter)},1823:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Private=0]="Private",e[e.Public=1]="Public"}(r||(r={}))},1858:function(e,t,n){"use strict";var r=n(0),i=n(1745);var o=n(3),a=Object(o.mutatorAction)("setDropState",(function(e,t,n){e.isDragOver=t,e.draggableItemType=n})),s=n(1997);n.d(t,"a",(function(){return d}));const u="nothing",c=50;class d{constructor(e){this.props=e,this.onDragEnter=e=>{e.preventDefault(),this.props.preventBubblingDragEvents&&e.stopPropagation();const t=this.getDragData(e);this.props.onDragEnter&&this.props.onDragEnter(t)},this.onDragLeave=e=>{if(this.props.preventBubblingDragEvents&&e.stopPropagation(),this.props.greedy&&!this.isReallyLeavingDroppable(e))return;let t=this.props.dropViewState.draggableItemType;t||(t=this.getDragType(e));let n={itemType:t,itemData:Object(s.a)()};if("none"==this.getDesiredDropEffect(n))return;const r=t=>()=>{this.props.onDragLeave&&this.props.onDragLeave(t,e.currentTarget),a(this.props.dropViewState,!1,null),this.pendingDragLeaveHandler=null};this.props.shouldIgnoreTransientOnDragLeave?this.pendingDragLeaveHandler||(e.persist(),this.pendingDragLeaveHandler=setTimeout(r(n),c)):r(n)()},this.onDragOver=e=>{this.props.preventBubblingDragEvents&&e.stopPropagation();let t=this.props.dropViewState.draggableItemType;t||(t=this.getDragType(e));let n={itemType:t,itemData:Object(s.a)()};const r=this.getDesiredDropEffect(n);"none"!=r?(this.props.bypassActOnDrop||(e.preventDefault(),this.setDropEffectInternal(e,r)),this.props.shouldUseCopyAsDropEffect&&this.setDropEffectInternal(e,"copy"),this.props.onDragOver&&this.props.onDragOver(n,e.pageX,e.pageY,e.currentTarget),this.cancelPendingDragLeaveHandler(),this.props.dropViewState.isDragOver&&this.props.dropViewState.draggableItemType==t||a(this.props.dropViewState,!0,t)):this.props.bypassActOnDrop||this.setDropEffectInternal(e,"none")},this.onDrop=e=>{this.props.preventBubblingDragEvents&&e.stopPropagation();let t=this.getDragData(e);(null==t?void 0:t.itemType)!=u&&e.preventDefault(),"none"!=this.getDesiredDropEffect(t)&&(this.props.onDrop(t,e.pageX,e.pageY,e.currentTarget),this.props.onDragLeave&&this.props.onDragLeave(t,e.currentTarget),this.cancelPendingDragLeaveHandler(),Object(s.c)(null,null),a(this.props.dropViewState,!1,null))},this.refCallback=e=>{this.div=e}}getDiv(){return this.div}cancelPendingDragLeaveHandler(){this.pendingDragLeaveHandler&&(clearTimeout(this.pendingDragLeaveHandler),this.pendingDragLeaveHandler=null)}isReallyLeavingDroppable(e){let t=document.elementFromPoint(e.pageX,e.pageY);return!this.isDescendantOrSelf(t,e.currentTarget)}isDescendantOrSelf(e,t){if(!e||!t)return!1;if(e==t)return!0;for(var n=e;n=n.parentElement;)if(n==t)return!0;return!1}getDesiredDropEffect(e){return e?this.props.canDrop?"boolean"==typeof this.props.canDrop(e)?this.props.canDrop(e)?"move":"none":this.props.canDrop(e):"move":"none"}getDragData(e){let t=null;if(e.dataTransfer.files&&e.dataTransfer.files.length>0)r=e.dataTransfer.files,t={itemType:i.a.LocalFile,files:r};else{const r=e.dataTransfer.types;let i=null,o=!1;for(var n=0;n<r.length;n++){const t=r[n];if("text"!=t){i=e.dataTransfer.getData(t),o=!0;break}}o||(i=e.dataTransfer.getData("text"));try{t=JSON.parse(i)}catch(e){t={itemType:u}}}var r;return t}getDragType(e){let t=Object(s.b)();const n=e.dataTransfer?e.dataTransfer:e.nativeEvent.dataTransfer;if(!t&&n&&n.types&&n.types.length>0){const n=Array.prototype.slice.apply(e.dataTransfer.types),r=Object.values(i.a),o=n.filter(e=>r.indexOf(e)>=0);o.length>0&&(t=o[0])}return t}setDropEffectInternal(e,t){e.dataTransfer&&(e.dataTransfer.dropEffect=t)}}t.b=r.forwardRef((function(e,t){const n=r.useRef(new d(e));return r.useImperativeHandle(t,()=>({getDiv:()=>n.current.getDiv()}),[]),r.createElement("div",{ref:n.current.refCallback,className:e.classNames,style:e.style,onDrop:n.current.onDrop,onDragOver:n.current.onDragOver,onDragEnter:n.current.onDragEnter,onDragLeave:n.current.onDragLeave},e.children)}))},1887:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},1922:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(44),i=n(1775),o=n(49);function a(){return(Object(r.j)("grp-shareable-crud")||Object(i.a)().isSensitivityLabelsEnabled)&&!Object(o.r)()}function s(){return Object(r.j)("grp-shareable-crud-smtpEdit")&&Object(r.j)("grp-cardReloadAfterEditingSmtp")}},1936:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1785);function i(e,t){return{headers:Object(r.e)(e,"GroupMailbox",!1,t)}}},1958:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1973:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(3);const i={myOrgGroups:[],withContextMenuGroup:null,shouldShowAllGroups:!1,hasLoadedFromServer:!1,loadGroupsError:!1,groupNodeViewStates:new(n(14).ObservableMap)({})};let o=Object(r.createStore)("leftNavGroupsStore",i);const a=o();t.a=a},1987:function(e,t,n){"use strict";n(1936);var r=n(1871);function i(e){let t=void 0;switch(e){case"None":t=0;break;case"Private":t=1;break;case"Secret":t=2;break;case"Public":t=3}return t}var o=n(3),a=Object(o.action)("EDIT_GROUP_SUCCESS",(e,t)=>({groupSmtp:e,photoUrl:t})),s=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",e=>({groupSmtp:e})),u=Object(o.action)("MEMBER_MANAGEMENT_SUCCESS",e=>({groupSmtp:e})),c=Object(o.action)("POPUP_OPENED",()=>({isOpen:!0})),d=Object(o.action)("POPUP_CLOSED",()=>({isOpen:!1})),l=Object(o.action)("DELETE_GROUP_SUCCESS",e=>({groupSmtp:e})),p=Object(o.action)("EDIT_GROUP_SMTP_SUCCESS",(e,t,n,r)=>({aadObjectId:e,groupSmtp:t,photoUrl:n,oldGroupSmtp:r})),b=n(1886);n.d(t,"n",(function(){return r.a})),n.d(t,"o",(function(){return i})),n.d(t,"m",(function(){return a})),n.d(t,"j",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"r",(function(){return c})),n.d(t,"q",(function(){return d})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return p})),n.d(t,"g",(function(){return b.g})),n.d(t,"c",(function(){return b.c})),n.d(t,"d",(function(){return b.d})),n.d(t,"a",(function(){return b.a})),n.d(t,"e",(function(){return b.e})),n.d(t,"f",(function(){return b.f})),n.d(t,"i",(function(){return b.i})),n.d(t,"b",(function(){return b.b})),n.d(t,"h",(function(){return b.h}))},1997:function(e,t,n){"use strict";let r,i;function o(e,t){r=e,i=t}function a(){return r}function s(){return i}n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}))},2002:function(e,t,n){"use strict";var r=n(14),i=n(0),o=n(20);const a=new o.c(()=>n.e(2023).then(n.t.bind(null,18883,7))),s=new o.b(a,e=>e.default);var u=n(1813),c=n(2013),d=n(1816),l=n(1697);function p(e){if("string"==typeof(e=Object(u.a)(e))||Array.isArray(e))return e;const t=Object(c.a)();return Object(d.a)()?function(e,t){switch(t){case l.b.OutlookForWindows:return e.outlook;case l.b.OutlookForWeb:return e.owa;default:return}}(e,t):function(e,t){switch(t){case 0:return e.hotmail;case 2:return e.yahoo;case 3:return e.gmail;case 4:return e.owa;default:return}}(e,t)}function b(e,t,n,r,i){return o=>{(function(e,t){if(t)return!1;let n=e.target;return"INPUT"==n.tagName||"SELECT"==n.tagName||"TEXTAREA"==n.tagName||n.contentEditable&&"true"==n.contentEditable})(o,e)||t&&!t(o)||(n&&o.stopPropagation(),r&&o.preventDefault(),i(o))}}function f(e,t,n={}){g(void 0,i.useMemo(()=>[{command:e,handler:t,options:n}],[e,t,n.stopPropagation,n.preventDefault,n.allowHotkeyOnTextFields,n.isEnabled]))}function m(e,t,n,r={}){g(e,i.useMemo(()=>[{command:t,handler:n,options:r}],[t,n,r.stopPropagation,r.preventDefault,r.allowHotkeyOnTextFields,r.isEnabled]))}function v(e,t,n){g(e,i.useMemo(()=>t(n),[t,n]))}function g(e,t){i.useEffect(()=>{const n=(async()=>{const n=await s.import(),i=e?e.current:document.body;if(i){const e=new n(i),o=Array.isArray(t)?t:await t,a=Object(r.autorun)(()=>{for(const{command:t,handler:n,options:{stopPropagation:r=!0,preventDefault:i=!0,allowHotkeyOnTextFields:a=!1,isEnabled:s}={}}of o){const o=p(t);o&&e.bind(o,b(a,s,r,i,n))}});return()=>{e.reset(),a()}}return()=>{}})();return()=>{n.then(e=>e())}},[e,t])}n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return u.a}))},2051:function(e,t,n){"use strict";var r,i;let o,a,s,u,c,d,l,p;var b;let f,m;let v,g;var O;n(5),n(468);function h(e,t){t,O=e}function y(){return O}n.d(t,"o",(function(){return r})),n.d(t,"n",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"m",(function(){return p})),n.d(t,"q",(function(){return b})),n.d(t,"r",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"j",(function(){return v})),n.d(t,"e",(function(){return g})),n.d(t,"p",(function(){})),n.d(t,"k",(function(){return h})),n.d(t,"i",(function(){return y}))},2057:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"BodyContentType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2501:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(29),i=n(44);function o(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(i.j)("cmp-proxy-address")}},2612:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Delete="DELETE",e.AuthorizationTag="Authorization",e.BearerTokenHeader="Bearer ",e.Patch="PATCH",e.ContentTypeHeader="Content-type",e.ContentTypeValue="application/json",e.PreferTag="Prefer",e.XAnchorMailbox="X-AnchorMailbox",e.PreferValueExchangeBehaviorTag="exchange.behavior",e.PreferValueGroupMembers="GroupMembers",e.PreferValueGroupDetailsExtended="GroupDetailsExtended",e.PreferValueUpdateGroup="UpdateGroup",e.PreferValueUpdateGroupV2="UpdateGroupV2",e.GenerateRWCToken="GenerateReadWriteConsistencyToken",e.RWCTokenResponseHeader="ReadWriteConsistencyToken",e.OIDPrefix="OID:"}(r||(r={}))},2657:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(32);function i(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},2718:function(e,t,n){"use strict";var r,i,o,a,s;n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),function(e){e.Beta="/api/beta/",e.V1="/api/V1.0/",e.V2="/api/V2.0/"}(r||(r={})),function(e){e.Mail="MailFolders/inbox/"}(i||(i={})),function(e){e.Groups="groups/",e.AddMembers="/addmembers",e.Members="members/",e.MailFolders="mailfolders",e.ChildFolders="childfolders",e.MessageRules="messagerules/",e.CopyFolder="copy",e.MoveFolder="move"}(o||(o={})),function(e){e.Me="me/"}(a||(a={})),function(e){e.Count="@odata.count"}(s||(s={}))},2951:function(e,t,n){"use strict";var r=n(3),i=n(2115);t.a=Object(r.mutatorAction)("setGroupFolderViewExpanded",(function(e,t){e=e.toLowerCase();const n=i.n.groupListNodesViewStates.get(e);if(n){n.isExpanded=!0;const e=n.groupFolderNodeViewStates.get(t);e&&(e.isExpanded=!0)}}))},2952:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=Object(r.action)("SET_LOADING_STATE_FOR_GROUP_FOLDER_TREE",(e,t)=>({groupId:e,loadingState:t}))},3085:function(e,t,n){"use strict";function r(e,t,n){var r,i,o,a,s;const u=e.groups.get(t.toLowerCase());if(u||(n.unreadMessageCount=null,n.groupDetailsError=n.groupDetailsError||!1),!n.groupDetailsError||u&&u.basicInformation||(n.basicInformation={SmtpAddress:t,DisplayName:t}),n.groupDetails){const e=n.groupDetails;u&&u.basicInformation&&!u.groupDetailsError||(n.basicInformation={SmtpAddress:e.SmtpAddress,DisplayName:e.DisplayName,AccessType:e.AccessType,LegacyDN:e.LegacyDN,MailboxGuid:e.MailboxGuid}),n.groupDetails.UserGroupRelationship={SubscriptionType:(null===(r=e.UserGroupRelationship)||void 0===r?void 0:r.SubscriptionType)||0,IsSubscribed:(null===(i=e.UserGroupRelationship)||void 0===i?void 0:i.IsSubscribed)||!1,ShouldIgnoreReply:(null===(o=e.UserGroupRelationship)||void 0===o?void 0:o.ShouldIgnoreReply)||!1,IsMember:(null===(a=e.UserGroupRelationship)||void 0===a?void 0:a.IsMember)||!1,IsOwner:(null===(s=e.UserGroupRelationship)||void 0===s?void 0:s.IsOwner)||!1}}return n}var i=n(699),o=n(1887);const a=Object(i.action)("addOrUpdateGroup")((e,t,n,i,a)=>{var s;t=t.toLowerCase();const u=void 0!==i&&""!==i;if(u&&(i=i.toLowerCase(),t=n.groupDetails.SmtpAddress),n=r(e,u?i:t,n),e.groups.has(t)||u&&e.groups.has(i)){const r=e.groups.has(t)?e.groups.get(t):e.groups.get(i);n.basicInformation&&(r.basicInformation=n.basicInformation),n.groupDetails&&((null===(s=r.groupDetails)||void 0===s?void 0:s.MailboxSettings)&&!n.groupDetails.MailboxSettings&&(n.groupDetails.MailboxSettings=r.groupDetails.MailboxSettings),r.groupDetails=n.groupDetails),n.members&&(r.members=n.members),null!=n.groupDetailsError&&(r.groupDetailsError=n.groupDetailsError),u&&t!==i&&(void 0!==a&&a(t,i),e.groups.set(t,r),e.groups.delete(i),Object(o.a)().smtpAddress=t)}else e.groups.set(t,n)});t.a=a},3231:function(e,t,n){"use strict";var r=n(20),i=n(699),o=n(2115),a=Object(i.action)("toggleGroupFolderNodeExpansion")((function(e,t){var n;const r=null===(n=o.n.groupListNodesViewStates.get(e.toLowerCase()))||void 0===n?void 0:n.groupFolderNodeViewStates.get(t);r&&(r.isExpanded=!r.isExpanded)})),s=n(2951),u=n(2952);n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return f})),n.d(t,"h",(function(){return a})),n.d(t,"f",(function(){return s.a})),n.d(t,"g",(function(){return u.a}));const c=new r.c(()=>Promise.all([n.e(0),n.e(900)]).then(n.bind(null,19216)));let d=new r.a(c,e=>e.loadGroupFolders),l=new r.a(c,e=>e.toggleGroupListNodeExpansion);const p=new r.a(c,e=>e.createNewGroupFolder),b=new r.a(c,e=>e.deleteGroupFolder),f=new r.a(c,e=>e.renameGroupFolder);new r.a(c,e=>e.moveGroupFolder)},3721:function(e,t,n){"use strict";var r=n(1),i=n(1973),o=n(14),a=n(911),s=n(182),u=n(2289),c=n(0),d=n(3882);let l=class extends c.Component{constructor(){super(...arguments),this.onClick=e=>{e.stopPropagation(),this.props.selectGroup(this.props.groupId,this.props.customData)},this.toggleFavorite=()=>{Object(d.a)(this.props.groupId)},this.onKeyDown=e=>{switch(e.keyCode){case 13:case 32:e.stopPropagation(),this.props.selectGroup(this.props.groupId,this.props.customData)}},this.renderRightCharm=()=>this.props.renderRightCharm(this.props.groupId,this.props.customData,2)}get isSelected(){return this.props.isSelected(this.props.groupId,this.props.customData)}get isWithContextMenuOpen(){return i.a.withContextMenuGroup&&this.props.groupId==i.a.withContextMenuGroup.groupId}shouldComponentUpdate(e,t){return!Object(s.e)(this.props,e)}render(){return c.createElement(u.a,{chevronProps:this.props.chevronProps,customIcon:this.props.customIcon,depth:1,displayName:this.props.displayName,isBeingDragged:this.props.isBeingDragged,isDroppedOver:this.props.isDroppedOver,isRootNode:!1,isSelected:this.isSelected,isWithContextMenuOpen:this.isWithContextMenuOpen,key:this.props.groupId,onClick:this.onClick,onContextMenu:this.props.onContextMenu,onKeyDown:this.onKeyDown,renderCustomTreeNodeDisplay:this.props.renderCustomTreeNodeDisplay,renderRightCharm:this.renderRightCharm,showAsHoverOnDroppedOver:this.props.showHoverStateOnDroppedOver,isFavorited:this.props.isFavorited,toggleFavorite:this.toggleFavorite})}};Object(r.__decorate)([o.computed],l.prototype,"isSelected",null),Object(r.__decorate)([o.computed],l.prototype,"isWithContextMenuOpen",null),l=Object(r.__decorate)([a.observer],l),t.a=l},3882:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("TOGGLE_FAVORITE_GROUPNODE_FROM_LEFTNAV",e=>({groupId:e}))},4260:function(e,t,n){"use strict";var r=n(699),i=n(2051),o=n(2388),a=n(1833),s=n(3085),u=n(1951),c=n(1852);var d=function(e,t){const n=Object(c.b)(t,"Site");n?!function(e){return-1==e.indexOf("_layouts/groupstatus.aspx")}(n)?Object(u.a)(e,1):Object(u.a)(e,2):Object(u.a)(e,0)},l=n(3);const p=Object(l.action)("beforeGetGroupDetailsStartAction",e=>({groupSmtpAddress:e}));Object(l.orchestrator)(p,e=>{3==Object(a.h)(e.groupSmtpAddress)&&Object(a.n)(e.groupSmtpAddress,1)});var b=p,f=n(1887),m=Object(l.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(e,t)=>{Object(f.a)().groupId=e,Object(f.a)().tenantId=t});const v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GroupDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loadFullDetails"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupDetails"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mailboxSmtpAddress"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}}},{kind:"Argument",name:{kind:"Name",value:"loadFullDetails"},value:{kind:"Variable",name:{kind:"Name",value:"loadFullDetails"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AccessType"}},{kind:"Field",name:{kind:"Name",value:"GroupId"}},{kind:"Field",name:{kind:"Name",value:"Kind"}},{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"SmtpAddress"}},{kind:"Field",name:{kind:"Name",value:"TenantId"}},{kind:"Field",name:{kind:"Name",value:"Details"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AllowExternalSenders"}},{kind:"Field",name:{kind:"Name",value:"AutoSubscribeNewMembers"}},{kind:"Field",name:{kind:"Name",value:"Classification"}},{kind:"Field",name:{kind:"Name",value:"Culture"}},{kind:"Field",name:{kind:"Name",value:"Description"}},{kind:"Field",name:{kind:"Name",value:"HasGuests"}},{kind:"Field",name:{kind:"Name",value:"IsJoinRequestPendingApproval"}},{kind:"Field",name:{kind:"Name",value:"IsMembershipHidden"}},{kind:"Field",name:{kind:"Name",value:"IsMembershipDynamic"}},{kind:"Field",name:{kind:"Name",value:"IsMember"}},{kind:"Field",name:{kind:"Name",value:"IsOwner"}},{kind:"Field",name:{kind:"Name",value:"IsSubscribedByMail"}},{kind:"Field",name:{kind:"Name",value:"MemberCount"}},{kind:"Field",name:{kind:"Name",value:"OwnerCount"}},{kind:"Field",name:{kind:"Name",value:"ProxyAddresses"}},{kind:"Field",name:{kind:"Name",value:"Resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Url"}}]}},{kind:"Field",name:{kind:"Name",value:"RetentionPolicyTags"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Description"}},{kind:"Field",name:{kind:"Name",value:"DisplayName"}},{kind:"Field",name:{kind:"Name",value:"IsArchive"}},{kind:"Field",name:{kind:"Name",value:"IsVisible"}},{kind:"Field",name:{kind:"Name",value:"OptedInto"}},{kind:"Field",name:{kind:"Name",value:"ParentLabelIdentity"}},{kind:"Field",name:{kind:"Name",value:"Priority"}},{kind:"Field",name:{kind:"Name",value:"RetentionAction"}},{kind:"Field",name:{kind:"Name",value:"RetentionId"}},{kind:"Field",name:{kind:"Name",value:"RetentionPeriod"}},{kind:"Field",name:{kind:"Name",value:"Type"}}]}},{kind:"Field",name:{kind:"Name",value:"SendAsPermission"}},{kind:"Field",name:{kind:"Name",value:"SubscriptionType"}},{kind:"Field",name:{kind:"Name",value:"SubscriptionTypeAllowedValues"}}]}}]}}]}}]};var g=n(702),O=n(44);function h(e){switch(e){case"None":return 0;case"MoveToDeletedItems":return 1;case"MoveToFolder":return 2;case"DeleteAndAllowRecovery":return 3;case"PermanentlyDelete":return 4;case"MarkAsPastRetentionLimit":return 5;case"MoveToArchive":return 6;default:return}}function y(e){switch(e){case"Calendar":return 1;case"Contacts":return 2;case"DeletedItems":return 3;case"Drafts":return 4;case"Inbox":return 5;case"JunkEmail":return 6;case"Journal":return 7;case"Notes":return 8;case"Outbox":return 9;case"SentItems":return 10;case"Tasks":return 11;case"All":return 12;case"ManagedCustomFolder":return 13;case"RssSubscriptions":return 14;case"SyncIssues":return 15;case"ConversationHistory":return 16;case"Personal":return 17;case"RecoverableItems":return 18;case"NonIpmRoot":return 19;default:return}}function j(e){return Object.assign(Object.assign({},e),{Type:y(e.Type),RetentionAction:h(e.RetentionAction)})}var D=n(1987);function S(e){var t,n,r,i;let o=void 0;switch(null===(t=e.Details)||void 0===t?void 0:t.SubscriptionType){case"None":o=0;break;case"ReplyOnly":o=1;break;case"ReplyAndCalendar":o=2;break;case"All":o=3}return{IsMember:null===(n=e.Details)||void 0===n?void 0:n.IsMember,IsOwner:null===(r=e.Details)||void 0===r?void 0:r.IsOwner,IsSubscribed:null===(i=e.Details)||void 0===i?void 0:i.IsSubscribedByMail,SubscriptionType:o}}function k(e){var t,n,r,i,o;return{ExternalSendersEnabled:null===(t=e.Details)||void 0===t?void 0:t.AllowExternalSenders,AutoSubscribeNewMembers:null===(n=e.Details)||void 0===n?void 0:n.AutoSubscribeNewMembers,MailboxCultureName:null===(r=e.Details)||void 0===r?void 0:r.Culture,RetentionPolicyTags:(o=null===(i=e.Details)||void 0===i?void 0:i.RetentionPolicyTags,o?o.map(j):null)}}function T(e){var t,n,r,i,o;return{ExternalMemberCount:(null===(t=e.Details)||void 0===t?void 0:t.HasGuests)?1:0,IsMembershipDynamic:null===(n=e.Details)||void 0===n?void 0:n.IsMembershipDynamic,IsGroupMembershipHidden:null===(r=e.Details)||void 0===r?void 0:r.IsMembershipHidden,IsJoinRequestPendingApproval:null===(i=e.Details)||void 0===i?void 0:i.IsJoinRequestPendingApproval,SendAsPermission:null===(o=e.Details)||void 0===o?void 0:o.SendAsPermission}}function N(e){var t,n;return{SubscriptionType:{AllowedValues:null===(n=null===(t=e.Details)||void 0===t?void 0:t.SubscriptionTypeAllowedValues)||void 0===n?void 0:n.map(e=>{switch(e){case"ReplyOnly":return"Message";case"ReplyAndCalendar":return"Calendar";default:return e}})}}}const A=(e,t,n,r)=>{const i=e;i&&void 0!==i?(Object(s.a)(Object(a.j)(),i.SmtpAddress,{basicInformation:null,groupDetails:i,members:null,groupDetailsError:!1}),m(i.ExternalDirectoryObjectId,i.ExternalDirectoryOrganizationId),d(t,i),n&&n()):I(t,r)},I=(e,t)=>{Object(s.a)(Object(a.j)(),e,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(a.n)(e,0),t&&t()},w=Object(r.action)("getGroupDetailsAction")((async function(e,t,n,r){var a;if(b(e),Object(O.j)("grp-groupDetails-gql")){const i=Object(g.a)();try{const o=null===(a=(await i.query({query:v,variables:{mailboxSmtpAddress:e,loadFullDetails:t}})).data)||void 0===a?void 0:a.groupDetails,s=o?function(e){var t,n,r,i,o,a;return{SmtpAddress:e.SmtpAddress,DisplayName:e.Name,AccessType:Object(D.o)(e.AccessType),ProxyAddresses:null===(t=e.Details)||void 0===t?void 0:t.ProxyAddresses,ExternalDirectoryOrganizationId:e.TenantId,Kind:e.Kind,UserGroupRelationship:S(e),GroupResources:null===(n=e.Details)||void 0===n?void 0:n.Resources,MailboxSettings:k(e),OwnerCount:null===(r=e.Details)||void 0===r?void 0:r.OwnerCount,Description:null===(i=e.Details)||void 0===i?void 0:i.Description,ExternalDirectoryObjectId:e.GroupId,AdditionalProperties:T(e),Classification:null===(o=e.Details)||void 0===o?void 0:o.Classification,MemberCount:null===(a=e.Details)||void 0===a?void 0:a.MemberCount,EditProperties:N(e)}}(o):void 0;A(s,e,n,r)}catch(t){I(e,r)}}else{(i.g||o.j)(e,t).then(t=>{t&&t.Body&&Object(o.n)(t.Body)?A(t.Body.GroupDetails,e,n,r):I(e,r)}).catch(t=>{I(e,r)})}}));t.a=w},468:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="en",i={en:{dir:"ltr"},af:{dir:"ltr"},am:{dir:"ltr"},ar:{dir:"rtl"},"as-IN":{dir:"ltr"},"az-Latn-AZ":{dir:"ltr"},bg:{dir:"ltr"},"bn-IN":{dir:"ltr"},"bs-Latn-BA":{dir:"ltr"},ca:{dir:"ltr"},"ca-Es-VALENCIA":{dir:"ltr"},cs:{dir:"ltr"},cy:{dir:"ltr"},da:{dir:"ltr"},de:{dir:"ltr"},el:{dir:"ltr"},"en-GB":{dir:"ltr"},es:{dir:"ltr"},"es-MX":{dir:"ltr"},et:{dir:"ltr"},eu:{dir:"ltr"},fa:{dir:"rtl"},fi:{dir:"ltr"},fil:{dir:"ltr"},fr:{dir:"ltr"},"fr-CA":{dir:"ltr"},"ga-IE":{dir:"ltr"},"gd-gb":{dir:"ltr"},gl:{dir:"ltr"},gu:{dir:"ltr"},he:{dir:"rtl"},hi:{dir:"ltr"},hr:{dir:"ltr"},hu:{dir:"ltr"},hy:{dir:"ltr"},id:{dir:"ltr"},is:{dir:"ltr"},it:{dir:"ltr"},ja:{dir:"ltr"},ka:{dir:"ltr"},kk:{dir:"ltr"},"km-KH":{dir:"ltr"},kn:{dir:"ltr"},ko:{dir:"ltr"},kok:{dir:"ltr"},"lb-LU":{dir:"ltr"},"lo-LA":{dir:"ltr"},lt:{dir:"ltr"},lv:{dir:"ltr"},"mi-NZ":{dir:"ltr"},mk:{dir:"ltr"},ml:{dir:"ltr"},mr:{dir:"ltr"},ms:{dir:"ltr"},"mt-MT":{dir:"ltr"},"ne-NP":{dir:"ltr"},nl:{dir:"ltr"},"nn-NO":{dir:"ltr"},no:{dir:"ltr"},or:{dir:"ltr"},"pa-IN":{dir:"ltr"},pl:{dir:"ltr"},pt:{dir:"ltr"},"pt-PT":{dir:"ltr"},"quz-PE":{dir:"ltr"},ro:{dir:"ltr"},ru:{dir:"ltr"},sk:{dir:"ltr"},sl:{dir:"ltr"},sq:{dir:"ltr"},sr:{dir:"ltr"},"sr-Cyrl":{dir:"ltr"},"sr-Cyrl-BA":{dir:"ltr"},sv:{dir:"ltr"},ta:{dir:"ltr"},te:{dir:"ltr"},th:{dir:"ltr"},tr:{dir:"ltr"},tt:{dir:"ltr"},"ug-CN":{dir:"rtl"},uk:{dir:"ltr"},ur:{dir:"rtl"},uz:{dir:"ltr"},vi:{dir:"ltr"},"zh-Hans":{dir:"ltr"},"zh-Hant":{dir:"ltr"}},o={"en-us":"en","nb-no":"no","ne-ne":"ne-NP","quz-bo":"quz-PE","quz-ec":"quz-PE","zh-cn":"zh-Hans","zh-hk":"zh-Hant","zh-mo":"zh-Hant","zh-sg":"zh-Hans","zh-tw":"zh-Hant"};function a(e){let t=e.toLowerCase().split("-");for(;t.length>0;){let e=t.join("-"),n=o[e];if(n)return u(n);for(const t of Object.keys(i))if(s(t,e))return u(t);t.pop()}return Object.assign(Object.assign({},u(r)),{localeNotFound:!0})}function s(e,t){try{return!e.localeCompare(t,[],{sensitivity:"base"})}catch(e){return!1}}function u(e){return Object.assign({locale:e},i[e])}},5233:function(e,t,n){"use strict";n.r(t);var r=n(32);function i(e){return Object.assign({__type:"UpdateUserGroupsSetConfigurationRequest:#Exchange"},e)}function o(e){var t,n;void 0===(t={request:i({GroupsSet:e})}).request||t.request.__type||(t.request=i(t.request)),Object(r.a)("UpdateUserGroupsSetConfiguration",t,n)}var a=n(61),s=n(44),u=n(2882),c=n(7016),d=n(699),l=Object(d.action)("removeGroupFromLeftNav")((function(e,t){const n=t.myOrgGroups.indexOf(e);n>=0&&t.myOrgGroups.splice(n,1)})),p=n(4260),b=n(1728),f=n(1679),m=n(2537),v=n(1744),g=n(2912),O=n(3254),h=n(1810),y=n(4384);function j(e){if(("RowModified"==e.EventType||"RowAdded"==e.EventType)&&null!=e.IsMember&&null!=e.Group){const t=e.Group.SmtpAddress.toLowerCase();O.d.importAndExecute(t,e.IsMember);const n=Object(u.b)();e.IsMember?n.myOrgGroups.includes(t)||(ue(),function(e){const t=Object(f.I)(),n=t&&Object(v.b)(t.tableQuery);n&&n.toLowerCase()===e&&Object(g.a)(t.tableQuery)}(t)):n.myOrgGroups.includes(t)&&(l(t,n),Object(c.c)(t),Object(p.a)(t),function(e){var t;const n=Object(f.I)(),r=n&&Object(v.b)(n.tableQuery);if((null==r?void 0:r.toLowerCase())!==e)return;const i=Object(b.a)().groups.get(e);3!==(null===(t=null==i?void 0:i.basicInformation)||void 0===t?void 0:t.AccessType)&&(m.a.clear(n,null),Object(g.b)(n,"ErrorAccessDenied"))}(t))}}function D(){var e;e=j,h.b.import().then(t=>{h.j.importAndExecute({subscriptionId:"GroupAssociationNotification",requiresExplicitSubscribe:!0,subscriptionParameters:Object(y.a)({NotificationType:"GroupAssociationNotification",ChannelId:t()})},e)})}var S=n(4041),k=n(3085),T=n(40),N=n(3),A=n(1833),I=n(7),w=n(1737),E=n(3348),G=n(2665),C=n(3700),F=n(2048),x=n(1814),P=n(2929),M=n(700),R=n(3231);const L=5,U=1e4,V=30,_="GroupModulePrefetch",H="X-OWA-ActionSource",q="GroupMailbox_WarmUp",B="X-OWA-ActionName";let z=!1;function W(){const e=Object(A.j)();z||(z=!0,setTimeout(()=>{if(!function(e){for(let t of u.c.myOrgGroups)if(X(e,t,V))return!0;return!1}(e))return;Object(C.b)(Date.now());const t=function(e){let t=u.c.myOrgGroups.filter((t,n)=>Object(w.isGroupInFavorites)(t)&&X(e,t,V)).slice(0,L);if(t.length<L){const n=u.c.myOrgGroups.filter((t,n)=>n<E.a&&!Object(w.isGroupInFavorites)(t)&&X(e,t,V));t=t.concat(n).slice(0,L)}return t}(e);t.forEach(e=>{(function(e){const t=Object(G.c)(),n=Object(G.b)(e,t);switch(t){case 0:return function(e){const t=new Headers;return t.set(H,_),t.set(B,q),Object(F.d)("inbox",1,e.viewFilter,e.sortBy,!1,e.focusedViewFilter,e.requestShapeName,Object(x.d)(e),void 0,e.categoryName,void 0,{headers:t})}(n);case 1:return function(e){return Object(s.j)("mon-messageList-useGqlForFindItem")?Object(F.h)(Object(f.k)(e),1,e.viewFilter,e.sortBy,!1,e.focusedViewFilter,e.requestShapeName,Object(x.d)(e),void 0,K(e),e.categoryName):Object(F.c)(Object(f.k)(e),0,1,e.viewFilter,Object(P.a)(e),e.focusedViewFilter,e.requestShapeName,void 0,K(e),e.categoryName)}(n)}return Promise.resolve()})(e).catch(e=>{}),Object(s.j)("grp-loadFolders")&&R.c.importAndExecute(e.toLowerCase())}),Object(C.c)(t)},U))}function X(e,t,n){const r=e.groups.get(t.toLowerCase());if(!r||!r.basicInformation)return!1;const i=r.basicInformation;if(!i.LastVisitedTimeUtc)return!1;const o=Object(I.qc)(i.LastVisitedTimeUtc),a=Object(I.bc)(o),s=Object(I.pc)();return Object(I.Rb)(a,Object(I.e)(s,-n),s)}function K(e){const t=Object(M.a)(Object(x.d)(e))||{};return t.headers=new Headers,t.headers.set(H,_),t.headers.set(B,q),t}var J=n(10108),Q=n(1050),Y=n(1049),$=n(245);async function Z(){const e=function(){const e=new Array;return Object(s.j)("tri-favorites-roaming")?e.push({FilterType:0,SortType:4,SortDirection:"Descending"}):(e.push({FilterType:1,SortType:4,SortDirection:"Descending"}),e.push({FilterType:2,SortType:4,SortDirection:"Descending"})),Object(Q.a)({RequestedGroupsSets:e,AdditionalProperties:[4]})}();return await Object(Y.a)({Header:Object($.b)(),Body:e})}const ee={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GroupsSets"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"groupsSetsQueryParams"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"GroupsSetsQueryParam"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupsSets"},arguments:[{kind:"Argument",name:{kind:"Name",value:"groupsSetsQueryParams"},value:{kind:"Variable",name:{kind:"Name",value:"groupsSetsQueryParams"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Filter"}},{kind:"Field",name:{kind:"Name",value:"Groups"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AccessType"}},{kind:"Field",name:{kind:"Name",value:"GroupId"}},{kind:"Field",name:{kind:"Name",value:"LastVisitedTimeUtc"}},{kind:"Field",name:{kind:"Name",value:"Kind"}},{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"SmtpAddress"}},{kind:"Field",name:{kind:"Name",value:"TenantId"}},{kind:"Field",name:{kind:"Name",value:"Details"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"IsOwner"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"TotalGroups"}}]}}]}}]};var te=n(702),ne=n(1987);function re(e){switch(e){case"All":return 0;case"Favorites":return 1;case"ExcludeFavorites":return 2;case"PublicOnly":return 3;case"DistributionGroups":return 4;case"FamilyGroup":return 5;default:return}}function ie(e){return{FilterType:re(e.Filter),Groups:(t=e.Groups,null==t?void 0:t.map(e=>{var t;return{AccessType:Object(ne.o)(e.AccessType),ExternalDirectoryObjectId:e.GroupId,LastVisitedTimeUtc:e.LastVisitedTimeUtc,Kind:e.Kind,DisplayName:e.Name,SmtpAddress:e.SmtpAddress,ExternalDirectoryOrganizationId:e.TenantId,AdditionalProperties:{IsOwner:null===(t=e.Details)||void 0===t?void 0:t.IsOwner}}})),TotalGroups:e.TotalGroups};var t}var oe=n(49);let ae=!1;function se(){let e=new Array;return Object(s.j)("tri-favorites-roaming")?e.push({FilterType:"All",SortType:"Relevance",SortDirection:"Descending"}):(e.push({FilterType:"Favorites",SortType:"Relevance",SortDirection:"Descending"}),e.push({FilterType:"ExcludeFavorites",SortType:"Relevance",SortDirection:"Descending"})),e}async function ue(e){if(ae)return;let t,n=!1,r="";const i=new a.b("loadGroups");if(ae=!0,Object(s.j)("grp-groupsleftNav-gql")){const e=Object(te.a)();try{let r=(await e.query({query:ee,variables:{groupsSetsQueryParams:se()}})).data.groupsSets;t=r.map(ie),n=!0}catch(e){r="There was an error loading groups: "+e.toString()}}else{const e=await Z();n="Success"==e.Body.ResponseClass,n?t=e.Body.GroupsSets:r="There was an error loading groups: "+Object(S.b)(e)}n?(i.end(),de(!1),pe(t),o(t),e&&W()):(i.addCustomData({error:r}),i.endWithError("ServerError",new Error(r)),de(!0)),ae=!1}function ce(e){var t,n;const r=null===(n=null===(t=Object(oe.g)())||void 0===t?void 0:t.GroupsSets)||void 0===n?void 0:n.UnifiedGroupsSets;r&&(pe(r),e&&W())}const de=Object(N.mutatorAction)("setLoadGroupsError",e=>{u.c.loadGroupsError=e,e||(u.c.hasLoadedFromServer=!0)});let le=Object(a.r)({name:"LoadGroupsInLeftNavFromSessionData",options:{}},(function(){if(ae)return;ae=!0;const e=Object(J.a)();if(!e)return T.h.info("GroupsSets data is not available in session data"),void(ae=!1);pe(e.UnifiedGroupsSets),ae=!1}));function pe(e){if(e){const t=[],n=Object(A.j)();e.forEach(e=>{e.Groups.forEach(e=>{t.push(e.SmtpAddress.toLowerCase()),Object(k.a)(n,e.SmtpAddress,{basicInformation:e,groupDetails:null,members:null})})}),be(t)}Object(c.b)(),D()}const be=Object(N.mutatorAction)("setMyOrgGroups",e=>{u.c.myOrgGroups=e});var fe=n(29),me=n(455);function ve(){const e=!Object(fe.a)().UserOptions.IsGroupsTreeCollapsed;Object(me.a)(t=>{t.UserOptions.IsGroupsTreeCollapsed=e},[{key:"IsGroupsTreeCollapsed",valuetype:"Boolean",value:[String(e)]}])}function ge(e){return Object.assign({__type:"SetUnifiedGroupLastVisitedTimeJsonRequest:#Exchange"},e)}var Oe=n(1958);function he(e){const t=Object(Oe.a)({Type:0,Value:e});var n,i,o;void 0===(n=ge({Header:Object($.b)(),Body:(o={GroupIdentity:t,LastVisitedTimeUtc:(new Date).toISOString(),PreserveReadState:!0},Object.assign({__type:"SetUnifiedGroupLastVisitedTimeRequest:#Exchange"},o))}))||n.__type||(n=ge(n)),Object(r.a)("SetUnifiedGroupLastVisitedTime",n,i)}var ye=n(20),je=n(1736);const De=Object(ye.e)(je.a,"LOAD_GROUPS_FROM_USERCONFIGURATION",()=>ce(!0));n.d(t,"loadGroups",(function(){return ue})),n.d(t,"loadGroupsFromUserConfiguration",(function(){return ce})),n.d(t,"loadGroupsFromSessionData",(function(){return le})),n.d(t,"removeGroupFromLeftNav",(function(){return l})),n.d(t,"toggleGroupTreeExpansion",(function(){return ve})),n.d(t,"unsubscribeFromUnreadNotifications",(function(){return c.c})),n.d(t,"setGroupLastVisitedTime",(function(){return he})),n.d(t,"lazyLoadGroupsOrchestrator",(function(){return De}))},700:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},7016:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return O}));var r=n(4217),i=n(4384),o=n(1810),a=n(61),s=n(1737),u=n(44),c=n(2882),d=n(3348),l=n(6503),p=n(6732);const b={};function f(e){const t=e.id.replace("UnreadCountNotification_","");if(r.b.import().then(n=>n(t,e)),"0"==e.EventType.toString()){const n=b[t];n&&(Object(l.a)(t.toLowerCase(),e.UnreadCount),n.firstNotificationReceived||(n.unreadCountDataPoint.end(),n.unreadCountDataPoint=null,n.firstNotificationReceived=!0))}}function m(){Object(u.j)("grp-unreadCountTop5AndFavorites")?Object(u.j)("grp-groupunreadcountnotification-gql")?c.c.myOrgGroups.filter((e,t)=>t<d.a||Object(s.isGroupInFavorites)(e)).forEach(e=>{Object(p.a)(e)}):c.c.myOrgGroups.filter((e,t)=>t<d.a||Object(s.isGroupInFavorites)(e)).forEach(e=>{g(e)}):v()}function v(){c.c.myOrgGroups.forEach(e=>{g(e)})}function g(e){(function(e){return!b[e]})(e=e.toLowerCase())&&o.b.import().then(t=>{const n=Object(i.a)({NotificationType:"UnreadCountNotification",ChannelId:t(),MailboxId:e}),s={subscriptionId:h(e),requiresExplicitSubscribe:!0,subscriptionParameters:n};o.j.importAndExecute(s,f);const c={notificationSubscription:s,firstNotificationReceived:!1,unreadCountDataPoint:new a.b("UnreadCountNotification",{logEvery:Object(u.j)("ring-dogfood")?1:20})};b[e]=c,r.c.import().then(t=>t(e,s,!1))})}function O(e){e=e.toLowerCase();const t=b[e];if(t){const n=t.notificationSubscription;n&&(o.k.importAndExecute(n,f),delete b[e],r.c.import().then(t=>t(e,n,!0)))}}function h(e){return"UnreadCountNotification_"+e}}}]);
//# sourceMappingURL=owa.698.js.map
self.scriptsLoaded['owa.698.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.698.js'] = (new Date()).getTime();