self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.720.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[720],{10852:function(e,t,n){"use strict";n.r(t);var r=n(7250);n.d(t,"getAdditionalPropertiesFromServer",(function(){return r.b})),n.d(t,"getItemProperties",(function(){return r.c})),n.d(t,"cleanUpByItemId",(function(){return r.a}))},1685:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e){if(!e)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(e)}},1688:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"m",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return h}));const r=["journal","outbox","syncissues"],i="archivemsgfolderroot",o="msgfolderroot",s="archivedeleteditems",u="deleteditems",a="archiverecoverableitemsdeletions",c="recoverableitemsdeletions",d="msgfolderroot",l="sharedFolderTree",f="primaryFolderTree",m="archiveFolderTree",b="favorites",h="groups"},1690:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(14),i=n(3);const o={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}};let s=Object(i.createStore)("mail",o);const u=s();t.a=u},1692:function(e,t,n){"use strict";var r=n(20),i=n(1690),o=n(1827),s=n(1760),u=n(1752);const a="ChronologicalNewestOnBottom";function c(e,t){return e[t==a?0:e.length-1]}var d=n(705),l=n(1705);function f(e){return Object(u.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(l.a)({FieldURI:"TailoredXpEntities"}),Object(l.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(l.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(l.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then(e=>{if(e&&!(e instanceof Error)){const{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}=e;return{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}}return{}})}var m=n(1838),b=n(29);function h(e){const t=i.a.conversations.get(e);if(t){const e=Object(b.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==e}return!1}var v=n(1797),g=n(1683);function p(e,t={folderTable:g.d.folderTable}){return!!t.folderTable.get(e)}var I=n(1688);function O(e,t){const n=g.d.folderTable.get(e);return!!n&&(Object(g.H)(n,I.d,t)||n.distinguishedFolderType===I.b)}function j(e){return O(e)||function(e){const t=g.d.folderTable.get(e);return t&&t.distinguishedFolderType===I.d}(e)}function y(e,t,n={folderTable:g.d.folderTable}){return Object(g.H)(e,t,n)}var S=n(1839),w=n(1812);function T(e){return e&&(Object(w.a)(e,I.i)||Object(w.a)(e,I.b))}function E(e){return e&&(y(e,I.h)||y(e,I.a))}var M=n(1809);function x(e,t){try{return P(e,t)}catch(e){return null}}function P(e,t){if(!e||!t)return null;const n=Object(g.m)().get(e).PermissionSet.Permissions.filter(e=>e.UserId.PrimarySmtpAddress===t);return null==n?void 0:n[0]}var F=n(283);const C="OneOff",A="Unknown";function L(e,t,n){return!Object(F.a)()&&(n==C||n==A)&&(null==e?void 0:e.indexOf(t))<0}var R=n(3),k=Object(R.mutatorAction)("setIsDraftQueuedForSubmission",(e,t)=>{const n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}),N=n(1741);n.d(t,"s",(function(){return B})),n.d(t,"u",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return s.a})),n.d(t,"e",(function(){return u.a})),n.d(t,"d",(function(){return c})),n.d(t,"t",(function(){return f})),n.d(t,"v",(function(){return m.a})),n.d(t,"q",(function(){return h})),n.d(t,"c",(function(){return v.a})),n.d(t,"r",(function(){return p})),n.d(t,"m",(function(){return O})),n.d(t,"l",(function(){return j})),n.d(t,"n",(function(){return y})),n.d(t,"j",(function(){return S.a})),n.d(t,"k",(function(){return T})),n.d(t,"p",(function(){return E})),n.d(t,"f",(function(){return M.a})),n.d(t,"h",(function(){return x})),n.d(t,"i",(function(){return P})),n.d(t,"o",(function(){return L})),n.d(t,"w",(function(){return k})),n.d(t,"x",(function(){return N.a}));const D=new r.c(()=>n.e(2067).then(n.bind(null,19538))),B=new r.a(D,e=>e.setTriageActionAnnouncement)},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1726:function(e,t,n){"use strict";var r=n(3);let i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}});var o=i();function s(){return o.selectedNode}function u(){const e=s();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o}))},1727:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(3),i=n(14);const o=Object(r.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxFolderTreeData:new i.ObservableMap}),s=o();t.a=o},1729:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1857);function i(e,t){const n=Object(r.a)(t),i=n&&n.get(e);return null==i?void 0:i.rootFolder}},1741:function(e,t,n){"use strict";var r=n(44),i=n(121),o=n(49),s=n(20);const u=new s.c(()=>n.e(1160).then(n.bind(null,19563))),a=new s.b(u,e=>e.isReadingPaneConversationEnabled);function c(){var e,t;if(Object(r.j)("mon-rp-unstackedConversation")){return 0==(null===(t=null===(e=Object(o.g)())||void 0===e?void 0:e.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)&&!function(){var e,t;let n=null;const r=a.tryImportForRender();if(r)n=r();else{const r=Object(i.a)("useNativeConversationOptions");let s=null===(e=Object(o.g)())||void 0===e?void 0:e.PrimeSettings;if(null==s?void 0:s.Items)for(let e of s.Items)if("ReadingPaneConversationOptions"===e.Id&&e.Value){const i=null===(t=e.Value.options)||void 0===t?void 0:t[0];n=r?null==i?void 0:i.conversationEnabledNativeHost:null==i?void 0:i.conversationEnabled;break}null==n&&(n=!r)}return n}()}return!1}n.d(t,"a",(function(){return c}))},1752:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1977),i=n(44);const o=new(n(4).d)(()=>Promise.all([n.e(9),n.e(10),n.e(12),n.e(13),n.e(291),n.e(2068)]).then(n.bind(null,2508)));function s(e,t,n,s,u,a,c,d,l){if(Object(i.j)("mon-rp-loadItemViaGql")){if(!e&&!d)throw new Error("getItem passed a null or undefined id");return o.import().then(r=>r.getItemViaGraphQL(e,t,n,s,u,a,c,d,l))}return Object(r.a)(e,t,n,s,a,c,d)}},1760:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1765:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1777),i=n(1774);function o(e){if(!e)return Promise.reject(Object(r.a)("500","Server returned a null response!",null));const t=Array.isArray(e)?e:[e];for(const e of t)if(e&&!Object(i.a)(e))return Promise.reject(Object(r.a)(e.ResponseCode,e.StackTrace,e.MessageText));return Promise.resolve()}},1774:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r="Success";function i(e){return e&&e.ResponseClass==r}},1777:function(e,t,n){"use strict";function r(e,t,n){let r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);const i=new Error(r);return i.responseCode=e,i.fetchErrorType="ServerFailure",n&&(i.diagnosticInfo="MessageText= "+n),i}n.d(t,"a",(function(){return r}))},1797:function(e,t,n){"use strict";const r=new(n(939).a)(50);t.a=r},1809:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1683),i=n(1726);function o(){const e=Object(i.c)();let t=null;return t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id,null==t?null:r.d.folderTable.get(t)}},1812:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},1827:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1838:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1690);function i(e){return r.a.items.get(e)}},1839:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1812),i=n(1688);function o(e){return e&&(Object(r.a)(e,i.h)||Object(r.a)(e,i.a))}},1845:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1727);function i(){return Object(r.a)().folderTable}},1857:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(1727),i=n(49);function o(e){return s(e).folderTreeTable}function s(e){return e||(e=Object(i.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},1860:function(e,t,n){"use strict";var r=n(49),i=n(44);function o(e){var t;const n=Object(r.g)().SegmentationSettings,o=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(i.j)("cal-stickyNotesFolder")&&!o}var s=n(283);function u(){const e=Object(s.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(i.j)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}))},1889:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1729),i=n(1688);function o(e){return Object(r.a)(i.k,e)}},1890:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1729),i=n(1688);function o(e){return Object(r.a)(i.d,e)}},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1729);function i(e){return Object(r.a)(e)}},1965:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));var r=n(1685),i=n(1703),o=n(1727),s=n(1889),u=n(1845),a=n(1890),c=n(1896),d=n(1860);function l(e,t){const n=Object(u.a)();if(t){return[...n.values()].filter(n=>n.distinguishedFolderType===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function f(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(a.a)(t);break;case"SharedMailbox":n=Object(c.a)(t);break;default:n=Object(s.a)(t)}const u=Object(d.a)();if("UserMailbox"==e&&n.distinguishedFolderType==Object(s.a)(t).distinguishedFolderType&&n.id){const e=u.map(e=>l(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.id):e.map(e=>e.id)}const f=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>o.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.id)}(n,t);for(let e=0;e<f.length;e++)-1==u.indexOf(Object(i.a)(f[e]))&&r.push(f[e]);return r}function m(e,t){const n=Object(u.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},1977:function(e,t,n){"use strict";var r=n(954),i=n(910);var o=n(955),s=n(245),u=n(40),a=n(1765);function c(e,t,n,c,d,l,f){const m=Object(s.b)();var b;return c&&(m.RequestServerVersion=c),l&&(m.ManagementRole=(b={UserRoles:["MailboxSearch"]},Object.assign({__type:"ManagementRoleType:#Exchange"},b))),Object(o.a)({Header:m,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map(e=>Object(i.a)({Id:e})):e?[Object(i.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:f})},d).then(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}).then(e=>Object(a.a)(e).then(()=>e)).then(t=>{if(!(null==t?void 0:t.length))return null;let n=[];return t.forEach(e=>{n=n.concat(e.Items)}),n.length?Array.isArray(e)||void 0!==f?n:n[0]:null}).catch(e=>(u.h.warn("GetItem:"+e.message),e))}n.d(t,"a",(function(){return c}))},598:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},700:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(121),i=n(12);function o(){return Object(r.a)("acctmonaccounts")&&Object(i.i)("acctmonaccounts")}function s(){return o()||!Object(r.a)("acctmonaccounts")&&Object(i.i)("accountsapi")}},7250:function(e,t,n){"use strict";var r=n(3),i=n(1692),o=Object(r.mutatorAction)("updateItemInStore",(e,t)=>{const n=i.u.items.get(e);n&&Object.keys(t).forEach(e=>{"ExtendedProperty"==e?n.ExtendedProperty=[...t.ExtendedProperty,...n.ExtendedProperty]:"ItemId"!=e&&(n[e]=t[e])})}),s=n(61),u=n(1752),a=n(1690),c=n(705),d=n(40),l=n(700);n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return p}));const f={},m={},b="GetItemManagerFailure";function h(e){e.forEach(e=>{m[e.featureId]=e})}function v(e,t,n){if(f[e]&&"Pending"==f[e].requestStatus)return;const{itemShape:r,defaultValues:i}=function(e,t){const n=[];let r={};if(Object.keys(m).forEach(i=>{const{isPropertyExistedOnItem:o,shouldGetItemPropertiesFromServer:s,propertyPaths:u,getDefaultValues:a}=m[i];!o(e)&&s(e,t)&&(n.push(...u),r=Object.assign(Object.assign({},r),null==a?void 0:a()))}),n.length>0)return{itemShape:Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:n}),defaultValues:r};return{itemShape:null,defaultValues:null}}(e,t);if(!r)return;const h=a.a.items.get(e);if(!h)return;const v={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};f[e]=v;const g=Object(l.a)(h.MailboxInfo);v.pendingPromise=Object(u.a)(e,r,null,null,h.MailboxInfo,g,null,null).then(t=>{if(!t||t instanceof Error)return t?(t.fetchErrorType="ServerFailure",Promise.reject(t)):Promise.resolve(null);{let n;v.requestStatus="Success",n=Array.isArray(t)?t[0]:t;const r=Object.assign(Object.assign({},i),n);return o(e,r),Promise.resolve(a.a.items.get(e))}}).catch(e=>(v.requestStatus="Error",Object(s.o)(b,{errorMessage:e.message}),d.h.warn(`[GetItemManager_getAdditionalPropertiesFromServer] Error: ${e.message}`),Promise.reject(e)))}function g(e,t){const n=m[t];if(!n)return Promise.reject(new Error("GetItemManager: The featureId is not registered in GetItemManager."));if(n.isPropertyExistedOnItem(e)||"WebExtNotifications"==t)return Promise.resolve(a.a.items.get(e));if(!f[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");{const t=f[e];switch(t.requestStatus){case"Success":return Promise.resolve(a.a.items.get(e));case"Pending":case"Error":return t.pendingPromise;default:return Promise.reject(new Error("GetItemManager: The request status is unknown."))}}}function p(e){delete f[e]}},939:function(e,t,n){"use strict";var r=n(699);class i{constructor(e){this.maxSize=e,this.references=[],this.mruList=[]}initialize(e,t){if(!this.store){this.store=e,this.deleteCallback=t;for(let t of e.keys())this.mruList.push(t)}}add(e,t){Object(r.action)("MruCache_add")(()=>{this.store.set(e,t),this.mruList.indexOf(e)>=0?this.touch(e):(this.mruList.push(e),this.purgeIfNecessary())})()}get(e){return this.store.get(e)}getAndTouch(e){const t=this.store.get(e);return t&&this.touch(e),t}has(e){return this.store.has(e)}remove(e){Object(r.action)("MruCache_remove")(()=>{if(this.store.has(e)&&!this.isReferenced(e))return this.removeItemAtIndex(this.mruList.indexOf(e))})()}registerReference(e){this.references.push(e)}clear(){Object(r.action)("MruCache_clear")(()=>{this.purgeTillSize(0)})()}getItemIds(){return new Array(...this.mruList)}touch(e){let t=this.mruList.indexOf(e);if(t<0)throw new Error(`Item with key '${e}' does not exist in the cache.`);this.mruList.splice(t,1),this.mruList.push(e)}purgeIfNecessary(){this.purgeTillSize(this.maxSize)}purgeTillSize(e){let t=0;for(;this.mruList.length>e&&t<this.mruList.length;){let e=this.mruList[t];this.isReferenced(e)?t++:this.removeItemAtIndex(t)}}removeItemAtIndex(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);let t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)}isReferenced(e){for(let t=0;t<this.references.length;t++){const n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1}}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.720.js.map
self.scriptsLoaded['owa.720.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.720.js'] = (new Date()).getTime();