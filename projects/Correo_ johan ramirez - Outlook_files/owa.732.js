self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.732.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[732],{1736:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("ON_SELECTED_ACCOUNT_CHANGED",(e,t,n)=>({selectedAccountSourceId:e,selectedEmailAddress:t,oldSourceId:n}))},1876:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,"a",(function(){return i}))},1968:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(29),c=n(44),r=n(3119);function a(){const e=Object(i.a)(),t=null==e?void 0:e.SessionSettings,n=null==t?void 0:t.IsExplicitLogon,a=null==t?void 0:t.IsSubstrateSearchServiceAvailable;return!(r.a.fallbackToFindPeople||!Object(c.j)("rp-3SPeopleSuggestions")||n||!a)}},2120:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(44);function c(){return Object(i.j)("rp-cacheFirstPeopleTrieSize300")||Object(i.j)("rp-cacheFirstPeopleTrieSize500")||Object(i.j)("rp-cacheFirstPeopleTrieSize700")||Object(i.j)("rp-peopleTrieOnTimeoutLow")||Object(i.j)("rp-peopleTrieOnTimeoutMed")||Object(i.j)("rp-peopleTrieOnTimeoutHigh")}},2240:function(e,t,n){"use strict";var i=n(5),c=n(699),r=n(2967),a=n(2938),o=n(245),s=n(40);function u(e){let t=Object(a.a)({EntityFeedbackEntries:e});return Object(r.a)({Header:Object(o.b)(),Body:t}).then(e=>{!function(e){if(null==e?void 0:e.Body){let t=e.Body;s.h.info(Object(i.c)("addEntityFeedback Error count: {0}",t.ErrorCount)),s.h.info(Object(i.c)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(c.action)("attemptToSubmitAddEntityFeedback")((function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(u(e.entityFeedbackEntries),s.h.info(Object(i.c)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))}))},2358:function(e,t,n){"use strict";var i=n(5),c=n(699),r=Object(c.action)("increaseEntrySequenceNumber")((function(e){e&&e.entrySequenceNumber++})),a=n(701),o=n(40),s=n(7);function u(e,t,n,c,u,l,d,b=Object(s.Ub)()){if(!e)return o.h.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(a.a)(e.clientSessionId))return o.h.warn(Object(i.c)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;let f={ClientEventTimeUtc:Object(s.vb)(b),ClientEventTimeLocal:Object(s.sb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:c,EntityAddSource:u,JsonPropertyBag:l,ScenarioName:d||e.entityScenarioName};return r(e),f}n.d(t,"a",(function(){return u}))},2367:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"FindPeopleJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return i}))},2578:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"PersonaResponseShape:#Exchange"},e)}n.d(t,"a",(function(){return i}))},2623:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var i=n(3);const c=Object(i.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),r=c();t.a=r},267:function(e,t,n){"use strict";var i=n(912);n.d(t,"a",(function(){return i.a}))},2717:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(32),c=n(2367);function r(e,t){return void 0===e||e.__type||(e=Object(c.a)(e)),Object(i.a)("FindPeople",e,t)}},2721:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"FindPeopleRequest:#Exchange"},e)}n.d(t,"a",(function(){return i}))},2805:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(1968);function c(e){let t="";if(e)if(Object(i.a)()){let n=e;n.Groups&&n.Instrumentation&&(t=n.Instrumentation.TraceId)}else{let n=e;"Success"==n.ResponseClass&&n.ResultSet&&(t=n.TransactionId)}return t}},2825:function(e,t,n){"use strict";var i=n(121);var c=n(44),r=n(6);n.d(t,"a",(function(){return o}));const a="searchtesthook";function o(e={}){const t=function(e,...t){const n={};for(const i of t)for(const t of Object.keys(i))e.includes(t)&&n.hasOwnProperty(t)?n[t]=n[t]+","+i[t]:n[t]=i[t];return n}(["setflight"],e,function(){let e={};const t=Object(r.c)(a),n=decodeURIComponent(t||"").trim();if(Object(c.j)("sea-debugHook")&&n.length>0){e=n.split("&").reduce((e,t)=>{const[n,i]=t.split("=");return e[n]=i,e},{})}return e}(),Object(i.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(t).filter(e=>null!==t[e]).reduce((e,n)=>Object.assign(Object.assign({},e),{[n]:t[n]}),{})}},2938:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"AddEntityFeedbackRequest:#Exchange"},e)}n.d(t,"a",(function(){return i}))},2967:function(e,t,n){"use strict";var i=n(32);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"AddEntityFeedbackJsonRequest:#Exchange"},n)),Object(i.a)("AddEntityFeedback",e,t)}n.d(t,"a",(function(){return c}))},3050:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"ContextProperty:#Exchange"},e)}n.d(t,"a",(function(){return i}))},3118:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(2623);function c(e){return!!Object(i.b)().sessionMaskedRecipients[e]}},3119:function(e,t,n){"use strict";var i=n(3),c=Object(i.createStore)("recipientcommon",{fallbackToFindPeople:!1})();t.a=c},3174:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(5),c=n(3118);const r="MkU4MDBGNDUtMEY3OS00MzM4LTg3RUUtNENFOTFBRURCODcx",a=e=>e?{Id:e,__type:"ItemId:#Exchange"}:void 0;function o(e,t,n,r){const{EmailAddresses:o,DisplayName:f,Text:p,PDLItemId:O,ADObjectId:j,PersonaId:y,FeatureData:h,Id:m,ReferenceId:I,ImAddress:S,JobTitle:g,PeopleType:v,PeopleSubtype:P,GivenName:E,Surname:T,Alias:A,Phones:F,Department:C,OfficeLocation:R,AdditionalNames:w,PersonId:k,MRI:N}=e,D=o?o[0]:void 0;if(!n&&D&&Object(c.a)(D))return null;const x={EmailAddress:D,Name:Object(i.k)(f)?p:f,MailboxType:l(P),RoutingType:s(P),ItemId:a(O)};var L;return{DisplayName:f,ADObjectId:j,FeatureData:h,Id:m,ImAddress:S,EmailAddress:x,EmailAddresses:[x],PersonaTypeString:u(P),PersonaId:a(y),Title:g,ReferenceId:I,PeopleType:v,PeopleSubtype:P,GivenName:E,Surname:T,TransactionId:t,LogicalId:r,Alias:A,PhoneNumber:d(F),Department:C,Location:R,AdditionalNames:w,PersonId:(L=k,L&&b(L)?L:void 0),MRI:N}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function u(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function l(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}function d(e){return(null==e?void 0:e.length)?{Number:e[0].Number,Type:e[0].Type}:{Number:""}}function b(e){return-1==(null==e?void 0:e.indexOf("@"))&&!(0==(null==(t=e)?void 0:t.indexOf(r)));var t}},3335:function(e,t,n){"use strict";function i(e){var t,n;return e?(null===(t=e.EmailAddress)||void 0===t?void 0:t.EmailAddress)||(null===(n=e.PersonaId)||void 0===n?void 0:n.Id):null}n.d(t,"a",(function(){return i}))},3655:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(2120);const c=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle","PersonId","MRI"],r=c.concat(["FeatureData","GivenName","Surname","Alias","AdditionalNames"]),a=c.concat(["FeatureData"]),o=c.concat(["Phones","OfficeLocation","Department"]);function s(e,t=!0){return 2===e?o:Object(i.a)()&&t?function(e){return 0==e?[...r]:[...a]}(e):c}},3754:function(e,t,n){"use strict";n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return v}));var i=n(272),c=n(1718),r=n(44),a=n(311),o=n(267),s=n(312),u=n(2825),l=n(283),d=n(2120),b=n(40),f=n(3655);const p="/search/api/v1/init?",O="/search/api/v1/suggestions?",j="owa.react.compose",y="20",h="5",m="CSRClientEnabled",I="owa.projectMoca.peopleCard";async function S(e,t,n,i,c,r,u,l=!0){const d=u||j;if(null==t)return async function(e){return Object(s.b)(p+v(e),void 0,!0,await P(null),!0,!1).then(e=>Object(o.a)(e.status)?e.json():null).catch(e=>(e.networkError=!0,b.d(e),null))}(d);{let o=function(e,t,n){return{AppName:"OWA",Scenario:{Name:n},Cvid:t||Object(a.a)(),EntityRequests:[e]}}(await async function(e,t,n,i,c){let r={Query:{QueryString:e},EntityType:"People",Provenances:g(t),Size:t?y:h};i&&i.length>0&&(r.Context=function(e){let t={};e&&(t.RecipientsTo=e.toString());return t}(i));return r.Fields=c===I?Object(f.a)(2,n):Object(f.a)(1,n),r}(t,n,l,r,d),null==c?void 0:c.conversationId,d);return Object(s.e)(O+v(d,t),o,i,!1,await P(e,null==c?void 0:c.clientSessionId),!0,!0,!1).then(e=>e).catch(e=>(b.h.info(e),null))}}function g(e){let t=["Mailbox"];return e&&!Object(l.a)()&&t.push("Directory"),t}function v(e,t){const n=Object.assign({scenario:e},Object(u.a)());let i=[];return Object(d.a)()&&i.push(m),Object(r.j)("rp-cacheFirstPeopleTrieSize500cf")&&i.push(m),n.setflight&&i.push(n.setflight),i.length>0&&(n.setflight=i.join(",")),Object.keys(n).map(e=>`${e}=${n[e]}`).join("&")}async function P(e,t){let n={};return t&&(n["client-session-id"]=t),e&&Object(i.r)(e)?Object(c.a)(e).then(e=>(Object.keys(e).forEach(t=>n[t]=e[t]),n)):n}},4030:function(e,t,n){"use strict";var i=n(5),c=n(2240),r=n(2358),a=n(7),o=n(701),s=n(40),u=n(699);t.a=Object(u.action)("transactionFailed")((function(e,t,n,u,l,d=null){if(null==e?void 0:e.hasSessionStarted){let b={TransactionRequestTime:Object(a.sb)(u),TransactionRequestDuration:Object(a.w)(Object(a.Ub)(),u),QueryString:Object(i.k)(t)?"":t,QueryStringLength:Object(o.a)(t)?0:t.length,ImpressionId:n};d&&Object.keys(d).forEach(e=>{b[e]=d[e]}),l&&(b.Context=l);let f=JSON.stringify(b),p=Object(r.a)(e,n,"TransactionFailed",null,0,f);Object(c.a)(e,p,!1),s.h.info(Object(i.c)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}))},4031:function(e,t,n){"use strict";t.a={RecipientCacheInitialization:{name:"RecipientCacheInitialization",custonData:(e,t)=>[e,t]},SearchSuggestionTrie:{name:"SearchSuggestionTrie"}}},5500:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(311);function c(){return{maxActionBatchSize:10,entityType:1,entityScenarioName:"FindPeople_react",hasSessionStarted:!1,isSessionPaused:!1,entityFeedbackEntries:[],clientSessionId:"",clientVersion:"1.0",clientId:1,entrySequenceNumber:0,conversationId:Object(i.a)()}}},6106:function(e,t,n){"use strict";n.r(t);var i=n(209),c=n(1968),r=n(704),a=n(3335),o=n(4031),s=n(3050),u=n(2367),l=n(2721),d=n(1876),b=n(2578),f=n(1705),p=n(2717),O=n(245);const j=500,y="owa.react.compose";function h(){let e=Object(l.a)({IndexedPageItemView:Object(d.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:j}),PersonaShape:Object(b.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(f.a)({FieldURI:"PersonaEmailAddress"}),Object(f.a)({FieldURI:"EmailAddresses"}),Object(f.a)({FieldURI:"PersonaDisplayName"}),Object(f.a)({FieldURI:"PersonaDisplayNames"}),Object(f.a)({FieldURI:"PersonaId"}),Object(f.a)({FieldURI:"PersonaType"}),Object(f.a)({FieldURI:"PersonaImAddress"}),Object(f.a)({FieldURI:"PersonaTitle"})]}),QuerySources:["Mailbox"],QueryString:"",SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:[Object(s.a)({Key:"AppName",Value:"OWA"}),Object(s.a)({Key:"AppScenario",Value:y})]});return Object(p.a)(Object(u.a)({Header:Object(O.b)(),Body:e})).then(e=>{return e.Body})}var m=n(311),I=n(312),S=n(3655),g=n(3754),v=n(44);const P=300,E=500,T=700;const A="/search/api/v1/suggestions?",F="owa.react.recipientcache";async function C(e){let t=function(e,t){return{AppName:"OWA",Scenario:{Name:F},Cvid:null!=t?t:Object(m.a)(),EntityRequests:[e]}}(await async function(){return{Query:{QueryString:""},EntityType:"People",Provenances:["Mailbox"],Size:Object(v.j)("rp-cacheFirstPeopleTrieSize300")?P:Object(v.j)("rp-cacheFirstPeopleTrieSize700")?T:E,Fields:Object(S.a)(0)}}(),e);return Object(I.e)(A+Object(g.c)(F),t,null,!1,null,!0,void 0,!1).then(e=>e,e=>{throw new Error(e.message)})}var R=n(3),w=n(5500),k=n(4030),N=n(7),D=n(3119),x=Object(R.mutatorAction)("setFallbackToFindPeople",e=>{D.a.fallbackToFindPeople=e}),L=n(3174),U=n(2805),M=n(40),_=n(2120),z=n(923),G=n(61);const q={Action:"Type Down"};var B=Object(G.r)(o.a.RecipientCacheInitialization,(async function(e,t,n){const i=Object(N.Ub)();let c="";try{let i,r;switch(Object(v.j)("rp-enableZqFvlJoin")&&(r=Object(m.a)()),e){case 0:const e=await C(r);i=function(e){var t;let n=[];if(e&&e.Groups){const i=null===(t=e.Instrumentation)||void 0===t?void 0:t.TraceId;for(const t of e.Groups)if("People"===t.Type){n=t.Suggestions.map(e=>Object(L.a)(e,i));break}}else M.h.warn("Response groups should not be null");return n}(e),c=Object(U.a)(e);break;case 1:const t=await h();i=t.ResultSet,c=Object(U.a)(t)}t&&x(!0),Q(i,n,e,t,r)}catch(e){M.h.warn(e.message),function(e,t){Object(k.a)(Object(w.a)(),"",t,e,q)}(i,c),Object(G.o)("tryInitializeCacheWithSourceError",[e.Name])}}));const Q=Object(R.mutatorAction)("processCacheCallResults",(e,t,n,i,c)=>{if(e&&e.length>0&&(e.forEach(e=>{let n=Object(a.a)(e);n&&(t.store.allKeys[n]=!0)}),t.store.recipientCache=e,c&&(t.store.cvid=c),Object(_.a)()&&0==n&&!i)){let n=[...e],i=function(e){return e.filter(e=>7!=e.FeatureData.PeopleSource)}(e);t.store.recipientCache=i,z.b.importAndExecute(n)}});var J=Object(R.mutatorAction)("updateRecipientCache",(e,t)=>{e.recipientCache=t}),V=Object(R.mutatorAction)("updateUserIdentity",(e,t)=>{e.userIdentity=t});async function H(e={store:r.a}){if(e.store.recipientCache)return;V(e.store,Object(i.d)().userIdentity);const t=Object(c.a)();await B(t?0:1,!1,e),t&&!e.store.recipientCache&&await B(1,!0,e),e.store.recipientCache||J(e.store,[])}var K=n(707),$=n(1736),W=Object(R.mutatorAction)("resetRecipientCacheMutator",()=>{r.a.recipientCache=null,r.a.allKeys={},r.a.usedFindPeopleFallback=!1,r.a.cvid="",r.a.userIdentity=""});Object(R.orchestrator)($.a,e=>{if(!Object(K.b)())throw new Error(`Reload Recipient cache called when multi accounts is turned off. ${e.selectedEmailAddress}`);W(),H()}),n.d(t,"initializeCache",(function(){return H}))},701:function(e,t,n){"use strict";function i(e){return null==e||0==e.trim().length}n.d(t,"a",(function(){return i}))},704:function(e,t,n){"use strict";var i=n(3),c=Object(i.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1,userIdentity:""})();t.a=c},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i=n(121),c=n(12);function r(){return Object(i.a)("acctmonaccounts")&&Object(c.i)("acctmonaccounts")}function a(){return r()||!Object(i.a)("acctmonaccounts")&&Object(c.i)("accountsapi")}},912:function(e,t,n){"use strict";function i(e){return e>=200&&e<300}n.d(t,"a",(function(){return i}))},923:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var i=n(20);const c=new i.c(()=>n.e(646).then(n.bind(null,1574)));let r=new i.b(c,e=>e.searchCacheTrie),a=new i.b(c,e=>e.compareFeatureData),o=new i.a(c,e=>e.initializeSuggestionTrie),s=new i.a(c,e=>e.isSuggestionTrieEmpty)}}]);
//# sourceMappingURL=owa.732.js.map
self.scriptsLoaded['owa.732.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.732.js'] = (new Date()).getTime();