self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.783.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[783,2033],{164:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,c){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var a={value:n,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){o(t),c&&c(t,n)}.bind(this),i)),e[t]=a,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var c=e[o];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return i&&t++,c.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(o)if(e[c])continue;var u=r[c],a=u.expire-i;if(a<=0){this.del(c);continue}a=a>0?a:void 0,this.put(c,u.value,a)}return this.size()}}e.exports=new r,e.exports.Cache=r},1688:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"l",(function(){return f})),n.d(t,"j",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return h}));const r=["journal","outbox","syncissues"],i="archivemsgfolderroot",o="msgfolderroot",c="archivedeleteditems",u="deleteditems",a="archiverecoverableitemsdeletions",s="recoverableitemsdeletions",d="msgfolderroot",f="sharedFolderTree",l="primaryFolderTree",b="archiveFolderTree",p="favorites",h="groups"},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);function i(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1727:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(3),i=n(14);const o=Object(r.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxFolderTreeData:new i.ObservableMap}),c=o();t.a=o},1729:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1857);function i(e,t){const n=Object(r.a)(t),i=n&&n.get(e);return null==i?void 0:i.rootFolder}},1825:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"DistinguishedFolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1845:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1727);function i(){return Object(r.a)().folderTable}},1857:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1727),i=n(49);function o(e){return c(e).folderTreeTable}function c(e){return e||(e=Object(i.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},1860:function(e,t,n){"use strict";var r=n(49),i=n(44);function o(e){var t;const n=Object(r.g)().SegmentationSettings,o=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(i.j)("cal-stickyNotesFolder")&&!o}var c=n(283);function u(){const e=Object(c.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(i.j)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}))},1867:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function i(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},1889:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1729),i=n(1688);function o(e){return Object(r.a)(i.k,e)}},1890:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1729),i=n(1688);function o(e){return Object(r.a)(i.d,e)}},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1729);function i(e){return Object(r.a)(e)}},1946:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}function u(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u}))},1958:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1965:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return b}));var r=n(1685),i=n(1703),o=n(1727),c=n(1889),u=n(1845),a=n(1890),s=n(1896),d=n(1860);function f(e,t){const n=Object(u.a)();if(t){return[...n.values()].filter(n=>n.distinguishedFolderType===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function l(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(a.a)(t);break;case"SharedMailbox":n=Object(s.a)(t);break;default:n=Object(c.a)(t)}const u=Object(d.a)();if("UserMailbox"==e&&n.distinguishedFolderType==Object(c.a)(t).distinguishedFolderType&&n.id){const e=u.map(e=>f(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.id):e.map(e=>e.id)}const l=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>o.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.id)}(n,t);for(let e=0;e<l.length;e++)-1==u.indexOf(Object(i.a)(l[e]))&&r.push(l[e]);return r}function b(e,t){const n=Object(u.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},198:function(e,t,n){"use strict";var r=n(40);let i;function o(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}var c=n(108);const u=500,a=[],s=[],d=[];let f=!0;function l(e,t){Object(r.g)((e,t,n)=>{f&&(t==r.b.Error&&s.push({message:e,error:n}),a.push({message:e,level:t}))}),e(p),t(p),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(u):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(u))}function b(e){const t=Object(c.a)(e);return f=!1,{traces:a,errors:s,network:d,usage:t}}function p(){f&&d.push(arguments)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return c.b})),n.d(t,"c",(function(){return o}))},2050:function(e,t,n){"use strict";var r=n(1825),i=n(598);function o(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var u=n(1958),a=n(1703);var s=n(1685),d=n(1946),f=n(1688),l=n(1965);n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return S}));const b={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(d.b)({folderId:Object(s.a)(f.k),kind:"PrimaryMailbox"}));const t=Object(l.b)("UserMailbox");for(let n of t)e.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(a.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),[(o={FolderScope:c({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},o))];var o}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(d.a)({folderId:Object(s.a)(f.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(s.a)(f.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(a.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(u={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},u))]:[o({FolderScope:c({BaseFolderId:n})})];var u}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(u.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},g={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},O=e=>{switch(e.kind){case"PrimaryMailbox":return b;case"ArchiveMailbox":return p;case"SharedFolders":return h;case"Group":return v;case"Calendar":return g;case"PublicFolder":return m;default:throw new Error("Unregistered search scope")}},j=e=>O(e).getKey(e),y=e=>O(e).getSearchScopeList(),S=e=>O(e).getSearchScopeType(e)},210:function(e,t,n){"use strict";t.decode=t.parse=n(367),t.encode=t.stringify=n(368)},2225:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2050);function i(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},276:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return a}));var r=n(117),i=n(97),o=n(2);let c;function u(e){c=e}async function a(e){var t,n;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const u=c&&await c(void 0,e);if(u&&u.length>0){if("bearer"===(null===(t=null==u?void 0:u.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return u.split(" ")[1];if("msauth1.0"===(null===(n=null==u?void 0:u.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return u}}},3288:function(e,t,n){"use strict";n.r(t);var r=n(8744);let i={},o=[];function c(e,t,n,o){const c={Name:"clientdatasource",Attributes:[]},u={Results:[]};n.forEach(e=>{u.Results.push({ReferenceId:e.localContentId,EntityId:e.entityId,Type:e.contentType})}),c.Attributes.push({Key:t,Value:btoa(JSON.stringify(u))}),Object(r.a)(e,c,o),function(e){e.forEach(e=>{i[e.entityId]=e.localContentId})}(n)}function u(e,t,n){if(-1!=o.indexOf(e))return;o.push(e);const i={Name:"clientlayout",Attributes:[]};Object.keys(t).forEach(e=>{const n={Results:[]};t[e].forEach(e=>{const t=s(e.entityId);n.Results.push({ReferenceId:t,Position:e.position})}),i.Attributes.push({Key:e,Value:btoa(JSON.stringify(n))})}),Object(r.a)(e,i,n)}function a(){i={},o=[]}function s(e){return i[e]}var d=n(5380),f=n(312),l=n(2825),b=n(391),p=n(597),h=n(49);async function v(e,t,n,r){const i={cvid:e,scenario:t},o=Object(l.a)(i),c={};if(n&&(c["X-Client-Flights"]=n),2==r){let[e,t]=Object(b.getAccessTokenforResourceAsLazy)((Object(h.q)()?`${Object(p.n)()}/search`:Object(p.n)()).replace("outlook-sdf.office.com","outlook.office.com"),"OwaSearchService");e||(e=await t),c.authorization=Object(b.buildAuthorizationHeader)(e)}return Object(f.b)(Object(p.v)(Object(d.a)("init",r),o),void 0,void 0,c,void 0,!1)}var g=n(1835),m=n(40);function O(e,t,n,r,i,o,c){const u={Cvid:t,EntityRequests:[{EntityType:n,Filter:void 0,From:void 0,PropertySet:void 0,Provenances:void 0,Query:{QueryString:e},RefiningQueries:void 0,Size:r,Sort:void 0}],Scenario:{Name:i},TextDecorations:void 0,TimeZone:void 0,LogicalId:c};return Object(f.e)(Object(p.v)(Object(g.A)("suggestions"),Object(l.a)()),u,void 0,!0,o,void 0,void 0,!1).then(e=>Promise.resolve(e)).catch(e=>(m.h.warn(e),Promise.reject(e)))}function j(){S("Delete")}function y(){return S("Export")}const S=e=>{const t=Object(l.a)();return Object(f.e)(Object(p.v)(Object(d.a)("searchHistory"),t),{Action:e,Scenario:{Name:"owa.react"}})};n.d(t,"logLocalContentDataSource",(function(){return c})),n.d(t,"logLocalContentLayout",(function(){return u})),n.d(t,"clearLocalContentInstrumentationCache",(function(){return a})),n.d(t,"getLocalContentId",(function(){return s})),n.d(t,"substrateSearchInitOperation",(function(){return v})),n.d(t,"substrateSearchPostSuggestionsService",(function(){return O})),n.d(t,"deleteSubstrateSearchHistoryService",(function(){return j})),n.d(t,"exportSubstrateSearchHistoryService",(function(){return y}))},367:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var c={};if("string"!=typeof e||0===e.length)return c;var u=/\+/g;e=e.split(t);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var s=e.length;a>0&&s>a&&(s=a);for(var d=0;d<s;++d){var f,l,b,p,h=e[d].replace(u,"%20"),v=h.indexOf(n);v>=0?(f=h.substr(0,v),l=h.substr(v+1)):(f=h,l=""),b=decodeURIComponent(f),p=decodeURIComponent(l),r(c,b)?i(c[b])?c[b].push(p):c[b]=[c[b],p]:c[b]=p}return c};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},368:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,u){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(c(e),(function(c){var u=encodeURIComponent(r(c))+n;return i(e[c])?o(e[c],(function(e){return u+encodeURIComponent(r(e))})).join(t):u+encodeURIComponent(r(e[c]))})).join(t):u?encodeURIComponent(r(u))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var c=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},417:function(e,t,n){"use strict";class r{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return r}))},8744:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(5380),i=n(61),o=n(2),c=n(312),u=n(2825),a=n(597);let s={};function d(e,t,n){const d=t.Attributes.filter(e=>null!=e.Value);t.Attributes=d,t.Attributes.forEach(e=>{if(e.Value&&"string"!=typeof e.Value)throw new Error("All values in substrate search event attributes must be strings or null/undefines")}),void 0===s[n]&&(s[n]={},setTimeout(function(e){return()=>{const t=s[e],n=Object.keys(t).reduce((e,n)=>(e.push({Key:n,Value:t[n]}),e),[]),d={scenario:e},f=Object(u.a)(d);s[e]=void 0,Object(c.e)(Object(a.v)(Object(r.a)("events"),f),n,void 0,!0,{"Client-Session-Id":Object(o.M)()},void 0,void 0,!1).then(n=>{const r={},o=Object.keys(t).reduce((e,n)=>(t[n].forEach(t=>{e.push({TraceId:n,EventName:t.Name}),r[t.Name]?r[t.Name]=r[t.Name]+1:r[t.Name]=1}),e),[]),c={scenario:e,status:n.status,totalEvents:o.length,events:JSON.stringify(o)};Object.keys(r).forEach(e=>{c[e]=r[e]}),Object(i.o)("3SInstEvent",c)})}}(n),5e3)),s[n][e]=(s[n][e]||[]).concat(t)}}}]);
//# sourceMappingURL=owa.783.js.map
self.scriptsLoaded['owa.783.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.783.js'] = (new Date()).getTime();