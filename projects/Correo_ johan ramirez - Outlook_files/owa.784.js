self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.784.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[784],{1008:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("setFirstRenderCompleted",e=>({tabId:e}))},1793:function(e,t,n){"use strict";n.d(t,"b",(function(){return d}));var i=n(14),a=n(1797),o=n(3);const r={loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null,loadingProjectionIds:[]};let d=Object(o.createStore)("readingpane",r);const c=d();a.a.registerReference(()=>[...c.loadedConversationReadingPaneViewStates.keys()]),t.a=c},1810:function(e,t,n){"use strict";var i=n(20);var a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"j",(function(){return r})),n.d(t,"k",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return a}));const o=new i.c(()=>Promise.all([n.e(0),n.e(663)]).then(n.bind(null,19157))),r=new i.a(o,e=>e.subscribe),d=new i.a(o,e=>e.unsubscribe),c=new i.b(o,e=>e.getChannelId),l=new i.a(o,e=>e.getChannelReady),u=new i.a(o,e=>e.retryDisconnectionWithMinimumReconnectInterval),s=new i.a(o,e=>e.setup),b=new i.a(o,e=>e.handleNotification),f=new i.a(o,e=>e.NotificationManager.stopConnection),m=new i.a(o,e=>e.initializeNotificationManager),p=new i.b(o,e=>e.getNotificationEmitter)},1902:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1793),a=n(2349);function o(e){return Object(i.b)().loadedConversationReadingPaneViewStates.get(e||Object(i.b)().sxsItemId||Object(a.a)())}},19248:function(e,t,n){"use strict";n.r(t);var i=n(7014),a=n(7),o=n(2754),r=n(6823),d=n(2782),c=n(1679),l=n(699),u=Object(l.action)("updateRollupOnAddOrUpdateRowNotification")((function(e){const t=Object(c.I)();if(null==t)return;const n=Object(c.n)(e),i=Object(c.n)(t);(0==n&&1==i||1==n&&0==i)&&Object(d.b)(e.tableQuery)})),s=n(1986),b=n(2537),f=n(3251),m=n(7838),p=n(1692),v=n(44),y=n(2483);var O=Object(l.action)("rowNotificationHandler.onAddOrUpdateRow")((function(e,t){const n=e.InstanceKey;if(!n)throw new Error("onAddOrUpdateNotification: Row instanceKey should not be null");if(!Object(s.k)(e,t))return;const{lastDeliveryOrRenewTimeStamp:d,lastDeliveryTimeStamp:l}=Object(s.e)(e,t.tableQuery.listViewType);let O=Object(m.b)(d,l,t,0,n);const w=Object(i.a)(n,t),k=w>=0;-1!=O?Object(c.V)(t.tableQuery.folderId)&&Object(a.Hb)(Object(a.qc)(l),c.Z.inboxPausedDateTime)||(!function(e,t){if(Object(v.j)("tri-spotlight2")){let n;if(1===t.tableQuery.listViewType){const i=c.b.getRowClientItemId(e.InstanceKey,t),a=p.u.items.get(null==i?void 0:i.Id);n=null==a?void 0:a.SpotlightIsVisible}else{const i=Object(c.M)(e.InstanceKey,t.id);n=null==i?void 0:i.spotlightIsVisible}(e.SpotlightIsVisible&&!n||!e.SpotlightIsVisible&&n)&&y.c.importAndExecute()}}(e,t),k?(w<O&&O--,function(e,t,n){Object(s.g)(e,t)?(b.a.updateRowData(e,t),Object(c.bb)(t,4)):(b.a.updateRow(n,e,t,"RowUpdateNotification"),Object(c.bb)(t,2)),Object(r.a)(e.InstanceKey,t)}(e,t,O)):function(e,t,n){b.a.addRow(n,e,t,"RowAddNotification"),Object(c.bb)(t,1),t.currentLoadedIndex++}(e,t,O),f.d.importAndExecute(n,t,!0),-1!=Object(c.n)(t)&&u(t),Object(s.d)(t)):k&&Object(o.a)([n],t,"UpdateNotification")})),w=n(5032),k=n(3),j=Object(k.action)("TRY_REMOVE_ITEM_NORMALIZED_BODY",e=>({item:e})),I=n(2041),N=n(1797),S=n(2202),T=n(1945),g=n(61),R=n(40),h=n(1703);let V=Object(l.action)("handleRowNotification")((function(e,t={tableView:T.a.tableViews.get(e.id)}){Object(v.j)("auth-signalrChannelLogging")&&Object(g.o)("SignalRNotification",{NotificationType:e.id,EventType:e.EventType});const n=t.tableView;if(!n)return void R.h.info("Received row notification for a deleted folder");if(!n.isInitialLoadComplete)return void R.h.info("Ignore row notifications as table has not loaded");let i;switch(e.EventType){case"RowAdded":i=F(e,n),C(i,n),"inbox"==Object(h.a)(n.tableQuery.folderId)&&Object(g.o)("SubscribeRowNotification_RowAddedNotification");break;case"RowModified":i=F(e,n),P(i,n);break;case"RowDeleted":i=F(e,n),D(i,n);break;case"QueryResultChanged":case"Reload":E(n);break;default:return}}));function F(e,t){switch(t.tableQuery.listViewType){case 0:return e.Conversation?e.Conversation:(R.d("Conversation should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);case 1:return e.Item?e.Item:(R.d("Item should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);default:return R.d("rowNotificationStrategy: unsupported listViewType: "+t.tableQuery.listViewType),null}}let C=Object(l.action)("rowNotificationHandler.onAddRow")((function(e,t){Object(c.V)(t.tableQuery.folderId)||t.totalRowsInView++,O(e,t)})),P=Object(l.action)("rowNotificationHandler.onUpdateRow")((function(e,t){O(e,t)})),D=Object(l.action)("rowNotificationHandler.onDeleteRow")((function(e,t){const n=e.InstanceKey;if(!n)throw new Error("onDeleteNotification: Row instanceKey should not be null");t.totalRowsInView--,Object(s.j)(e,t)&&Object(i.a)(n,t)>=0&&(Object(o.a)([n],t,"DeleteNotification"),Object(c.bb)(t,3))})),E=Object(l.action)("rowNotificationHandler.onReload")((function(e,t={conversations:N.a,items:p.u.items}){!function(e,t){switch(e.tableQuery.listViewType){case 0:t.conversations.clear();const n=t.conversations.getItemIds();for(let i=0,a=n.length;i<a;i++){const a=n[i];if(t.conversations.has(a)){const n=t.conversations.get(a);f.c.importAndExecute(n.conversationId,e)}}break;case 1:for(const n of e.rowKeys){const i=c.b.getRowClientItemId(n,e),a=t.items.get(i.Id);j(a),t.items.get(i.Id).NormalizedBody&&f.c.importAndExecute(i,e)}}}(e,t),Object(w.a)(e),I.a.clearMapForFolder(e.serverFolderId)}));Object(k.mutator)(j,e=>{const t=e.item;Object(S.d)(t.ConversationId.Id,0)||Object(S.e)(t.ItemId.Id,0)||(t.NormalizedBody=void 0)});var A=n(1683),Q=n(4309),x=n(1705),M=n(2316);var _=n(2929),B=n(1810),L=n(6221),U=n(6807);const K={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToRowNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listViewType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReactListViewType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TableQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToRowNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"listViewType"},value:{kind:"Variable",name:{kind:"Name",value:"listViewType"}}},{kind:"ObjectField",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoryName"},value:{kind:"Variable",name:{kind:"Name",value:"categoryName"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationPayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"EventType"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationChangePayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConversationTypeFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"Item"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ItemRowFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationDeletePayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"}}]}},{kind:"Field",name:{kind:"Name",value:"Item"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"}}]}}]}}]}}]}},...L.a.definitions,...U.a.definitions]};var q=n(702),G=n(1814),H=n(5766);var z=n(20);const W=new z.c(()=>n.e(2064).then(n.bind(null,19505))),Y=new z.a(W,e=>e.subscribeToChannelReadyNotification),$={};function Z(e){const t=$[e];if(t){te(Object(c.L)().tableViews.get(e))?function(e){e.unsubscribe()}(t):B.k.importAndExecute(t,V),delete $[e]}}function J(e){if($[e.id])return;if(0!==e.tableQuery.type&&2!==e.tableQuery.type&&3!==e.tableQuery.type)throw new Error("subscribeToRowNotifications should only be called for Folder, Group or GroupFolder table type");const t=e.tableQuery;1!=t.sortBy.sortColumn||Object(p.m)(e.tableQuery.folderId)||Object(A.C)(e.tableQuery.folderId,"SharedMailbox")||"spotlight"!==t.scenarioType&&(te(e)?(Y.importAndExecute(),async function(e){const t=e.tableQuery,n=Object(q.a)();return Object(H.a)(()=>n.subscribe({query:K,variables:{subscriptionId:e.id,folderId:e.tableQuery.folderId,listViewType:Object(c.s)(t.listViewType),type:Object(c.u)(e.tableQuery.type),categoryName:t.categoryName,focusedViewFilter:Object(c.r)(t.focusedViewFilter),viewFilter:Object(c.v)(t.viewFilter),sortBy:{sortColumn:Object(c.t)(t.sortBy.sortColumn),sortDirection:t.sortBy.sortDirection,canSortByRenewTime:Object(s.l)(t)},shapeName:Q.c(e.tableQuery.folderId,Object(c.T)(t.scenarioType)),isScheduledFolder:"scheduled"==Object(h.a)(e.tableQuery.folderId),mailboxInfo:Object(G.d)(t)}}),{next:e=>V(e.data.subscribeToRowNotifications),error:t=>{V({id:e.id,EventType:"Reload"})}},"RowNotifications")}(e).then(t=>{$[e.id]=t})):B.b.import().then(n=>{const i={NotificationType:"RowNotification",FolderId:X(e),FocusedViewFilter:t.focusedViewFilter,IsConversation:0==t.listViewType,CategoryFilter:t.categoryName,Filter:t.viewFilter,ChannelId:n(),MailboxId:ee(e)};!0===i.IsConversation?(i.ConversationShapeName=Q.c(e.tableQuery.folderId,Object(c.T)(t.scenarioType)),i.ConversationResponseShape=Q.b(e.tableQuery.folderId),i.SortBy=function(e){const t=e.sortBy;let n;switch(e.sortBy.sortColumn){case 1:Object(s.l)(e)&&(n="ConversationLastDeliveryOrRenewTime");break;case 3:n="ConversationUniqueSenders";break;case 7:n="ConversationSize";break;case 8:n="ConversationTopic";break;case 5:n="ConversationImportance";break;default:throw new Error("getConversationSortByProperty: sort column is not supported "+t.sortColumn)}const i=[];n&&i.push(Object(M.a)({Order:t.sortDirection,Path:Object(x.a)({FieldURI:n})}));const a=1==e.sortBy.sortColumn?e.sortBy.sortDirection:c.c.DESCENDING_SORT_DIR;return i.push(Object(M.a)({Order:a,Path:Object(x.a)({FieldURI:"ConversationLastDeliveryTime"})})),i}(t)):i.SortBy=Object(_.a)(t);const a={subscriptionId:e.id,requiresExplicitSubscribe:!0,subscriptionParameters:i};B.j.importAndExecute(a,V),$[e.id]=a}))}function X(e){return 0===e.tableQuery.type?e.tableQuery.folderId:3===e.tableQuery.type?null==(t=e.tableQuery.folderId)?void 0:t.split("/").join("-").split("+").join("_"):null;var t}function ee(e){return 2===e.tableQuery.type?e.tableQuery.folderId:3===e.tableQuery.type?e.tableQuery.groupId:null}function te(e){return e&&(0==e.tableQuery.listViewType||1==e.tableQuery.listViewType&&Object(v.j)("mon-messageList-useGqlForFindItem"))}n.d(t,"subscribeToRowNotifications",(function(){return J})),n.d(t,"unsubscribeToRowNotifications",(function(){return Z}))},2195:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1793),a=n(2349);function o(e){return Object(i.b)().loadedItemReadingPaneViewStates.get(e||Object(a.a)())}},2202:function(e,t,n){"use strict";var i=n(20),a=n(2647),o=n(2194),r=n(2089),d=n(2137),c=n(2313),l=n(2314),u=n(2412),s=n(2648),b=n(2496),f=n(1793),m=n(1690);function p(e,t){return!!e&&(1!==t&&!!m.a.conversations.get(e))}function v(e,t){return 2!=t&&f.a.loadedItemReadingPaneViewStates.has(e)}var y=n(2286),O=n(2287),w=n(2195),k=n(1902);n.d(t,"l",(function(){return I})),n.d(t,"p",(function(){return N})),n.d(t,"m",(function(){return S})),n.d(t,"q",(function(){return T})),n.d(t,"s",(function(){return g})),n.d(t,"n",(function(){return R})),n.d(t,"o",(function(){return h})),n.d(t,"i",(function(){return V})),n.d(t,"j",(function(){return F})),n.d(t,"k",(function(){return C})),n.d(t,"g",(function(){return P})),n.d(t,"r",(function(){return D})),n.d(t,"h",(function(){return E})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return y.a})),n.d(t,"a",(function(){return O.a})),n.d(t,"t",(function(){return f.a})),n.d(t,"c",(function(){return w.a})),n.d(t,"b",(function(){return k.a}));const j=new i.c(()=>Promise.all([n.e(0),n.e(5),n.e(6),n.e(11),n.e(14),n.e(17),n.e(18),n.e(24),n.e(27),n.e(30),n.e(41),n.e(63),n.e(73),n.e(75),n.e(157),n.e(198),n.e(185),n.e(206),n.e(260),n.e(275),n.e(240),n.e(331),n.e(417)]).then(n.bind(null,19099)));let I=new i.a(j,e=>e.loadConversationReadingPane),N=new i.a(j,e=>e.moveReadingPaneToTab),S=new i.a(j,e=>e.loadConversationReadingPaneForSingleMailItemSelected),T=new i.a(j,e=>e.print),g=new i.a(j,e=>e.setItemIdToScrollTo),R=new i.a(j,e=>e.loadItemReadingPane),h=new i.a(j,e=>e.loadItemReadingPaneForSingleMailItemSelected),V=new i.a(j,e=>e.expandCollapseAllItemParts);Object(i.f)(r.a,j,e=>e.deleteItemsStoreUpdateOrchestrator),Object(i.f)(c.a,j,e=>e.markConversationsAsReadStoreUpdateOrchestrator),Object(i.f)(l.a,j,e=>e.markItemsAsReadStoreUpdateOrchestrator),Object(i.f)(d.a,j,e=>e.markAllAsReadOrchestrator),Object(i.f)(a.a,j,e=>e.applyConversationFlagStateStoreUpdateOrchestrator),Object(i.f)(o.a,j,e=>e.deleteConversationStoreUpdateOrchestrator),Object(i.f)(b.a,j,e=>e.conversationReadyToLoadOrchestrator),Object(i.f)(b.b,j,e=>e.updateAttachmentsOrchestrator),Object(i.f)(b.c,j,e=>e.updateItemMandatoryPropertiesOrchestrator),Object(i.f)(u.a,j,e=>e.updateInternetMessageIdOrchestrator),Object(i.f)(s.a,j,e=>e.initializeExtendedCardForItemReadingPaneOrchestrator);new i.b(j,e=>e.getLastestNonDraftItemId);let F=new i.b(j,e=>e.getLatestNonDraftItemIdFromConversation),C=new i.b(j,e=>e.isUnsupportedItem),P=new i.a(j,e=>e.clearReadingPaneStore),D=new i.a(j,e=>e.replyByMeeting),E=new i.a(j,e=>e.ensureSecondaryReadingPaneTabHandler)},2286:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(44);function a(){return Object(i.j)("rp-linkedInViewProfile")||Object(i.j)("rp-linkedInViewProfileV1_1")}},2287:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i="displaylinkedindataprebind"},2349:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(797),a=n(2606);function o(){const e=Object(i.d)();switch(e.type){case i.a.SecondaryReadingPane:return e.data.id.Id;case i.a.Primary:default:return Object(a.a)()}}},2412:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("updateInternetMessageId",(e,t,n)=>({conversationId:e,itemId:t,internetMessageId:n}))},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return d}));var i=n(274),a=n(3);const o={tabs:[{id:"primaryTab",type:i.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1,isTabBarAvailable:!1};let r=Object(a.createStore)("tab",o);r();const d=r().tabs[0]},2496:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r}));var i=n(3);const a=Object(i.action)("CONVERSATION_READY_TO_LOAD",(e,t)=>({conversationId:e,nodeIdCollectionChange:t})),o=Object(i.action)("UPDATE_ATTACHMENTS"),r=Object(i.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(e,t)=>({conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}))},2606:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1793),a=n(597);function o(){var e,t;return Object(a.w)()?null===(e=Object(i.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(i.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},2647:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(e,t,n)=>({conversationIds:e,flagType:t,tableViewId:n}))},2648:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("initializeExtendedCardForItemReadingPane",(e,t)=>({itemReadingPaneViewState:e,loadedItem:t}))},274:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.MailCompose=3]="MailCompose",e[e.SxS=4]="SxS",e[e.CalendarCompose=5]="CalendarCompose",e[e.CalendarReadingPane=6]="CalendarReadingPane"}(i||(i={}))},5032:function(e,t,n){"use strict";var i=n(61),a=n(1986),o=n(699);let r=Object(o.action)("onReloadTableSucceeded")((function(e,t,n){Object(a.h)(t,e,n,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),d=Object(o.action)("onReloadTableFailed")((function(e){Object(i.o)("TnS_ReloadError",[e])}));var c=n(2465),l=n(44),u=n(2645),s=n(2048),b=n(1820),f=n(2929),m=n(417),p=n(1679),v=n(1814);const y=new m.a(1,(async function(e){const t=e.tableViewId,n=Object(p.L)().tableViews.get(t);if(!n)return Promise.resolve();const o=Math.max(n.currentLoadedIndex,b.a);switch(n.tableQuery.listViewType){case 0:await function(e,t){var n;const i=e.tableQuery,o=Object(p.l)(e,!0),l=null===(n=o)||void 0===n?void 0:n.Id;return Object(s.d)(i.folderId,t,i.viewFilter,i.sortBy,Object(a.l)(i),i.focusedViewFilter,i.requestShapeName,Object(v.d)(i),void 0,i.categoryName,l).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalConversationRowsInView)}).catch(e=>{const t=Object(c.a)(e);d(t)})}(n,o);break;case 1:await function(e,t){const n=e.tableQuery;return Object(l.j)("mon-messageList-useGqlForFindItem")?Object(s.h)(Object(p.k)(n),t,n.viewFilter,n.sortBy,Object(a.l)(n),n.focusedViewFilter,n.requestShapeName,Object(v.d)(n),void 0,Object(v.e)(n),n.categoryName,Object(p.l)(e,!0)).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalItemRowsInView)}).catch(e=>{const t=Object(c.a)(e);d(t)}):Object(s.c)(Object(p.k)(n),0,t,n.viewFilter,Object(f.a)(n),n.focusedViewFilter,n.requestShapeName,void 0,Object(v.e)(n),n.categoryName,Object(p.l)(e,!0)).then(t=>{"Success"==t.ResponseClass?r(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView):d(t.ResponseCode)}).catch(e=>{d()})}(n,o)}0==n.tableQuery.type&&Object(u.a)(n.tableQuery.folderId);return Object(i.o)("ReloadTable",[o],{sessionSampleRate:10}),Promise.resolve()}),150);t.a=Object(o.action)("reloadMailListTableAction")((function(e){1===e.tableQuery.type||Object(p.V)(e.tableQuery.folderId)||y.add({tableViewId:e.id})}))},5766:function(e,t,n){"use strict";var i=n(61),a=n(2),o=n(560),r=n(40);const d=10;function c(e,t,n){let c,l=0;const u={next:e=>{var n;return null===(n=t.next)||void 0===n?void 0:n.call(t,e)},complete:()=>{var e;return null===(e=t.complete)||void 0===e?void 0:e.call(t)},error:s=>{var b;Object(i.o)("GraphqlSubscriptionError",{owa_1:n,owa_2:Object(a.T)(null==s?void 0:s.toString()),owa_3:Object(a.T)(null==s?void 0:s.stack),owa_4:l},{isCore:!0}),Object(o.isApolloError)(s)&&(l++<d?(null==c||c.unsubscribe(),c=e().subscribe(u)):Object(r.d)(`${n}: too many apollo errors`)),null===(b=t.error)||void 0===b||b.call(t,s)}};return c=e().subscribe(u),{closed:!c||c.closed,unsubscribe:()=>null==c?void 0:c.unsubscribe()}}n.d(t,"a",(function(){return c}))},6823:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("ROW_UPDATED",(e,t)=>({rowKey:e,tableView:t}))},7014:function(e,t,n){"use strict";function i(e,t){return t.rowKeys.indexOf(e)}n.d(t,"a",(function(){return i}))},7838:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return c}));var i=n(2402),a=n(1679),o=n(1986);function r(e,t,n,i){const r=new Date(a.b.getLastDeliveryTimeStamp(n,i)).getTime()-new Date(t).getTime();if(Object(o.l)(i.tableQuery)){const t=new Date(a.b.getLastDeliveryOrRenewTimeStamp(n,i)).getTime()-new Date(e).getTime();return 0!=t?t:r}return r}function d(e,t,n,a,r){return Object(i.a)(r,n.id,e)?Object(o.f)(n,0):c(e,t,n,a)}function c(e,t,n,o){const d=n.rowKeys.length;if(0==d)return 0;const c=Object(a.K)(n).sortDirection==a.c.DESCENDING_SORT_DIR;let l;for(l=o;l<d;l++){const a=n.rowKeys[l];if(Object(i.a)(a,n.id,e))continue;const o=r(e,t,a,n);if(c?o<=0:o>0)return l}return d==n.totalRowsInView?d:-1}},797:function(e,t,n){"use strict";var i=n(20),a=n(246),o=n(949),r=n(274);function d(e){const t=Object(a.a)();for(const n of t.tabs)if(n.type!==r.a.Primary&&n.type!==r.a.SxS&&n.data==e)return n;return null}function c(e){const t=Object(a.a)();for(const n of t.tabs)if(n.sxsId===e)return n.id;return null}function l(e){var t,n;const i=Object(a.a)();for(const a of i.tabs)if(a.type!==r.a.Primary&&a.type!==r.a.SxS&&(null===(n=null===(t=a.data)||void 0===t?void 0:t.id)||void 0===n?void 0:n.Id)==e)return!0;return!1}function u(e,t){var n,i;const o=Object(a.a)();for(const a of o.tabs)if(a.type!==r.a.Primary&&a.type!==r.a.SxS&&(null===(i=null===(n=a.data)||void 0===n?void 0:n.id)||void 0===i?void 0:i.Id)==e&&a.id!=t)return!0;return!1}function s(e){switch(e.type){case r.a.SecondaryReadingPane:return e.data.subject;default:return null}}var b=n(950);n(962);function f(e){for(const t of Object(a.a)().tabs)if(t.id===e)return t.firstRibbonRenderCompleted;return!1}var m=n(3),p=n(1008);Object(m.mutator)(p.a,e=>{for(const t of Object(a.a)().tabs)t.id===e.tabId&&(t.firstRibbonRenderCompleted=!0)}),n.d(t,"h",(function(){return y})),n.d(t,"i",(function(){return O})),n.d(t,"j",(function(){return w})),n.d(t,"n",(function(){return k})),n.d(t,"l",(function(){return j})),n.d(t,"m",(function(){return I})),n.d(t,"k",(function(){return N})),n.d(t,"f",(function(){return a.a})),n.d(t,"p",(function(){return a.b})),n.d(t,"d",(function(){return o.a})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return c})),n.d(t,"r",(function(){return l})),n.d(t,"o",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return r.a})),n.d(t,"q",(function(){return b.b})),n.d(t,"e",(function(){return f}));const v=new i.c(()=>n.e(923).then(n.bind(null,19473)));let y=new i.a(v,e=>e.activateTab),O=new i.a(v,e=>e.addTab),w=new i.a(v,e=>e.closeTab),k=new i.a(v,e=>e.setTabIsShown),j=new i.a(v,e=>e.reloadSecondaryTabAsDeeplink),I=new i.a(v,e=>e.setFirstRenderCompleted),N=new i.b(v,e=>e.getTabById)},949:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(246),a=n(40);function o(){const e=Object(i.a)();for(const t of e.tabs)if(2==t.state)return t;return a.d("There is no active tab. Something went very wrong."),null}},950:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var i=n(274);const a={};function o(e,t){a[i.a[e]]=t}function r(e){return a[i.a[e]]}},962:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(246);function a(){return Object(i.a)().tabs.filter(e=>3===e.state)}}}]);
//# sourceMappingURL=owa.784.js.map
self.scriptsLoaded['owa.784.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.784.js'] = (new Date()).getTime();