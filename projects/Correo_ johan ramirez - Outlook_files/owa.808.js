self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.808.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[808],{16313:function(t){t.exports=JSON.parse('{"a":"oba"}')},1971:function(t,e,n){"use strict";var a=n(926),r=n(713),c=n(918),o=n(931),u=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Object(a.a)(e,Object(c.a)(t)),t=Object(r.a)(t);return e}:o.a;e.a=u},2222:function(t,e,n){"use strict";var a=n(930),r=n(1971),c=n(706);e.a=function(t){return Object(a.a)(t,c.a,r.a)}},2242:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,a=null==t?0:t.length;++n<a&&!1!==e(t[n],n,t););return t}},2351:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o}));var a=n(3),r=n(3264);const c=Object(a.createStore)("signature",Object(r.a)()),o=c()},2457:function(t,e,n){"use strict";var a=n(459),r=n(2242),c=n(1053),o=n(915),u=n(552);var i=function(t,e){return t&&Object(o.a)(e,Object(u.a)(e),t)},s=n(706);var b=function(t,e){return t&&Object(o.a)(e,Object(s.a)(e),t)},l=n(966),j=n(965),f=n(918);var g=function(t,e){return Object(o.a)(t,Object(f.a)(t),e)},O=n(1971);var d=function(t,e){return Object(o.a)(t,Object(O.a)(t),e)},v=n(808),m=n(2222),S=n(800),y=Object.prototype.hasOwnProperty;var p=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&y.call(t,"index")&&(n.index=t.index,n.input=t.input),n},h=n(1044);var w=function(t,e){var n=e?Object(h.a)(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},A=/\w*$/;var x=function(t){var e=new t.constructor(t.source,A.exec(t));return e.lastIndex=t.lastIndex,e},M=n(354),R=M.a?M.a.prototype:void 0,E=R?R.valueOf:void 0;var I=function(t){return E?Object(E.call(t)):{}},N=n(967),C="[object Boolean]",U="[object Date]",k="[object Map]",$="[object Number]",_="[object RegExp]",D="[object Set]",L="[object String]",B="[object Symbol]",P="[object ArrayBuffer]",F="[object DataView]",K="[object Float32Array]",V="[object Float64Array]",W="[object Int8Array]",T="[object Int16Array]",H="[object Int32Array]",G="[object Uint8Array]",J="[object Uint8ClampedArray]",q="[object Uint16Array]",z="[object Uint32Array]";var Q=function(t,e,n){var a=t.constructor;switch(e){case P:return Object(h.a)(t);case C:case U:return new a(+t);case F:return w(t,n);case K:case V:case W:case T:case H:case G:case J:case q:case z:return Object(N.a)(t,n);case k:return new a;case $:case L:return new a(t);case _:return x(t);case D:return new a;case B:return I(t)}},X=n(968),Y=n(247),Z=n(502),tt=n(293),et="[object Map]";var nt=function(t){return Object(tt.a)(t)&&Object(S.a)(t)==et},at=n(1021),rt=n(830),ct=rt.a&&rt.a.isMap,ot=ct?Object(at.a)(ct):nt,ut=n(227),it="[object Set]";var st=function(t){return Object(tt.a)(t)&&Object(S.a)(t)==it},bt=rt.a&&rt.a.isSet,lt=bt?Object(at.a)(bt):st,jt=1,ft=2,gt=4,Ot="[object Arguments]",dt="[object Function]",vt="[object GeneratorFunction]",mt="[object Object]",St={};St[Ot]=St["[object Array]"]=St["[object ArrayBuffer]"]=St["[object DataView]"]=St["[object Boolean]"]=St["[object Date]"]=St["[object Float32Array]"]=St["[object Float64Array]"]=St["[object Int8Array]"]=St["[object Int16Array]"]=St["[object Int32Array]"]=St["[object Map]"]=St["[object Number]"]=St[mt]=St["[object RegExp]"]=St["[object Set]"]=St["[object String]"]=St["[object Symbol]"]=St["[object Uint8Array]"]=St["[object Uint8ClampedArray]"]=St["[object Uint16Array]"]=St["[object Uint32Array]"]=!0,St["[object Error]"]=St[dt]=St["[object WeakMap]"]=!1;e.a=function t(e,n,o,f,O,y){var h,w=n&jt,A=n&ft,x=n&gt;if(o&&(h=O?o(e,f,O,y):o(e)),void 0!==h)return h;if(!Object(ut.a)(e))return e;var M=Object(Y.a)(e);if(M){if(h=p(e),!w)return Object(j.a)(e,h)}else{var R=Object(S.a)(e),E=R==dt||R==vt;if(Object(Z.a)(e))return Object(l.a)(e,w);if(R==mt||R==Ot||E&&!O){if(h=A||E?{}:Object(X.a)(e),!w)return A?d(e,b(h,e)):g(e,i(h,e))}else{if(!St[R])return O?e:{};h=Q(e,R,w)}}y||(y=new a.a);var I=y.get(e);if(I)return I;y.set(e,h),lt(e)?e.forEach((function(a){h.add(t(a,n,o,a,e,y))})):ot(e)&&e.forEach((function(a,r){h.set(r,t(a,n,o,r,e,y))}));var N=x?A?m.a:v.a:A?s.a:u.a,C=M?void 0:N(e);return Object(r.a)(C||e,(function(a,r){C&&(a=e[r=a]),Object(c.a)(h,r,t(a,n,o,r,e,y))})),h}},3264:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(14);function r(){return{legacySignature:{html:null,txt:null},roamingSignatureMap:new a.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""}}},5111:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return r})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"i",(function(){return i})),n.d(e,"h",(function(){return s})),n.d(e,"e",(function(){return b})),n.d(e,"c",(function(){return l}));const a="/ows/beta/OutlookCloudSettings/settings/account",r="Roaming_Signature_List",c="Roaming_New_Signature",o="Roaming_Reply_Signature",u="signaturehtml",i="signaturetxt",s=r.toLowerCase(),b=c.toLowerCase(),l=o.toLowerCase()},5387:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n(20);const r=new a.c(()=>n.e(2076).then(n.bind(null,8224)));let c=new a.a(r,t=>t.loadSignatureInUserOptions)},5441:function(t,e,n){"use strict";var a=n(2457),r=4;e.a=function(t){return Object(a.a)(t,r)}},552:function(t,e,n){"use strict";var a=n(725),r=n(944),c=n(385);e.a=function(t){return Object(c.a)(t)?Object(a.a)(t):Object(r.a)(t)}},6411:function(t,e,n){"use strict";n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return j})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return g}));var a=n(2351),r=n(312),c=n(5111),o=n(29);const u=621355968e9,i=1e4,s="encoding:utf-8",b={"x-outlook-client":"owa",Accept:"application/json","x-overridetimestamp":!0};function l(t){const e=[];t.forEach((t,n)=>{e.push(...function(t){var e,n;const a=null===(e=t.html)||void 0===e?void 0:e.name,r=t.txt?t.txt.value:"";return[O(a,null===(n=t.html)||void 0===n?void 0:n.value,"Blob","RoamingSetting","htm",!0,"roaming_signature_list"),O(a,r,"Blob","RoamingSetting","txt",!0,"roaming_signature_list")]}(t))}),e.length>0&&Object(r.d)(c.a,e,void 0,!0,Object.assign(Object.assign({},b),{"x-islargesetting":!0}))}function j(){const{roamingSignatureMap:t}=a.b,e=[];t.forEach(t=>{var n;(null===(n=t.html)||void 0===n?void 0:n.name)&&e.push(t.html.name)});const n=[O(c.g,e.join(),"BlobArray","RoamingSetting",c.g,!1)];Object(r.d)(c.a,n,void 0,!0,b)}function f(t){const e=[O(c.d,t,"String","RoamingSetting",c.d,!1)];Object(r.d)(c.a,e,void 0,!0,b)}function g(t){const e=[O(c.b,t,"String","RoamingSetting",c.b,!1)];Object(r.d)(c.a,e,void 0,!0,b)}function O(t,e,n,a,r,c,b){var l;const j={name:t,value:e,type:n,scope:null===(l=Object(o.a)().SessionSettings)||void 0===l?void 0:l.UserEmailAddress,itemClass:a,timestamp:u+Date.now()*i,secondaryKey:r,metadata:s};return b&&(j.parentSetting=b),c&&(j["value@is.Large"]=c),j}},707:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o}));var a=n(121),r=n(12);function c(){return Object(a.a)("acctmonaccounts")&&Object(r.i)("acctmonaccounts")}function o(){return c()||!Object(a.a)("acctmonaccounts")&&Object(r.i)("accountsapi")}},712:function(t,e,n){"use strict";var a=n(313),r=n(222),c=Object(a.a)(r.a,"Set");e.a=c},800:function(t,e,n){"use strict";var a=n(313),r=n(222),c=Object(a.a)(r.a,"DataView"),o=n(469),u=Object(a.a)(r.a,"Promise"),i=n(712),s=Object(a.a)(r.a,"WeakMap"),b=n(335),l=n(415),j=Object(l.a)(c),f=Object(l.a)(o.a),g=Object(l.a)(u),O=Object(l.a)(i.a),d=Object(l.a)(s),v=b.a;(c&&"[object DataView]"!=v(new c(new ArrayBuffer(1)))||o.a&&"[object Map]"!=v(new o.a)||u&&"[object Promise]"!=v(u.resolve())||i.a&&"[object Set]"!=v(new i.a)||s&&"[object WeakMap]"!=v(new s))&&(v=function(t){var e=Object(b.a)(t),n="[object Object]"==e?t.constructor:void 0,a=n?Object(l.a)(n):"";if(a)switch(a){case j:return"[object DataView]";case f:return"[object Map]";case g:return"[object Promise]";case O:return"[object Set]";case d:return"[object WeakMap]"}return e});e.a=v},808:function(t,e,n){"use strict";var a=n(930),r=n(918),c=n(552);e.a=function(t){return Object(a.a)(t,c.a,r.a)}},8209:function(t,e,n){"use strict";n.r(e);var a=n(703),r=n(312),c=n(3),o=n(2351),u=Object(c.mutatorAction)("setDefaultSignatureName",(t,e)=>{e?Object(o.a)().defaultReplySignatureName=t:Object(o.a)().defaultSignatureName=t}),i=Object(c.mutatorAction)("setLegacySignatureInStore",(t,e)=>{"html"==t?Object(o.a)().legacySignature.html=e:"txt"==t&&(Object(o.a)().legacySignature.txt=e)}),s=Object(c.mutatorAction)("setRoamingSignatureInStore",t=>{const{roamingSignatureMap:e}=Object(o.a)();if("htm"==t.secondaryKey){let n=e.get(t.name);n?n.html=t:n={html:t,txt:null},e.set(t.name,n)}else if("txt"==t.secondaryKey){let n=e.get(t.name);n?n.txt=t:n={html:null,txt:t},e.set(t.name,n)}}),b=n(5111),l=n(49),j=n(6411),f=n(5),g=n(16313);const O="dataURI";function d(){var t,e;const{roamingSignatureMap:n,legacySignature:a}=Object(o.a)(),r=Object(l.g)().UserOptions,c=null===(t=a.html)||void 0===t?void 0:t.value;if(!c)return;const i=function(t){var e;const n=(new DOMParser).parseFromString(t,"text/html"),a=n.getElementsByTagName("img");for(let t=0;t<a.length;t++){let n=a[t];if(!n.currentSrc){let t=n.nextElementSibling;(null==t?void 0:t.id)==O&&(t.textContent&&(n.src=t.textContent),null===(e=n.parentElement)||void 0===e||e.removeChild(t))}}return n.body.innerHTML}(c),b={name:Object(f.b)(g.a),value:i,secondaryKey:"htm"};if(s(b),null===(e=a.txt)||void 0===e?void 0:e.value){const t={name:Object(f.b)(g.a),value:a.txt.value,secondaryKey:"txt"};s(t)}Object(j.c)(n),Object(j.d)(),r&&(r.AutoAddSignature&&(u(Object(f.b)(g.a),!1),Object(j.b)(Object(f.b)(g.a))),r.AutoAddSignatureOnReply&&(u(Object(f.b)(g.a),!0),Object(j.a)(Object(f.b)(g.a))))}let v;async function m(t){return v&&!t||(v=Object(r.b)(`${b.a}?settingname=${b.f},${b.i},${b.h},${b.e},${b.c}`,void 0,!1,{"x-outlook-client":"owa"}).then(e=>{if(!t||t===Object(a.a)().selectedAccountSourceId){let t;e.forEach(e=>{var n;switch(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()){case b.f:i("html",e);break;case b.i:i("txt",e);break;case b.h:t=e.value,function(t){Object(r.b)(`${b.a}?settingname=${t}`,void 0,!1,{"x-islargesetting":!0}).then(t=>{t.forEach(t=>{s(t)})})}(e.value);break;case b.e:u(e.value,!1);break;case b.c:u(e.value,!0)}}),t&&""!=t||d()}})),v}var S=n(5387),y=n(29),p=n(44);async function h(t){if(Object(p.j)("cmp-roaming-signature")&&!(null===(e=Object(y.a)().SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)){const e=Object(o.a)();if(null==e.legacySignature.html||null==e.legacySignature.txt)return m(t)}else{const t=Object(y.a)().UserOptions;if(t&&(null==t.SignatureHtml||null==t.SignatureText))return S.a.importAndExecute()}var e;return Promise.resolve()}var w=n(5441),A=n(707),x=n(20),M=n(1736),R=n(3264);const E=new Map,I=Object(x.e)(M.a,"clone_onSelectedAccountChanged",t=>{if(!Object(A.b)())throw new Error(`Reset Signature store for account selection change is called when multi accounts is turned off. ${t.selectedEmailAddress}`);const e=Object(w.a)(o.b);E.set(t.oldSourceId,e);const n=E.get(t.selectedAccountSourceId);n?N(n):(N(Object(R.a)()),h(t.selectedAccountSourceId))}),N=Object(c.mutatorAction)("resetStoreForAccountSelectionChange",t=>{o.b.legacySignature=t.legacySignature,o.b.roamingSignatureMap=t.roamingSignatureMap,o.b.defaultSignatureName=t.defaultSignatureName,o.b.defaultReplySignatureName=t.defaultReplySignatureName});n.d(e,"loadSignature",(function(){return h})),n.d(e,"resetSignatureStoreOrchestrator",(function(){return I}))},918:function(t,e,n){"use strict";var a=n(952),r=n(931),c=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,u=o?function(t){return null==t?[]:(t=Object(t),Object(a.a)(o(t),(function(e){return c.call(t,e)})))}:r.a;e.a=u},926:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,a=e.length,r=t.length;++n<a;)t[r+n]=e[n];return t}},930:function(t,e,n){"use strict";var a=n(926),r=n(247);e.a=function(t,e,n){var c=e(t);return Object(r.a)(t)?c:Object(a.a)(c,n(t))}},931:function(t,e,n){"use strict";e.a=function(){return[]}},944:function(t,e,n){"use strict";var a=n(563),r=n(726),c=Object(r.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;e.a=function(t){if(!Object(a.a)(t))return c(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},952:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,a=null==t?0:t.length,r=0,c=[];++n<a;){var o=t[n];e(o,n,t)&&(c[r++]=o)}return c}}}]);
//# sourceMappingURL=owa.808.js.map
self.scriptsLoaded['owa.808.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.808.js'] = (new Date()).getTime();