self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.844.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[844,863],{12879:function(e,n,t){"use strict";t.r(n);var r=t(4259),o=t(1705),i=t(1765),u=t(700),s=t(598),d=t(3116),a=t(3559),c=t(3613),l=t(245);t.d(n,"foldersWeb",(function(){return f}));const f=async(e,n,t,f)=>{var p,I;let g,y=[];(null===(p=n.options)||void 0===p?void 0:p.additionalProperties)?(y=n.options.additionalProperties.map(e=>"totalMessageCount"===e?Object(o.a)({FieldURI:"TotalCount"}):Object(o.a)({FieldURI:e})),y.push(Object(o.a)({FieldURI:"ParentFolderId"}))):g="Folder";const v=await async function(e,n,t,r,o){return Object(c.a)({Header:Object(l.b)(),Body:Object(a.a)({FolderShape:Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:e}),ShapeName:t,FolderIds:n.map(e=>Object(s.a)({Id:e}))})},Object(u.a)(r,o)).then(e=>{var n,t;return null===(t=null===(n=e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===t?void 0:t.Items})}(y,n.ids,g,null===(I=n.options)||void 0===I?void 0:I.mailboxInfo,t.requestOptions);await Object(i.a)(v);const F=[];if(v.forEach(e=>{var t;null===(t=e.Folders)||void 0===t||t.forEach(e=>{const t=Object(r.c)(e,n.options.mailboxInfo);t&&F.push(t)})}),0===F.length)throw new Error("foldersWeb: failed to get folders");return F}},1688:function(e,n,t){"use strict";t.d(n,"f",(function(){return r})),t.d(n,"d",(function(){return o})),t.d(n,"k",(function(){return i})),t.d(n,"a",(function(){return u})),t.d(n,"h",(function(){return s})),t.d(n,"b",(function(){return d})),t.d(n,"i",(function(){return a})),t.d(n,"m",(function(){return c})),t.d(n,"l",(function(){return l})),t.d(n,"j",(function(){return f})),t.d(n,"c",(function(){return p})),t.d(n,"e",(function(){return I})),t.d(n,"g",(function(){return g}));const r=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",u="archivedeleteditems",s="deleteditems",d="archiverecoverableitemsdeletions",a="recoverableitemsdeletions",c="msgfolderroot",l="sharedFolderTree",f="primaryFolderTree",p="archiveFolderTree",I="favorites",g="groups"},1705:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"PropertyUri:#Exchange"},e)}t.d(n,"a",(function(){return r}))},1765:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1777),o=t(1774);function i(e){if(!e)return Promise.reject(Object(r.a)("500","Server returned a null response!",null));const n=Array.isArray(e)?e:[e];for(const e of n)if(e&&!Object(o.a)(e))return Promise.reject(Object(r.a)(e.ResponseCode,e.StackTrace,e.MessageText));return Promise.resolve()}},1774:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));const r="Success";function o(e){return e&&e.ResponseClass==r}},1777:function(e,n,t){"use strict";function r(e,n,t){let r="ResponseCode="+e;n&&(r+=", Stacktrace="+n);const o=new Error(r);return o.responseCode=e,o.fetchErrorType="ServerFailure",t&&(o.diagnosticInfo="MessageText= "+t),o}t.d(n,"a",(function(){return r}))},18867:function(e,n,t){"use strict";t.r(n),t.d(n,"folderWeb",(function(){return o}));var r=t(12879);const o=async(e,n,t,o)=>{const i={ids:[n.id],options:n.options};return(await Object(r.foldersWeb)(e,i,t,o))[0]}},245:function(e,n,t){"use strict";t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return a}));var r=t(370),o=t(463),i=t(462),u=t(452),s=t(13);function d(e){return e||(e=Object(s.a)().timezone),e?Object(r.a)({RequestServerVersion:"V2018_01_08",TimeZoneContext:Object(o.a)({TimeZoneDefinition:Object(i.a)({Id:e})})}):Object(r.a)({RequestServerVersion:"V2018_01_08"})}function a(e,n,t){return Object(u.a)({PropertySetId:e,PropertyName:n,PropertyType:t})}},3116:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FolderResponseShape:#Exchange"},e)}t.d(n,"a",(function(){return r}))},3559:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"GetFolderRequest:#Exchange"},e)}t.d(n,"a",(function(){return r}))},3613:function(e,n,t){"use strict";var r=t(32);function o(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetFolderJsonRequest:#Exchange"},t)),Object(r.a)("GetFolder",e,n)}t.d(n,"a",(function(){return o}))},370:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"JsonRequestHeaders:#Exchange"},e)}t.d(n,"a",(function(){return r}))},4259:function(e,n,t){"use strict";var r=function(e,n){var t,r;if(e.ExtendedProperty)for(let o=0;o<e.ExtendedProperty.length;o++){let i=e.ExtendedProperty[o];if((null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyTag)===n||(null===(r=null==i?void 0:i.ExtendedFieldURI)||void 0===r?void 0:r.PropertyName)===n)return i.Value}};var o=e=>{const n=r(e,"SourceWellKnownFolderType");switch(n&&parseInt(n,10)||-1){case 86:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_ARCHIVE";case 87:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_IMPORTANT";case 88:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_STARRED";default:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_UNSPECIFIED"}};var i=e=>r(e,"0x7018")||null;var u=e=>"false"!==r(e,"0x10f4"),s=t(5808);var d=t(1688),a=t(40);function c(e,n,t,r){var o;const i=e.RootFolder;if(!i||!i.Folders||!i.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");let s=[];null==i||i.Folders.forEach(e=>{if(e&&function(e,n,t){if(r=null==e?void 0:e.__type,"Folder:#Exchange"!=r)return!1;var r;if((null==e?void 0:e.DistinguishedFolderId)&&d.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(u(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!n;if("notes"===e.DistinguishedFolderId)return!!t;return!0}(e,t,r)){const t=l(e,n);t&&s.push(t)}});const a=function(e,n){return"SharedMailbox"===n?void 0:e}((null===(o=null==i?void 0:i.ParentFolder)||void 0===o?void 0:o.DistinguishedFolderId)||"none",n.type);i.ParentFolder.DistinguishedFolderId=a;let c=l(i.ParentFolder,n);return{__typename:"FolderHierarchyResult",Folders:s,RootFolder:c,offset:i.IndexedPagingOffset,TotalItemsInView:i.TotalItemsInView,IncludesLastItemInRange:i.IncludesLastItemInRange}}function l(e,n){const t=e,{FolderId:u,ParentFolderId:d,DisplayName:c,ArchiveTag:l,PolicyTag:g,ChildFolderCount:y,UnreadCount:v,TotalCount:F,FolderClass:h,DistinguishedFolderId:b}=t;if(!u||!d)return a.h.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;const m=y||0,_=p(u),E=function(e){const n=r(e,s.a);if(n){const e=atob(n);return[e.substr(0,e.length-1)]}return null}(t);return{id:_.Id,changeKey:_.ChangeKey,__typename:"MailFolder",type:t.__type,parentFolderId:p(d).Id,displayName:c||"",distinguishedFolderType:b||null,FolderClass:h||"IPF.Note",UnreadCount:v||0,totalMessageCount:F||0,ArchiveTag:l?I(l):null,PolicyTag:g?I(g):null,childFolderCount:m,remoteFolderInfo:{remoteFolderDisplayName:i(t),remoteDistinguishedFolderType:o(t)},replicaList:E,PermissionSet:t.PermissionSet,messageSizeInBytes:f(t),pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:n.type,userIdentity:n.userIdentity,mailboxSmtpAddress:n.mailboxSmtpAddress,auxiliaryMailboxGuid:null==E?void 0:E[0]}}}function f(e){var n,t;return null===(t=null===(n=e.ExtendedProperty)||void 0===n?void 0:n[0])||void 0===t?void 0:t.Value}function p(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function I(e){return{__typename:"RetentionTagType",IsExplicit:!!e.IsExplicit,Value:e.Value}}t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return l}))},452:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"ExtendedPropertyUri:#Exchange"},e)}t.d(n,"a",(function(){return r}))},462:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"TimeZoneDefinitionType:#Exchange"},e)}t.d(n,"a",(function(){return r}))},463:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"TimeZoneContext:#Exchange"},e)}t.d(n,"a",(function(){return r}))},5808:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));const r="0x6698"},598:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}t.d(n,"a",(function(){return r}))},700:function(e,n,t){"use strict";function r(e,n){return e?Object.assign({mailboxInfo:e},n):null!=n?n:void 0}t.d(n,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.844.js.map
self.scriptsLoaded['owa.844.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.844.js'] = (new Date()).getTime();