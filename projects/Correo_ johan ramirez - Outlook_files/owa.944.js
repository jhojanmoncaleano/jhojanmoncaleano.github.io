self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.944.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[944,1347],{1271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(14),i=n(951),r=n(115);t.default=function(e,t,n,o){r.getGlobalContext().legacyInDispatch++,a.action(t||"(anonymous action)",i.dispatchWithMiddleware.bind(null,e,t,n,o))(),r.getGlobalContext().legacyInDispatch--}},1272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(799),i=n(115);function r(e,t){var n={};return Object.keys(e).forEach((function(a){void 0===n[a]&&Object.defineProperty(n,a,{enumerable:!0,get:function(){return e[a].apply(null,t)}})})),Object.freeze(n),n}t.default=function(e){return function(t){if(i.getGlobalContext().legacyTestMode)return t;var n=this,o=t.length-1,s=a.getOriginalTarget(t);s&&(o=s.length-1);var c=function(){var a=r(e,arguments),i=Array.prototype.slice.call(arguments);if(void 0===i[o]){for(var s=i.length;s<o;s++)i[s]=void 0;i[o]=a}return t.apply(n,i)};return a.setActionType(c,a.getActionType(t)),c}}},1273:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(14),i=n(947),r=0,o=null;var s=[];function c(e){var t,n=e.object;switch(e.type){case"update":t=void 0!==e.index?{verify:function(){return n[e.index]===e.newValue},objectName:e.name,propertyName:e.index,undo:function(){n[e.index]=e.oldValue}}:void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n[e.key]=e.oldValue}};break;case"splice":t={verify:function(){for(var t=0;t<e.addedCount;t++)if(n[e.index+t]!==e.added[t])return!1;return!0},objectName:e.name,propertyName:e.index,undo:function(){n.splice(e.index,e.addedCount);for(var t=0;t<e.removedCount;t++)n.splice(e.index+t,0,e.removed[t])}};break;case"add":t=void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.delete(e.key)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){delete n[e.key]}};break;case"delete":t={verify:function(){return!n.has(e.key)},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}};break;default:return}s.forEach((function(e){return e.steps.push(t)}))}function u(e,t,n){0===r&&(o=a.spy(c)),r++,s.push({steps:[]});try{var u=t(),l=s[s.length-1],d=!1;l.steps.reverse();var f=i.default("undo-"+e)((function(){if(d)throw"This instance of undo-"+e+" has already been executed";n&&l.steps.forEach((function(e){if(!e.verify())throw'Property "'+e.propertyName+' on store object "'+e.objectName+" changed since action was performed."})),l.steps.forEach((function(e){return e.undo()})),d=!0}));return f.actionReturnValue=u,f}finally{s.pop(),0==--r&&(o(),o=null)}}t.default=function(e,t){return function(n){return u(e,n,!!t)}}},1274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(115);t.initializeTestMode=function(){a.getGlobalContext().legacyTestMode=!0},t.resetTestMode=function(){a.getGlobalContext().legacyTestMode=!1}},1856:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(5);const i="/profile/v1.0/{0}/{1}/image/$value";function r(e,t){const n=e.indexOf("@")>-1,r="GroupMailbox"==t?"groups":"users";return Object(a.c)(i,r,n?e:`cid:${e}`)}},2022:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p}));var a=n(1856),i=n(1712),r=n(1732),o=n(266),s=n(13);const c="email",u="personId",l="UA",d="size",f="/service.svc/s/GetPersonaPhoto";function h(e,t,n,r){if(Object(i.a)()&&Object(i.b)(t,e))return Object(a.a)(e,n);{let n=Object(s.a)().baseUrl,a="";return e&&(a=y(a,c,e&&e.toLowerCase())),t&&(a=y(a,u,t)),a=y(a,l,"0"),a=y(a,d,r?"HR96x96":"HR64x64"),`${n}${f}?${a}`}}function p(e,t,n){return Object(i.a)()?Object(a.a)(e,t):`https://cid-${e}.users.storage.live.com/users/0x${e}/myprofile/expressionprofile/profilephoto:${function(e){switch(e){case r.c.tiny:case r.c.extraExtraSmall:case r.c.extraSmall:case r.c.small:case r.c.regular:case r.c.large:case r.c.size10:case r.c.size8:case r.c.size16:case r.c.size24:case r.c.size28:case r.c.size32:return"UserTileStatic,UserTileSmall";case r.c.extraLarge:case r.c.size40:case r.c.size48:case r.c.size56:case r.c.size72:case r.c.size100:case r.c.size120:return"UserTileMedium,UserTileStatic,UserTileSmall";default:return Object(o.a)(e)}}(n)}/MeControlMediumUserTile?ck=1&ex=24&fofoff=1`}function y(e,t,n){n&&(n=encodeURIComponent(n));let a=`${t}=${n}`;return e&&(a=`${e}&${a}`),a}},2174:function(e,t,n){"use strict";n.r(t);var a=n(2022),i=n(699);function r(e,t){e.isPendingFetch=!1,document.body.removeChild(t)}let o=Object(i.action)("onConsumerPhotoLoad")((function(e,t,n){t.hasFetchFailed=n.width<5||n.height<5,t.blobUrl=t.hasFetchFailed?null:e,r(t,n)})),s=Object(i.action)("onConsumerPhotoError")((function(e,t){e.hasFetchFailed=!0,r(e,t)}));var c=n(3381),u=n(4139),l=n(1681),d=n(1803),f=n(1712),h=n(1811),p=Object(i.action)("getPersonaPhoto")((function(e,t,n,i,r,p,y,b={personaViewStates:l.a.viewStates}){let m=Object(d.a)(t,n,i,p,e);b.personaViewStates.has(m)||b.personaViewStates.set(m,Object(u.a)(e,r||Object(h.a)(t),t,n,i,p));let v=b.personaViewStates.get(m);!Object(f.a)()&&v.hexConsumerIdForUser?function(e){let t=e.personaBlob;if(t.isPendingFetch||t.hasFetchFailed)return;let n=Object(a.b)(e.hexConsumerIdForUser,e.mailboxType,e.size),i=document.createElement("img");i.src=n,i.onload=()=>o(n,t,i),i.onerror=()=>s(t,i),i.style.visibility="hidden",document.body.appendChild(i)}(v):c.a.add({name:e,emailAddress:t,personaId:n,size:i,mailboxType:p,skipLoadingPhoto:y})}));n.d(t,"getPersonaPhoto",(function(){return p}))},3381:function(e,t,n){"use strict";var a=n(417),i=n(20);const r=new i.c(()=>Promise.all([n.e(0),n.e(11),n.e(14),n.e(24),n.e(309),n.e(1013)]).then(n.bind(null,7015)));let o=new i.a(r,e=>e.downloadPersonaPhoto);var s=n(1681),c=n(1803);let u=new a.a(1,(function(e){let t=Object(c.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),n=s.a.viewStates.get(t);return o.importAndExecute(n,!1,e.skipLoadingPhoto)}),500);t.a=u},4139:function(e,t,n){"use strict";function a(e,t,n,a,i,r){return{emailAddress:n,hexConsumerIdForUser:t,personaId:a,name:e,personaBlob:{blobUrl:null,isPendingFetch:!1,hasFetchFailed:!1},size:i,mailboxType:r}}n.d(t,"a",(function(){return a}))},417:function(e,t,n){"use strict";class a{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return a}))},699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(951);t.legacyApplyMiddleware=a.default;var i=n(947);t.action=i.default;var r=n(1272);t.select=r.default;var o=n(1273);t.createUndo=o.default;var s=n(799);t.getActionType=s.getActionType;var c=n(1274);t.initializeTestMode=c.initializeTestMode,t.resetTestMode=c.resetTestMode},799:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOriginalTarget=function(e,t){e.__SATCHELJS_ORIGINAL_TARGET=t},t.getOriginalTarget=function(e){if(void 0!==e.__SATCHELJS_ORIGINAL_TARGET)return e.__SATCHELJS_ORIGINAL_TARGET},t.setActionType=function(e,t){e.__SATCHELJS_ACTION_TYPE=t},t.getActionType=function(e){return e.__SATCHELJS_ACTION_TYPE}},947:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1271),i=n(799);function r(e,t,n){var r=function(){var i,r=this,o=arguments;return a.default((function(){return i=e.apply(r,o)}),t,arguments,n),i};return i.setOriginalTarget(r,e),i.setActionType(r,t),r}function o(e,t,n,a,i){if(!n||"function"!=typeof n.value)throw new Error("The @action decorator can only apply to class methods.");n.value=r(n.value,a,i)}t.default=function(e,t){return function(n,a,i){if(1==arguments.length&&"function"==typeof n)return r(n,e,t);o(n,a,i,e,t)}}},951:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(115);function i(e,t){return e.bind(null,t)}function r(e,t,n,a){return e()}t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=r,o=e.length-1;o>=0;o--)n=i(e[o],n);a.getGlobalContext().legacyDispatchWithMiddleware=n},t.dispatchWithMiddleware=function(e,t,n,i){a.getGlobalContext().legacyDispatchWithMiddleware||(a.getGlobalContext().legacyDispatchWithMiddleware=r),a.getGlobalContext().legacyDispatchWithMiddleware(e,t,n,i)}}}]);
//# sourceMappingURL=owa.944.js.map
self.scriptsLoaded['owa.944.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.944.js'] = (new Date()).getTime();