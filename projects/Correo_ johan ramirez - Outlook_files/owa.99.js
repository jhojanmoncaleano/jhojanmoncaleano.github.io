self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.99.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[99],{1820:function(e,t,n){"use strict";var o=n(3),r=n(71),i=n(1679);const c=Object(o.action)("selectFocusedViewFilter",(e,t)=>Object(r.b)({name:0===e?"TnS_SelectFocusedPivot":"TnS_SelectOtherPivot",options:{isCore:!0},customData:[e,t,null!=i.Z.inboxPausedDateTime]},{focusedViewFilter:e,actionSource:t})),u=Object(o.action)("ON_INITIAL_TABLE_LOAD_COMPLETE",e=>({tableView:e}));var a=n(3399),d=n(14);const s=Object(o.mutatorAction)("addTableViewToStore",(e,t)=>{t.set(e.id,e)});function l(e,t){const n=Object(i.L)().tableViews,o=Object(a.a)(e);let r=n.get(o);if(!r&&(r=function(e,t){return{currentLoadedIndex:0,loadErrorStatus:0,id:e,isInCheckedMode:!1,isInVirtualSelectAllMode:!1,isInitialLoadComplete:!1,isLoading:!0,rowKeys:[],rowIdToRowKeyMap:new d.ObservableMap,lastEmptiedTime:null,selectAllModeTimeStamp:null,selectedRowKeys:new d.ObservableMap,serverFolderId:t.folderId,tableQuery:t,totalRowsInView:0,virtualSelectAllExclusionList:[],selectionAnchorRowKey:null,focusedRowKey:null,multiSelectionAnchorRowKey:null}}(o,e),!t)){const e=r.id;s(r,n),r=n.get(e)}return r}n.d(t,"a",(function(){return 25})),n.d(t,"b",(function(){return 25})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l}))},1947:function(e,t,n){"use strict";var o=n(2799),r=n(3250),i=n(20),c=n(2979),u=n(2137),a=n(548);function d(e,t){return Object(a.b)(e,t,!1,{hideCancelButton:!0})}var s=n(2664),l=n(2288),f=n(1939),b=n(913),O=n(2463),S=n(29),w=n(1685),j=n(1683),p=n(283);function g(e,t){var n;if(t==Object(w.a)("msgfolderroot"))return!(null===(n=Object(S.a)().UserOptions)||void 0===n?void 0:n.IsMailRootFolderTreeCollapsed);{const n=e[t];return!n||n.IsExpanded}}async function I(e){var t;await Object(j.v)(void 0,void 0,e),Object(p.a)()||((null===(t=Object(S.a)().SessionSettings)||void 0===t?void 0:t.HasArchive)&&Object(j.z)(),Object(j.B)()),function(){const e=Object(s.c)();Object.keys(e).forEach(t=>{const{sortColumn:n,sortDirection:o}=Object(l.a)(t),r={isExpanded:g(e,t),sortColumn:n,sortOrder:o,drag:Object(f.a)(),drop:Object(b.a)()};Object(O.a)(t,r)})}()}var v=n(2574),C=n(2447),h=n(3),m=n(3158);Object(h.orchestrator)(m.a,e=>{I()});n.d(t,"c",(function(){return F})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return C.a})),n.d(t,"b",(function(){return C.b})),n.d(t,"e",(function(){return o.a}));const y=new i.c(()=>n.e(956).then(n.bind(null,19261)));Object(i.f)(r.a,y,e=>e.onNewFolderSuccessOrchestrator),Object(i.f)(v.a,y,e=>e.onNewFolderRowNotificationOrchestrator),Object(i.f)(u.a,y,e=>e.markAllAsReadOrchestrator),Object(i.f)(c.a,y,e=>e.emptyFolderStoreUpdateOrchestrator),Object(i.f)(o.a,y,e=>e.setFolderSortByOrchestrator);let F=new i.a(y,e=>e.dismissMailFolderTextField)},2218:function(e,t,n){"use strict";var o=n(3),r=n(14),i=n(1683),c=n(2363),u=n(2574),a=n(1726);Object(o.mutator)(c.a,e=>{d(e.unreadCount,e.totalCount,e.folderId,e.isDeltaChange)});Object(o.mutator)(u.b,e=>{d(e.unreadCount,e.totalCount,e.folderId,!1)});function d(e,t,n,o){const r=i.d.folderTable.get(n);r&&(o?(r.UnreadCount+=e,r.totalMessageCount+=t):(r.UnreadCount=e,r.totalMessageCount=t),r.pausedTotalCount&&Object(a.b)()===n&&(r.pausedTotalCount=r.totalMessageCount),r.UnreadCount=Math.max(r.UnreadCount,0),r.totalMessageCount=Math.max(r.totalMessageCount,0))}n.d(t,"b",(function(){return l}));const s={folderNodeViewStates:new r.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null},l=Object(o.createStore)("folderViewState",s),f=l();t.a=f},2259:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(2463),r=n(2218),i=n(1939),c=n(913),u=n(1679);function a(e){const t=u.c.getDefaultSortBy();return r.a.folderNodeViewStates.has(e)||Object(o.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(i.a)(),drop:Object(c.a)()}),r.a.folderNodeViewStates.get(e)}},2288:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(2664),r=n(1679),i=n(3541),c=n(61);function u(e){const t=Object(o.c)()[e];if(t){const n=Object(i.getSupportedSortColumns)(e),{SortColumn:o,SortOrder:u}=t;if(n.includes(o)){let e=u;return(!u||u!=r.c.DESCENDING_SORT_DIR&&u!=r.c.ASCENDING_SORT_DIR)&&(e=r.c.getDefaultSortDirectionForSortColumn(o),Object(c.o)("getSortByFolderId_invalidSortOrder",{sortColumn:o,sortOrder:u})),{sortColumn:o,sortDirection:e}}}return r.c.getDefaultSortBy()}},2363:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("UPDATE_FOLDER_COUNTS",(e,t,n,o)=>({unreadCount:e,totalCount:t,folderId:n,isDeltaChange:o}))},2402:function(e,t,n){"use strict";var o=n(3);const r=Object(o.action)("ON_NUDGE_REMOVED",e=>({rowKey:e})),i=Object(o.action)("ON_GET_NUDGES_COMPLETED",(e,t)=>({nudgedRows:e,tableView:t}));let c=Object(o.createStore)("nudgeStore",{nudgedRows:[]});var u=c();Object(o.mutator)(i,e=>{u.nudgedRows=e.nudgedRows}),Object(o.mutator)(r,e=>{for(let t=u.nudgedRows.length-1;t>=0;t--)u.nudgedRows[t].rowKey===e.rowKey&&u.nudgedRows.splice(t,1)});var a=n(4310),d=n(5);function s(e){const t=u.nudgedRows.filter(t=>t.rowKey===e)[0],n=t.daysAgo,o=0==t.reason;return 0==n?o?Object(d.b)(a.c):Object(d.b)(a.f):1==n?o?Object(d.b)(a.b):Object(d.b)(a.e):o?Object(d.c)(Object(d.b)(a.a),n):Object(d.c)(Object(d.b)(a.d),n)}var l=n(1679);function f(e,t){return u.nudgedRows.some(n=>n.rowKey===e&&n.tableViewId===t||"testNudgeRowKey"==e)}var b=n(4143);function O(e,t,n){return!!f(e,t)&&(!!Object(b.c)(t)&&!Object(l.x)(n))}function S(e){const t=u.nudgedRows.filter(t=>t.conversationId===e);return t.length>0&&j(t[0])?t[0].rowKey:null}function w(e){const t=u.nudgedRows.filter(t=>t.itemId===e);return t.length>0&&j(t[0])?t[0].rowKey:null}function j(e){const t=e.tableViewId,n=Object(l.L)().tableViews.get(t);if(!n||n.id!=Object(l.J)())return!1;const o=e.rowKey;return O(o,t,l.b.getLastDeliveryOrRenewTimeStamp(o,n))}function p(e){const t=u.nudgedRows.filter(t=>t.rowKey===e);return t.length>0?t[0].itemId:null}n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return w})),n.d(t,"d",(function(){return S})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return O})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return r}))},2447:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var o=n(29),r=n(1683);const i=["drafts","junkemail","recoverableitemsdeletions"];function c(e){let t;return e&&(t=Object(r.m)().get(e)),u(t)}function u(e){var t,n;return e&&(e.distinguishedFolderType&&-1!=i.indexOf(e.distinguishedFolderType)||"ArchiveMailbox"===e.mailboxInfo.type||"SharedMailbox"===e.mailboxInfo.type)||Object(r.G)(null==e?void 0:e.id)?1:(null===(n=null===(t=Object(o.a)())||void 0===t?void 0:t.UserOptions)||void 0===n?void 0:n.GlobalListViewTypeReact)||0}},2463:function(e,t,n){"use strict";var o=n(2218),r=n(3);t.a=Object(r.mutatorAction)("setFolderViewState",(function(e,t){o.a.folderNodeViewStates.set(e,t)}))},2574:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var o=n(3);const r=Object(o.action)("onNewFolderNotification",(e,t,n,o=0,r=0,i)=>({folderId:e,parentFolderId:t,displayName:n,unreadCount:o,totalCount:r,mailboxInfo:i})),i=Object(o.action)("onUpdateFolderNotification",(e,t,n,o,r)=>({unreadCount:e,totalCount:t,folderId:n,displayName:o,parentFolderId:r}))},2664:function(e,t,n){"use strict";var o=n(2259),r=n(29),i=n(49),c=n(1703),u=n(2464);function a(e){return"inbox"!=Object(c.a)(e)||Object(u.a)(e)?j.SearchRefinerScopeCurrentFolder:j.SearchRefinerScopeAll}var d=n(1679),s=n(2182),l=n(1683),f=n(1692);function b(e){const t=Object(c.a)(e);return Object(u.a)(e)||Object(l.G)(e)?p.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?p.DateViewOnly:"deleteditems"==t||Object(f.k)(e)?p.DateView:p.ConversationView}var O=n(958),S=n(61);const w=Object(O.a)(e=>{Object(S.o)("UpdateFolderViewState",{},{isCore:!0}),i.u.importAndExecute([{key:"FolderViewState",valuetype:"StringArray",value:e}],"OWA.ViewStateConfiguration")},3e4,{leading:!1,trailing:!0});var j,p,g=n(317);function I(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?d.c.DESCENDING_SORT_DIR:d.c.ASCENDING_SORT_DIR}))}function v(){var e;const t=(null===(e=Object(r.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState)||[],n={};for(let e=0;e<t.length;e++){const o=I(t[e]);n[o.FolderId.Id]=o}return n}function C(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==d.c.DESCENDING_SORT_DIR&&t!==d.c.ASCENDING_SORT_DIR?t:t===d.c.DESCENDING_SORT_DIR?1:0}))}function h(e){let t=!1;Object(g.a)(n=>{var i;const c=(null===(i=n.ViewStateConfiguration)||void 0===i?void 0:i.FolderViewState)||[],u=Object(o.a)(e);let d=null,f=-1;for(let t=0;t<c.length;t++){const n=I(c[t]);if(n.FolderId.Id===e){d=n,f=t;break}}const O=function(e,t,n){var o;const i=n?n.sortOrder:"Ascending",c=n?n.sortColumn:1,u=!!n&&n.isExpanded;if(t)return Object.assign(Object.assign({},t),{SortOrder:i,SortColumn:c,IsExpanded:u});const d=l.d.folderTable.get(e);return d?{FolderId:{Id:d.id,ChangeKey:d.changeKey},View:b(d.id),Width:s.b,SortOrder:i,SortColumn:c,IsExpanded:u,ReadingPanePosition:null===(o=Object(r.a)().UserOptions)||void 0===o?void 0:o.GlobalReadingPanePositionReact,SearchScope:a(d.id)}:null}(e,d,u);O&&(-1!==f?(t=d!==O,t&&(c[f]=C(O))):(t=!0,c.push(C(O))))}),t&&function(){var e,t;const n=null===(e=Object(r.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState;if(n){const e=[],o=d.c.getDefaultSortBy();for(let i=0;i<n.length;i++){const c=I(n[i]),u=Object(l.m)().get(c.FolderId.Id);(!(!u||u.childFolderCount>0)||!c.IsExpanded)&&c.SearchScope===a(c.FolderId.Id)&&c.SortColumn===o.sortColumn&&c.SortOrder===o.sortDirection&&c.Width===s.b&&c.ReadingPanePosition===(null===(t=Object(r.a)().UserOptions)||void 0===t?void 0:t.GlobalReadingPanePositionReact)&&c.View===b(c.FolderId.Id)||e.push(n[i])}w(e)}}()}n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return I})),n.d(t,"c",(function(){return v})),n.d(t,"e",(function(){return h})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(j||(j={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(p||(p={}))},2799:function(e,t,n){"use strict";var o=n(3);const r=Object(o.action)("setFolderSortBy",(e,t,n)=>({folderId:e,sortColumn:t,sortDirection:n}));t.a=r},2979:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("EMPTY_FOLDER_STORE_UPDATE",(e,t,n,o,r,i)=>({folderId:e,clientLastSyncTime:t,deletedItemsFolderId:n,disposalType:o,deleteSubFolders:r,rowKeysToExclude:i}))},3158:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("SELECT_CATEGORIES_OPTIONS")},3250:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(3);const r=Object(o.action)("onNewFolderSuccess",(e,t,n,o)=>({folderId:e,parentFolderId:t,displayName:n,mailboxInfo:o}))},3399:function(e,t,n){"use strict";function o(e,t=!1){const n=[];switch(e.type){case 0:n.push("folderId:"+e.folderId);const o=e;n.push("lVT:"+e.listViewType),n.push("vF:"+o.viewFilter),n.push("fVF:"+o.focusedViewFilter),t||(n.push("sC:"+o.sortBy.sortColumn),n.push("sD:"+o.sortBy.sortDirection)),o.categoryName&&n.push("catName:"+o.categoryName),n.push("sT:"+o.scenarioType);break;case 1:n.push("folderId:"+e.folderId);const r=e;n.push("id:"+r.searchNumber),n.push("query:"+r.queryString),n.push("lVT:"+e.listViewType),n.push("sT:"+r.scenarioType);break;case 2:n.push("gId:"+e.folderId);const i=e;n.push("lVT:"+e.listViewType),n.push("vF:"+i.viewFilter);break;case 3:n.push("folderId:"+e.folderId);const c=e;n.push("gId:"+c.groupId),n.push("lVT:"+e.listViewType),n.push("vF:"+c.viewFilter),t||(n.push("sC:"+c.sortBy.sortColumn),n.push("sD:"+c.sortBy.sortDirection))}return n.join(";").toString()}n.d(t,"a",(function(){return o}))},3544:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var o=n(49);function r(e){var t;return!!(e&((null===(t=Object(o.g)().ViewStateConfiguration)||void 0===t?void 0:t.FocusedInboxBitFlags)||0))}function i(e,t){r(t)!==e&&Object(o.x)(n=>{!function(e,t,n){var o;if(null==(null===(o=t.ViewStateConfiguration)||void 0===o?void 0:o.FocusedInboxBitFlags))return;e?t.ViewStateConfiguration.FocusedInboxBitFlags|=n:t.ViewStateConfiguration.FocusedInboxBitFlags&=~n}(e,n,t)})}},4143:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return S})),n.d(t,"a",(function(){return w}));var o=n(44),r=n(3541),i=n(1685),c=n(1679),u=n(3544),a=n(29),d=n(283),s=n(61);let l;function f(){const e=Object(d.a)(),t=e&&Object(o.j)("tri-nudge-consumer"),n=!e&&Object(o.j)("tri-nudge"),r=Object(a.a)().UserOptions.MessageRemindersEnabled;return l||(l=!0,Object(s.o)("Nudge_TenantSetting",{owa_1:r})),r&&(n||t)&&!Object(u.a)(32)}function b(e){return e===Object(i.a)("inbox")||e===Object(i.a)("sentitems")}function O(e,t){if(0!=e.tableQuery.type)return!1;if("All"!=Object(c.Q)(e))return!1;const n=Object(c.n)(e);if(0!=n&&-1!=n)return!1;const o=Object(c.K)(e);return 1==o.sortColumn&&o.sortDirection==r.DESCENDING_SORT_DIR}function S(e){const t=c.Z.tableViews.get(e),n=t.tableQuery.folderId;return!!b(n)&&O(t)}function w(e){if(!b(e))return!1;return O(Object(c.I)())}},4310:function(e){e.exports=JSON.parse('{"c":"Dba","b":"Eba","a":"Fba","f":"Gba","e":"Hba","d":"Iba"}')}}]);
//# sourceMappingURL=owa.99.js.map
self.scriptsLoaded['owa.99.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.99.js'] = (new Date()).getTime();