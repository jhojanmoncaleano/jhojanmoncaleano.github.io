self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[408],{10066:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("ON_ITEM_PART_SELECTED",(e,t)=>({conversationNodeId:e,conversationId:t}))},10133:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("CONFIRM_TIMEZONE")},10134:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(3),i=n(5178),r=n(5),a=n(29);let s=Object(o.action)("SEND_AN_EMAIL",()=>({taskSendEmailSubject:Object(r.c)(Object(r.b)(i.C),Object(a.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(r.c)(Object(r.b)(i.B),Object(a.a)().SessionSettings.UserEmailAddress)}))},10135:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("ADD_STORAGE_ACCOUNT")},10136:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("SETUP_SIGNATURE")},10137:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("SHOW_PERSONALIZATION_MODAL")},10138:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("COMPLETE_SEND_AN_EMAIL")},10139:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("COMPLETE_PERSONALIZATION")},10147:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a}));const o="mailtoHandlerIgnoredCount",i=14,r=6048e5,a={"https://outlook-sdf.office.com":"AugAIqsZDxGSVhnlEo0b/F1lgqztKRxkOfYrcIOvWJmm9lvo+HbqtpfvOBJRTp3paOK7ecDCRlNFfaFmsvKBFHIAAAB6eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLm9mZmljZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYzNzYxMjUxMX0=","https://outlook.office.com":"Am+WI2I40F25oTkqP5Ys+utnzwAsoI6jqgTlGG8to9eAkFQVDlvx9QtDpAiLN0k0TGCfySH4S2C3aZCKxd/XX68AAAB2eyJvcmlnaW4iOiJodHRwczovL291dGxvb2sub2ZmaWNlLmNvbTo0NDMiLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiZmVhdHVyZSI6IlBhcnNlVXJsUHJvdG9jb2xIYW5kbGVyIiwiZXhwaXJ5IjoxNjM3NjEyNTI5fQ==","https://outlook-sdf.live.com":"AlSSLoybQyyL2N1S9eNsW42rpOymUMKCA6xw5hHCENqtpbtg93HxlyXhbjVyEYxHg9QxNqSOvrbsQjBKhtEawvQAAAB4eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLmxpdmUuY29tOjQ0MyIsImlzU3ViZG9tYWluIjp0cnVlLCJmZWF0dXJlIjoiUGFyc2VVcmxQcm90b2NvbEhhbmRsZXIiLCJleHBpcnkiOjE2Mzc2MTI1NTR9","https://outlook.live.com":"AkTNbUVviYOixRg4gKB7FammnVLuqXtO9VR71GZdDUPbUeMF0B0KYkHhpAVBc56Isq9A2zxibVh1AUlArykZTtIAAAB0eyJvcmlnaW4iOiJodHRwczovL291dGxvb2subGl2ZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYzNzYxMjU0OH0="}},10169:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(6262),i=n(6584);function r(e,t){Object(o.a)(e),Object(i.a)(t)}},10173:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var o=n(61),i=n(11),r=n(10174),a=n(597),s=n(5);function c(){var e;(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",`${Object(a.n)()}${Object(a.l)()}deeplink/compose?mailtouri=%s`,Object(s.b)(r.a))}function d(e){Object(i.c)(window)&&Object(i.e)(window,e,(new Date).getTime().toString()),"MailToBannerTryItNow"===e&&c(),Object(o.o)("mailToHandlerEvent",{UserAction:e})}},10174:function(e){e.exports=JSON.parse('{"a":"INc"}')},1715:function(e,t,n){"use strict";function o(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function i(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}))},1718:function(e,t,n){"use strict";var o=n(1787),i=n(272),r=n(1686),a=n(61),s=n(7),c=n(40);const d="X-AnchorMailbox",u="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function b(e,t){const n={},b=Object(i.k)(e);if(t?(n[d]=t,n[f]=t):b&&(n[d]=b.anchorMailbox),Object(i.s)())return c.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(b){if(b.accountState==i.b.AccessRevoked)return null;if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.d)(b.accountState,b.accountProviderType),null}if(b){let t,i=b.token,d=Object(r.g)(b.tokenExpiry);!d&&i||(Object(a.o)("getAndUpdateAccessToken",{tokenExpiry:Object(s.y)(b.tokenExpiry,Object(s.Ub)()),isTokenExpired_1:d,isTokenInvalid_2:!i},{isCore:!0}),i=await o.a.importAndExecute(b.accountId,e,i),c.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+i),i||(i="")),"Outlook"==b.accountProviderType?(t=`MSAuth1.0 usertoken="${i}", type="MSACT"`,n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType&&"Yahoo"!=b.accountProviderType||(t=`Bearer ${i}`,n[l]=2..toString()),n[u]=t}return n}var p=n(1715),v=n(914);async function m(e,t){var n;const o=Object(p.a)();if(o.headers=await async function(e,t){var n;const o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,i=await b(e.mailboxInfo.userIdentity,I(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(p.b)(o,i),o}(e,t),o.authNeededOnUnAuthorized=!1,o.datapoint=o.datapoint||{},Object(i.s)()){const t=Object(v.a)(null===(n=null==e?void 0:e.mailboxInfo)||void 0===n?void 0:n.userIdentity);c.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+t),o.sourceId=t,o.datapoint.mailbox="Connected"}else o.datapoint.mailbox="Connected";return o}function I(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&c.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return I}))},1721:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);const i=Object(o.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},1728:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(3),i=n(14);const r=Object(o.createStore)("groupsStore",{groups:new i.ObservableMap})},1757:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1728);function i(e){const t=Object(o.a)().groups.get(e.toLowerCase());return t?t.groupDetails:null}},1785:function(e,t,n){"use strict";var o=n(1715);function i(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function r(e,t,n){t&&(e||n)&&Object(o.b)(t,i(e,n))}function a(e,t){var n;const o=null!=t?t:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",r(e,i),Object.assign(Object.assign({},o),{headers:i})}var s=n(272),c=n(1718),d=n(56),u=n(294),l=n.n(u);async function f(e){return Object(d.b)().then(async t=>{if(e)if(Object(s.r)(e.userIdentity)){const n=await Object(c.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);l()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=i(e.mailboxSmtpAddress);l()(t,n)}return t})}function b(){return Object(d.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function p(e=null){return Object(s.r)(e)?b().then(t=>{return Object(c.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var v=n(50);function m(e,t,n,o){let i=new Headers;return n&&i.set("X-OWA-CANARY",Object(v.a)()),t&&i.set("X-OWA-ActionName",t),(e||o)&&(o?r(e,i,o):r(e,i)),i}n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return m}))},1787:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(20),i=n(1721);n.d(t,"b",(function(){return i.a}));const r=new o.c(()=>n.e(1045).then(n.bind(null,2021))),a=new o.a(r,e=>e.getAndUpdateAccessToken)},19127:function(e,t,n){"use strict";n.r(t);var o=n(1685),i=n(5746),r=n(1679),a=n(44);function s(e){return Object(r.V)(Object(o.a)("inbox"))||Object(a.j)("rp-reactions")}var c=n(1737);function d(e){const t=Object(o.a)("inbox");return Object(r.V)(t)&&!Object(c.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}function u(){return Object(r.V)(Object(o.a)("inbox"))||!Object(a.j)("auth-reactionNotifications")||!Object(a.j)("rp-reactions")}var l=n(11103),f=n(3872),b=n(4147),p=n(5075),v=n(3),m=n(3033),I=n(8729);Object(v.orchestrator)(I.a,e=>{let t={Subject:e.taskNewEventTitle,IsAllDayEvent:!0};m.g.importAndExecute("GetStarted","GetStarted",t)});var O=n(1988),g=n(10135);Object(v.orchestrator)(g.a,()=>{O.f.importAndExecute("mail","attachments")});var h=n(10136);Object(v.orchestrator)(h.a,()=>{O.f.importAndExecute("mail","messageContent")});var w=n(10133);Object(v.orchestrator)(w.a,()=>{O.f.importAndExecute("general","timeAndLanguage")});var j=n(2376),y=n(10134),S=n(10138),x=n(2772);Object(v.orchestrator)(y.a,e=>{j.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)}),Object(v.orchestrator)(x.a,e=>{1==e.event&&Object(S.a)()});var N=n(10137),M=n(10139),A=n(20);const E=new A.c(()=>Promise.all([n.e(104),n.e(601)]).then(n.bind(null,19291)));let k=new A.a(E,e=>e.showPersonalizationCard);Object(v.orchestrator)(N.a,()=>{k.importAndExecute(M.a)});var R=n(8693);const C=new A.c(()=>n.e(998).then(n.bind(null,19332)));let T=new A.a(C,e=>e.loadSignatureEditorWizardUtil);Object(v.orchestrator)(R.a,e=>{T.importAndExecute(e.target,e.viewState)}),Object(b.a)()&&p.d.importAndExecute();var P=n(5007);const V=new A.c(()=>n.e(2054).then(n.bind(null,19496)));let H=new A.a(V,e=>e.loadSenders);var F=n(8387),_=n(2574);const L=new A.c(()=>n.e(1042).then(n.bind(null,19321))),D=new A.a(L,e=>e.subscribeToHierarchyNotification);Object(A.f)(_.a,L,e=>e.onNewFolderNotificationOrchestrator),Object(A.f)(_.b,L,e=>e.onUpdateFolderNotificationOrchestrator);var U=n(5),B=n(14),K=n(1690),Z=n(2926),G=n(40);function W(e,t){const n=function(e){const t={};let n=K.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){G.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(Z.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(U.k)(n.parentInternetMessageId))break;n=K.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){const n=new B.ObservableMap({});return t.forEach(t=>{const o=K.a.conversationNodes.get(t),i=t===e?r.a.CheckMark:r.a.None;n.set(o.internetMessageId,i)}),n}(e,t);const o=new B.ObservableMap({});let i=!1,a=!1,s=0;for(let e=0;e<t.length;e++){const c=K.a.conversationNodes.get(t[e]);c&&(n[c.internetMessageId]?(i?s+1===Object.keys(n).length?(o.set(c.internetMessageId,r.a.BusEnd),a=!0):o.set(c.internetMessageId,r.a.BusStop):(o.set(c.internetMessageId,r.a.BusStart),i=!0),s++):!i||a?o.set(c.internetMessageId,r.a.None):o.set(c.internetMessageId,r.a.NoStop))}return o}var z=Object(v.action)("FOCUS_ITEM_PART",(e,t)=>({nodeId:e,mailListItemSelectionSource:t})),q=n(1846),J=n(2850),Y=n(6020),X=n(8711),Q=n(1692),$=n(2750),ee=n(1741);function te(e,t){const n=r.Z.expandedConversationViewState;n.expandedRowKey!=e?Object(ee.a)()?(n.shouldBeExpanded=!0,n.expandedRowKey=e,n.forks=[]):t===Q.b.MailListItemTwisty&&(n.shouldBeExpanded=!0,n.expandedRowKey=e,n.forks=null):t===Q.b.MailListItemTwisty&&Object($.a)(e)&&(Object(Y.a)(),n.shouldBeExpanded=!0,n.expandedRowKey=e)}Object(v.mutator)(q.s,e=>{const{nodeId:t}=e,{selectedNodeIds:n,allNodeIds:o}=r.Z.expandedConversationViewState;r.Z.expandedConversationViewState.focusedNodeId=t,n.indexOf(t)>-1?n.splice(n.indexOf(t),1):n.push(t),1===n.length&&(r.Z.expandedConversationViewState.busStopStateMap=W(n[0],o))}),Object(v.mutator)(q.g,e=>{r.Z.expandedConversationViewState.busStopStateMap=new B.ObservableMap({})}),Object(v.mutator)(z,e=>{r.Z.expandedConversationViewState.focusedNodeId=e.nodeId}),Object(v.mutator)(q.p,e=>{const{rowKey:t,nodeIdToSelect:n,allNodeIds:o}=e,i=r.Z.expandedConversationViewState;i.selectedNodeIds=[n],i.busStopStateMap=W(n,o),i.expandedRowKey=t,i.focusedNodeId=n,i.allNodeIds=o}),Object(v.mutator)(q.t,e=>{e.mailListItemSelectionSource===Q.b.MailListItemCheckbox&&Object(Y.a)()}),Object(v.mutator)(J.a,e=>{Object(Y.a)()}),Object(v.mutator)(q.h,e=>{Object(Y.a)()}),Object(v.mutator)(q.j,e=>{Object(Y.a)()}),Object(v.mutator)(q.q,e=>{const{rowKey:t,mailListItemSelectionSource:n}=e;te(t,n)}),Object(v.mutator)(q.n,e=>{const{rowKey:t,mailListItemSelectionSource:n}=e;te(t,n)}),Object(v.mutator)(q.o,e=>{Object(Y.a)(),r.Z.expandedConversationViewState.expandedRowKey=e.rowKey}),Object(v.mutator)(X.a,e=>{if(1===r.Z.expandedConversationViewState.selectedNodeIds.length){const t=r.Z.expandedConversationViewState.selectedNodeIds[0],n=Q.u.conversations.get(e.conversationId).conversationNodeIds;r.Z.expandedConversationViewState.busStopStateMap=W(t,n)}});var ne=n(3630),oe=n(6821),ie=n(2119),re=n(1761),ae=n(4496);var se=async function(e,t){return async function(e,t){const n=await Object(ae.a)(e,t);if(n.length>1){const e=[];return n.forEach(t=>{const n=[];t.forEach(e=>{var t,o;const i=Q.u.items.get(e),r=null===(o=null===(t=null==i?void 0:i.From)||void 0===t?void 0:t.Mailbox)||void 0===o?void 0:o.Name;r&&!n.includes(r)&&n.push(r)}),e.push({id:t[0],displayNames:n,ancestorIds:t})}),e}return[]}(e,t)},ce=n(1814),de=n(2203),ue=n(5753),le=n(3096),fe=n(6587),be=n(2202),pe=n(3934);Object(v.orchestrator)(q.a,e=>{Oe(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)});let ve;Object(v.orchestrator)(q.d,e=>{if(1==e.listViewType)return;const t=r.Z.expandedConversationViewState,n=e.mailListItemSelectionSource==Q.b.MailListItemTwisty;Object(ee.a)()&&t.expandedRowKey!=e.rowKey?ye(e.rowKey,e.tableView,n):t.expandedRowKey==e.rowKey&&(t.shouldBeExpanded?t.forks?ye(e.rowKey,e.tableView,n):we(e.rowKey,e.tableView):!t.forks&&n&&je())}),Object(v.orchestrator)(q.b,e=>{(Object($.a)(e.rowKey)||Object($.c)(e.rowKey))&&je()}),Object(v.orchestrator)(q.l,e=>{var t,n;let o=null,i=null,a=null;if(Object($.a)(e.rowKey)){const e=r.Z.expandedConversationViewState.forks,s=e.map(e=>e.id);if(a=s,e.length>1){const a=s.indexOf(r.Z.expandedConversationViewState.selectedNodeIds[0]);-1!=a&&(i=e.length-1>a?null===(t=e[a+1])||void 0===t?void 0:t.id:null===(n=e[a-1])||void 0===n?void 0:n.id,o=i)}}else{const t=r.b.getConversationId(e.rowKey,e.tableView),n=Q.u.conversations.get(t),s=n.conversationNodeIds.indexOf(r.Z.expandedConversationViewState.selectedNodeIds[0]);a=n.conversationNodeIds;for(let e=s+1;e<n.conversationNodeIds.length;e++){const t=n.conversationNodeIds[e],r=Object(le.a)(t,!1);if(r){i=r.ItemId.Id,o=t;break}}}o?Oe(i,e.tableView,o,a,Q.b.RowRemoval):he(e.rowKey,e.tableView)});let me=0,Ie=!0;function Oe(e,t,n,o,i){if(ve&&(clearTimeout(ve),ve=null),Object(oe.a)(t,!0,i,void 0),i!==Q.b.KeyboardUpDown||Object(re.d)())ge(e,t);else{const n=Date.now(),o=n-me;me=n,(Ie||o<=500)&&(Ie=!1,ve=setTimeout(()=>{ve=null,Ie=!0,ge(e,t)},250))}const a=r.Z.expandedConversationViewState;q.p(a.expandedRowKey,n,o,t.id,a.selectedNodeIds)}function ge(e,t){if(Object(ee.a)()){if(t.focusedRowKey!==r.Z.expandedConversationViewState.expandedRowKey)return;be.o.importAndExecute({Id:e,mailboxInfo:Object(ce.b)(t)},!0,null,!1)}else{const n=r.b.getRowClientItemId(r.Z.expandedConversationViewState.expandedRowKey,t);be.s.importAndExecute(null==n?void 0:n.Id,e,!0)}}function he(e,t,n,o){let i=null==n?void 0:n.map(e=>e.id);if(!i||0==i.length){const n=r.b.getConversationId(e,t),o=Q.u.conversations.get(n);i=null==o?void 0:o.conversationNodeIds}const a=o?r.b.getRowIdToShowInReadingPane(e,t):null;if(i)for(const n of i){const o=Object(le.a)(n,Object($.a)(e));if(o&&(!a||o.ItemId.Id==a.Id)){Oe(o.ItemId.Id,t,n,i,Object(ee.a)()&&Object(ie.a)()&&Object(re.d)()?Q.b.MailListItemExpansion:Q.b.RowRemoval);break}}}async function we(e,t){const n=r.b.getRowClientItemId(e,t);n&&!Object(fe.a)(n.Id)&&await de.e.importAndExecute(n,"PrefetchSingleRow"),q.o(e),Object(ne.a)(t,!1),Object(ee.a)()?he(e,t,null,!0):he(e,t)}function je(){q.h()}async function ye(e,t,n){const o=r.b.getRowClientItemId(e,t);if(o){const i=o.Id;Object(pe.a)()||Object(fe.a)(i)||await de.e.importAndExecute(o,"CreateConversationRelationMap");const a=r.b.getParentFolderId(e,t);if(a){const o=await se(i,a);o.length>1?(Object(ue.a)(e,o),he(e,t,o)):n?we(e,t):Object(ue.a)(e,o)}}}var Se=n(8712),xe=n(7705),Ne=(Object(v.orchestrator)(xe.a,e=>{Object(Se.a)(),1===Object(r.L)().expandedConversationViewState.selectedNodeIds.length&&q.g()}),n(10066)),Me=n(2847),Ae=(Object(v.orchestrator)(Ne.a,e=>{if(!r.Z.expandedConversationViewState.expandedRowKey)return;const t=Q.u.conversations.get(e.conversationId);q.p(r.Z.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(Me.a)())}),n(8741)),Ee=n(5548),ke=n(7004),Re=n(2931),Ce=Object(v.action)("FOCUS_ROW_IN_DIRECTION",(e,t,n)=>({tableView:e,selectionDirection:t,mailListItemSelectionSource:n}));function Te(e,t,n){return Object(Re.a)()?1===e&&n===r.d.Next||0===e&&n===r.d.Previous:e===t-1&&n===r.d.Next||e===t-2&&n===r.d.Previous}Object(v.orchestrator)(Ae.a,e=>{var t;const{selectionDirection:n,tableView:o,mailListItemSelectionSource:i,shouldSelect:a}=e,[s,c]=function(e,t){const{focusedNodeId:n,allNodeIds:o}=r.Z.expandedConversationViewState;if(!n)return[null,null];let i,a,s=o.indexOf(n);e===r.d.Next?(i=o.length-1,a=1):(i=0,a=-1);const c=Object(r.M)(t.focusedRowKey,t.id).id,d=r.Z.conversationItems.get(c);for(;s!==i;){if(s+=a,Object(Ee.a)(d.id)&&Te(s,o.length,e))return Object(ke.a)(d.clientId),["loading",null];let n=o[s],i=Object(le.a)(n,Object($.a)(t.focusedRowKey));if(i)return[n,i]}return[null,null]}(n,o);"loading"!==s&&(s?a?q.a(s,c.ItemId.Id,r.Z.expandedConversationViewState.allNodeIds,o,i):z(s,i):r.Z.expandedConversationViewState.expandedRowKey&&(!Object(ee.a)()||(null===(t=r.Z.expandedConversationViewState.forks)||void 0===t?void 0:t.length)>1||Object($.c)(r.Z.expandedConversationViewState.expandedRowKey))&&n===r.d.Previous?q.b(r.Z.expandedConversationViewState.expandedRowKey):a?q.m(o,n,i):Ce(o,n,i))});var Pe=n(6822),Ve=n(3313),He=n(3105),Fe=n(3104),_e=(Object(v.orchestrator)(Ce,e=>{const{tableView:t,selectionDirection:n}=e,o=Object(Pe.a)(t,n);if(null===o)return;const i=t.rowKeys[o];Object(Ve.a)(t,i),Object(Fe.a)(t,i),Object(He.a)(t,null),q.h()}),n(8742));Object(v.orchestrator)(_e.a,e=>{const{tableView:t,mailListItemSelectionSource:n}=e,o=r.Z.expandedConversationViewState.focusedNodeId;o?q.s(o):q.t(t,t.focusedRowKey,!0,n)});var Le=n(1760),De=n(8370),Ue=n(8743);Object(v.orchestrator)(Ue.a,e=>{const{tableView:t,selectedNodeIds:n,selectedRowKeys:o,mailListItemSelectionSource:i}=e;if(n.length>0&&i===Le.a.KeyboardEnter){if(1!==n.length)return;q.a(n[0],Object(De.a)(n[0],Object($.a)(o[0])),r.Z.expandedConversationViewState.allNodeIds,t,i)}else{if(1!==o.length)return;q.q(t,o[0],!0,i)}});var Be=n(32);var Ke=n(283),Ze=n(2483),Ge=n(3136),We=n(9884),ze=n(2888),qe=n(3153);const Je=new A.c(()=>Promise.all([n.e(302),n.e(1115)]).then(n.bind(null,19200))),Ye=new A.a(Je,e=>e.evaluatePlaywrightMailActions);var Xe=n(29),Qe=n(2281),$e=n(2577),et=n(10173),tt=n(10147),nt=n(597),ot=n(96),it=n(121),rt=n(2439),at=n(2205),st=n(1905),ct=n(1802),dt=n(2110);function ut(){var e;if(Object(Xe.a)().IsMonitoring&&Ye.importAndExecute(),D.importAndExecute(),Object(l.a)(!0),Object(a.j)("fwk-mailtoProtocolHandler")&&Object(it.a)("showOWAMailtoBanner")&&(Object(et.b)(),Object(ot.e)())){const e=Object(nt.n)();if(e in tt.d){const t=tt.d[e],n=document.createElement("meta");n.httpEquiv="origin-trial",n.content=t,document.head.appendChild(n)}}ze.b.importAndExecute({task:()=>st.d.import(),idle:!0},{task:()=>qe.c.import(),idle:!0},{task:()=>st.l.import(),idle:!0},{task:()=>dt.i.import(),idle:!0},{task:()=>st.k.import(),idle:!0},{task:()=>ct.b.import(),idle:!0},{task:()=>j.g.import(),idle:!0},{task:()=>j.f.import(),idle:!0},{task:()=>j.b.import(),idle:!0},{task:()=>j.a.import(),idle:!0},{task:()=>st.w.import(),idle:!0},{task:()=>st.o.import(),idle:!0},{task:()=>rt.e.import(),idle:!0},{condition:Object(a.j)("fwk-devTools")||Object(a.j)("sea-contextFeedback"),task:()=>F.b.importAndExecute()},{condition:Object(a.j)("fwk-nlqsFloodgateSurvey")&&Object(it.a)("floodgate")&&"en-us"!==(null===(e=Object(U.e)())||void 0===e?void 0:e.toLowerCase()),task:()=>$e.a.importAndExecute(null,!0)},lt,{condition:Object(Qe.h)(),task:()=>Qe.l.importAndExecute()},{condition:Object(a.j)("tri-spotlight2"),task:()=>Ze.c.importAndExecute(at.a)},{condition:Object(Ke.a)(),task:()=>H.importAndExecute()},()=>We.b.importAndExecute(),()=>We.a.importAndExecute(),{condition:Object(a.j)("mc-personalization"),task:()=>{Ge.b.importAndExecute()},idle:!0},{condition:Object(be.f)(),task:()=>P.a.importAndExecute(),idle:!0},{task:()=>qe.a.importAndExecute(),idle:!0},{condition:Object(a.j)("auth-activityFeed")&&Object(a.j)("auth-activityFeedWeveSignal"),task:()=>f.e.importAndExecute(),idle:!0},{condition:Object(a.j)("mail-popout-projection"),task:()=>be.h.importAndExecute(),idle:!0}).then(()=>{ze.a.importAndExecute()})}function lt(){var e,t;Object(i.g)(d),Object(i.f)(s),Object(i.h)(u),Object(Ke.a)()&&(e={isOWALogon:!0},Object(Be.a)("ConnectedAccountsNotification",e,t))}Object(v.orchestrator)(i.b,async e=>{const t=e.notification;if(Object(r.R)(Object(r.I)())){const e=Object(Q.g)().conversations.get(t.conversationId),n={Id:t.conversationId,mailboxInfo:Object(ce.a)()};e||await de.e.importAndExecute(n,"LoadLikedConversation"),ft(n,t.subject)}else{const e=Object(Q.g)().items.get(t.itemId),n={Id:t.itemId,mailboxInfo:Object(ce.a)()};if(null==e?void 0:e.NormalizedBody)ft(n,t.subject);else{const e={Id:t.itemId,mailboxInfo:Object(ce.a)()};await de.f.importAndExecute(e,"LoadLikedItem"),ft(e,t.subject)}}});function ft(e,t){be.p.importAndExecute(e,t,[],!0,null)}var bt=n(10169),pt=n(49);Object(v.orchestrator)(i.c,e=>{const t=e.notification,n=1===Object(pt.g)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(bt.a)("inbox",n)}),Object(v.orchestrator)(i.d,async e=>{const t=e.notification;if(Object(r.R)(Object(r.I)())){const e=Object(Q.g)().conversations.get(t.conversationId),n={Id:t.conversationId,mailboxInfo:Object(ce.a)()};e||await de.e.importAndExecute(n,"LoadReactedConversation"),vt(n,t.subject)}else{const e=Object(Q.g)().items.get(t.itemId),n={Id:t.itemId,mailboxInfo:Object(ce.a)()};if(null==e?void 0:e.NormalizedBody)vt(n,t.subject);else{const e={Id:t.itemId,mailboxInfo:Object(ce.a)()};await de.f.importAndExecute(e,"LoadReactedItem"),vt(e,t.subject)}}});function vt(e,t){be.p.importAndExecute(e,t,[],!0,null)}n.d(t,"setupMailModulePostRender",(function(){return ut}))},1936:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1785);function i(e,t){return{headers:Object(o.e)(e,"GroupMailbox",!1,t)}}},1960:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1887);const i=()=>Object(o.a)().smtpAddress},1987:function(e,t,n){"use strict";n(1936);var o=n(1871);function i(e){let t=void 0;switch(e){case"None":t=0;break;case"Private":t=1;break;case"Secret":t=2;break;case"Public":t=3}return t}var r=n(3),a=Object(r.action)("EDIT_GROUP_SUCCESS",(e,t)=>({groupSmtp:e,photoUrl:t})),s=Object(r.action)("ADD_GROUP_MEMBER_SUCCESS",e=>({groupSmtp:e})),c=Object(r.action)("MEMBER_MANAGEMENT_SUCCESS",e=>({groupSmtp:e})),d=Object(r.action)("POPUP_OPENED",()=>({isOpen:!0})),u=Object(r.action)("POPUP_CLOSED",()=>({isOpen:!1})),l=Object(r.action)("DELETE_GROUP_SUCCESS",e=>({groupSmtp:e})),f=Object(r.action)("EDIT_GROUP_SMTP_SUCCESS",(e,t,n,o)=>({aadObjectId:e,groupSmtp:t,photoUrl:n,oldGroupSmtp:o})),b=n(1886);n.d(t,"n",(function(){return o.a})),n.d(t,"o",(function(){return i})),n.d(t,"m",(function(){return a})),n.d(t,"j",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"r",(function(){return d})),n.d(t,"q",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"g",(function(){return b.g})),n.d(t,"c",(function(){return b.c})),n.d(t,"d",(function(){return b.d})),n.d(t,"a",(function(){return b.a})),n.d(t,"e",(function(){return b.e})),n.d(t,"f",(function(){return b.f})),n.d(t,"i",(function(){return b.i})),n.d(t,"b",(function(){return b.b})),n.d(t,"h",(function(){return b.h}))},2112:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(945);function i(e){var t;return null===(t=o.a.projections)||void 0===t?void 0:t.filter(t=>t.tabId==e||t.window==e)[0]}},2439:function(e,t,n){"use strict";var o=n(20);function i(e,t){const n=new o.b(e,e=>e[t]);return(...e)=>n.import().then(t=>t(...e))}n.d(t,"e",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"k",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"l",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"j",(function(){return m}));const r=new o.c(()=>Promise.all([n.e(0),n.e(4),n.e(5),n.e(6),n.e(7),n.e(11),n.e(14),n.e(17),n.e(20),n.e(19),n.e(25),n.e(26),n.e(29),n.e(31),n.e(33),n.e(34),n.e(47),n.e(50),n.e(54),n.e(56),n.e(63),n.e(75),n.e(103),n.e(128),n.e(476)]).then(n.bind(null,19197))),a=i(r,"send"),s=i(r,"save"),c=i(r,"runPostOpenTasks"),d=i(r,"switchBodyType"),u=i(r,"discard"),l=i(r,"upConvert"),f=i(r,"insertSignature"),b=i(r,"popoutCompose"),p=i(r,"createAttachments"),v=i(r,"clickAttachButton"),m=i(r,"showMessageOptionsDialog")},2501:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(29),i=n(44);function r(){var e;return(null===(e=Object(o.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(i.j)("cmp-proxy-address")}},2577:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var o=n(20);const i=new o.c(()=>Promise.all([n.e(24),n.e(27),n.e(115),n.e(762)]).then(n.bind(null,4256))),r=new o.a(i,e=>e.loadAndInitializeFloodgateEngine),a=new o.b(i,e=>e.logFloodgateActivity)},2772:function(e,t,n){"use strict";var o=n(3);const i=Object(o.action)("OnComposeLifecycleEvent",(e,t)=>({viewState:e,event:t}));t.a=i},2830:function(e,t,n){"use strict";var o,i;n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention",e.TxpRentalCarReservation="TxpRentalCarReservation",e.TxpFlightReservation="TxpFlightReservation",e.TxpLodgingReservation="TxpLodgingReservation",e.TxpFoodEstablishmentReservation="TxpFoodEstablishmentReservation",e.TxpEventReservation="TxpEventReservation",e.TxpParcelDelivery="TxpParcelDelivery",e.TxpInvoice="TxpInvoice",e.TxpServiceReservation="TxpServiceReservation",e.UserAtMentioned="UserAtMentioned",e.TaskNotificationInsight="TaskNotificationInsight",e.FollowUpNotificationInsight="FollowUpNotificationInsight",e.OutOfRoutineNotificationInsight="OutOfRoutineNotificationInsight",e.RealTimeFlightUpdate="RealTimeFlightUpdate",e.YammerLiveEventNotification="YammerLiveEventNotification",e.Reactions="Reactions",e.CommentCreated="CommentCreated",e.TaskCreated="TaskCreated",e.TaskCompleted="TaskCompleted",e.TaskReassigned="TaskReassigned",e.TaskReopened="TaskReopened",e.PromptAction="PromptAction"}(o||(o={})),function(e){e[e.None=0]="None",e[e.IsDismissed=1]="IsDismissed",e[e.IsSeen=2]="IsSeen",e[e.IsRead=4]="IsRead",e[e.IsCompleted=8]="IsCompleted",e[e.IsFlagged=16]="IsFlagged"}(i||(i={}))},3033:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return p}));var o=n(2216),i=n(20);const r=new i.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(5),n.e(9),n.e(10),n.e(12),n.e(13),n.e(16),n.e(17),n.e(35),n.e(40),n.e(51),n.e(52),n.e(64),n.e(71),n.e(185),n.e(250),n.e(440)]).then(n.bind(null,4486)));Object(i.f)(o.d,r,e=>e.openTimePanelOrchestrator);const a=Object(i.d)(r,e=>e.TimePanel),s=Object(i.d)(r,e=>e.TimePanelHeaderBar),c=new i.a(r,e=>e.loadTimePanelData),d=new i.a(r,e=>e.openEventDetailsView),u=(new i.a(r,e=>e.openAttendeeTrackingView),new i.a(r,e=>e.closeAttendeeTrackingView),new i.a(r,e=>e.openTasksView)),l=new i.a(r,e=>e.openCalendarView),f=new i.a(r,e=>e.openConflictsView),b=new i.a(r,e=>e.closeConflictsView),p=new i.a(r,e=>e.openEventQuickComposeView)},3136:function(e,t,n){"use strict";var o=n(20),i=n(3662);function r(e){var t;return null===(t=i.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return r}));const a=new o.c(()=>n.e(1348).then(n.bind(null,19251)));let s=new o.a(a,e=>e.initializePersonalizationSuggestions),c=(new o.a(a,e=>e.postPersonalizationSuggestionFeedback),new o.a(a,e=>e.postPersonalizationUsageSignals))},3170:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("saveReadingPanePositionOption")},3662:function(e,t,n){"use strict";var o=n(14),i=n(3);const r={usageSuggestions:new o.ObservableMap},a=Object(i.createStore)("personalization",r)();t.a=a},3872:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return u}));var o=n(20),i=n(2830);n.d(t,"c",(function(){return i.b}));const r=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(11),n.e(14),n.e(16),n.e(111),n.e(150),n.e(163),n.e(189),n.e(196),n.e(304),n.e(1104)]).then(n.bind(null,6092)));let a=Object(o.d)(r,e=>e.ActivityFeed),s=new o.a(r,e=>e.initializeActivityFeed),c=Object(o.d)(r,e=>e.ActivityFeedTitle),d=new o.a(r,e=>e.postWeveSignal),u=new o.a(r,e=>e.loadActivityFeed)},3934:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(44);function i(){return Object(o.j)("mon-rp-unstackedConversation")}},3953:function(e,t,n){"use strict";var o=n(20),i=n(3),r=n(4740),a=n(2544),s=n(2333),c=n(2348),d=n(2300),u=n(699),l=n(1761),f=Object(u.action)("onPrintRow")((function(){Object(l.d)()&&(Object(d.a)(!0),Object(c.a)(!1))})),b=Object(u.action)("onNewMessage")((function(e){e||(Object(d.a)(!0),Object(c.a)(!Object(l.d)()))})),p=n(4012);n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return O})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return p.a}));const v=new o.c(()=>Promise.all([n.e(60),n.e(63),n.e(752)]).then(n.bind(null,19277)));let m=new o.a(v,e=>e.onReplyOrReplyAllOrForwardMessage),I=(new o.b(v,e=>e.onSxSPreviewPaneClose),new o.a(v,e=>e.onReadingPanePositionOptionSaved)),O=new o.a(v,e=>e.onSelectMessageAd);function g(){Object(i.orchestrator)(r.b,()=>{I.importAndExecute()})}Object(o.f)(a.a,v,e=>e.onClientReadingPanePositionChangeOrchestrator),Object(o.f)(s.a,v,e=>e.closeImmersiveReadingPaneOrchestrator)},4012:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3);let i=Object(o.action)("exitSearch",e=>({actionSource:e}))},4496:function(e,t,n){"use strict";var o=n(1692),i=n(5410);function r(e,t){if(!t||!e)return;const n=t.internetMessageId,r=t.parentInternetMessageId,a=o.u.items.get(t.itemIds[0]),s=null==a?void 0:a.ItemClass,c=!!s&&i.a.test(s);e.set(n,{itemIds:t.itemIds,parentImId:c?void 0:r,visited:!1})}function a(e,t){var n;if(e)for(let i=0;i<e.length;i++)if(t){const r=Object(o.v)(e[i]);if((null===(n=null==r?void 0:r.ParentFolderId)||void 0===n?void 0:n.Id)==t)return e[i]}return null}var s=n(40);var c=n(61),d=n(209),u=n(44),l=n(2203);let f,b,p,v;function m(){return b}async function I(e,t){return p!=e?(b=null,f=[],p=e,v=async function(e,t){var n;await async function(e){var t,n,i,r;let a=null===(t=o.u.conversations)||void 0===t?void 0:t.get(e);for(a&&(null===(n=null==a?void 0:a.conversationNodeIds)||void 0===n?void 0:n.length)>0&&Object(c.o)("ForksCacheHit",{isPrefetchFlight:Object(u.j)("mon-rp-prefetchForks")});(!a||0==(null===(i=null==a?void 0:a.conversationNodeIds)||void 0===i?void 0:i.length)||(null==a?void 0:a.canLoadMoreForRelationMap))&&(a&&(a.isLoadMoreInProgress=!0,a.maxItemsToReturn=l.b,a.syncState=""),await l.e.importAndExecute({Id:e,mailboxInfo:Object(d.d)()},"CreateConversationRelationMap"),a||(a=null===(r=o.u.conversations)||void 0===r?void 0:r.get(e),a)););}(e);const i=null===(n=o.u.conversations)||void 0===n?void 0:n.get(e);if(!i)return s.h.warn("getForksList: conversation not found in mailStore. ConversationId: "+e),p="",Promise.reject([]);const v=i?i.conversationNodeIds:[],m=null==v?void 0:v.length;if(!m||0==m)return s.h.warn("getForksList: No nodeIds found in conversation. ConversationId: "+e),p="",Promise.reject([]);const I=[...v],O="ChronologicalNewestOnBottom"===(null==i?void 0:i.conversationSortOrder),g=[];[...v].forEach(e=>{const t=o.u.conversationNodes.get(e);t&&g.push(t.internetMessageId)}),O?g.reverse():I.reverse();return b=function(e){const t=o.u.conversationNodes.get(e[0]),n=new Map;t&&n.set(t.internetMessageId,{itemIds:t.itemIds,visited:!1});let i=1;const a=e.length;for(;i<a;){r(n,o.u.conversationNodes.get(e[i])),i+=1}return n}(I),f=function(e,t,n){const o=[];if(!t)return s.h.warn("getForksFromConversationRelationMap: conversationRelationMap not found"),[];for(;e.length>0;){const i=e.shift(),r=[],s=i?t.get(i):void 0;if(s){const i=a(s.itemIds,n);i&&r.push(i),s.visited=!0;let c=s.parentImId;for(;c;){const o=e.indexOf(c);o>-1&&e.splice(o,1);const i=t.get(c);if(i){if(i.visited)break;let e=a(i.itemIds,n);e&&r.push(e),i.visited=!0,c=i.parentImId}else c=void 0}r.length>0&&o.push(r)}}return o}(g,b,t),Promise.resolve(f)}(e,t).then(()=>Promise.resolve(f),()=>Promise.resolve(f)),v):null==b?v:Promise.resolve(f)}n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return I}))},4740:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(20),i=n(3170);n.d(t,"b",(function(){return i.a}));const r=new o.c(()=>n.e(1201).then(n.bind(null,7041)));let a=new o.a(r,e=>e.saveReadingPaneOptionQuick)},5178:function(e){e.exports=JSON.parse('{"e":"hwa","a":"iwa","s":"kwa","u":"lwa","H":"nwa","A":"owa","r":"pwa","l":"qwa","C":"rwa","B":"swa","h":"twa","t":"uwa","m":"vwa","D":"wwa","k":"xwa","g":"ywa","q":"zwa","f":"Awa","d":"Bwa","b":"Cwa","c":"Dwa","y":"Ewa","z":"Fwa","w":"Gwa","x":"Hwa","v":"Iwa","p":"Jwa","o":"Kwa","n":"Lwa","G":"Mwa","F":"Nwa","E":"Owa","j":"Pwa","i":"Qwa"}')},5548:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1690);function i(e){const t=o.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},5753:function(e,t,n){"use strict";var o=n(3);const i=Object(o.action)("EXPAND_ROW_FIRST_LEVEL",(e,t)=>({rowKey:e,forks:t})),r=Object(o.action)("REMOVE_FORKS_STORE_UPDATE",(e,t)=>({forks:e,itemIdsToRemove:t}));var a=n(1679),s=n(6020);Object(o.mutator)(i,e=>{Object(s.a)();const t=a.Z.expandedConversationViewState;t.forks=e.forks,t.expandedRowKey=e.rowKey}),Object(o.mutator)(r,e=>{const{itemIdsToRemove:t,forks:n}=e;if(n){const e=n.map(e=>e.id);for(const o of t){const t=e.indexOf(o);e.splice(t,1),n.splice(t,1)}a.Z.expandedConversationViewState.forks=[...n]}});var c=n(20),d=n(4496);n(3934);n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return d.b}));const u=new c.c(()=>n.e(2066).then(n.bind(null,19608))),l=new c.a(u,e=>e.getIdsForTriageActions)},5800:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var o=n(20);const i=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(9),n.e(10),n.e(12),n.e(13),n.e(16),n.e(19),n.e(18),n.e(35),n.e(40),n.e(42),n.e(51),n.e(55),n.e(64),n.e(71),n.e(80),n.e(163),n.e(171),n.e(196),n.e(273),n.e(492)]).then(n.bind(null,8186))),r=Object(o.d)(i,e=>e.NotificationPane),a=new o.b(i,e=>e.onDismissAutomaticReplyNotification)},6018:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(3730),i=n(71),r=n(3),a=n(4020);const s=Object(r.action)("expandCollapsedItemsRollUp",(e,t=!1)=>Object(i.b)({name:"RPCountExpCollItemsRollUp",customData:[Object(o.b)(Object(a.a)(e)),t]},{viewState:e}));Object(r.mutator)(s,({viewState:e})=>{e.conversationNodeIdsInCollapsedItemsRollUp=[]})},6020:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(1679),i=n(14);function r(){const e=o.Z.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new i.ObservableMap({}),e.forks=null}},6262:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2106);function i(e){e?Object(o.q)(e,"Route"):Object(o.o)("Route")}},6584:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(1846),i=n(1679),r=n(1998),a=n(1760);function s(e){const t=Object(r.a)(),n=Object(i.F)([e],t)[0];t.rowKeys.includes(n)&&Object(o.q)(t,n,!0,a.a.RouteHandler)}},6587:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1690);function i(e){var t,n;const i=null===(n=null===(t=o.a.conversations)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.conversationNodeIds;return(null==i?void 0:i.length)>0}},7004:function(e,t,n){"use strict";var o=n(6018),i=n(3730),r=n(1902),a=n(4020),s=n(61),c=n(2203),d=n(1690),u=n(3895),l=n(3);t.a=Object(s.r)(i.a.RPCountLoadMore,(function(e){if(e&&d.a.conversations.has(e.Id)){f(e);const t=Object(s.q)();t&&t.addCustomData([b(d.a.conversations.get(e.Id).maxItemsToReturn)]);const n=Object(r.a)(e.Id);return Object(a.b)(n)&&Object(o.a)(n,!0),c.e.importAndExecute(e,"LoadMore")}return Promise.resolve()}));const f=Object(l.mutatorAction)("updateConversationItemParts",e=>{const t=d.a.conversations.get(e.Id);t.isLoadMoreInProgress=!0,t.maxItemsToReturn=t.maxItemsToReturn+c.a,t.syncState=""});function b(e){const t=Math.ceil((e-20)/10);return Object(u.a)(t)}},72:function(e,t,n){"use strict";var o,i,r,a;n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(o||(o={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(i||(i={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(r||(r={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(a||(a={}));var s=7},76:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfVersionIsNotSupported=t.IsVersonSupportedByHost=t.isPIEHostPresent=t.HostBridge=void 0;var r=function(){function e(){this.nextHandlerId=1,this.registeredHandlers=new Map}return e.prototype.registerHandler=function(e){var t=this,n=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(n,e),function(){t.unregisterHandler(n)}},e.prototype.RaiseEvent=function(e){this.registeredHandlers.forEach((function(t){t(e)}))},e.prototype.HasHandlers=function(){return 0!==this.registeredHandlers.size},e.prototype.unregisterHandler=function(e){this.registeredHandlers.has(e)&&this.registeredHandlers.delete(e)},e}(),a=function(){function e(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.abandonedCallHandlers=new r,this.namespaceVersionChangeHandlers=new r,this.hostNotificationHandlers=new r,this.firstSyncIdCall=!0,this.nextSyncId=1,this.maxMessageId=2147483647}return e.prototype.isNamespaceVersionChange=function(e){return e.isIdRequest&&"version-change"===e.messageName&&-3===e.messageId},e.prototype.onMessageFromHost=function(e){if("app/pie"===e.contentType)if(this.raiseMessageInfoIfNeeded(e,!1),e.isEvent){var t=e.messageName;this.eventHandlers.has(t)&&this.eventHandlers.get(t).RaiseEvent(e.args)}else{var n=e.messageId;if(this.pendingMessages.has(n)){var o=this.pendingMessages.get(n);this.pendingMessages.delete(n),e.abandoned?this.abandonedCallHandlers.RaiseEvent(e.messageName):e.wasSuccessful?o.resolve(o.postProcessing?o.postProcessing(e.message):e.message):o.reject(new Error(e.messageName+":"+e.errorMessage))}else this.isNamespaceVersionChange(e)&&this.namespaceVersionChangeHandlers.RaiseEvent(e.message)}},e.prototype.addMessageToPendingMessages=function(e,t,n){var o=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var i={resolve:e,reject:t,postProcessing:n};return this.pendingMessages.set(o,i),o},e.prototype.invokeIdRequest=function(e,t,n,o,i){var r={contentType:"app/pie",messageName:t,isIdRequest:!0,messageId:this.addMessageToPendingMessages(o,i),message:n};this.raiseMessageInfoIfNeeded(r,!0,!0),e.sendMessageToHost(r)},e.throwPieSyncNotSupported=function(){throw new Error("Synchronous bridge not supported")},e.prototype.getNextSyncId=function(e){this.firstSyncIdCall&&(this.nextSyncId=e.getStartingSyncId(),this.firstSyncIdCall=!1);var t=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,t},e.prototype.invokeOnHostSync=function(t,n,o,i,r,a){if(t.sendMessageToHostSync){var s=this.addMessageToPendingMessages(i,r,a),c={contentType:"app/pie",messageName:n,syncId:this.getNextSyncId(t),messageId:s,message:o};this.raiseMessageInfoIfNeeded(c,!0,!1),t.sendMessageToHostSync(c)}else e.throwPieSyncNotSupported()},e.prototype.invokeOnHost=function(e,t,n,o,i,r){var a={contentType:"app/pie",messageName:t,messageId:this.addMessageToPendingMessages(o,i,r),message:n};this.raiseMessageInfoIfNeeded(a,!0,!0),e.sendMessageToHost(a)},e.prototype.registerForEvent=function(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new r),this.eventHandlers.get(e).registerHandler(t)},e.prototype.registerForAbandonedCalls=function(e){return this.abandonedCallHandlers.registerHandler(e)},e.prototype.registerForNamespaceVersionChange=function(e){return this.namespaceVersionChangeHandlers.registerHandler(e)},e.prototype.registerForHostMessageNotification=function(e){return this.hostNotificationHandlers.registerHandler(e)},e.prototype.raiseMessageInfoIfNeeded=function(e,t,n){if(this.hostNotificationHandlers.HasHandlers()){var o={isToHost:t,isAsync:n,messageName:e.messageName,isIdRequest:e.isIdRequest,syncId:e.syncId,messageId:e.messageId,isEvent:e.isEvent,wasSuccessful:e.wasSuccessful,abandoned:e.abandoned};this.hostNotificationHandlers.RaiseEvent(o)}},e}(),s=function(){function e(e){this.bridge=e,this.processor=new a,this.instanceId=null,this.namespaceVersions=new Map;var t=function(e){this.namespaceVersions.has(e)&&this.namespaceVersions.delete(e)}.bind(this);this.processor.registerForNamespaceVersionChange(t);var n=function(e){this.processor.onMessageFromHost(e)}.bind(this);this.bridge.addHostMessageHandler(n)}return e.prototype.isUsingBridge=function(e){return this.bridge===e},e.prototype.invokeHost=function(e,t,n){var o=this;return new Promise((function(i,r){o.processor.invokeOnHost(o.bridge,e,t,i,r,n)}))},e.prototype.invokeHostSync=function(e,t,n){var o;return this.processor.invokeOnHostSync(this.bridge,e,t,(function(e){o=e}),(function(e){throw e}),n),o},e.prototype.invokeIdRequestOnHost=function(e,t){var n=this;return new Promise((function(o,i){n.processor.invokeIdRequest(n.bridge,e,t,o,i)}))},e.prototype.registerForEvent=function(e,t){return this.processor.registerForEvent(e,t)},e.prototype.registerForAbandonedCalls=function(e){return this.processor.registerForAbandonedCalls(e)},e.prototype.registerForHostMessageNotification=function(e){return this.processor.registerForHostMessageNotification(e)},e.prototype.getInstanceId=function(){var e=this;return new Promise((function(t,n){e.instanceId?t(e.instanceId):e.invokeIdRequestOnHost("instance","id").then((function(n){e.instanceId=n,t(e.instanceId)})).catch((function(e){n(e)}))}))},e.prototype.getNamespaceVersion=function(e){var t=this;return new Promise((function(n,o){t.namespaceVersions.has(e)?n(t.namespaceVersions.get(e)):t.invokeIdRequestOnHost("version",e).then((function(i){var r=parseFloat(i);isNaN(r)?o("Non numeric version returned"):(t.namespaceVersions.set(e,r),n(r))})).catch((function(e){o(e)}))}))},e}(),c=function(){function e(){}return e.setGlobalPreprocessCheck=function(t){e._globalPreprocessCheck=t},e.isInitializationNeeded=function(t){return!e._implInstance||!e._implInstance.isUsingBridge(t)},e.initialize=function(t){e.isInitializationNeeded(t)&&(e._implInstance=new s(t))},e.resetBridgeForUnitTests=function(){e._implInstance=null},e.reloadBridgeForUnitTests=function(){if(e._implInstance){var t=e._implInstance.bridge;e._implInstance=new s(t)}},e.failBridgeNotInitialized=function(){return new Promise((function(e,t){t(new Error("HostBridge not initialized"))}))},e.invokeHost=function(t,n,r){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return e._implInstance?e._globalPreprocessCheck?[4,e._globalPreprocessCheck(t)]:[3,2]:[3,3];case 1:o.sent(),o.label=2;case 2:return[2,e._implInstance.invokeHost(t,n,r)];case 3:return[2,e.failBridgeNotInitialized()]}}))}))},e.invokeHostSync=function(t,n,o){if(e._implInstance)return e._implInstance.invokeHostSync(t,n,o);throw new Error("HostBridge not initialized")},e.getInstanceId=function(){return o(this,void 0,void 0,(function(){return i(this,(function(t){return e._implInstance?[2,e._implInstance.getInstanceId()]:[2,e.failBridgeNotInitialized()]}))}))},e.getNamespaceVersion=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return e._implInstance?[2,e._implInstance.getNamespaceVersion(t)]:[2,e.failBridgeNotInitialized()]}))}))},e.registerForEvent=function(t,n){return e._implInstance?e._implInstance.registerForEvent(t,n):null},e.registerForAbandonedCalls=function(t){return e._implInstance?e._implInstance.registerForAbandonedCalls(t):null},e.registerForHostMessageNotification=function(t){return e._implInstance?e._implInstance.registerForHostMessageNotification(t):null},e.throwPieSyncNotSupported=function(){a.throwPieSyncNotSupported()},e._implInstance=null,e._globalPreprocessCheck=null,e}();function d(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,new Promise((function(e){c.getInstanceId().then((function(t){e(!!t)})).catch((function(){e(!1)}))}))]}))}))}function u(e,t,n){return o(this,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return[4,d()];case 1:return i.sent()?[4,c.getNamespaceVersion(e)]:[3,3];case 2:if((o=i.sent())>=t&&(!n||o<n))return[2,!0];i.label=3;case 3:return[2,!1]}}))}))}t.HostBridge=c,t.isPIEHostPresent=d,t.IsVersonSupportedByHost=u,t.throwIfVersionIsNotSupported=function(e,t,n){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,u(e,t,n)];case 1:if(!o.sent())throw new Error("VersionNotSupported for "+e+": "+t+", "+n);return[2]}}))}))}},7705:function(e,t,n){"use strict";var o=n(3);const i=Object(o.action)("ON_CONVERSATION_OPTION_SAVED");t.a=i},8693:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("loadSignatureEditorWizard",(e,t)=>({target:e,viewState:t}))},8711:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(e,t)=>({conversationId:e,nodeIdCollectionChanged:t}))},8712:function(e,t,n){"use strict";var o=n(5012),i=n(4678),r=n(5382),a=n(1885),s=n(929),c=n(2495),d=n(1741),u=n(699),l=n(1679);t.a=Object(u.action)("reloadReadingPane")((function(e={composeViewState:s.a.viewStates.get(s.a.primaryComposeId),conversationItems:l.Z.conversationItems}){var t,n;const u=Object(l.I)(),f=u?[...u.selectedRowKeys.keys()]:[];if(1==f.length){const s=l.b.getRowIdToShowInReadingPane(f[0],u),b=Object(c.a)(f,u)[0],p=u.tableQuery.listViewType;if(1===p||Object(d.a)())(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?a.q.importAndExecute(e.composeViewState).then(()=>{Object(i.a)(s,b,r.a)}):Object(i.a)(s,b,r.a);else if(0===p){const t=e.conversationItems.get(s.Id);(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?a.q.importAndExecute(e.composeViewState).then(()=>{Object(o.b)(s,b,t.subject)}):Object(o.b)(s,b,t.subject)}}}))},8729:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(3),i=n(5178),r=n(5);let a=Object(o.action)("ADD_FIRST_EVENT",()=>({taskNewEventTitle:Object(r.b)(i.q)}))},8741:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("ON_KEYBOARD_UP_DOWN",(e,t,n,o)=>({selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:o}))},8742:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("ON_KEYBOARD_TOGGLE_SELECT",(e,t)=>({tableView:e,mailListItemSelectionSource:t}))},8743:function(e,t,n){"use strict";var o=n(3);t.a=Object(o.action)("ON_KEYBOARD_UP_DOWN",(e,t,n,o)=>({tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:o}))},93:function(e,t,n){"use strict";var o=n(72);let i={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn15Mins:9e5,MillisecondsIn20Mins:12e5,MillisecondsIn22Mins:132e4,MillisecondsIn24Mins:144e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,HoursInOneDay:24,DaysInOneWeek:7,AllDaysOfWeek:[o.c.Sunday,o.c.Monday,o.c.Tuesday,o.c.Wednesday,o.c.Thursday,o.c.Friday,o.c.Saturday]};t.a=i},945:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var o=n(3);const i=Object(o.createStore)("popoutParent",{projections:[],isAvailable:!1}),r=i();t.a=r},9884:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var o=n(20);const i=new o.c(()=>Promise.all([n.e(1),n.e(293)]).then(n.bind(null,12755))),r=new o.a(i,e=>e.subscribeToBulkActionNotification),a=new o.a(i,e=>e.findBulkActionItemAction)}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();