(window.msfast_search_hostapp_owa_jsonp=window.msfast_search_hostapp_owa_jsonp||[]).push([[2],{333:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r={};n.r(r),n.d(r,"getCompactRelativeTimeString",function(){return s}),n.d(r,"getDetailedTimestamp",function(){return u}),n.d(r,"getFriendlyTimestamp",function(){return d}),n.d(r,"getAlternativeFriendlyTimestamp",function(){return m}),n.d(r,"getSemiDetailedRelativeTimestamp",function(){return p}),n.d(r,"getDetailedRelativeTimeString",function(){return h}),n.d(r,"getShortDurationTimeString",function(){return f}),n.d(r,"getShortDurationFromHoursDifferenceString",function(){return g}),n.d(r,"getRelativeTimeFromNow",function(){return b}),n.d(r,"getLongDurationTimeString",function(){return v}),n.d(r,"getWeekRelativeDateString",function(){return y});var a=n(397),i=n(403),o=n(93),c=n(195),l=n(94);function s(e,t,n,r,o,c){return void 0===o&&(o=!1),void 0===c&&(c=!1),O(n,r)&&n.timeFormats?i.o(e,t)?Object(a.format)(o||n.todayAsLabel?n.timeFormats.todayDayShort:n.timeFormats.todayShort,e,t,n,r):i.q(e,t)?Object(a.format)(n.timeFormats.yesterdayShort,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.daysAgoShort,e,t,n,r):i.p(e,t)?Object(a.format)(n.timeFormats.tomorrowShort,e,t,n,r):i.n(e,t)?Object(l.l)(e,n.timeFormats,"long"):c?Object(l.c)(e,n.timeFormats,"short"):Object(a.format)(n.timeFormats.generic,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function u(e,t,n,r){return O(n,r)&&n.timeFormats?i.m(e,t)?n.timeFormats.justNow:i.h(e,t)?Object(a.format)(n.timeFormats.minutesAgoShort,e,t,n,r):i.o(e,t)?Object(a.format)(n.timeFormats.hoursAgoShort,e,t,n,r):i.q(e,t)?Object(a.format)(n.timeFormats.yesterdayLong,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.weekdayShort,e,t,n,r):i.a(e,t)?Object(a.format)(n.timeFormats.timestampDate,e,t,n,r):Object(a.format)(n.timeFormats.timestampDateYear,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function d(e,t,n,r){return O(n,r)&&n.timeFormats?i.p(e,t)?Object(a.format)(n.startWithLowercase?n.timeFormats.tomorrowShortLowercase:n.timeFormats.tomorrowShort,e,t,n,r):i.l(e,t)?i.d(e,t)<=59?Object(a.format)(n.a11yFriendly?n.timeFormats.inMinutesShortNumbers:n.timeFormats.inMinutesShorterNumbers,e,t,n,r):i.c(e,t)<=23?Object(a.format)(n.a11yFriendly?n.timeFormats.inHoursShortNumbers:n.timeFormats.inHoursShorterNumbers,e,t,n,r):Object(a.format)(n.startWithLowercase?n.timeFormats.todayLongLowercase:n.timeFormats.todayLong,e,t,n,r):i.m(e,t)?n.startWithLowercase?n.timeFormats.justNowLowercase:n.timeFormats.justNow:i.h(e,t)?Object(a.format)(n.a11yFriendly?n.timeFormats.minutesAgoShortNumbers:n.timeFormats.minutesAgoShorterNumbers,e,t,n,r):i.o(e,t)?Object(a.format)(n.a11yFriendly?n.timeFormats.hoursAgoShortNumbers:n.timeFormats.hoursAgoShorterNumbers,e,t,n,r):i.q(e,t)?Object(a.format)(n.startWithLowercase?n.timeFormats.yesterdayLongLowercase:n.timeFormats.yesterdayLong,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.weekdayShort,e,t,n,r):i.a(e,t)?Object(a.format)(n.timeFormats.timestampDate,e,t,n,r):Object(a.format)(n.timeFormats.timestampDateYear,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function m(e,t,n,r){return O(n,r)&&n.timeFormats?i.o(e,t)?d(e,t,n,r):i.j(e,t)?Object(l.l)(e,n.timeFormats,"long"):i.a(e,t)?Object(a.format)(n.timeFormats.monthNameAndDate,e,t,n,r):d(e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function p(e,t,n,r){return O(n,r)&&n.timeFormats?i.p(e,t)?Object(a.format)(n.timeFormats.tomorrowShort,e,t,n,r):i.l(e,t)?Object(a.format)(n.timeFormats.todayLong,e,t,n,r):i.m(e,t)?n.timeFormats.justNow:i.h(e,t)?Object(a.format)(n.timeFormats.minutesAgoShortNumbers,e,t,n,r):i.o(e,t)?Object(a.format)(n.timeFormats.hoursAgoShortNumbers,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.daysAgoShortWithYesterday,e,t,n,r):i.i(e,t)?Object(a.format)(n.timeFormats.weeksAgoLongNumbers,e,t,n,r):i.g(e,t)<1?Object(a.format)(n.timeFormats.monthsAgoLongNumbers,e,t,n,r):Object(a.format)(n.timeFormats.yearsAgoLong,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function h(e,t,n,r,o){return void 0===o&&(o=!1),O(n,r)&&n.timeFormats?i.o(e,t)?Object(a.format)(n.timeFormats.todayLong,e,t,n,r):i.q(e,t)?Object(a.format)(n.timeFormats.yesterdayLong,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.daysAgoLong,e,t,n,r):o&&i.i(e,t)?Object(a.format)(n.timeFormats.weeksAgoLong,e,t,n,r):o&&i.k(e,t)?Object(a.format)(n.timeFormats.monthsAgoLong,e,t,n,r):o?Object(a.format)(n.timeFormats.yearsAgoLong,e,t,n,r):Object(a.format)(n.timeFormats.generic,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes()}function f(e,t,n,r){if(n){var a=new Date(e).setHours(0,0,0,0),i=new Date(t).setHours(0,0,0,0),c=Object(l.r)((i-a)/o.c);return c<1?"":r.shortDurationByDays.replace(o.d,String(c))}var s=t.getTime()-e.getTime(),u=Object(l.r)(s/o.c),d=Object(l.r)(s/o.e)%24,m=Object(l.r)(s/o.h)%60;return!u||d||m?u&&d&&!m?r.shortDurationByDaysAndHours.replace(o.d,String(u)).replace(o.f,String(d)):u&&d&&m?r.shortDurationByDaysHoursAndMinutes.replace(o.d,String(u)).replace(o.f,String(d)).replace(o.i,String(m)):u&&!d&&m?r.shortDurationByDaysAndMinutes.replace(o.d,String(u)).replace(o.i,String(m)):u||!d||m?!u&&d&&m?r.shortDurationByHoursAndMinutes.replace(o.f,String(d)).replace(o.i,String(m)):u||d||!m?"":r.shortDurationByMinutes.replace(o.i,String(m)):r.shortDurationByHours.replace(o.f,String(d)):r.shortDurationByDays.replace(o.d,String(u))}var g=function(e,t,n){return f(e,new Date(e.getTime()+Math.abs(t*o.m)),!1,n)};function b(e,t,n,r){var a=t.getTime()>e.getTime(),i=Math.abs(e.getTime()-t.getTime())>o.c,c=a?e:t,l=a?t:e,s=r?v(c,l,void 0,i):f(c,l,i,n);return""===s?n.justNowLowercase:a?n.durationFuture({p0:s}):n.durationPast({p0:s})}function v(e,t,n,r){var i=Object(c.b)(),s=t.getTime()-e.getTime();if(s<0)return"";if(r){var u=new Date(e).setHours(0,0,0,0),d=new Date(t).setHours(0,0,0,0),m=Object(l.r)((d-u)/o.c);return m<1?"":Object(a.getPluralizedFormatString)(i.longDurationByDays,m,n).replace(o.o,String(m))}var p=Object(l.r)(s/o.c),h=Object(l.r)((s-p*o.c)/o.e),f=Object(l.r)((s-p*o.c-h*o.e)/o.h);return!p||h||f?p&&h&&!f?[Object(a.getPluralizedFormatString)(i.longDurationByDays,p,n).replace(o.o,String(p)),Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h))].join(" "):p&&h&&f?[Object(a.getPluralizedFormatString)(i.longDurationByDays,p,n).replace(o.o,String(p)),Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h)),Object(a.getPluralizedFormatString)(i.longDurationByMinutes,f,n).replace(o.q,String(f))].join(" "):p&&!h&&f?[Object(a.getPluralizedFormatString)(i.longDurationByDays,p,n).replace(o.o,String(p)),Object(a.getPluralizedFormatString)(i.longDurationByMinutes,f,n).replace(o.q,String(f))].join(" "):p||!h||f?!p&&h&&f?[Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h)),Object(a.getPluralizedFormatString)(i.longDurationByMinutes,f,n).replace(o.q,String(f))].join(" "):p||h||!f?"":Object(a.getPluralizedFormatString)(i.longDurationByMinutes,f,n).replace(o.q,String(f)):Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h)):Object(a.getPluralizedFormatString)(i.longDurationByDays,p,n).replace(o.o,String(p))}function y(e,t,n,r){return void 0===n&&(n="long"),isNaN(e.getTime())?Object(a.format)(t.timeFormats.generic,new Date(432e5),new Date,t,r):i.o(e)?Object(a.format)(t.todayAsLabel?t.timeFormats.todayDayShort:t.timeFormats.todayShort,e,new Date,t,r):i.q(e)?Object(a.format)(t.timeFormats.yesterdayShort,e,new Date,t,r):i.p(e)?Object(a.format)(t.timeFormats.tomorrowShort,e,new Date,t,r):i.j(e)||i.n(e)?Object(l.l)(e,t.timeFormats,n):Object(a.format)(t.timeFormats.generic,e,new Date,t,r)}function O(e,t){if(!e.timeFormats)return Object(l.q)(t,"validateFormatStrings",{message:"Failed validating format strings: timeFormats object was not provided"}),!1;var n=[];return e.is24HourFormat||e.timeFormats.amPartOfDay||n.push("amPartOfDay"),e.is24HourFormat||e.timeFormats.pmPartOfDay||n.push("pmPartOfDay"),e.timeFormats.timeZone||n.push("timeZone"),e.timeFormats.todayShort||n.push("todayShort"),e.timeFormats.todayShortWithTimeZone||n.push("todayShortWithTimeZone"),e.timeFormats.todayDayShort||n.push("todayDayShort"),e.timeFormats.todayLong||n.push("todayLong"),e.timeFormats.yesterdayShort||n.push("yesterdayShort"),e.timeFormats.yesterdayLong||n.push("yesterdayLong"),e.timeFormats.daysAgoShort||n.push("daysAgoShort"),e.timeFormats.daysAgoLong||n.push("daysAgoLong"),e.timeFormats.weeksAgoLong||n.push("weeksAgoLong"),e.timeFormats.monthsAgoLong||n.push("monthsAgoLong"),e.timeFormats.yearsAgoLong||n.push("yearsAgoLong"),e.timeFormats.generic||n.push("generic"),!(n.length>0)||(Object(l.q)(t,"validateFormatStrings",{message:"Failed validating "+n.length+" timeFormat(s)",failedTimeFormats:n}),!1)}},394:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n(93);var r=n(195);new Date(2014,1,1,15,0,0,0);function a(e){var t=Object(r.b)();return[t.sundayLong,t.mondayLong,t.tuesdayLong,t.wednesdayLong,t.thursdayLong,t.fridayLong,t.saturdayLong][e]}},397:function(e,t,n){"use strict";n.r(t),n.d(t,"format",function(){return l}),n.d(t,"formatCalendarDate",function(){return s}),n.d(t,"formatUTCCalendarDate",function(){return u}),n.d(t,"formatTimeZone",function(){return d}),n.d(t,"formatCalendarDateFromString",function(){return m}),n.d(t,"getPluralizedFormatString",function(){return p}),n.d(t,"getWeekDayDate",function(){return h}),n.d(t,"getTimeInAMPM",function(){return f}),n.d(t,"getCompleteDate",function(){return g});var r=n(494),a=n(403),i=n(93),o=n(195),c=n(94);function l(e,t,n,r,o,l){if(!e||!t||isNaN(t.valueOf())||!n||isNaN(n.valueOf()))return"";if(e.match(i.t)){var u=a.g(t,n);e=(e=p(e,u,o)).replace(i.t,String(u))}else if(e.match(i.r)){var d=a.e(t,n);e=(e=p(e,d,o)).replace(i.r,String(d))}else if(e.match(i.s)){var m=a.f(t,n);e=(e=p(e,m,o)).replace(i.s,String(m))}else if(e.match(i.o)){var h=a.b(t,n);e=(e=p(e,h,o)).replace(i.o,String(h))}else if(e.match(i.p)){var f=a.c(t,n);e=(e=p(e,f,o)).replace(i.p,String(f))}else if(e.match(i.q)){var g=a.d(t,n);e=(e=p(e,g,o)).replace(i.q,String(g))}e=(e=(e=(e=(e=e.replace(i.f,c.d(t,r.is24HourFormat,r.hostAppTimeFormat))).replace(i.i,c.e(t))).replace(i.a,c.a(t,r.timeFormats,r.is24HourFormat))).replace(i.x,c.l(t,r.timeFormats,"short"))).replace(i.g,c.l(t,r.timeFormats,"long"));var b=null!=l?l:c.j(t);return e=s(e=e.replace(i.v,c.k(b)),t,r.timeFormats)}function s(e,t,n){return e&&t&&!isNaN(t.valueOf())?e.replace(i.d,""+t.getDate()).replace(i.l,""+(t.getMonth()+1)).replace(i.k,c.f(t.getMonth(),n)).replace(i.z,""+t.getFullYear()):""}function u(e){var t=Object(o.b)(),n=t.timestampDateYear;return n&&e&&!isNaN(e.valueOf())?n.replace(i.d,""+e.getUTCDate()).replace(i.l,""+(e.getUTCMonth()+1)).replace(i.k,c.f(e.getUTCMonth(),t)).replace(i.z,""+e.getUTCFullYear()):""}function d(e,t){return e.replace(i.v,c.k(t))}function m(e,t,n){if(!e||!t||c.o(t))return"";var r=/(\d{4})-(\d{2})-(\d{2})/,a=r.exec(t);if(!r.test(t)||!a)return"";var o=parseInt(a[1],10),l=parseInt(a[2],10),s=parseInt(a[3],10);return e=(e=(e=(e=e.replace(i.d,""+s)).replace(i.l,""+l)).replace(i.k,c.f(l-1,n))).replace(i.z,""+o)}function p(e,t,n){try{return Object(r.a)(e,t)}catch(t){return c.q(n,"getPluralizedFormatString",{message:"Failed parsing pluralized format string '"+e+"'"}),e}}var h=function(e){if(!e)return"";var t=Object(o.b)();return[m(t.monthNameAndDate,e,t),c.l(new Date(e),t,"long")].join(Object(o.a)()+" ")},f=function(e,t){return e&&t?c.i(new Date(new Date(e).getTime()),t,!1,!1).toUpperCase():""},g=function(e){if(!e)return"";var t=Object(o.b)();return m(t.timestampDateYear,e,t)}},403:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"m",function(){return m}),n.d(t,"h",function(){return p}),n.d(t,"o",function(){return h}),n.d(t,"l",function(){return f}),n.d(t,"p",function(){return g}),n.d(t,"q",function(){return b}),n.d(t,"j",function(){return v}),n.d(t,"i",function(){return y}),n.d(t,"k",function(){return O}),n.d(t,"n",function(){return j});var r=n(93);function a(e,t){return void 0===t&&(t=new Date),e.getDate()===t.getDate()&&function(e,t){void 0===t&&(t=new Date);return e.getMonth()===t.getMonth()&&i(e,t)}(e,t)}function i(e,t){return void 0===t&&(t=new Date),e.getFullYear()===t.getFullYear()}function o(e,t){var n=t.getTime(),a=e.getTime();return Math.floor((n-a)/r.y)}function c(e,t){var n=t.getTime(),a=e.getTime();return Math.floor((n-a)/r.j)}function l(e,t){var n=t.getTime(),a=e.getTime();return Math.ceil((n-a)/r.w)}function s(e,t,n){var a=t.getTime(),i=e.getTime();return n&&1===n?Math.floor((a-i)/r.c):Math.ceil((a-i)/r.c)}function u(e,t){var n=t.getTime(),a=e.getTime();return Math.abs(Math.ceil((n-a)/r.e))}function d(e,t){var n=t.getTime(),a=e.getTime();return Math.abs(Math.ceil((n-a)/r.h))}function m(e,t){return void 0===t&&(t=new Date),Boolean(e&&t.getTime()-e.getTime()<r.h)}function p(e,t){return void 0===t&&(t=new Date),Boolean(e&&t.getTime()-e.getTime()<r.e)}function h(e,t){return void 0===t&&(t=new Date),!!e&&a(e,t)}function f(e,t){return void 0===t&&(t=new Date),!!e&&(!!a(e,t)&&t.getTime()-e.getTime()<0)}function g(e,t){return void 0===t&&(t=new Date),!!e&&a(e,new Date(t.getTime()+r.c))}function b(e,t){return void 0===t&&(t=new Date),!!e&&a(new Date(t.getTime()-r.c),e)}function v(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime(),a=n<r.w&&n>=0,i=t.getDay()===e.getDay()&&n>=r.c;return a&&!i}function y(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime();return n<r.j&&n>=0}function O(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime();return n<r.y&&n>=0}function j(e,t){void 0===t&&(t=new Date);var n=t.getTime(),a=e.getTime()-n;return a<r.w&&a>=0}},407:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function a(){return r.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)})}},494:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n(1),a=n(245),i=n(95),o=n(514),c="||",l="::",s=",",u=["->","–>","-","–"],d="INF",m="*",p=/^\d+$/;function h(e){var t=Object(a.a)(u,function(t){return e.indexOf(t)>=0}),n=t?e.split(t).map(function(e){return e.trim()}):[e.trim()];if(1===n.length){var r=n[0];if(Object(i.e)(r,m)){var o=r.substring(m.length);return o.match(p)?function(e){return Object(i.b)(e.toString(),o)}:null}return r.match(p)?function(e){return e.toString()===r}:null}if(2===n.length){if(!n[0].match(p))return null;var c=parseInt(n[0],10);if(isNaN(c))return null;if(n[1]===d)return function(e){return e>=c};if(!n[1].match(p))return null;var l=parseInt(n[1],10);return isNaN(l)?null:function(e){return e>=c&&e<l}}return null}function f(e,t){var n,a,i,o,u=function(t){throw new Error('pluralized string "'+e+'" '+t)};try{for(var d=Object(r.__values)(e.split(c)),m=d.next();!m.done;m=d.next()){var p=m.value,f=p.split(l);2!==f.length&&u("is missing separator "+l+' in clause "'+p+'"');var g=Object(r.__read)(f,2),b=g[0],v=g[1];try{for(var y=(i=void 0,Object(r.__values)(b.split(s))),O=y.next();!O.done;O=y.next()){var j=O.value,S=h(j);if(null===S)u('contains invalid range "'+j+'"');else if(!t(v,S))return}}catch(e){i={error:e}}finally{try{O&&!O.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}function g(e,t){if(void 0===t)return e;try{return function(e,t){if(t<0||t!==1/0&&!Object(o.a)(t))throw new Error("count must be a positive integer or Infinity");var n="";return f(e,function(e,r){return!r(t)||(n=e,!1)}),n}(e,t)}catch(t){return e}}},501:function(e,t,n){"use strict";n.r(t),n.d(t,"HeroCardRouterContainer",function(){return $s});var r=n(173),a=n(1),i=n(12),o=i.createContext(void 0);var c=function(e){var t=e.target,n=Object(a.__rest)(e,["target"]),r=i.useContext(o);return i.createElement("a",Object(a.__assign)({target:t||r},n,{id:n.id}))},l=n(258),s=n(17),u=n(80);var d=n(181),m=n(131),p=n(147);n(347);var h=n(153),f=n(14),g=n(152),b=n(69);function v(){return Object(u.useSelector)(f.k)}var y=["SkypeTeams","Yammer","Exchange"],O=n(383),j=n(6),S=n(24),x=n(9);function C(e){var t=function(e){if(Object(j.z)(e))return Object(x.i)(e);var t=Object(S.g)(e);return t&&"Conversation"===t.domain?t.provenance:void 0}(e);return t?Object(O.a)(y,function(e){return e===t?-1:0}):y}var k,E=n(335),w=n(148),T=n(283),I=(k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),P=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return I(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){var n=this.props,r=n.appContext,a=n.codeLocation;Object(w.g)(r.logger,a+".componentDidCatch:"+t.componentStack,e)},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(i.Component),N=Object(T.a)(P),A=n(92),F=n(128),D=n(33),L=n(41),R=n(104),H=n(70),W=n(8),M=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function z(e){return{heroDomain:Object(W.c)(e),allResultDomains:Object(W.a)(e),domainsFilter:Object(j.e)(e),areConnectorsEnabled:Object(j.b)(e),variantEnabledAsyncDomains:Object(f.l)(e)}}var _=n(68),U=(n(277),n(48)),q=n(380),K=n(23),V=n(177),Q=n(2),Y=n(108),G=n(35);function $(e,t){return void 0===t&&(t=Q.c),Object(q.a)(Object(_.filterOutNull)(Object(K.a)(e,function(e){return t(e)})))}function J(e,t,n,r,a,i,o,c,l,s,u,d,m,p,h){if(!Object(L.a)(t)){var f={cardType:a,clientSize:i,eventScope:r,count:Object(V.a)(t).toString(),isHero:o,pageNumber:c,target:l||$(t),entityId:$(t,Q.b),initialHeroImpression:s,placement:u,value:d,queryType:m,verticalId:p,externalSourceType:h};Object(Q.p)(e,{properties:f,eventId:n})}}var Z="Hero";function X(){var e=Object(u.useSelector)(x.w),t=i.useState(!1),n=t[0],r=t[1],a=Object(E.a)(),o=Object(l.b)(),c=Object(u.useSelector)(x.D);i.useEffect(function(){e&&!n&&(r(!0),function(e,t,n,r,a,i){var o={eventScope:"AnswerRoot",cardType:t,clientSize:n,target:r,alreadySignedIn:a,ssoSignedIn:i};Object(Q.p)(e,{properties:o,eventId:"Answer_Impression"})}(a,Z,o,c?"Hide":"Shown"))},[e,a,c])}n(513);var ee=n(62),te=n(37);function ne(){return window.performance?performance.now():Date.now()}function re(e){var t=i.useRef({}),n=i.useRef(ne());t.current.logger=Object(E.a)(),t.current.clientSize=Object(l.b)(),t.current.muid=Object(l.e)(),t.current.prevStaticProperties=Object(l.g)(),t.current.isSuppressed=Object(u.useSelector)(f.z),t.current.isHero=Object(u.useSelector)(f.y),t.current.heroDomain=Object(u.useSelector)(W.c);var r=function(e){var r=t.current,i=r.logger,o=r.clientSize,c=r.isSuppressed,l=r.isHero,s=r.heroDomain;n.current&&!c&&i&&o&&(!function(e,t,n,r,i,o){var c=n&&Object(G.b)(n),l=Object(a.__assign)({name:"DwellTime",value:t.toString(),eventScope:c,clientSize:r,isHero:i},o||{});Object(Q.C)(e,{eventId:"DwellTime",properties:l})}(i,ne()-n.current,s,o,!!l,e),n.current=ne())};return i.useEffect(function(){return function(){r(t.current.prevStaticProperties)}},[e]),r}var ae=n(130),ie=n(184),oe=n(250),ce=n(38),le=n(28);function se(e,t){void 0===t&&(t=!0);var n=i.useRef(void 0);return i.useEffect(function(){(t||null!=e)&&(n.current=e)},[e]),n.current}var ue=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},de=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};var me=n(199);function pe(e,t){var n=function(e){switch(e){case"Bookmark":return{BookmarkAnswerTriggered:!0};case"Calendar":return{CalendarAnswerTriggered:!0};case"File":return{FileAnswerTriggered:!0};case"Flight":return{FlightAnswerTriggered:!0};case"Person":return{PersonAnswerTriggered:!0};case"Acronym":return{AcronymAnswerTriggered:!0};case"Link":return{LinkAnswerTriggered:!0};case"TuringQnA":return{TuringQnAAnswerTriggered:!0};case"PeopleAlsoAsk":return{PeopleAlsoAskAnswerTriggered:!0};default:return}}(t);if(n){var r={TriggerConditions:n};Object(Q.m)(e,r)}}var he=n(20),fe=n(427);function ge(e,t,n,r,a){var i,o,c=t.offsetWidth,l=t.offsetHeight;if(a&&(0===c&&(c=(null===(i=t.parentElement)||void 0===i?void 0:i.offsetWidth)||0),0===l&&(l=(null===(o=t.parentElement)||void 0===o?void 0:o.offsetHeight)||0)),!n||n.offsetWidth!==c||n.offsetHeight!==l){var s=0;try{s=null==t?void 0:t.getBoundingClientRect().width}catch(n){console.log("element "+t+" is not on DOM when calling 'element.getBoundingClientRect()' in useDimension from "+e)}r({offsetWidth:c,offsetHeight:l,preciseOffsetWidth:s})}}function be(e,t){var n=i.useState({offsetWidth:0,offsetHeight:0,preciseOffsetWidth:0}),r=n[0],a=n[1],o=se(r),c=function(e){var t=i.useRef(null);return i.useEffect(function(){if(t&&t.current){var n=t.current,r=new fe.a(function(t){window.requestAnimationFrame(function(){Array.isArray(t)&&t.length&&(t[0].target===n&&e(n.clientHeight,n.clientWidth))})});return r.observe(n),function(){r.unobserve(n)}}},[t]),[t]}(function(){var n=c.current;n&&ge(e,n,o,a,t)})[0];return i.useEffect(function(){var n=c.current;n&&ge(e,n,o,a,t)}),[c,r]}function ve(e,t,n,r){var a=be(e+" + useDynamicClientSize"),i=a[0],o=a[1];return 0===o.offsetWidth?[i,n]:[i,r?r():o.offsetWidth<=t?"Small":"Large"]}var ye=n(408),Oe=n(337);function je(){var e=i.useContext(ye.a);return Oe.a.getSettings(["theme"],"WithTheme",e.customizations).theme}var Se=n(418),xe=n(516),Ce=n(101),ke=n(509),Ee=n(32),we=n(384),Te=n(44),Ie="<sep/>";Object(Ce.a)(function(e,t,n,r){return t?function(e,t){var n=(r=t,a=Object(ke.a)(r,RegExp("\\W+","g")),i="",Object(Ee.a)(a,function(e){return i+=(i.length>0?"|":"")+"(\\b"+e+"\\b)"}),new RegExp(i,"gi"));var r,a,i;return Pe(e,n)}(e,t):function(e,t,n){if(!t||!n)return[e];var r=new RegExp(t+".*?"+n,"gi");return Pe(e,r)}(e,n,r)});function Pe(e,t){var n=Object(we.a)(e,t,function(e){return""+Ie+e+Ie});return Ne(Object(ke.a)(n,Ie))}function Ne(e){return Object(R.a)(e,function(e){return!!e})}function Ae(e,t){!t||"Enter"!==e.key&&" "!==e.key||t()}var Fe=function(e){return e.replace(/-/g,"/").replace(/_/g,"+")},De=n(0),Le=((Object(De.declareStringWithPlaceholders)("search-components.search.shared.ResultsCount")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.resultsCountPlus")),(Object(De.declareString)("search-components.search.shared.ResultsCount1")),(Object(De.declareString)("search-components.search.shared.seeProfile")),(Object(De.declareString)("search-components.search.shared.getDirections")),(Object(De.declareString)("search-components.search.shared.seeFullMap")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.numberMore")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.relatedTo")),(Object(De.declareString)("search-components.search.shared.somethingWentWrong")),(Object(De.declareString)("search-components.search.shared.clickToRetry")),(Object(De.declareString)("search-components.search.shared.noResultFound")),(Object(De.declareString)("search-components.search.shared.noEduResultFound")),(Object(De.declareString)("search-components.search.shared.moreResults")),(Object(De.declareString)("search-components.search.shared.noResultMessage")),(Object(De.declareString)("search-components.search.shared.learnMore")),(Object(De.declareString)("search-components.search.shared.learnMoreWorkPrivacy")),(Object(De.declareString)("search-components.search.shared.learnMoreAboutMicrosoftSearch")),(Object(De.declareString)("search-components.search.shared.microsoftSearch")),(Object(De.declareString)("search-components.search.shared.seeMore"))),Re=(Object(De.declareString)("search-components.search.shared.seeLess")),He=((Object(De.declareString)("search-components.search.shared.dataFromLabel")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.viewAllWithCount")),(Object(De.declareString)("search-components.search.shared.openInBrowser")),(Object(De.declareString)("search-components.search.shared.ellipsisString"))),We=((Object(De.declareString)("search-components.search.shared.seeMoreOnOffice")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.seeMoreOn")),(Object(De.declareString)("search-components.search.shared.clickToCollapse")),(Object(De.declareString)("search-components.search.shared.bingMap")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.scopeCardAriaLabel")),(Object(De.declareString)("search-components.search.shared.plus")),(Object(De.declareString)("search-components.search.shared.defaultTenantDisplayName")),(Object(De.declareString)("search-components.search.shared.illustration"))),Me=((Object(De.declareStringWithPlaceholders)("search-components.search.shared.tenantResults")),(Object(De.declareString)("search-components.search.shared.copy")),(Object(De.declareString)("search-components.search.shared.semanticTitle")),(Object(De.declareString)("search-components.search.shared.semanticDescription")),(Object(De.declareString)("search-components.search.shared.semanticButton")),(Object(De.declareString)("search-components.search.shared.event"))),Be=(Object(De.declareString)("search-components.search.shared.file")),ze=(Object(De.declareString)("search-components.search.shared.people")),_e=((Object(De.declareString)("search-components.search.shared.work")),(Object(De.declareString)("search-components.search.shared.school")),(Object(De.declareString)("search-components.search.navmenu.all")),(Object(De.declareString)("search-components.search.shared.closeButton"))),Ue=((Object(De.declareString)("search-components.search.shared.listGenericTitleNoQuery")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.listGenericTitleWithQuery")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.listVerticalTitleNoQuery")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.listVerticalTitleWithQuery")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.listVerticalNameWithQuery")),(Object(De.declareString)("search-components.search.shared.workResultIndicatorText")),(Object(De.declareString)("search-components.search.shared.answerTile")));var qe=n(339),Ke=function(e){return{margin:"0 "+(e?12:24)+"px",padding:"8px 0"}},Ve=Object(Ce.a)(function(e,t,n,r,a,i,o,c,l){var s=e.palette,u=s.neutralLighter,d=s.neutralLighterAlt,m=s.themePrimary;return Object(qe.t)({bodyContainer:["ms-search-heroTile-bodyContainer",Ke(t),{overflow:"hidden"},l?l(e).bodyStyles:{}],headerContainer:["ms-search-heroTile-headerContainer",Ke(t),{borderBottom:"1px solid "+u,display:"flex",alignItems:"center"},l?l(e).headerStyles:{}],footerContainer:["ms-search-heroTile-footerContainer",{backgroundColor:d,height:"48px",overflow:"hidden",display:"flex"},l?l(e).footerStyles:{}],tileContainer:{display:"flex",flexDirection:"Top"===n?"column":"Bottom"===n?"column-reverse":"Right"===n?"row-reverse":"row",cursor:c?"pointer":"default"},imageContainer:{cursor:o?"pointer":"auto",overflow:"inherit",selectors:{"> img":{backgroundColor:m,width:a,maxWidth:i,height:r}}},content:{width:"100%"},cardStyles:[l?l(e).cardStyles:{}]})}),Qe=Object(Ce.a)(function(e){var t=e.palette.neutralPrimary;return Object(qe.t)({root:["ms-search-heroTile-dismissButton",{marginLeft:"auto",float:"right"}],icon:["ms-search-heroTile-dimissButton-icon",{color:t}]})}),Ye=n(100);(Object(De.declareString)("search-components.search.privacy.learnMoreAboutPrivacy")),(Object(De.declareString)("search-components.search.shared.whoCanSeeWorkResults")),(Object(De.declareString)("search-components.search.shared.whoCanSeeEduResults")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.PrivacyNotice")),(Object(De.declareString)("search-components.search.shared.privacyNoticeResults")),(Object(De.declareString)("search-components.search.shared.privacyNoticeResultsSmall")),(Object(De.declareString)("search-components.search.shared.privacyNoticeResultsForEduLicenses")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.privacyNoticeResultsLimited")),(Object(De.declareStringWithPlaceholders)("search-components.search.shared.privacyNoticeEduResultsLimited")),(Object(De.declareString)("search-components.search.shared.privacySearchHistory")),(Object(De.declareString)("search-components.search.shared.privacySearchHistoryEdu")),(Object(De.declareString)("search-components.search.shared.privacyLinkContent")),(Object(De.declareString)("search-components.search.shared.privacyLinkEduContent")),(Object(De.declareString)("search-components.search.shared.privacy")),(Object(De.declareString)("search-components.search.shared.dismiss")),(Object(De.declareString)("search-components.search.shared.peopleResultsMessage")),(Object(De.declareString)("search-components.search.shared.otherResultsMessage"));function Ge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(_.filterOutNull)(e).join(" ")}var $e=function(e,t,n){if(t&&n)return e?e({name:t,emailAddress:n}):void 0};var Je=n(336),Ze=Object(Je.b)(function(e,t){var n;return Object(qe.t)({heroTileFrame:["ms-search-heroFrame",{background:e.palette.white,margin:"12px 12px 17px 12px",borderRadius:"2px",boxShadow:e.effects.elevation4,border:"1px solid "+e.palette.neutralLighterAlt,selectors:(n={"&:hover":{boxShadow:e.effects.elevation8},"&:active":{boxShadow:e.effects.elevation4}},n["&.ms-search-maxWidth"]={maxWidth:t||"603px"},n["&.ms-search-image-maxWidth"]={maxWidth:t||"871px"},n["&.ms-search-maxContent"]={maxWidth:"fit-content",minWidth:"360px"},n["&.ms-search-IEAdjustment"]={marginRight:"24px"},n)}]})}),Xe=function(e){var t,n,r,a=e.className,o=e.cardStyles,c=je(),l=Ze(c).heroTileFrame,s=!(r=null===(n=null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.userAgent)||void 0===n?void 0:n.toLowerCase())||-1===r.indexOf("msie")&&-1===r.indexOf("edge")&&-1===r.indexOf("rv:11.0")?void 0:"ms-search-IEAdjustment";return i.createElement("div",{className:Ge(l,a,o,s)},e.children)};Xe.displayName="HeroTileFrame";var et=function(e){var t=e.body,n=e.className,r=e.header,a=e.footer,o=e.isSmall,c=e.imageProps,l=e.styleOverrides,s=e.cardClickProps,u=e.onDismiss,d=e.isDismissible,m=null==c?void 0:c.imagePosition,p=null==c?void 0:c.imageHeight,h=null==c?void 0:c.imageWidth,f=null==c?void 0:c.imageMaxWidth,g=null==c?void 0:c.headerImageUrl,b=null==c?void 0:c.onImageClick,v=je(),y=i.useState(!0),O=y[0],j=y[1],S=function(){d&&u&&u(),j(!1)},x=Ve(v,void 0===o||o,m,p,g&&h,f,!!b,!!s,l),C=x.headerContainer,k=x.bodyContainer,E=x.footerContainer,w=x.tileContainer,T=x.imageContainer,I=x.content,P=x.cardStyles,N=null==s?void 0:s.onCardClick,A=null==s?void 0:s.clickRole,F=function(){b&&b()},D=function(e){var t;null===(t=e.currentTarget.parentElement)||void 0===t||t.setAttribute("hidden","true")},L={iconName:Te.d};return i.createElement(i.Fragment,null,O&&i.createElement(Xe,{className:n,cardStyles:P},i.createElement("div",{role:A||"presentation",className:w,tabIndex:N?0:-1,onClick:N,onKeyPress:function(e){e.preventDefault(),Ae(e,function(){return null==N?void 0:N()})},"aria-label":Ue()},!o&&m&&g&&i.createElement(Se.a,{alt:We(),src:g,className:T,onClick:F,onError:function(e){return D(e)}}),i.createElement("div",{className:I},r&&i.createElement("div",{className:C},r,d&&i.createElement(xe.a,{iconProps:L,onClick:function(e){return function(e){e.stopPropagation(),S()}(e)},onKeyPress:function(e){e.stopPropagation(),Ae(e,S)},styles:Qe(v),title:_e(),ariaLabel:_e()})),o&&m&&g&&i.createElement(Se.a,{alt:We(),role:"presentation",src:g,className:T,onClick:F,onError:function(e){return D(e)}}),i.createElement("div",{className:k},t),a&&i.createElement("div",{className:E},a)))))},tt=n(149),nt=n(511),rt=(n(343),{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"}),at=[rt,{whiteSpace:"nowrap"}];Object(qe.s)({from:{opacity:0},to:{opacity:1}});var it=13,ot=17,ct=function(e){return["ms-search-text",e.fonts.small,{fontSize:it+"px",lineHeight:ot+"px"}]},lt=function(e){return["ms-search-text-s",e.fonts.tiny,{fontSize:"11px",lineHeight:"13px",color:e.palette.neutralPrimary}]},st=Object(Ce.a)(function(e){return Object(qe.t)({icon:{fontSize:11,verticalAlign:"middle",cursor:"pointer",color:e.palette.neutralPrimary},link:{marginLeft:"4px"}})}),ut="https://support.microsoft.com/en-us/office/find-acronym-definitions-89062352-e1ce-4f59-b58c-f94869521404",dt=function(e){var t=je(),n=st(t),r=e.onPrivacyIconClick,a=e.openLink,o=function(e){null==e||e.preventDefault(),a?a(ut):window.open(ut,"_blank"),null==r||r()};return i.createElement("a",{href:ut,className:n.link,target:"_blank",tabIndex:0,onClick:function(e){return null==o?void 0:o(e)},onKeyPress:function(e){return Ae(e,o)},"aria-label":Object(tt.l)()},i.createElement(nt.a,{iconName:"Info",className:n.icon}))},mt=n(499),pt=((Object(De.declareString)("search-components-carousel.search.carousel.scrollLeft")),(Object(De.declareString)("search-components-carousel.search.carousel.scrollRight")),(Object(De.declareString)("search-components-carousel.search.carousel.nextPage"))),ht=(Object(De.declareString)("search-components-carousel.search.carousel.previousPage")),ft=(Object(De.declareStringWithPlaceholders)("search-components-carousel.search.carousel.pageNumber")),gt=(Object(De.declareStringWithPlaceholders)("search-components-carousel.search.carousel.pageNumberSelected")),bt=(Object(qe.s)({"0%":{opacity:.6},"50%":{opacity:1},"100%":{opacity:.6}}),Object(qe.s)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),function(e,t){return{visibility:"visible",opacity:1,transition:"opacity "+e+"ms",transitionTimingFunction:t}}),vt=function(e,t){return{visibility:"hidden",opacity:0,transition:"visibility 0s linear "+e+"ms, opacity "+e+"ms",transitionTimingFunction:t}},yt=Object(Ce.a)(function(e,t,n,r,a){var i=e.palette.neutralSecondary;return Object(qe.t)({nextIconContainer:{width:"30px",fontSize:"14px",height:"24px",marginTop:"8px",float:"left",display:"flex"},carouselContainer:{position:"relative"},nextIcon:{display:n?"none":void 0,alignSelf:"center",color:i,marginLeft:"-4px",selectors:{":hover":{color:i}}},previousIconContainer:{width:"30px",fontSize:"14px",height:"24px",marginTop:"8px",float:"left",display:"flex"},previousIcon:{display:t?"none":void 0,alignSelf:"center",color:i,marginLeft:"4px",selectors:{":hover":{color:i}}},pageBar:{width:"calc(100% - 62px)",height:"24px",float:"left",display:"flex",justifyContent:"center",marginTop:"8px",alignItems:"center"},footer:{height:"40px"},body:[bt(r,a),{width:"100%"}],hidden:[vt(r,a),{position:"absolute",top:"0",width:"100%"}]})}),Ot=Object(Ce.a)(function(e,t){var n=e.palette.neutralSecondary;return Object(qe.t)({dot:{height:"7px",width:"7px",marginRight:"8px",border:"1px solid "+n,background:t?n:"",opacity:t?"100%":"40%",borderRadius:"50%",display:"inline-block",selectors:{":hover":{opacity:t?"100%":"65%",cursor:t?"auto":"pointer"}}}})}),jt=function(e){var t=e.pages,n=e.onNextButtonClick,r=e.onPreviousButtonClick,a=e.onDotButtonClick,o=je(),c=i.useState(0),l=c[0],s=c[1],u=t.length,d=yt(o,0===l,l===u-1,500,"cubic-bezier(0.3,0.55,0.1,1.0)"),m=d.nextIconContainer,p=d.previousIconContainer,h=d.pageBar,f=d.footer,g=d.body,b=d.hidden,v=d.nextIcon,y=d.previousIcon,O=d.carouselContainer,j=i.useRef(null);function S(e){var t;s(e),a&&a(e),null===(t=j.current)||void 0===t||t.focus()}return i.createElement("div",{className:O,tabIndex:-1,ref:j},t.map(function(e,t){return t===l?i.createElement("div",{key:"page"+t,className:g,tabIndex:-1},e):i.createElement("div",{key:"page"+t,className:b},e)}),i.createElement("div",{className:f},i.createElement("div",{className:p},i.createElement(xe.a,{iconProps:{iconName:"ChevronLeftMed"},title:ht(),"aria-label":ht(),onClick:function(){var e;s(l-1),r&&r(l-1),null===(e=j.current)||void 0===e||e.focus()},className:y})),i.createElement("div",{className:h},Object(mt.a)(t.length,function(e){var t=Ot(o,e===l).dot,n=e===l?-1:0,r=e!==l?ft({index:(e+1).toString()}):void 0,a=e!==l?ft({index:(e+1).toString()}):gt({index:(e+1).toString()});return i.createElement("span",{className:t,key:"dot"+e,onClick:function(){return S(e)},tabIndex:n,onKeyPress:function(){return S(e)},title:r,"aria-label":a,role:"button"})})),i.createElement("div",{className:m},i.createElement(xe.a,{iconProps:{iconName:"ChevronRightMed"},title:pt(),"aria-label":pt(),onClick:function(){var e;s(l+1),n&&n(l+1),null===(e=j.current)||void 0===e||e.focus()},className:v}))))},St=Object(Ce.a)(function(e){var t=e.palette.neutralLight;return Object(qe.t)({pageContainer:{minHeight:"182px",borderBottom:"1px solid",borderColor:t}})}),xt=function(){return(xt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ct=function(e){var t,n=e.numberOfResults,r=e.acronymViews,a=e.setactivePage,o=e.onAcronymCarouselClick,c=[],l=je(),s=St(l).pageContainer;for(t=0;t<n/3;t++){var u=r.slice(3*t,Math.min(3*(t+1),n)),d=i.createElement("div",{className:s},u);c.push(d)}var m={pages:c,onNextButtonClick:function(e){a(e),o&&o("Acronym_Carousel_Next_Click",(e+1).toString())},onPreviousButtonClick:function(e){a(e),o&&o("Acronym_Carousel_Previous_Click",(e+1).toString())},onDotButtonClick:function(e){a(e),o&&o("Acronym_Carousel_Page_Click",(e+1).toString())}};return i.createElement(jt,xt({},m))},kt=n(493),Et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wt=function(){return(wt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var Tt=n(497),It={black:{red:0,green:0,blue:0,alpha:1},transparent:{red:0,green:0,blue:0,alpha:0},white:{red:255,green:255,blue:255,alpha:1}};function Pt(e,t,n){if(!t||!(t<0||t>1)){var r=function(e,t){if(void 0===t&&(t=!1),(e=e.toLowerCase())in It)return It[e];var n=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/);if(n)return t?{alpha:parseInt(n[1],16)/255,red:parseInt(n[2],16),green:parseInt(n[3],16),blue:parseInt(n[4],16)}:{red:parseInt(n[1],16),green:parseInt(n[2],16),blue:parseInt(n[3],16),alpha:parseInt(n[4],16)/255};var r=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/);if(r)return{red:parseInt(r[1],16),green:parseInt(r[2],16),blue:parseInt(r[3],16),alpha:1};var a=e.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])$/);if(a)return t?{alpha:parseInt(""+a[1],16)/15,red:parseInt(""+a[2]+a[2],16),green:parseInt(""+a[3]+a[3],16),blue:parseInt(""+a[4]+a[4],16)}:{red:parseInt(""+a[1]+a[1],16),green:parseInt(""+a[2]+a[2],16),blue:parseInt(""+a[3]+a[3],16),alpha:parseInt(""+a[4],16)/15};var i=e.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])$/);if(i)return{red:parseInt(""+i[1]+i[1],16),green:parseInt(""+i[2]+i[2],16),blue:parseInt(""+i[3]+i[3],16),alpha:1};var o=e.replace(/\s/g,"").match(/^rgb\(([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/);if(o)return{red:Number(o[1]),green:Number(o[2]),blue:Number(o[3]),alpha:1};var c=e.replace(/\s/g,"").match(/^rgba\(([0-9\.]+),([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/);return c?{red:Number(c[1]),green:Number(c[2]),blue:Number(c[3]),alpha:Number(c[4])}:{red:0,green:0,blue:0,alpha:1}}(e),a=r.red,i=r.green,o=r.blue,c=r.alpha,l=null!=t?t:c,s=a+","+i+","+o+(1!==l?","+l:"");return n?s:1!==l?"rgba("+s+")":"rgb("+s+")"}}var Nt,At,Ft=Object(Je.b)(function(e,t){return Object(qe.t)({h1:{fontSize:"2em",margin:".67em 0"},h2:{fontSize:"1.5em",margin:".83em 0"},h3:{fontSize:"1.17em",margin:"1em 0"},h4:{margin:"1.33em 0"},code:{background:Pt(e.palette.white,.05),borderRadius:"2px"},blockquote:{padding:"0 1rem",marginLeft:"0",color:"#819198",borderLeft:".3rem solid #dce6f0"},ol:{paddingLeft:"40px",selectors:{"> li":{listStyleType:"decimal"},".ms-search-text &":{paddingLeft:"40px"}}},ul:{paddingLeft:"40px",selectors:{"> li":{listStyleType:"disc"},".ms-search-text &":{paddingLeft:"40px"}}},td:{border:"1px solid",padding:"8px"},th:{border:"1px solid",padding:"8px",fontWeight:"bold"},p:{selectors:{"+ &":{marginTop:t?"0px":"1em"}}}})}),Dt=(Nt=function(e){return function(e){var t=e.theme,n=e.item,r=e.isCompactView,a=e.onLinkClick,o=Ft(t,r);switch(Object(Tt.a)(n.type)){case"a":return i.createElement(c,{href:n.href,title:n.title,onClick:a},Lt(e));case"blockquote":return i.createElement("blockquote",{className:o.blockquote},Lt(e));case"br":return i.createElement("br",null);case"code":return i.createElement("code",{className:Ge(o.code,n.class)},Lt(e));case"div":return i.createElement("div",null,Lt(e));case"em":return i.createElement("em",null,Lt(e));case"h1":return i.createElement("h1",{className:o.h1},Lt(e));case"h2":return i.createElement("h2",{className:o.h2},Lt(e));case"h3":return i.createElement("h3",{className:o.h3},Lt(e));case"h4":return i.createElement("h4",{className:o.h4},Lt(e));case"hr":return i.createElement("hr",null,Lt(e));case"img":return i.createElement("img",{src:n.src,title:n.title,alt:n.alt},Lt(e));case"li":return i.createElement("li",null,Lt(e));case"ol":return i.createElement("ol",{className:o.ol},Lt(e));case"p":return i.createElement("p",{className:o.p},Lt(e));case"pre":return i.createElement("pre",null,Lt(e));case"strong":return i.createElement("strong",null,Lt(e));case"text":return i.createElement(i.Fragment,null,n.text);case"span":return i.createElement("span",null,Lt(e));case"ul":return i.createElement("ul",{className:o.ul},Lt(e));case"table":return i.createElement("table",null,Lt(e));case"thead":return i.createElement("thead",null,Lt(e));case"tbody":return i.createElement("tbody",null,Lt(e));case"tr":return i.createElement("tr",null,Lt(e));case"th":return i.createElement("th",{style:Rt(n),className:o.th},Lt(e));case"td":return i.createElement("td",{style:Rt(n),className:o.td},Lt(e));default:return null}}(e)},At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Et(t,e),t.prototype.render=function(){return i.createElement(Nt,wt({},this.props))},t}(i.Component),Object(kt.a)("WithTheme",["theme"])(At));function Lt(e){var t=e.item,n=e.isCompactView,r=e.onLinkClick;if(!t.children)return null;if(1===Object(V.a)(t.children)&&"text"===Object(Tt.a)(t.children[0].type)){for(var a=t.children[0].text,o=a&&Object(ke.a)(a,"\n")||[],c=[],l=0,s=0;s<o.length;s++){var u={type:"text",text:o[s]};c.push(i.createElement(Dt,{item:u,key:l,isCompactView:n})),l++,s<o.length-1&&(c.push(i.createElement("br",{key:l})),l++)}return c}return Object(K.a)(t.children,function(e,t){return i.createElement(Dt,{item:e,key:t,isCompactView:n,onLinkClick:r})})}function Rt(e){if(e&&e.style)try{var t={},n=Object(R.a)(Object(ke.a)(e.style,";"),function(e){return!!e});return Object(Ee.a)(n,function(e){var n=Object(K.a)(Object(R.a)(Object(ke.a)(e,":"),function(e){return!!e}),function(e){return e.trim()});if(2===Object(V.a)(n)){var r=n[0],a=n[1];switch(r){case"text-align":t.textAlign=a}}}),t}catch(t){return void console.warn("Invalid style format in markdown: "+e.style)}}var Ht=n(507),Wt=n(396),Mt=n(325),Bt=/([\r\n]+|,|_|\.|-|\/|\\|\))/g,zt=/(\()/g,_t=/([^A-Z])([A-Z]\w)/g;function Ut(e,t,n,r,a,i,o){if(void 0===o&&(o=!1),Object(Mt.d)(e)||!i)return{originalText:e,numLines:0,text:e};i.font=Qt(t);var c=r,l=n,s=e,u=function(e,t){void 0===t&&(t=!1);var n=Object(Mt.b)(e),r=!n&&(a=e,a.indexOf(" ")<0&&!(a.match(Bt)||a.match(zt)||a.match(_t)));var a;return{textUnits:n||r||t?e.split(""):(i=e,i.replace(Bt,"$1​").replace(zt,"​$1").replace(_t,"$1​$2")).match(/([\u200B]?[ ]?[\u200B]?[^\u200B ]+)/g)||[],isCJKLanguage:n,isSingleWord:r};var i}(s,o),d=u.textUnits,m=u.isCJKLanguage,p=u.isSingleWord;!m&&p&&(c=1,r=1);for(var h=o?s:d,f=0,g=h[f],b=g;f<h.length&&c>0;)if(i.measureText(Kt(g,f,h.length,c,a)).width>=l){if(0===--c&&!o){for(var v=g.length,y=g.length/2;y>=1;)i.measureText(a.replace("{0}",g.slice(0,-v+y))).width<l&&(v-=y),y/=2;var O=h[f].slice(0,-v);O.length>2&&(b+=O)}g=h[f].trim()}else f>0&&(b+=h[f]),g+=h[++f];return{originalText:e,numLines:0===c?r:r-c+1,text:b=Kt(b,f,h.length,c,a)}}function qt(){return window&&window.document?window.document.createElement("canvas").getContext("2d"):null}function Kt(e,t,n,r,a){return t===n||r>1?e:a.replace("{0}",e)}function Vt(e,t,n,r){if(Object(Mt.d)(n.fontFamily)||Object(Mt.d)(n.fontSize.toString()))throw new RangeError("Font parameters not provided ");return function(e,t,n,r,a){if(Object(Mt.d)(e)||!a||t<=0)return{originalText:e,text:""};a.font=Qt(n);var i=e;if(a.measureText(e).width>t){var o=a.measureText(r).width,c=t-o,l=Ut(e,n,c/2,1,"{0}",a,!0),s=Ut(e.split("").reverse().join(""),n,c/2,1,"{0}",a,!0);s.text=e.slice(-s.text.length),i=""+l.text+r+s.text}return{originalText:e,text:i}}(e,t,n,r,qt())}function Qt(e){return(e.fontStyle||"")+" "+(e.fontVariant||"")+" "+(e.fontWeight||"")+" "+e.fontSize+"px "+e.fontFamily}var Yt=Object(Je.b)(function(){return Object(qe.t)({container:["ms-search-splitter",{display:"inline-block",verticalAlign:"middle"}]})}),Gt=function(e){var t=Yt(),n=e.className,r=e.isLarge;return i.createElement("div",{className:Ge(t.container,n),"aria-hidden":!0},r?i.createElement(i.Fragment,null,"•"):i.createElement(i.Fragment,null,"·"))},$t="Arial, Helvetica, sans-serif",Jt="'SF UI Text', HelveticaNeue, Roboto, Arial, sans-serif";var Zt=function(e){return{color:e.palette.themePrimary,textDecoration:"none",cursor:"pointer",selectors:{":hover":{textDecoration:"underline"}}}},Xt=function(e){return[ct(e),Zt(e),{selectors:{span:{verticalAlign:"middle"}}}]},en=function(){return(en=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},tn=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},nn=Jt,rn=12,an=$t,on=11,cn=function(e){var t=[lt(e),{display:"block",maxWidth:"50%",whiteSpace:"nowrap",selectors:{a:Zt(e)}}];return{attribution:tn(["ms-search-attribution",at],t),attributionFileType:["ms-search-attribution",t],attributionSource:[Zt(e)],scopeAttributionWrapper:{selectors:{" > span":{maxWidth:"50%"}}},dotSplitter:{marginLeft:"4px",marginRight:"4px"}}},ln=Object(Je.b)(function(e,t){return Object(qe.t)(t?function(e){var t=["ms-search-attribution",{display:"block",color:e.palette.neutralPrimary,fontFamily:nn,fontSize:rn+"px",lineHeight:"16px",whiteSpace:"nowrap",selectors:{a:Zt(e)}}];return en(en({},cn(e)),{attribution:[at,t],attributionFileType:["ms-search-attribution",t],scopeAttributionWrapper:{selectors:{" > span":{marginBottom:0}}}})}(e):cn(e))}),sn=function(e){var t=e.id,n=e.source,r=e.sourceType,a=e.sourceId,o=e.url,c=e.tenantName,l=e.onLinkClick,u=e.isSmall,d=e.disableClickThrough,m=e.className,p=e.fromSourceElement,h=e.openLink,f=be("AcronymAttribution"),g=f[0],b=f[1],v=je(),y=ln(v,u),O=y.attribution,j=y.attributionFileType,S=y.attributionSource,x=y.scopeAttributionWrapper,C=y.dotSplitter,k=function(e,t,n){if(!e)return;return"Email"===e&&n?function(e){return"https://outlook.office365.com/mail/deeplink/read/"+encodeURIComponent(e)}(Fe(n)):t}(r,o,a),E=Object(L.a)(n),w=Ge(m,x);switch(r){case"Editorial":case"Annotation":return c?un(O,i.createElement(i.Fragment,null,c,k&&i.createElement(i.Fragment,null,i.createElement(Gt,{className:C,isLarge:!0}),dn(k,t,Object(tt.n)(),S,l,d))),c,tt.k,p):null;case"Email":return k?un(O,dn(k,t,T=E?Object(tt.g)():Object(tt.h)({subject:n}),S,l,d,h),T,tt.i,void 0,w):null;case"FileItem":case"File":if(!k)return null;var T,I=function(e){return e?{fontFamily:nn,fontSize:rn}:{fontFamily:an,fontSize:on}}(u),P=function(e,t){var n=qt();return n?(n.font=Qt(t),n.measureText(e).width):0}(Object(tt.j)({source:""}),I),N=Vt(n,b.offsetWidth-P,I,He());return un(E?O:j,dn(k,t,T=E?k:N.text,S,l,d,h),T,tt.j,void 0,w,g,n);default:return Object(s.a)(r)}};function un(e,t,n,r,a,o,c,l){var s=r({source:"|"}),u=Object(ke.a)(s,"|");return i.createElement("span",{className:o},i.createElement("span",{className:e,ref:c,title:l||n},a||i.createElement(i.Fragment,null,u[0],t,u[1])))}function dn(e,t,n,r,a,o,l){return o?i.createElement("span",{className:r},n):i.createElement(c,{onClick:function(n){n.stopPropagation(),l?l(e):window.open(e,"_blank"),mn(t,a)},onKeyPress:function(n){n.stopPropagation(),l?l(e):window.open(e,"_blank"),mn(t,a)}},n)}function mn(e,t){t&&t(e)}var pn=Object(Ce.a)(function(e,t,n,r,a,i){var o,c=e.palette,l=c.neutralPrimary,s=c.neutralDark,u=c.neutralSecondary,d=c.neutralLight,m=c.neutralLighterAlt,p=c.themeLighterAlt;return Object(qe.t)({singleAcronymContainer:{cursor:i&&!a?"pointer":"auto",borderBottom:n?"none":"1px solid",borderColor:d,padding:"8px 0 12px 0",display:r?"block":"flex",backgroundColor:t&&!a?p:void 0,selectors:!i||a||t?{}:{":hover":{backgroundColor:m}}},singleAcronym:{margin:"0 12px 0 12px",width:"calc(100% - 24px)"},detailsContainer:{display:r?"block":"flex",width:r?"100%":"calc(100% - 376px)",float:r?"none":"left",flexDirection:t&&!r?"column":void 0},expansionContainer:[!t&&at,{fontWeight:"600",fontSize:14,lineHeight:"20px",color:l,height:"20px",width:r?"100%":"288px",float:r?"none":"left",marginRight:r?"0":"24px"}],expansionText:[at,"ms-search-acronymTile-expansionText"],expandContainer:{height:"20px",maxWidth:r||!i||t?"100%":"50%"},iconContainer:{width:"10px",height:r?"10px":"20px",float:"left",transform:t?"rotate(90deg)":void 0,transitionDuration:"200ms",fontSize:"9px",marginRight:"8px",marginTop:r?"5px":"0",display:a?"none":void 0},sourceContainer:[at,{fontSize:"14px",lineHeight:"20px"},{color:s,height:"100%",width:r&&i?"calc(100% - 20px)":"100%",float:"left",alignItems:"center",selectors:(o={"& .ms-search-text-s":[{fontSize:"14px",lineHeight:"20px"},{maxWidth:"100%"}]},o["& .ms-search-attribution"]=[at,{marginTop:r?"2px":"0",selectors:{a:{color:s}}}],o)}],descriptionContainer:[!t&&at,{fontSize:"14px",lineHeight:"20px"},{color:u,display:!r||t?"block":"none",marginLeft:r||t?"0":"17px",height:t?"auto":"20px"}]})}),hn=function(e){var t=e.acronym,n=e.isSmall,r=e.isLast,a=e.isSingleAcronym,o=e.activePage,c=e.tenantName,l=e.index,s=e.openLink,u=e.onAcronymEntityClick,d=e.onAcronymAttributionClick,m=t.expansion,p=t.source,h=t.descriptionPlainText,f=t.sourceType,g=t.id,b=t.url,v=t.sourceId,y=t.sourceShardType,O=i.useState(a),j=O[0],S=O[1],x=i.useState(!1),C=x[0],k=x[1],E=function(e,t){return t&&function(e){switch(e){case"User":case"PublicModernGroup":case"EditorialImport":case"Unknown":return!0;default:return!1}}(t)?"Source: "+e+"  Shard: "+t:e}(f,y);i.useEffect(function(){!a&&S(!1)},[o]);var w=je(),T=!!h&&("Editorial"===f||"Annotation"===f),I=h;h&&h.length>450&&(I=h.slice(0,450)+"...");var P=pn(w,j,r,n,a,T),N=P.expansionContainer,A=P.descriptionContainer,F=P.singleAcronymContainer,D=P.sourceContainer,L=P.expandContainer,R=P.iconContainer,H=P.detailsContainer,W=P.singleAcronym,M=P.expansionText,B=i.useRef(null);function z(){var e;if(!a&&T){var t=!j;S(t),null===(e=B.current)||void 0===e||e.focus(),u&&u(g,t)}}var _=("Editorial"===f||"Annotation"===f)&&c||("File"===f||"Email"===f)&&(p||b);return i.createElement("div",{className:F,onClick:z,tabIndex:0,ref:B,onKeyPress:z,role:T?"button":"presentation","aria-label":"Editorial"===f||"Annotation"===f?j&&h?Object(tt.a)({description:h}):c?Object(tt.b)({expansion:m,tenantName:c}):"":""},i.createElement("div",{className:W},i.createElement("div",{className:N},T&&!n&&i.createElement("div",{className:R},i.createElement(nt.a,{iconName:"ChevronRightMed"})),i.createElement("div",{title:C?m:void 0,onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;k(n!==r)}(e)},role:"presentation",className:M},m)),i.createElement("div",{className:H},_&&f&&i.createElement("div",{className:L},T&&n&&i.createElement("div",{className:R},i.createElement(nt.a,{iconName:"ChevronRightMed"})),i.createElement("div",{className:D},i.createElement(sn,{id:g,source:p,url:b,sourceType:f,sourceId:v,tenantName:c,isSmall:n,onLinkClick:function(e){d&&d(e,l,E,f)},openLink:s}))),T&&i.createElement("div",{title:h,className:A},I))))};hn.displayName="AcronymEntity";var fn={background:"none",padding:0,border:0},gn=function(e,t,n){return{fontSize:e,width:t||e,height:n||e}},bn=(gn("6px"),gn("8px"),gn("12px")),vn=(gn("14px"),gn("16px"),gn("20px"),gn("24px"),gn("25px"),gn("28px")),yn=(gn("32px"),gn("40px"),Object(Ce.a)(function(e){var t=e.palette,n=t.neutralLight,r=t.neutralDark;return Object(qe.t)({pageContainer:{borderBottom:"1px solid",borderColor:n},expandLinkContainer:{height:"36px",display:"flex",margin:"0 12px 4px 12px",alignItems:"center"},expandLink:{cursor:"pointer"},button:[Xt(e),fn,{color:r}],icon:[bn,{lineHeight:"100%",verticalAlign:"middle",margin:"3px 0 0 8px",color:r}]})})),On=function(e){var t=e.isCardExpanded,n=e.acronymViews,r=e.maxResultsOnCollapsed,a=e.onExpandLinkClick,o=t?n:n.slice(0,r),c=je(),l=yn(c),s=l.pageContainer,u=l.expandLinkContainer,d=l.button,m=l.icon,p=l.expandLink,h=t?Re():Le(),f=t?"ChevronUpMed":"ChevronDownMed";return i.createElement(i.Fragment,null,i.createElement("div",{className:s},o),i.createElement("div",{className:u},i.createElement("div",{className:p,onClick:a,onKeyPress:a,tabIndex:0,role:"button"},i.createElement("button",{className:d},i.createElement("span",null,h)),i.createElement(nt.a,{iconName:f,className:m}))))},jn=n(237);var Sn=Object(Ce.a)(function(e){var t,n=e.palette.neutralSecondary;return Object(qe.t)({header:["ms-search-acronymTile-header",{color:n,fontWeight:"600",margin:"0 12px",fontSize:14}],tileBodyOverride:["ms-search-tile-body"],tileHeaderOverride:["ms-search-tile-header"],tile:{selectors:(t={},t["& .ms-search-tile-header"]={margin:"0"},t["& .ms-search-tile-body"]={margin:"0",padding:"1px 0 0 0"},t["& .ms-search-heroTile-dismissButton"]={marginRight:"12px"},t)}})}),xn=function(){return(xn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Cn=function(e){var t,n=e.acronyms,r=e.tenantName,a=e.clientSize,o=e.isExpanded,c=e.onAcronymListExpandClick,l=e.onAcronymCarouselClick,s=e.onAcronymEntityClick,u=e.getClientSizeCallback,d=e.onAcronymAttributionClick,m=e.setAnswerHeight,p=e.openLink,h=e.className,f=e.isDismissible,g=e.onDismiss,b=e.onPrivacyIconClick,v=ve("HeroAcronymTile",752,a,u),y=v[0],O=v[1],j=null===(t=y.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){j&&m&&m(j)},[j]);var S=je(),x=i.useState(0),C=x[0],k=x[1],E=i.useState(!!o),w=E[0],T=E[1],I=function(e,t){return Object(jn.a)(e,t)}(n,9),P="Small"===O,N=Object(U.a)(I).abbreviation,A=I.length,F=Sn(S),D=F.header,L=F.tileBodyOverride,R=F.tileHeaderOverride,H=F.tile;function W(){var e=!w;T(e),c&&c(e)}var M=1===A,B=I.map(function(e,t){var n=function(e,t,n,r,a){return e||!t?n===r-1||n%a==a-1:n===r-1}(P,w,t,A,3),a={acronym:e,isSmall:P,tenantName:r,isLast:n,isSingleAcronym:M,activePage:C,index:t,openLink:p,onAcronymEntityClick:s,onAcronymAttributionClick:d};return i.createElement(hn,xn({key:"acronym"+t},a))}),z={header:i.createElement("div",{className:D},Object(tt.c)({abbreviation:N}),i.createElement(dt,{onPrivacyIconClick:b,openLink:p})),body:function(){if(P){if(A>3){var e={numberOfResults:A,acronymViews:B,setactivePage:k,onAcronymCarouselClick:l};return i.createElement(Ct,xn({},e))}return i.createElement("div",null,B)}if(A<=3)return i.createElement("div",null,B);var t={isCardExpanded:w,acronymViews:B,maxResultsOnCollapsed:3,onExpandLinkClick:W};return i.createElement(On,xn({},t))}(),styleOverrides:function(){return{bodyStyles:L,headerStyles:R,cardStyles:H}},className:h,isDismissible:f,onDismiss:g};return i.createElement("div",{ref:y},i.createElement(et,xn({},z)))};Cn.displayName="HeroAcronymTile";var kn=n(407),En=n(257),wn=n(47);const Tn=["Hero_File_Impression","PowerBiApp_Impression"];function In(e){return Object(F.a)(Tn,t=>t===e)}var Pn=n(285),Nn=n(478),An=n(303),Fn=n(282);function Dn(){var e=Object(u.useSelector)(f.j);return Object(u.useSelector)(j.w)?"Ribbon"===e:"RichRibbon"===e}var Ln=n(278);function Rn(e){var t=e.domain,n=e.isHero,r=e.isAsyncDomainImpressionFromMainRequest,a=e.intent,i=e.intentId,o=e.traceId,c=e.useAnswerOnly,l=e.pageNum;return Object(u.useSelector)(function(e){if(o)return o;if(n&&(r||!a))return Object(f.k)(e);switch(t){case"Conversation":case"Message":case"Person":var u=t&&Object(Ln.b)(t);return u&&Object(b.g)(e,u,{intent:a,intentId:i,useAnswerOnly:c,pageNum:l});case"Site":return Object(g.b)(e);case"File":return Object(m.c)(e)||Object(f.k)(e);case"PowerBi":return Object(h.b)(e);case"Connectors":return Object(d.a)(e,i);case"EducationAssignment":case"EducationClass":case"Calendar":case"CalendarAvailability":case"Group":case"Bookmark":case"Qna":case"Building":case"Acronym":case"FileEntity":case"Flight":case"FileAndSite":case"Notification":case"Turing":case"TuringQnA":case"PeopleAlsoAsk":case"Topic":case"Link":case"MeetingRoomProposal":case"External":case"EmployeeOffer":case"All":case"SharePoint":case"EducationAssignment":case"QueryReformulation":case"EnterpriseLearning":case void 0:return Object(f.k)(e);case"FloorPlan":return;default:return Object(s.a)(t)}})}var Hn=function(){return(Hn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function Wn(e){var t,n=e.domain,r=e.entity,a=e.impressionEventId,o=e.clickEventId,c=e.cardType,s=e.isHero,d=e.pageNumber,m=e.calendarIntent,p=e.eventScope,h=e.hasSubGroup,f=e.isFromMainSearch,g=e.virtualDomain,b=e.traceId,y=e.queryIntent,O=e.expandClickEventId,j=e.layoutProps,S=Object(E.a)(),x=Object(l.b)(),C=Object(Fn.b)(),k=S.getStaticProperties()().logicalSearchId,w=Object(l.f)(),T=v(),I=Rn({traceId:b,domain:g||n,isHero:!!s,isAsyncDomainImpressionFromMainRequest:f&&Object(A.d)(n)||In(a)}),P=Dn(),N=Object(u.useSelector)(te.b),F=!P&&!N,D=i.useState(!1),L=D[0],R=D[1],H=i.useState(void 0),W=H[0],M=H[1],B=i.useState(void 0),z=B[0],_=B[1],q=i.useState(!1),K=q[0],V=q[1],$=i.useState(!1),J=$[0],Z=$[1],X=null===(t=Object(l.g)())||void 0===t?void 0:t.logicalSearchId,ne=Object(u.useSelector)(ee.c);ne=ne||"Pole";var re={cardType:c,clientSize:x,eventScope:p||Object(G.b)(n),isHero:s,pageNumber:d,placement:ne,traceId:I},ae=function(e){var t,n;return JSON.stringify(((t={}).topicId=e.id,t.topicStatus=e.state,t.hasTopicDescription=!(null===(n=e.definitionProperties)||void 0===n||!n.text),t.topicLifeCycleState=e.lifeCycleState,t.topicSource=e.source,t.topicType=e.topicType,t.topicRelevanceScore=Math.round(100*e.relevanceScore)/100,t))};i.useEffect(function(){w&&K&&!J&&(Z(!0),Object(Y.e)({logger:S,domain:g||n,impressionEventId:a,traceId:I,startTime:w,endTime:new Date,pageNumber:d,componentStartTime:W,componentEndTime:Object(G.a)(),dontSendResultsRendered:!(I!==T||X&&X!==k)}))}),i.useEffect(function(){var e=Object(G.a)();M(e),_(new Date),Z(!1),Object(Y.g)(a,e),R(!1),V(!1)},[d,I]),i.useEffect(function(){if(r&&!L){if(R(!0),Object(me.a)({logger:S,entity:r,traceId:I,pageLoadStartTime:z,domain:g||n,hasSubGroup:h,entityAttributes:"Topic"===(n||r.domain)?ae(r):void 0,isHero:s,eventId:a,overridePlaceholderId:C,layoutProps:j}),a)switch(n){case"Calendar":m&&function(e,t,n,r,a,i,o,c){var l={cardType:r,clientSize:a,eventScope:"Calendar",target:t,isHero:i,placement:o,initialHeroImpression:c};Object(Q.p)(e,{properties:l,eventId:n})}(S,m,a,c,x,s,ne,F);break;case"Bookmark":!function(e,t,n,r,a,i,o,c){if(t){var l={cardType:r,clientSize:a,eventScope:"Bookmark",target:Object(Q.c)(t),entityId:Object(Q.b)(t),index:"1",queryType:t.queryType,isHero:i,value:t.entityType||"",content:t.isSystemOwned?"SystemOwned":void 0,placement:o,initialHeroImpression:c};Object(Q.p)(e,{properties:l,eventId:n})}}(S,r,a,c,x,s,ne,F);break;case"Flight":!function(e,t,n,r,a,i,o){if(t&&Object(U.a)(t.flights)){var c={cardType:r,clientSize:a,eventScope:"Flight",isHero:i,initialHeroImpression:o};Object(Q.p)(e,{properties:c,eventId:n})}}(S,r,a,c,x,s,F);break;default:!function(e,t,n,r,a,i,o,c,l,s,u,d,m){if(t){var p={cardType:a,clientSize:i,eventScope:r,target:Object(Q.c)(t),isHero:o,pageNumber:c,queryType:s,index:l,initialHeroImpression:u,placement:d,value:m};Object(Q.p)(e,{properties:p,eventId:n})}}(S,r,a,p||Object(G.b)(n),c,x,s,d,void 0,"Qna"===n?r.queryType:"Person"===n&&y?y:void 0,F,ne,"Hero_Adaptive_Async_Answer_Impression"===a?r.contentSource:void 0)}V(!0)}},[S,r,I,w,n,a,p,c,x,s,d,m,F,ne,C,j]);var ie=function(e,t){var a;if(o&&r){var i=(t||{}).interpretation;Object(En.e)(S,e||o,r,Hn(Hn(Hn({},re),t),{entityAttributes:"Topic"===(n||r.domain)?i||JSON.stringify((a={},a.topicId=r.id,a)):void 0,interpretation:i||r.interpretation,queryType:r.queryType}),0)}};return{entityActions:{onEntityClick:ie,onActionClick:function(e,t){ie(e,t)}},nonEntityActions:{onExpandClick:function(e,t){O&&ie(O,Hn(Hn({},t),{isExpanded:e}))},onSearchActionClick:function(e,t){return Object(En.d)(S,e,Hn(Hn({},re),t))}},placeholderId:C}}function Mn(e){var t,n=e.entities,a=e.domain,o=e.isHero,c=e.intent,s=e.calendarIntent,d=e.impressionEventId,m=e.clickEventId,p=e.cardType,h=e.pageNumber,f=e.target,g=e.provenance,b=e.eventScope,y=e.isFromMainSearch,O=e.intentId,j=e.startIndex,S=e.virtualDomain,x=e.traceId,C=e.completedLoading,k=e.expandClickEventId,w=e.groupReferenceId,T=e.contentSources,I=e.queryTypes,P=e.isSuppressed,N=e.layoutProps,F=e.placement,D=e.verticalId,L=e.externalSourceType,R=Object(E.a)(),H=R.getStaticProperties()().logicalSearchId,W=Object(l.f)(),M=v(),B=Object(l.b)(),z=Rn({traceId:x,domain:S||a,isHero:o,intent:c,intentId:O,isAsyncDomainImpressionFromMainRequest:y&&Object(A.d)(a)||In(d)}),_=i.useState(void 0),U=_[0],K=_[1],V=i.useState(void 0),Q=V[0],$=V[1],Z=i.useState(!1),X=Z[0],ne=Z[1],re=i.useState(!1),ae=re[0],ie=re[1],oe=null===(t=Object(l.g)())||void 0===t?void 0:t.logicalSearchId,ce=i.useState(Object(kn.a)())[0],le=i.useState(!1),se=le[0],ue=le[1],de=Dn(),pe=Object(u.useSelector)(te.b),he=Object(Fn.b)(),fe=!de&&!pe,ge=Object(u.useSelector)(ee.c);ge=F||(ge||"Pole");var be={cardType:p,clientSize:B,eventScope:b||Object(G.b)(a),isHero:o,groupReferenceId:w,pageNumber:h,placement:ge,target:f,traceId:z,verticalId:D,externalSourceType:L};i.useEffect(function(){U&&W&&X&&!ae&&d&&(ie(!0),Object(Y.e)({logger:R,domain:S||a,impressionEventId:d,traceId:z,startTime:W,endTime:new Date,noResultsPage:Object(r.a)(n),pageNumber:h,componentStartTime:U,componentEndTime:Object(G.a)(),dontSendResultsRendered:!(z!==M||oe&&oe!==H)}))}),i.useEffect(function(){if(oe!==H&&!Object(wn.c)()){var e=Object(G.a)();K(e),$(new Date),P||Object(Y.g)(d,e)}ne(!1),ie(!1),ue(!1)},[h,z]),i.useEffect(function(){Object(r.a)(n)&&!C||se||(ue(!0),Object(me.b)({logger:R,entities:n,domain:S||a,isHero:o,traceId:z,pageLoadStartTime:Q,provenance:g,intent:c,layoutKey:ce,eventId:d,groupReferenceId:w,overridePlaceholderId:he,layoutProps:N}),d&&J(R,n,d,b||Object(G.b)(a),p,B,o,h,f||s,fe,ge,Object(q.a)(T),Object(q.a)(I),D,L),ne(!0))},[R,n,a,z,W,g,c,d,b,p,B,o,h,f,fe,ce,ge,N]);var ve=function(e,t,r){var a=Object(Pn.a)(n,function(t){return t.id===e}),i=null==n?void 0:n[a];i&&ye(i,a,t,r)},ye=function(e,t,r,a){if(m){var i=e.queryType||(null==r?void 0:r.queryIntent);n&&Object(Nn.a)(t)&&(t=Object(An.a)(n,e)),t=Object(Nn.a)(t)||-1===t?void 0:t+(j||0),Object(En.e)(R,a||m,e,Hn(Hn(Hn(Hn({},be),{interpretation:e.interpretation}),r),{queryType:i,traceId:e.traceId||z}),t)}},Oe=function(e,t){return Object(En.d)(R,e,Hn(Hn({},be),t))};return{entityActions:{onEntityClickId:ve,onEntityClick:ye,onEntityClickDifferentDomain:function(e,t,n,r,i){m&&ye(e,t,Hn({eventScope:b||(n?Object(G.b)(n):Object(G.b)(a))},r),i)},onActionClickId:function(e,t,n){ve(e,n,t)},onActionClick:function(e,t,n,r){ye(e,n,r,t)}},nonEntityActions:{onExpandClick:function(e,t){k&&Oe(k,Hn(Hn({},t),{isExpanded:e}))},onSearchActionClick:Oe},placeholderId:he}}var Bn=n(43),zn=n(247);function _n(e){var t,n=null===(t=zn.b.getSelectors(e).getLatestSuccess(zn.c))||void 0===t?void 0:t.responses;return null==n||n.sort(function(e,t){return e.id.valueOf()-t.id.valueOf()}),n}function Un(e){var t=_n(e);return t&&t[0].body}function qn(e){var t=Un(e);return null==t?void 0:t.displayName}function Kn(e){var t=Un(e);return null==t?void 0:t.mail}function Vn(e){var t=Un(e);return null==t?void 0:t.userPrincipalName}function Qn(e){var t=function(e){var t=_n(e);return t&&t[1].body}(e);return null==t?void 0:t.value[0].displayName}n(379),n(270);var Yn=100;function Gn(e){return e&&"data:image/jpeg;base64,"+e}function $n(e,t){if(e&&!Object(L.a)(e))for(var n=0;n<e.length;n++){var r=Jn(e[n],t);if(r)return r}}function Jn(e,t){var n=e.text,r=e.children;if(n)return n.substr(0,t||Yn);if(r)for(var a=0;a<r.length;a++){var i=Jn(r[a],t);if(i)return i}}function Zn(){var e,t=Object(u.useSelector)(Bn.f),n=null===(e=er())||void 0===e?void 0:e.userData,r=Object(u.useSelector)(Kn);return tr()?(null==n?void 0:n.mail)||r:t}function Xn(){var e,t=Object(u.useSelector)(Bn.f),n=null===(e=er())||void 0===e?void 0:e.userData,r=Object(u.useSelector)(Vn);return tr()?(null==n?void 0:n.userPrincipalName)||r:t}function er(){var e;return null===(e=Object(l.h)())||void 0===e?void 0:e.userProperties}function tr(){var e;return!!(null===(e=Object(l.h)().additionalAnswerConfigs)||void 0===e?void 0:e.disableMsbApis)}var nr=n(175);function rr(e){return!!e.sourceType&&!!e.expanded}function ar(e,t,n,r,a){var i=Object(K.a)(null==e?void 0:e.filter(rr),function(e){return function(e,t,n,r){var a=e.id,i=e.shortened,o=e.expanded,c=e.snippet,l=e.source,s=e.url,u=e.sourceId,d=e.sourceType,m=e.sourceShardType,p=e.descriptionText,h=c&&c.json,f=t&&r?r(o,"None"):n?"https://www.bing.com/work/?q="+o+"&FORM=BFBACR":void 0;return{id:a,mappingId:Object(Q.c)(e),abbreviation:i,expansion:o,description:h,descriptionPlainText:h?$n(h):p,source:l,url:s,sourceId:u,sourceType:d,sourceShardType:m,requeryUrl:f}}(e,n,r,a)});return e.length&&!i.length&&Object(w.e)(t,"Acronym answer dropped due to missing required fields"),i}var ir=function(){return(ir=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},or=function(e){var t,n,r,a,o=e.className,c=Object(l.b)(),s=Object(E.a)(),d=v(),m=Object(u.useSelector)(nr.c),p=(n=Object(u.useSelector)(Bn.a),r=null===(t=er())||void 0===t?void 0:t.userOrganization,a=Object(u.useSelector)(Qn),tr()?(null==r?void 0:r.displayName)||a:n),h=Object(l.a)(),f=null==h?void 0:h.getCurrentClientSize,g=null==h?void 0:h.setAnswerHeight,b=null==h?void 0:h.openLink,y=null==h?void 0:h.dismissAnswer,O=Object(l.h)().additionalAnswerConfigs,j=null==O?void 0:O.isAnswerDismissible,S=null==O?void 0:O.answerBlockId,x=Mn({entities:m,domain:"Acronym",isHero:!0,cardType:"Hero",impressionEventId:"Hero_Acronym_Impression",clickEventId:"Acronym_Source_Click",expandClickEventId:"Acronym_Expand_Click",isFromMainSearch:!0,groupReferenceId:S,traceId:d});if(i.useEffect(function(){var e;m&&!Object(L.a)(m)&&(null===(e=null==h?void 0:h.setAnswerBlockRendered)||void 0===e||e.call(h,x.placeholderId))},[]),!m||Object(L.a)(m))return Object(w.h)(s,"Unexpected Empty response received for Acronym"),null;var C={clientSize:c,tenantName:p,acronyms:ar(m,s),onAcronymListExpandClick:function(e){x.nonEntityActions.onExpandClick(e,{pageNumber:"1"})},onAcronymCarouselClick:function(e,t){return x.nonEntityActions.onSearchActionClick(e,{pageNumber:t})},onAcronymEntityClick:function(e,t){return x.entityActions.onActionClickId(e,"Acronym_Expand_Description_Click",{isExpanded:t})},getClientSizeCallback:f,onAcronymAttributionClick:function(e,t,n,r){return x.entityActions.onEntityClickId(e,ir(ir({},function(e){if(e)switch(e){case"File":case"FileItem":return{RelatedEntityType:"FileSource"};case"Email":return{RelatedEntityType:"EmailSource"};case"Annotation":case"Editorial":default:return}}(r)),{interpretation:n}))},setAnswerHeight:g,openLink:b,className:o,isDismissible:j,onDismiss:function(){j&&(null==y||y(),x.nonEntityActions.onSearchActionClick("Answer_DismissButton_Click"))},onPrivacyIconClick:function(){return x.nonEntityActions.onSearchActionClick("Acronym_PrivacyIcon_Click")}};return i.createElement(Cn,ir({},C))},cr=n(183),lr=n(227),sr=Object(Ce.a)(function(e){var t=e.palette,n=t.themeLight,r=t.neutralSecondary,a=t.neutralPrimary,i=t.neutralTertiary;return Object(qe.t)({headerContent:["ms-search-bookmarkTile-headerContent",{overflow:"hidden",fontSize:"14px",lineHeight:"20px",verticalAlign:"middle",display:"flex"}],headerIcon:{width:"20px",height:"20px",float:"left",textAlign:"center",borderRadius:"50%",background:n},answerTitle:[{float:"left",marginLeft:"8px",fontWeight:"600",color:r},at],title:["ms-search-bookmarkTile-title",{color:a,fontSize:"17px",fontWeight:"600"},at],description:["ms-search-bookmarkTile-description",{maxWidth:"100%",maxHeight:"40px",margin:"0 auto",fontSize:"14px",lineHeight:"20px",color:r},at],url:[{color:lr.a,fontSize:"12px",height:"20px",lineHeight:"20px"},at],content:{overflow:"hidden",paddingBottom:"8px"},bodyIcon:[vn,{color:i,paddingRight:"12px",paddingTop:"4px",float:"left"}]})}),ur=function(){return(ur=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},dr=function(e){var t,n=e.heroBookmark,r=e.onHeroBookmarkClick,a=e.clientSize,o=e.setAnswerHeight,c=e.className,l=e.isDismissible,s=e.onDismiss,u=je(),d=sr(u),m=d.headerContent,p=d.headerIcon,h=d.answerTitle,f=d.title,g=d.description,b=d.url,v=d.content,y=d.bodyIcon,O=ve("HeroBookmarkTile",752,a),j=O[0],S=O[1],x=null===(t=j.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){x&&o&&o(x)},[x]);var C="Small"===S,k={body:i.createElement(i.Fragment,null,i.createElement(nt.a,{iconName:Te.b,className:y}),i.createElement("div",{className:v},i.createElement("div",{className:f,title:n.title},n.title),i.createElement("div",{className:b,title:n.url},n.url),i.createElement("div",{className:g,title:n.description},n.description))),header:i.createElement("div",{className:m},i.createElement(nt.a,{className:p,iconName:"Link12"}),i.createElement("div",{className:h,title:Object(cr.c)(),role:"heading","aria-level":3},Object(cr.c)())),isSmall:C,cardClickProps:{onCardClick:function(){r&&r(n.url)},clickRole:"link"},className:c,isDismissible:l,onDismiss:s};return i.createElement("div",{ref:j},i.createElement(et,ur({},k)))};dr.displayName="HeroBookmarkTile";var mr=n(232);function pr(e){if(e&&e.audience)return{token:e.token,audience:e.audience}}var hr=function(){return(hr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var fr=Object(u.connect)(function(e){return{heroBookmark:Object(mr.c)(e)}})(function(e){var t=e.className,n=e.heroBookmark,r=Object(E.a)(),a=Object(l.b)(),o=Object(u.useSelector)(f.k),c=Object(l.a)(),s=null==c?void 0:c.setAnswerHeight,d=null==c?void 0:c.openLink,m=null==c?void 0:c.dismissAnswer,p=Object(l.h)().additionalAnswerConfigs,h=null==p?void 0:p.isAnswerDismissible,g=null==p?void 0:p.answerBlockId,b=Mn({domain:"Bookmark",entities:n?[n]:void 0,impressionEventId:"Hero_Bookmark_Impression",clickEventId:"Bookmark_Click",cardType:"Hero",isHero:!0,groupReferenceId:g,traceId:o});if(i.useEffect(function(){var e;n&&(null===(e=null==c?void 0:c.setAnswerBlockRendered)||void 0===e||e.call(c,b.placeholderId))},[]),!n)return Object(w.h)(r,"Unexpected Empty response received for Bookmark"),null;var v,y,O,j,S,x,C,k,T,I,P,N={className:t,heroBookmark:(j=(v=n).id,S=v.displayTitle,x=v.snippet,C=v.url,k=v.displayIconInfo,T=v.powerApp,I=v.powerBiApp,P=x&&(x.raw||x.json&&x.json[0]&&x.json[0].text)||"",{id:j,mappingId:Object(Q.c)(v),title:S,description:P,url:C,displayIconInfo:k,powerApp:T,powerAppToken:pr(y),powerBiApp:I,powerBiToken:pr(O)}),clientSize:a,onHeroBookmarkClick:function(e){d?d(e):window.open(e,"_blank"),b.entityActions.onEntityClick(n,0,{EntityClickDetails:d?"OpenInViewer":void 0},"Bookmark_Click")},setAnswerHeight:s,isDismissible:h,onDismiss:function(){h&&(null==m||m(),b.nonEntityActions.onSearchActionClick("Answer_DismissButton_Click"))}};return i.createElement(dr,hr({},N))}),gr=n(286),br=n(333),vr=n(195),yr=n(403),Or=n(93),jr=n(397),Sr=n(94),xr="ConnectingFlights",Cr=((Object(De.declareString)("search-components-flight.search.flights.flights")),(Object(De.declareString)("search-components-flight.search.flights.flight")),(Object(De.declareString)("search-components-flight.search.flights.passengersLabel")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.layoverIn")),(Object(De.declareString)("search-components-flight.search.flights.flightsIcon")),(Object(De.declareString)("search-components-flight.search.flights.confirmationCode")),(Object(De.declareString)("search-components-flight.search.flights.viewEmail")),(Object(De.declareString)("search-components-flight.search.flights.webCheckin")),(Object(De.declareString)("search-components-flight.search.flights.numberOfStops")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.airportDetails")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departTimeLabel")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalTimeLabel")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.airportLabel")),(Object(De.declareString)("search-components-flight.search.flights.upcomingFlights")),(Object(De.declareString)("search-components-flight.search.flights.expandIcon")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightRoute")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.airlineNumber")),(Object(De.declareString)("search-components-flight.search.flights.nonStop"))),kr=(Object(De.declareString)("search-components-flight.search.flights.stops")),Er=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightToday")),wr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightTomorrow")),Tr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightInDays")),Ir=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightNextWeek")),Pr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.futureFlight")),Nr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.pastFlight")),Ar=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightDetails")),Fr=((Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.reservationId")),(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.reservationIdWithLabel"))),Dr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.genericDayAndDate")),Lr=(Object(De.declareString)("search-components-flight.search.flights.viewReservation")),Rr=(Object(De.declareString)("search-components-flight.search.flight.share")),Hr=(Object(De.declareString)("search-components-flight.search.flights.checkin")),Wr=(Object(De.declareString)("search-components-flight.search.flights.openFlightMail")),Mr=(Object(De.declareString)("search-components-flight.search.flights.departureDetailsAriaLabel")),Br=(Object(De.declareString)("search-components-flight.search.flights.departureDetailsAriaLabel")),zr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureDestinationAriaLabel")),_r=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureCityAriaLabel")),Ur=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureDateAriaLabel")),qr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalDateAriaLabel")),Kr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureTimeAriaLabel")),Vr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalDateAriaLabel")),Qr=(Object(De.declareString)("search-components-flight.search.flights.travelDurationDetailsAriaLabel")),Yr=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.travelDurationAriaLabel")),Gr=function(e,t){return e&&t?br.b.getShortDurationTimeString(new Date(e),new Date(t),!1,Object(vr.b)()):""};function $r(e,t){var n,r;if(!(n=e,r=new Date,!(new Date(n)>=r))){var a=new Date(e),i=new Date;if(Object(yr.l)(a,i))return Er({destinationCity:t});var o=function(e,t){void 0===t&&(t=new Date),e.setHours(0,0,0,0),t.setHours(0,0,0,0);var n=e.getTime()-t.getTime();return Math.trunc(n/Or.c)}(a,i),c=o.toString();return Object(yr.p)(a,i)?wr({destinationCity:t}):o<Or.w/Or.c?Tr({destinationCity:t,days:c}):o<2*Or.w/Or.c-(i.getDay()+6)%7?Ir({destinationCity:t}):Pr({destinationCity:t})}return Nr({destinationCity:t})}function Jr(e){var t=new Date(e).getTime()-(new Date).getTime(),n=Math.trunc(t/Or.e),r=Math.trunc((t-n*Or.e)/Or.h);return(n>0||r>0)&&n<24}var Zr=n(443),Xr=n(495),ea={display:"flex",flexDirection:"row",justifyContent:"space-between"},ta={display:"inline-block"},na={display:"inline-block",maxWidth:"45%",textAlign:"right"},ra={fontSize:"12px",fontWeight:"600"},aa=Object(Ce.a)(function(e,t){var n=e.palette.themeDark;return Object(qe.t)({row:[ea,{height:"100%",width:"100%",padding:"8px "+(t?"12px":"24px"),maxWidth:"556px"}],actionButton:{padding:"0 8px"},rightColumn:[na,{display:"flex",fontSize:"14px",maxWidth:"100%"}],confirmation:{paddingRight:"2px",paddingTop:"2px",lineHeight:"32px",verticalAlign:"middle"},shareMail:{border:"none",background:"inherit",color:n,padding:"0 12px",selectors:{"&:hover":{color:n}}},forwardIcon:{paddingLeft:"10px"}})}),ia=function(e){var t=e.actionUrl,n=e.onActionButtonClick,r=e.actionType,a=e.isSmall,o=e.onShareClick,c=e.reservationId,l=e.isCheckin,s=e.openLink,u=function(e){e.stopPropagation(),t&&(s?s(t):window.open(t,"_blank"),n())},d=je(),m=aa(d,a),p=m.row,h=m.actionButton,f=m.rightColumn,g=m.confirmation,b=m.shareMail,v=m.forwardIcon;return i.createElement("div",{className:p},!l&&t&&i.createElement(Zr.a,{role:"link",text:r,onClick:function(e){return u(e)},className:h}),l&&t&&i.createElement(Xr.a,{role:"link",text:r,onClick:function(e){return u(e)},className:h}),i.createElement("div",{className:f},!a&&i.createElement("div",{className:g},Fr({reservationId:c})),o&&i.createElement(Zr.a,{className:b,onClick:function(e){e.stopPropagation(),o&&o()}},i.createElement("span",null,Rr()),i.createElement(nt.a,{className:v,iconName:"Forward"}))))};function oa(e){var t=i.useRef(new Image),n=i.useState(!1),r=n[0],a=n[1],o=function(){var e;(e=t.current)&&1===e.naturalHeight&&1===e.naturalWidth||a(!0)};return i.useEffect(function(){if(t.current.addEventListener("load",o,!1),e)return t.current.src=e,function(){t.current.removeEventListener("load",o,!1)}},[e]),r}var ca=n(496),la=n(442),sa=n(506),ua=Object(Ce.a)(function(e){var t=e.palette,n=t.neutralPrimary,r=t.neutralSecondary;return Object(qe.t)({header:{color:n,fontSize:"14px",fontWeight:"600",lineHeight:"24px",maxWidth:"556px",width:"100%"},row:ea,leftColumn:[{maxWidth:"100%",width:"100%"},ta],rightColumn:[na,{float:"right"}],airlineDetails:ra,profilePhoto:{float:"left",marginRight:"8.75px"},answerTitle:[at,{fontWeight:"600",fontSize:"14px",color:r}]})}),da=function(){return(da=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ma=function(e){var t=e.arrivalAirportCity,n=e.departureTimeInUtc,r=e.firstFlight,a=e.isSmall,o=e.imageUrl,c=e.LpcWrapper,l=e.userName,s=je(),u=ua(s),d=u.header,m=u.row,p=u.leftColumn,h=u.rightColumn,f=u.airlineDetails,g=u.profilePhoto,b=u.answerTitle,v=r.airline,y=r.airlineIata,O=r.flightNumber,j={imageUrl:oa(o)?o:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(ca.a)(l,!1),initialsColor:Object(la.a)({text:l})},S=i.createElement("div",{className:g},i.createElement(sa.a,da({},j))),x=c?i.createElement(c,null,S):S,C=$r(n,t);return i.createElement("div",{className:d,role:"heading","aria-level":3},i.createElement("div",{className:m},i.createElement("div",{className:p},x,i.createElement("div",{className:b,title:C},C,!a&&i.createElement("div",{className:h},i.createElement("div",{className:f},Ar({airline:v,airlineIata:y,flightNumber:O})))))))},pa=n(494),ha=Object(Ce.a)(function(e,t,n,r){var a=e.palette,i=a.neutralPrimary,o=a.neutralSecondary,c=a.neutralTertiaryAlt;return Object(qe.t)({itineraryContainer:{paddingBottom:"8px",paddingTop:"4px",margin:"0 0.8px",cursor:n?"pointer":"auto",maxWidth:"556px"},row:ea,departIata:{paddingRight:"24px",color:i,fontSize:"21px",fontWeight:"600"},arrivalIata:{paddingLeft:"24px",color:i,fontSize:"21px",fontWeight:"600"},lineContainer:{flexGrow:"10",display:"flex",flexDirection:"row"},flightIcon:{fontSize:"14px",height:"14px",color:c,position:"relative",letterSpacing:"0px",top:"54%",transform:"translateY(-50%)"},line:{flexGrow:"10",borderTop:c+" 0.5px solid",top:"50%",position:"relative"},durationContainer:{fontSize:"12px",color:o,position:"relative",top:"50%",height:"16px",padding:"4px 2px",transform:"translateY(-50%)",textAlign:"center"},duration:{marginBottom:"2px"},stops:{fontWeight:"600",cursor:0!==t?"pointer":"inherit",color:0===t?o:i},leftColumn:[ta,{maxWidth:"45%"}],rightColumn:[na,{maxWidth:"60%"}],smallText:{color:o,fontSize:r?"12px":"14px",height:"16px",marginTop:"4px"},time:{marginTop:"4px",fontWeight:"600",fontSize:"14px"},stopData:{fontWeight:"600",textAlign:"center",fontSize:"14px",color:i},airlineDetails:[ra,{paddingBottom:"4px",color:o}],confirmation:{fontSize:"12px",paddingBottom:"4px",color:o}})}),fa=/{C}/g,ga=function(e){var t,n,r=e.firstFlight,a=e.departureAirportIata,o=e.arrivalAirportIata,c=e.departureAirportCity,l=e.arrivalAirportCity,s=e.departureTime,u=e.arrivalTime,d=e.departureTimeInUtc,m=e.arrivalTimeInUtc,p=e.stopsCount,h=e.intermediateFlights,f=e.isSmall,g=e.onClick,b=e.getDisplayTime,v=e.dateTimeFormatter,y=je(),O=ha(y,p,!!g,f),j=O.itineraryContainer,S=O.row,x=O.departIata,C=O.arrivalIata,k=O.flightIcon,E=O.line,w=O.lineContainer,T=O.durationContainer,I=O.duration,P=O.stops,N=O.leftColumn,A=O.rightColumn,F=O.smallText,D=O.time,L=O.stopData,R=O.airlineDetails,H=O.confirmation,W={onRenderContent:function(){return i.createElement(i.Fragment,null,Object(K.a)(h,function(e,t){if(0!==t)return i.createElement("div",{className:L},i.createElement("strong",null,e.departureAirportIata),": ",i.createElement("span",null,Gr(h[t-1].arrivalTimeInUtc,h[t].departureTimeInUtc)))}))}},M=function(e,t,n){var r=null==v?void 0:v.formatWeekDayDate,a=null==v?void 0:v.formatUserTime,o=(r?r(t):"")||function(e){if(!e)return"";var t=Object(vr.b)(),n=Object(jr.formatCalendarDateFromString)(t.generic,e,t),r=Object(Sr.l)(new Date(e),t,"short");return Dr({weekDay:r,genericDate:n})}(t),c=(a?a(t):"")||b(t);return i.createElement(i.Fragment,null,i.createElement("div",{className:F,role:"listitem","aria-label":n?zr({cityName:e}):_r({cityName:e})},e),i.createElement("div",{className:F,role:"listitem","aria-label":n?Ur({displayDate:o}):qr({displayDate:o})},o),i.createElement("div",{className:D,role:"listitem","aria-label":n?Kr({displayTime:c}):Vr({displayTime:c})},c))},B=r.airline,z=r.airlineIata,_=r.flightNumber,U=r.reservationId;return i.createElement("div",{className:j,role:"presentation",onClick:g,tabIndex:g?0:-1,onKeyPress:function(e){e.preventDefault(),Ae(e,function(){return null==g?void 0:g()})},"aria-label":Wr()},f&&i.createElement("div",{className:S},i.createElement("div",{className:N},i.createElement("div",{className:R},Ar({airline:B,airlineIata:z,flightNumber:_}))),i.createElement("div",{className:A},i.createElement("div",{className:H},Fr({reservationId:U})))),i.createElement("div",{className:S},i.createElement("div",{className:x},a),i.createElement("div",{className:w},i.createElement(nt.a,{className:k,iconName:"AirplaneSolid"}),i.createElement("div",{className:E}),i.createElement("div",{className:T,role:"list","aria-label":Qr()},i.createElement("div",{className:I,role:"listitem","aria-label":Yr({travelDuration:(t=d,n=m,t&&n?br.b.getLongDurationTimeString(new Date(t),new Date(n),void 0):"")})},Gr(d,m)),i.createElement(Ht.a,{tooltipProps:W,directionalHint:Wt.a.bottomCenter,id:r.reservationId,styles:{root:{display:"inline-block"}},hidden:0===p},i.createElement("div",{className:P,role:"listitem","aria-describedby":r.reservationId,tabIndex:0===p?-1:0},ba(p)))),i.createElement("div",{className:E})),i.createElement("div",{className:C},o)),i.createElement("div",{className:S},i.createElement("div",{className:N,role:"list","aria-label":Mr()},M(c,s,!0)),i.createElement("div",{className:A,role:"list","aria-label":Br()},M(l,u,!1))))},ba=function(e){return 0===e?Cr():Object(pa.a)(kr().replace(fa,String(e)),e)},va=function(){return(va=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ya=function(e){var t,n=e.intermediateFlights,r=e.scenarioType,a=e.clientSize,o=e.onCardClick,c=e.onShareClick,l=e.onWebCheckinClick,s=e.onViewReservationClick,u=e.imageUrl,d=e.userName,m=e.userEmail,p=e.getDisplayTime,h=e.livePersonaCard,f=e.dateTimeFormatter,g=e.setAnswerHeight,b=e.openLink,v=Object(U.a)(n),y=ve("HeroFlightsTile",752,a),O=y[0],j=y[1],S=null===(t=O.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){S&&g&&g(S)},[S]);var x=i.useMemo(function(){return $e(h,d,m)},[h,d,m]),C="Small"===j;if(!v)return null;var k=v.immutableItemIdsForMail,E=k[k.length-1],w=function(){if(E){var e=Fe(E);o&&o({itemId:e})}},T={body:function(e,t,n,r,a,o,c){var l=n===xr?Object(gr.a)(t):e;if(!l)return null;var s=e.departureAirportIata,u=e.departureAirportCity,d=e.departureTime,m=e.departureTimeInUtc,p=l.arrivalAirportIata,h=l.arrivalAirportCity,f=l.arrivalTime,g=l.arrivalTimeInUtc,b=t.length-1,v={firstFlight:e,intermediateFlights:t,scenarioType:n,departureAirportIata:s,departureAirportCity:u,departureTime:d,departureTimeInUtc:m,arrivalAirportIata:p,arrivalAirportCity:h,arrivalTime:f,arrivalTimeInUtc:g,stopsCount:b,isSmall:r,getDisplayTime:a,onClick:c,dateTimeFormatter:o};return i.createElement(ga,va({},v))}(v,n,r,C,p,f,o&&E?w:void 0),header:Oa(v,n,r,C,u,d,x),footer:ja(v,C,l,s,c&&E?function(){if(E){var e=Fe(E);c&&c({itemId:e})}}:void 0,b),isSmall:C,styleOverrides:function(){return{cardStyles:"ms-search-maxWidth"}}};return i.createElement("div",{ref:O,role:"presentation"},i.createElement(et,va({},T)))};function Oa(e,t,n,r,a,o,c){var l=n===xr?Object(gr.a)(t):e;if(!l)return null;var s={arrivalAirportCity:l.arrivalAirportCity,departureTimeInUtc:e.departureTimeInUtc,isSmall:r,firstFlight:e,imageUrl:a,userName:o,LpcWrapper:c};return i.createElement(ma,va({},s))}function ja(e,t,n,r,a,o){var c=e.potentialActions;if(0===c.length)return null;var l={actionUrl:c[0].value,actionType:Jr(e.departureTimeInUtc)?Hr():Lr(),onActionButtonClick:function(){Jr(e.departureTimeInUtc)?n():r()},isSmall:t,reservationId:e.reservationId,isCheckin:Jr(e.departureTimeInUtc),onShareClick:a,openLink:o};return i.createElement(ia,va({},l))}function Sa(e){return Object(x.r)(e,"Flight")}function xa(e){var t=Sa(e);return t?Object(U.a)(t):void 0}var Ca=n(510);function ka(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=Object(Ca.a)(String(e.getMinutes()),2,"0");return n?Ea(e,!1)+":"+r+" "+wa(e,t):Ea(e,!1)+":"+r+wa(e,t)}function Ea(e,t){var n=Object(Sr.d)(e,t,void 0);return Number(n)}function wa(e,t){void 0===t&&(t=!0);var n=Object(vr.b)();return t?e.getHours()>=12?n.pmPartOfDayLowercaseAbbreviated:n.amPartOfDayLowercaseAbbreviated:e.getHours()>=12?n.pmPartOfDayLowercase:n.amPartOfDayLowercase}var Ta=n(281),Ia=n(246);var Pa=n(280),Na=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},Aa=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},Fa="ErrorItemNotFound";function Da(e,t){var n=this,r=Object(E.a)(),a=i.useState(void 0),o=a[0],c=a[1],l=Object(Pa.b)(function(t){return!!e&&function(e,t){return Ia.b.getSelectors(e).isCallInProgress(Object(Ia.c)(t))}(t,e)},function(t){return!!e&&function(e,t){return Ia.b.getSelectors(e).hasLoaded(Object(Ia.c)(t))}(t,e)},function(t){return!!e&&function(e,t){return Ia.b.getSelectors(e).hasError(Object(Ia.c)(t))}(t,e)},function(t){return e?function(e,t){return Ia.b.getSelectors(e).getLatestSuccess(Object(Ia.c)(t))}(t,e):void 0},function(r){return function(e,r){return function(a){return Na(n,void 0,void 0,function(){var n;return Aa(this,function(i){switch(i.label){case 0:return!r||t?[3,2]:(n=[Object(le.f)("GET","ProfilePhoto",r)],[4,a(Object(Ta.a)(e,n,r))]);case 1:i.sent(),i.label=2;case 2:return[2]}})})}}(r,e)},"FetchPersonPhoto_"+e);return i.useEffect(function(){var n,a,i;if(e)if(t)Promise.resolve(t(e)).then(function(e){c(e)}).catch(function(){});else{if(l.isFetching||!l.data)return;var o=null===(n=null==l?void 0:l.data)||void 0===n?void 0:n.responses[0].status;if(o&&200!==o){if(404===o)try{if((null===(a=null==l?void 0:l.data)||void 0===a?void 0:a.responses[0].body).error.code===Fa)return}catch(e){}return void Object(w.a)(r,o.toString())}c(Gn(null===(i=l.data)||void 0===i?void 0:i.responses[0].body))}},[l.data,t,e]),o}var La="Flight";var Ra=function(){return(Ra=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ha=function(e){var t,n,r,a,o=e.className,c=Object(u.useSelector)(xa),s=Zn(),d=(n=Object(u.useSelector)(Bn.d),r=null===(t=er())||void 0===t?void 0:t.userData,a=Object(u.useSelector)(qn),tr()?(null==r?void 0:r.displayName)||a:n),m=Object(l.b)(),p=Object(E.a)(),h=Object(l.a)(),f=v(),g=function(e){if(!e||Object(L.a)(e.flights))return null;var t=e.flights,n=Object(U.a)(t);return n?{firstFlight:n,intermediateFlights:t}:null}(c),b=null==g?void 0:g.firstFlight,y=se(b),O=null==g?void 0:g.intermediateFlights,j=null==h?void 0:h.setAnswerHeight,S=null==h?void 0:h.openLink,x=Da(s,null==h?void 0:h.getProfilePhotoUrl),C=Wn({domain:"Flight",entity:c,impressionEventId:"Hero_Flight_Impression",cardType:"Hero",isHero:!0});i.useEffect(function(){var e;!y&&b&&(null===(e=null==h?void 0:h.setAnswerBlockRendered)||void 0===e||e.call(h,C.placeholderId))},[b,y]);var k=null==h?void 0:h.openMail,w=null==h?void 0:h.forwardMail,T=null==h?void 0:h.livePersonaCard,I=null==h?void 0:h.dateTimeFormatter;if(!c||Object(L.a)(c.flights))return null;var P=c.scenarioType;if(!b||!O)return null;var N={intermediateFlights:O,scenarioType:P,clientSize:m,onWebCheckinClick:function(){!function(e,t,n,r,a,i,o){Object(En.a)(e,a?"Flight_Web_CheckIn_Click_Expanded":"Flight_Web_CheckIn_Click_Collapsed",{eventScope:La,cardType:n,clientSize:r,traceId:i,isHero:o},t)}(p,c,"Hero",m,!0,f,!0)},onViewReservationClick:function(){!function(e,t,n,r,a,i){Object(En.a)(e,"Flight_View_Reservation_Click",{eventScope:La,cardType:n,clientSize:r,traceId:a,isHero:i},t)}(p,c,"Hero",m,f,!0)},getDisplayTime:function(e){return ka(new Date(e),!1,!0).toUpperCase()},imageUrl:x,className:o,userEmail:s,userName:d,onCardClick:k?function(e){null==k||k(e),function(e,t,n,r,a,i){Object(En.a)(e,"Flight_Card_Click",{eventScope:La,cardType:n,clientSize:r,traceId:a,isHero:i},t)}(p,c,"Hero",m,f,!0)}:void 0,onShareClick:w?function(e){null==w||w(e),function(e,t,n,r,a,i){Object(En.a)(e,"Flight_Share_Click",{eventScope:La,cardType:n,clientSize:r,traceId:a,isHero:i},t)}(p,c,"Hero",m,f,!0)}:void 0,dateTimeFormatter:I,livePersonaCard:T,setAnswerHeight:j,openLink:S};return i.createElement(ya,Ra({},N))},Wa=Object(Ce.a)(function(){var e;return Object(qe.t)({multiEntityFileHeader:[at,{fontWeight:"600",fontSize:14}],linkContainer:{selectors:(e={},e["& .ms-search-heroTile-bodyContainer"]={padding:"0"},e)}})}),Ma=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedOnWeekday")),Ba=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedToday")),za=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedYesterday")),_a=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedLastWeek")),Ua=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedThisMonth")),qa=(Object(De.declareString)("search-components-link.search.links.youText")),Ka=(Object(De.declareString)("search-components-link.search.links.sharedInTeams")),Va=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.sharedInEmail")),Qa=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.sharedInTeamsChat")),Ya=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.sharedInTeamsChatWith")),Ga=(Object(De.declareString)("search-components-link.search.links.linksHeader")),$a=n(394),Ja=n(259);function Za(e,t,n){if(void 0===n&&(n=new Date),e&&t){var r=n.getTime(),a=new Date(e),i=r-a.getTime(),o=Math.floor(i/Or.c),c=Object(Ja.a)(a,n);return Object(yr.l)(n,a)?Ba({name:t}):Object(Sr.p)(a,n)?za({name:t}):o<n.getDay()?Ma({name:t,day:Object($a.a)(a.getDay())}):o<Or.w/Or.c+n.getDay()?_a({name:t}):a.getMonth()===n.getMonth()&&a.getFullYear()===n.getFullYear()?Ua({name:t}):Ma({name:t,day:c})}}function Xa(e,t,n){return(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase())||(null==n?void 0:n.toLowerCase())===(null==e?void 0:e.toLowerCase())}function ei(e,t,n,r,a,i){var o,c,l;if(void 0===i&&(i=new Date),t&&e&&n){if(Xa(n,r,a)){if(!(c=Za(e,qa(),i)))return;l=[c=(null===(o=c[0])||void 0===o?void 0:o.toUpperCase())+(null==c?void 0:c.substr(1))]}else{if(!(c=Za(e,t,i)))return;l=null==c?void 0:c.split(t)}return l}}function ti(e,t,n,r,a){if(e)switch(e){case"Outlook":return function(e,t){if(e){var n=Va({title:e}),r=t?"https://outlook.office.com/owa/?viewmodel=ReadMessageItem&ItemID="+t:void 0;return{text:n,splits:n.split(e),sourceSubject:e,sourceUrl:r}}return}(t,a);case"Teams":return function(e,t,n){var r=n?"https://teams.microsoft.com/l/chat/"+n+"/conversations":void 0;if(e){var a=Qa({chat:e});return{text:a,splits:a.split(e),sourceSubject:e,sourceUrl:r}}if(t){var i=Ya({name:t});return{text:i,splits:i.split(t),sourceSubject:t,sourceUrl:r}}return{text:Ka()}}(t,n,r);default:return}}var ni=Object(Ce.a)(function(){return Object(qe.t)({header:{marginLeft:"5px",fontWeight:"400",fontSize:14},headerContent:{fontSize:14,lineHeight:"24px",verticalAlign:"middle",display:"flex",flexDirection:"row",overflow:"hidden"},senderFullName:{fontWeight:"600"},profilePhoto:{float:"left"},connectionText:[at,{fontWeight:"400",fontSize:14,paddingLeft:"8.75px"}]})}),ri=function(e){var t=e.link,n=e.profilePictureUrl,r=e.userEmail,o=e.userUpn,c=e.livePersonaCard,l=e.onProfileClick,s=t.senderName,u=t.senderAddress,d=t.lastSharedTimeUtc,m=ni(),p=ei(d,s,u,r,o),h=Za(d,s),f={imageUrl:oa(n)?n:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(ca.a)(s,!1),initialsColor:Object(la.a)({text:s})},g=$e(c,s,u),b=i.createElement("div",{className:m.profilePhoto,role:"button",onClick:l},i.createElement(sa.a,Object(a.__assign)({},f))),v=g?i.createElement(g,null,b):b,y=i.createElement("span",{className:m.senderFullName,role:"button",onClick:l},s),O=g?i.createElement(g,null,y):y;return p?i.createElement("div",{className:m.headerContent},v,i.createElement("div",{className:m.connectionText,title:h,role:"presentation","aria-label":h},p[0],!Xa(u,r,o)&&i.createElement("span",{className:m.senderFullName},O),p[1])):null},ai=Object(Ce.a)(function(e,t,n){var r=e.palette,a=r.neutralDark,i=r.neutralPrimary,o=r.neutralSecondary,c=r.neutralLight,l=r.blue;return Object(qe.t)({linkEntity:{margin:"0 1px",height:t?"auto":"33px",marginTop:"8px",borderBottom:n?"none":"1px solid",display:"flex",borderColor:c,selectors:{"&:hover":{cursor:"pointer"}}},linkIcon:[vn,{float:"left",color:i,width:"40px",height:"100%",marginTop:t?"0":"-4px"}],linkInfoContainer:{width:"calc(100% - 40px)",height:"100%",float:"left",display:"flex",paddingBottom:t?n?"12px":"8px":"0",flexDirection:t?"column":"row"},titleText:[at,{fontSize:"14px",lineHeight:"20px"},{color:l,display:"inline-block",height:"20px",width:t?"100%":"240px",marginRight:t?"0":"25px",selectors:{"&:hover":{textDecoration:"underline",color:l}}}],teaser:[at,{fontWeight:"400",fontSize:14,height:"20px",float:"left",color:o}],sourceInfo:[at,{color:a,fontWeight:"400",fontSize:14,height:"20px",display:"flex",marginRight:t?"0":"16px"}],sourceLink:[at,{color:a,textDecoration:"none",selectors:{":hover":{textDecoration:"underline"}}}],tertiaryInfo:[at,{fontWeight:"400",fontSize:14,height:"20px",color:o,float:"left"}]})}),ii=function(e){var t=e.link,n=e.isSmall,r=e.showConnection,a=e.index,o=e.numberOfLinks,c=e.userEmail,l=e.userUpn,s=e.onLinkClick,u=e.onLinkSourceClick,d=e.openLink,m=t.url,p=t.title,h=t.subject,f=t.safeUrl,g=t.senderName,b=t.description,v=t.senderAddress,y=t.messageThreadId,O=t.immutableMessageId,j=t.lastSharedTimeUtc,S=t.sharingReferenceType,x=je(),C=ai(x,n,a===o-1);function k(e,t,n,r){e.stopPropagation(),d&&r?d(r):window.open(r,"_blank","top=50,left=50,width=1000,height=600"),"Teams"===n?u(t,a,n):"Outlook"===n&&u(t,a,n)}var E=ei(j,g,v,c,l),w=E&&Xa(v,c,l)?E[0]:Za(j,g),T=ti(S,h,g,y,O),I=null==T?void 0:T.text,P=null==T?void 0:T.splits,N=null==T?void 0:T.sourceSubject,A=null==T?void 0:T.sourceUrl,F=P?i.createElement(i.Fragment,null,P[0],i.createElement("div",{className:C.sourceLink,onClick:function(e){return k(e,t,S,A)},onKeyPress:function(e){return k(e,t,S,A)},tabIndex:0,role:"link"},N),P[1]):I,D=f||m;function L(){d?d(D):window.open(D,"_blank"),s(t,a)}return i.createElement("div",{onClick:L,onKeyPress:L,tabIndex:0,className:C.linkEntity,role:"listitem","aria-posinset":a+1,"aria-setsize":o},i.createElement(nt.a,{className:C.linkIcon,iconName:"Link"}),i.createElement("div",{className:C.linkInfoContainer},i.createElement("div",{className:C.titleText,title:m},p||m),F&&i.createElement("div",{className:C.sourceInfo,title:I},F),b&&!r&&(!p||!F)&&i.createElement("div",{className:C.teaser,title:b},b),r&&w&&i.createElement("div",{className:C.tertiaryInfo,title:w},w)))},oi=function(e){var t,n=e.links,r=e.profilePictureUrl,o=e.clientSize,c=e.userEmail,l=e.userUpn,s=e.headingLevel,u=e.livePersonaCard,d=e.onLinkClick,m=e.onLinkSourceClick,p=e.setAnswerHeight,h=e.openLink,f=e.onProfileClick,g=Object(a.__read)(ve("HeroLinkTile",752,o),2),b=g[0],v="Small"===g[1],y=null===(t=b.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){y&&p&&p(y)},[y]);var O=Wa(),j={link:n[0],profilePictureUrl:r,userEmail:c,userUpn:l,livePersonaCard:u,onProfileClick:function(){return null==f?void 0:f(n[0])}},S=n.length>1;var x=S;var C={body:i.createElement("div",{role:"list"},n.map(function(e,t){var r={link:e,isSmall:v,showConnection:x,index:t,userEmail:c,userUpn:l,numberOfLinks:n.length,onLinkClick:d,onLinkSourceClick:m,openLink:h};return i.createElement(ii,Object(a.__assign)({key:"link"+t},r))})),header:S?i.createElement("div",{className:O.multiEntityFileHeader,role:"heading","aria-level":s},Ga()):i.createElement(ri,Object(a.__assign)({},j)),isSmall:v};return i.createElement("div",{className:O.linkContainer,ref:b},i.createElement(et,Object(a.__assign)({},C)))};oi.displayName="HeroLinkTile";var ci=n(296);var li=3,si=function(e){var t=e.className,n=Object(u.useSelector)(ci.a),r=Object(ae.a)(),o=Object(l.b)(),c=Object(E.a)(),s=Zn(),d=Xn(),m=r.clientActionCallbacks,p=null==m?void 0:m.setAnswerHeight,h=null==m?void 0:m.openLink,f=null==m?void 0:m.getProfilePhotoUrl,g=Da(function(e){return null==e?void 0:e.senderAddress}(n&&n[0]),f),b=function(e,t){if(!e||Object(L.a)(e))return Object(w.h)(t,"Unexpected Empty response received for Link"),[];var n=e.filter(function(e){var n=function(e){return!!e.url}(e);return!n&&Object(w.e)(t,"Link entity dropped due to missing required fields (url)"),n});return Object(L.a)(n)&&Object(w.e)(t,"Link answer dropped due to missing required fields (url)"),Object(jn.a)(n,li)}(n,c),v=(null==b?void 0:b.length)>1,y=Mn({entities:b,domain:"Link",isHero:!0,impressionEventId:v?"Hero_MultiEntity_Link_Impression":"Hero_Link_Impression",cardType:"Hero",clickEventId:"Link_Answer_Click"});if(i.useEffect(function(){var e;Object(L.a)(b)||null===(e=null==m?void 0:m.setAnswerBlockRendered)||void 0===e||e.call(m,y.placeholderId)},[b]),Object(L.a)(b))return null;var O=null==m?void 0:m.livePersonaCard,j={className:t,links:b,clientSize:o,userEmail:s,userUpn:d,profilePictureUrl:g,onProfileClick:function(e){y.entityActions.onEntityClick(e,0,void 0,"Link_Sender_Profile_Click")},livePersonaCard:O,onLinkClick:function(e,t){y.entityActions.onEntityClick(e,t)},onLinkSourceClick:function(e,t,n){y.entityActions.onEntityClick(e,t,{interpretation:n},"Link_MailSource_Click")},setAnswerHeight:p,openLink:h};return i.createElement(oi,Object(a.__assign)({},j))},ui="Person";var di=n(7);n(341),n(342),n(190),n(122);n(346);n(248),(Object(De.declareString)("search-components-calendar.search.calendar.upNext")),(Object(De.declareString)("search-components-calendar.search.calendar.noMeetings")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeString"));var mi=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeStringWithoutDotSeparator")),pi=((Object(De.declareString)("search-components-calendar.search.calendar.calendarUppercase")),(Object(De.declareString)("search-components-calendar.search.calendar.calendarIntent")),(Object(De.declareString)("search-components-calendar.search.calendar.calendarLowercase")),(Object(De.declareString)("search-components-calendar.search.calendar.meetings")),(Object(De.declareString)("search-components-calendar.search.calendar.meeting")),(Object(De.declareString)("search-components-calendar.search.calendar.allDayText")),(Object(De.declareString)("search-components-calendar.search.calendar.openInOutlookText")),(Object(De.declareString)("search-components-calendar.search.calendar.tentativelyAcceptedResponse")),(Object(De.declareString)("search-components-calendar.search.calendar.acceptedResponse")),(Object(De.declareString)("search-components-calendar.search.calendar.noResponse")),(Object(De.declareString)("search-components-calendar.search.calendar.organizerText")),(Object(De.declareString)("search-components-calendar.search.calendar.eventSingleMeetingText")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.eventstext")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.attendeesText")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.topMeetingTitleDecorator")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.duration")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingStartAndEndTime")));(Object(De.declareString)("search-components-calendar.search.calendar.previousSubtitle")),(Object(De.declareString)("search-components-calendar.search.calendar.lastMonthSubtitle")),(Object(De.declareString)("search-components-calendar.search.calendar.lastWeekSubtitle")),(Object(De.declareString)("search-components-calendar.search.calendar.yesterdaySubtitle")),(Object(De.declareString)("search-components-calendar.search.calendar.tomorrowSubtitle")),(Object(De.declareString)("search-components-calendar.search.calendar.thisWeekSubtitle")),(Object(De.declareString)("search-components-calendar.search.calendar.nextWeekSubtitle")),(Object(De.declareString)("search-components-calendar.search.calendar.laterSubtitle")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.eventConflictText")),(Object(De.declareString)("search-components-calendar.search.calendar.eventSingleConflictText")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.timeAndLocation")),(Object(De.declareString)("search-components-calendar.search.calendar.todaySchedule")),(Object(De.declareString)("search-components-calendar.search.calendar.meetingItemAriaLabel")),(Object(De.declareString)("search-components-calendar.search.calendar.upcomingSharedEvents")),(Object(De.declareString)("search-components-calendar.search.calendar.upcomingMeetings")),(Object(De.declareString)("search-components-calendar.search.calendar.pastMeetings")),(Object(De.declareString)("search-components-calendar.search.calendar.upcomingEventsForMe")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingDateTimeRange")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingTimeRange"));(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.availabilityChart.ariaLabelFormat"));(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.availabilityChart.availabilityBlockDescription"));(Object(De.declareString)("search-components-calendar.search.calendar.free")),(Object(De.declareString)("search-components-calendar.search.calendar.tentative")),(Object(De.declareString)("search-components-calendar.search.calendar.busy")),(Object(De.declareString)("search-components-calendar.search.calendar.outOfOffice")),(Object(De.declareString)("search-components-calendar.search.calendar.unknown"));(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.currentTime")),(Object(De.declareString)("search-components-calendar.search.calendar.calendarTitle")),(Object(De.declareString)("search-components-calendar.search.calendar.meetingsList"));var hi=(Object(De.declareString)("search-components-calendar.search.calendar.onlineMeeting")),fi=((Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.onlineMeetingWithRoom")),(Object(De.declareString)("search-components-calendar.search.calendar.canceled")),(Object(De.declareString)("search-components-calendar.search.calendar.eventsHeading"))),gi=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeStringForDifferentStartAndEndWeekDays")),bi=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.calendarTileConnectionString")),vi=((Object(De.declareString)("search-components-calendar.search.calendar.seeMeetingConflicts")),(Object(De.declareString)("search-components-calendar.search.calendar.joinTeamsMeetingButtonAriaLabel"))),yi=(Object(De.declareString)("search-components-calendar.search.calendar.editMeetingButtonAriaLabel")),Oi=(Object(De.declareString)("search-components-calendar.search.calendar.join")),ji=((Object(De.declareString)("search-components-class.search.class.classes")),(Object(De.declareString)("search-components-class.search.class.classesLowercase")),(Object(De.declareString)("search-components-class.search.class.myClasses")),(Object(De.declareString)("search-components-class.search.class.myClass")),(Object(De.declareString)("search-components-class.search.class.classesUppercase")),(Object(De.declareString)("search-components-class.search.shared.ClassesTitleWithCount1")),(Object(De.declareStringWithPlaceholders)("search-components-class.search.shared.classesTitleWithCount")),(Object(De.declareString)("search-components-class.search.classes.classPrivacyMessage")),(Object(De.declareString)("search-components-class.search.classes.teamsImageAltText")),n(256));n(166),n(279),(Object(De.declareString)("search-components.search.punctuation.comma"));n(252);(Object(De.declareString)("search-answer-person.search.person.overview")),(Object(De.declareString)("search-answer-person.search.person.overviewLowercase")),(Object(De.declareString)("search-answer-person.search.person.aboutUppercase")),(Object(De.declareString)("search-answer-person.search.person.seeMoreOrg")),(Object(De.declareString)("search-answer-person.search.person.seeMoreGroup")),(Object(De.declareString)("search-answer-person.search.person.seeMoreFile")),(Object(De.declareString)("search-answer-person.search.person.reportTo")),(Object(De.declareString)("search-answer-person.search.person.recentFile")),(Object(De.declareString)("search-answer-person.search.person.organization")),(Object(De.declareString)("search-answer-person.search.person.organizationUppercase")),(Object(De.declareString)("search-answer-person.search.person.organizationLowercase")),(Object(De.declareString)("search-answer-person.search.person.eduClasses")),(Object(De.declareString)("search-answer-person.search.person.office")),(Object(De.declareString)("search-answer-person.search.person.officeLowercase")),(Object(De.declareStringWithPlaceholders)("search-answer-person.search.person.personOrganization")),(Object(De.declareStringWithPlaceholders)("search-answer-person.search.person.personFiles")),(Object(De.declareStringWithPlaceholders)("search-answer-person.search.person.personGroups")),(Object(De.declareStringWithPlaceholders)("search-answer-person.search.person.personOffice")),(Object(De.declareStringWithPlaceholders)("search-answer-person.search.person.personCalendar")),(Object(De.declareStringWithPlaceholders)("search-answer-person.search.person.personClasses")),(Object(De.declareString)("search-answer-person.search.person.personCalendarIntent")),(Object(De.declareString)("search-answer-person.search.person.personFilesIntent")),(Object(De.declareString)("search-answer-person.search.person.personGroupsIntent")),(Object(De.declareString)("search-answer-person.search.personPersonOfficeIntent")),(Object(De.declareString)("search-answer-person.search.person.personOrganizationIntent")),(Object(De.declareString)("search-answer-person.search.person.personClassesIntent"));var Si=n(4),xi=n(49),Ci=function(e){var t,n,r=null==e?void 0:e.Source;return{id:function(e){if(!e)return Object(Ye.a)();var t=e.indexOf("@");return e.substring(0,-1!==t?t:e.length)}(null==e?void 0:e.Id),fullName:(null==r?void 0:r.DisplayName)||"",firstName:(null==r?void 0:r.GivenName)||"",lastName:(null==r?void 0:r.Surname)||"",email:(null===(t=null==r?void 0:r.EmailAddresses)||void 0===t?void 0:t[0])||"",userPrincipalName:(null==r?void 0:r.UserPrincipalName)||"",alias:function(e){if(!e)return;var t=e.replace("sip:",""),n=t.indexOf("@");return t.substring(0,-1!==n?n:t.length)}(null==r?void 0:r.ImAddress)||"",department:null==r?void 0:r.Department,jobTitle:null==r?void 0:r.JobTitle,officeLocation:null==r?void 0:r.OfficeLocation,phoneNumbers:null===(n=null==r?void 0:r.Phones)||void 0===n?void 0:n.map(function(e){return e.Number}),mappingId:null==e?void 0:e.ReferenceId,topics:null==r?void 0:r.Topics,tenantId:function(e){if(!e)return"";var t=e.indexOf("@");return e.substring(t+1)}(null==e?void 0:e.Id)}};var ki=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},Ei=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};function wi(e,t){return{key:(e||"")+"_"+t}}var Ti=Object(xi.a)("SubstrateSearchPersons",function(e,t){var n;return ki(this,void 0,void 0,function(){return Ei(this,function(r){switch(r.label){case 0:return[4,e.makeQueryRequest(function(e){var t,n,r,a,i,o=null===(a=null===(r=null===(n=null===(t=null==e?void 0:e.parsedBody)||void 0===t?void 0:t.EntitySets)||void 0===n?void 0:n[0])||void 0===r?void 0:r.ResultSets)||void 0===a?void 0:a[0],c=(null==o?void 0:o.Total)||0,l=null==o?void 0:o.Results,s=(null===(i=null==e?void 0:e.parsedBody)||void 0===i?void 0:i.Instrumentation.TraceId)||"";return{results:Object(K.a)(l,function(e){return Ci(e)}),totalEstimatedMatches:c,debug:{traceId:s}}},t.request,null===(n=t.flights)||void 0===n?void 0:n.toString())];case 1:return[2,r.sent()]}})})},!0),Ii=Object(Si.c)("SubstrateSearchPersonsStore",Ti),Pi=n(13);var Ni=Object(Pi.a)("PersonClasses",function(e,t){return ki(this,void 0,void 0,function(){var n;return Ei(this,function(r){switch(r.label){case 0:return n=e.createRequestUrl("search/classes"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,r.sent()]}})})});Object(Si.c)("PersonClassesDataStore",Ni);var Ai=Object(Pi.a)("PersonFiles",function(e,t){return ki(this,void 0,void 0,function(){var n;return Ei(this,function(r){return n=e.createRequestUrl("search/documents/personal"),[2,e.makeRequest(n,"POST",t)]})})});Object(Si.c)("PersonFilesDataStore",Ai);n(500);var Fi=n(326),Di=n(293),Li=n(109);function Ri(e){return{key:e.userId+(e.isPeersRequest?"-peers":"")}}var Hi=Object(Pi.a)("OrgChart",function(e,t){return ki(this,void 0,void 0,function(){var n;return Ei(this,function(r){switch(r.label){case 0:return n=e.createRequestUrl("browse/person/org/chart"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,r.sent()]}})})}),Wi=Object(Si.c)("OrgChartDataStore",Hi),Mi=Object(Fi.a)("OrgChart",Di.a,{debounce:Object(Li.a)()});Object(Si.c)("LokiOrgChartDataStore",Mi);var Bi=function(){return(Bi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function zi(e,t,n,r,a){void 0===n&&(n=di.a);var i=Vi(e,n,r,a),o=null==i?void 0:i.results;return t?Object(R.a)(o,function(t){return!function(e,t){return Ui(e)===t}(e,t.id)}):o}function _i(e,t,n){if(!Object(W.g)(e,"Person")){var r=function(e){var t=Qi(e);return null==t?void 0:t.results}(e),a=zi(e,void 0,t,void 0,n),i=Object(te.c)(e),o="Person"===Object(f.h)(e),c=i?function(e,t,n){var r=Object(p.a)(e,function(e){return e.userPrincipalName===n||e.id===n});r||(r=Object(p.a)(t,function(e){return e.userPrincipalName===n||e.id===n}));r||(r=Object(U.a)(e));return r}(r,a,i):o?void 0:Object(U.a)(r);if(c){var l=function(e,t){var n=Wi.getSelectors(e).getLatestSuccess(Ri({userId:t}));return n&&Object(p.a)(n.reportingChain,function(e){return e.id===t})}(e,c.id);if(l)return Ki(c,l)}return c}}function Ui(e){var t=_i(e);return t&&t.id}function qi(e){var t=Object(f.a)(e,"Person"),n=Object(j.s)(e);return"PersonOrgChart"===t&&n||"PersonEduClasses"===t&&!n?"None":t}var Ki=Object(Ce.a)(function(e,t){var n=t.aggregatedOrgStructure,r=t.orgStructure,a=t.customAggregatedAttributes,i=t.customAttributes;return Bi(Bi({},e),{aggregatedOrgStructure:n,orgStructure:r,customAggregatedAttributes:a,customAttributes:i})});function Vi(e,t,n,r){return void 0===t&&(t=di.a),!1!==r?Qi(e):function(e,t,n){void 0===t&&(t=di.a);var r=void 0===n?Yi(e):n;return Ii.getSelectors(e).getLatestSuccess(wi(r,t))}(e,t,n)}function Qi(e){return{results:Object(W.b)(e,"Person")}}function Yi(e){return Object(f.f)(e,"Person")}var Gi=Object(Ce.a)(function(e){var t,n=e.palette,r=n.white,a=n.neutralLight;return Object(qe.t)({profilePhoto:{float:"left",height:"40px",margin:"0 12px 0 16px",width:"40px"},personInfoContainer:{paddingRight:"16px",maxWidth:"calc(100% - 68px)"},emailIcon:{fontSize:18,marginTop:"5px",marginRight:"8px"},messageIcon:{fontSize:18,marginTop:"5px",marginRight:"8px",paddingTop:"2px"},personName:[at,{fontSize:"14px",lineHeight:"20px"},{height:"20px",fontWeight:"600",paddingRight:"15px"}],viewEmailText:[at,{fontSize:"14px",lineHeight:"20px"},{height:"20px",marginTop:"4px",paddingRight:"15px"}],viewMessageText:[at,{fontSize:"14px",lineHeight:"20px"},{height:"20px",marginTop:"4px",paddingRight:"15px"}],email:[at,{fontSize:"14px",lineHeight:"20px"},{height:"20px",paddingRight:"15px"}],personContainer:{height:"40px",display:"flex",padding:"9px 0 11px 0",backgroundColor:r,width:"100%",borderBottom:"1px solid",borderColor:a},tileBodyOverride:["ms-search-tile-body"],tile:[{selectors:(t={},t["& .ms-search-tile-body"]={margin:"0",padding:"0"},t)}],actionContainer:{paddingLeft:"10px",height:"30px",display:"flex",cursor:"pointer",float:"left"},actionChatContainer:{paddingLeft:"10px",height:"30px",display:"flex",cursor:"pointer"}})}),$i=(Object(De.declareStringWithPlaceholders)("search-components-person.search.person.viewEmailsFrom")),Ji=(Object(De.declareString)("search-components-person.search.person.viewEmails")),Zi=(Object(De.declareString)("search-components-person.search.person.viewMessages")),Xi=function(){return(Xi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},eo="Mail",to="Chat",no=function(e){var t,n=e.person,r=e.profilePictureUrl,a=e.clientSize,o=e.startPersonSearchRequery,c=e.openLink,l=e.logPersonClick,s=e.logPersonProfileClick,u=e.logPersonChatClick,d=e.livePersonaCard,m=e.setAnswerHeight,p=e.isTeamsChatFeatureEnabled,h=n.fullName,f=n.email,g=n.nicknames,b=je(),v=ve("HeroLinkTile",752,a),y=v[0],O="Small"===v[1],j=null===(t=y.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){j&&m&&m(j)},[j]);var S=oa(r),x=Gi(b),C=x.personContainer,k=x.actionChatContainer,E=x.actionContainer,w=x.profilePhoto,T=x.personInfoContainer,I=x.personName,P=x.viewEmailText,N={imageUrl:S?r:void 0,size:3,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(ca.a)(h,!1),initialsColor:Object(la.a)({text:h})};function A(){u(n,0);var e=function(e,t){var n="";return e&&t?n="https://teams.microsoft.com/l/search/"+e+"?from="+t:n}(h,f);e&&c?c(e):window.open(e,"_blank")}function F(){l(n,0),o(f,h)}var D=function(e){F&&Ae(e,F)},R=function(e){A&&Ae(e,A)},H=$e(d,h,f),W=i.createElement("div",{className:w,role:"button",onClick:function(){return s(n)},onKeyPress:function(){return s(n)}},i.createElement(sa.a,Xi({},N))),M=H?i.createElement(H,null,W):W,B=i.createElement("span",{role:"button",onClick:function(){return s(n)},onKeyPress:function(){return s(n)}},h),z=H?i.createElement(H,null,B):B,_=g&&!Object(L.a)(g)&&g[0]?g[0]:h,U=Zi(),q=p?Ji():$i({name:_});var K={body:function(){var e;return i.createElement("div",null,i.createElement("div",{className:C},M,i.createElement("div",{className:T},i.createElement("div",{className:I},z),i.createElement("div",{className:x.email,title:f},f))),i.createElement("div",{role:"Button",tabIndex:0,className:E,onClick:F,onKeyPress:D},i.createElement(nt.a,{iconName:eo,className:x.emailIcon}),i.createElement("div",{className:P,title:q},q)),p&&(null===(e=null==n?void 0:n.inferences)||void 0===e?void 0:e.HasReceivedMessagesFrom)&&i.createElement("div",{role:"Button",tabIndex:0,className:k,onClick:A,onKeyPress:R},i.createElement(nt.a,{iconName:to,className:x.messageIcon}),i.createElement("div",{className:x.viewMessageText,title:U},U)))}(),isSmall:O,styleOverrides:function(){return{bodyStyles:x.tileBodyOverride,cardStyles:x.tile}}};return i.createElement("div",{ref:y},i.createElement(et,Xi({},K)))};no.displayName="HeroPersonTile";var ro,ao,io,oo,co=function(){return(co=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},lo=function(e){var t=e.className,n=e.person,r=e.index,a=e.clientSize,o=e.startPersonSearchRequery,c=e.openLink,s=e.logPersonClick,u=e.logPersonProfileClick,d=e.logPersonChatClick,m=e.livePersonaCard,p=e.setAnswerHeight,h=e.getProfilePhotoUrlFromClient,f=e.isTeamsChatFeatureEnabled,g=e.intent,b=Object(l.a)(),v=Wn({domain:"Person",entity:n,impressionEventId:"Hero_Person_Impression",cardType:"Hero",isHero:!0,queryIntent:g});i.useEffect(function(){var e;n&&(null===(e=null==b?void 0:b.setAnswerBlockRendered)||void 0===e||e.call(b,v.placeholderId))},[]);var y=Da(null==n?void 0:n.email,h),O={className:t,person:n,openLink:c,profilePictureUrl:y,index:r,clientSize:a,startPersonSearchRequery:o,logPersonClick:s,logPersonProfileClick:u,logPersonChatClick:d,livePersonaCard:m,setAnswerHeight:p,isTeamsChatFeatureEnabled:f};return i.createElement(no,co({},O))},so=function(){return(so=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},uo=function(e){var t=e.className,n=Object(u.useSelector)(zi),r=Object(u.useSelector)(qi),a=Object(E.a)(),o=Object(l.b)(),c=v(),s="Hero",d=Object(l.a)(),m=null==d?void 0:d.livePersonaCard,p=null==d?void 0:d.startPersonSearchRequery,h=null==d?void 0:d.openLink,f=null==d?void 0:d.getProfilePhotoUrl,g=null==d?void 0:d.setAnswerHeight,b=Object(l.h)().additionalAnswerConfigs,y=null==b?void 0:b.isTeamsChatFeatureEnabled;if(!n||Object(L.a)(n))return Object(w.h)(a,"Unexpected Empty response received for People"),null;if(!p)return Object(w.b)(a,"startPersonSearchRequery callback undefined"),null;var O={person:n[0],className:t,index:-1,clientSize:o,startPersonSearchRequery:p,openLink:h,logPersonClick:function(e,t){!function(e,t,n,r,a,i,o){Object(En.c)(e,"Person_Entity_Click",t,{cardType:r,clientSize:a,eventScope:ui,traceId:i,isHero:o},n)}(a,e,t,s,o,c,!0)},setAnswerHeight:g,logPersonProfileClick:function(e){!function(e,t,n,r,a){Object(En.a)(e,"Person_SeeProfile_Click",{eventScope:ui,cardType:t,clientSize:n,traceId:a,isHero:!0},r)}(a,s,o,e,c)},logPersonChatClick:function(e,t){!function(e,t,n,r,a,i,o){Object(En.c)(e,"Person_SeeTeamsChat_Click",t,{cardType:r,clientSize:a,eventScope:ui,traceId:i,isHero:o},n)}(a,e,t,s,o,c,!0)},livePersonaCard:m,getProfilePhotoUrlFromClient:f,isTeamsChatFeatureEnabled:y,intent:r};return i.createElement("div",null,i.createElement(lo,so({},O)))};uo.displayName="HeroPersonTileContainer",function(e){e.OutOfRoutine="OutOfRoutine",e.Quorum="Quorum",e.Conflicts="Conflicts"}(ro||(ro={})),function(e){e.FileAttachment="FileAttachment",e.RelatedEmail="RelatedEmail",e.RelatedFile="RelatedFile"}(ao||(ao={})),function(e){e.ClassicAttachment="ClassicAttachment",e.ReferenceAttachment="ReferenceAttachment"}(io||(io={})),function(e){e.Implicit="Implicit",e.Explicit="Explicit"}(oo||(oo={}));var mo=10;Object(Ce.a)(function(e,t){var n=(new Date).getTime()/1e3,r=n+86400,a=Object(R.a)(e,function(e){return e.meetingStart>=n&&e.meetingStart<r});return Object(K.a)(t?a:e,function(e){var t,n=e.meetingSubject,r=e.meetingStart,a=e.meetingEnd,i=e.meetingLocation,o=e.id;return{subject:n,start:Object(Sr.b)(r),end:Object(Sr.b)(a),location:i,url:(t=o,"https://outlook.office.com/calendar/deeplink/read/"+(t=encodeURIComponent(t)))}})});function po(e,t){return void 0===t&&(t=mo),Object(jn.a)(e,t)}function ho(e,t,n){var r=(new Date).getTime()/1e3;return n?"Canceled":r+15*Or.h/Or.u<e?"Pre":r>t?"Post":"During"}function fo(e){var t=Object(vr.b)();return[t.january,t.february,t.march,t.april,t.may,t.june,t.july,t.august,t.september,t.october,t.november,t.december][Object(Sr.b)(e).getMonth()]}var go=n(255),bo=(Object(De.declareString)("search-components-calendar.search.calendar.edit")),vo=((Object(De.declareString)("search-components-calendar.search.calendar.cancel")),(Object(De.declareString)("search-components-calendar.search.calendar.deleteAppointment")),(Object(De.declareString)("search-components-calendar.search.calendar.reply"))),yo=(Object(De.declareString)("search-components-calendar.search.calendar.replyAll")),Oo=(Object(De.declareString)("search-components-calendar.search.calendar.forward")),jo=(Object(De.declareString)("search-components-calendar.search.calendar.scheduleNextMeeting")),So=(Object(De.declareString)("search-components-calendar.search.calendar.rsvp")),xo=(Object(De.declareString)("search-components-calendar.search.calendar.yes")),Co=(Object(De.declareString)("search-components-calendar.search.calendar.no")),ko=(Object(De.declareString)("search-components-calendar.search.calendar.maybe")),Eo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.duringOthersEvent")),wo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventStartingSoon")),To=(Object(De.declareString)("search-components-calendar.search.calendar.duringYourEvent")),Io=(Object(De.declareString)("search-components-calendar.search.calendar.eventStartingSoon")),Po=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersPastEvent")),No=(Object(De.declareString)("search-components-calendar.search.calendar.yourPastEvent")),Ao=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersCanceledEvent")),Fo=(Object(De.declareString)("search-components-calendar.search.calendar.yourCanceledEvent")),Do=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.yourEventInMinutes")),Lo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventInMinutes")),Ro=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.yourEventInDays")),Ho=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventInDays")),Wo=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventToday")),Mo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventToday")),Bo=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventTomorrow")),zo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventTomorrow")),_o=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventNextWeek")),Uo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventNextWeek")),qo=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventLaterThisMonth")),Ko=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventLaterThisMonth")),Vo=(Object(De.declareString)("search-components-calendar.search.calendar.yourUpcomingEvent")),Qo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersUpcomingEvent")),Yo=(Object(De.declareString)("search-components-calendar.search.calendar.happeningNow")),Go=(Object(De.declareString)("search-components-calendar.search.calendar.startingSoon")),$o=(Object(De.declareString)("search-components-calendar.search.calendar.numberOfConflicts")),Jo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.calendarEventListItemAriaLabel")),Zo=(Object(De.declareString)("search-components-calendar.search.calendar.recurring")),Xo=(Object(De.declareString)("search-components-calendar.search.calendar.hasAttachments")),ec=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingLocationWithLabel")),tc=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.conflictNameString")),nc=(Object(De.declareString)("search-components-calendar.search.calendar.noConflictsString")),rc=(Object(De.declareString)("search-components-calendar.search.calendar.outOfRoutine")),ac=((Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingAcceptanceRateString")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingAcceptanceString")),(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.acceptedAttendeeCountString"))),ic=(Object(De.declareString)("search-components-calendar.search.calendar.acceptedAttendeeNoResponse")),oc=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.additionConflictNumberString")),cc=(Object(De.declareString)("search-components-calendar.search.calendar.preReadsTitle")),lc=(Object(De.declareString)("search-components-calendar.search.calendar.relatedContentSuggestion")),sc=(Object(De.declareString)("search-components-calendar.search.calendar.editRsvpButtonLabel")),uc=(Object(De.declareString)("search-components-calendar.search.calendar.noMeetingSubject"));function dc(e){var t=Object(vr.b)();return[t.sundayShort,t.mondayShort,t.tuesdayShort,t.wednesdayShort,t.thursdayShort,t.fridayShort,t.saturdayShort][Object(Sr.b)(e).getDay()]}function mc(e,t,n,r){var a,i,o=new Date,c=o.getTime()/1e3,l=Object(Sr.b)(e),s=e-c,u=(i=o,(a=l).setHours(0,0,0,0),i.setHours(0,0,0,0),(a.getTime()-i.getTime())/Or.c),d=o.getDay()||7;if(s<Or.e/Or.u){var m=s*Or.u/Or.h;return t?Do({minutes:Math.ceil(m).toString()}):Lo({name:n,minutes:Math.ceil(m).toString()})}return r===o.getDate()?t?Wo():Mo({name:n}):Object(Sr.p)(o,l)?t?Bo():zo({name:n}):u<=Or.w/Or.c?t?Ro({days:Math.ceil(u).toString()}):Ho({name:n,days:Math.ceil(u).toString()}):u<=2*Or.w/Or.c-d?t?_o():Uo({name:n}):l.getMonth()===o.getMonth()?t?qo():Ko({name:n}):t?Vo():Qo({name:n})}function pc(e,t,n){return{key:"no",text:Co(),iconProps:{iconName:go.f},onClick:function(){n(e,"Decline").then(function(e){e&&t("Declined")})}}}function hc(e,t,n){return{key:"maybe",text:ko(),iconProps:{iconName:go.h},onClick:function(){n(e,"Tentative").then(function(e){e&&t("TentativelyAccepted")})}}}function fc(e,t,n){return{key:"yes",text:xo(),iconProps:{iconName:go.d},onClick:function(){n(e,"Accept").then(function(e){e&&t("Accepted")})}}}function gc(e,t,n,r){var a=[];switch(t){case"Accepted":a.push(pc(e,n,r)),a.push(hc(e,n,r));break;case"Declined":a.push(fc(e,n,r)),a.push(hc(e,n,r));break;case"TentativelyAccepted":a.push(fc(e,n,r)),a.push(pc(e,n,r));break;case"None":case"NotResponded":case"Organizer":a.push(fc(e,n,r)),a.push(pc(e,n,r)),a.push(hc(e,n,r));break;default:return Object(s.a)(t)}return{items:a}}function bc(e){switch(e){case"Accepted":return xo();case"TentativelyAccepted":return ko();case"Declined":return Co();case"NotResponded":case"None":case"Organizer":return So();default:return Object(s.a)(e)}}function vc(e){return e>2}function yc(e){return Object(pa.a)($o().replace(go.a,String(e)),e)}function Oc(e,t){return Object(L.a)(e)?t?hi():"":e}var jc=function(e,t){var n,r=e.meetingStart,a=e.meetingEnd,i=e.isCanceled,o=e.insights,c=null===(n=Object(R.a)(o,function(e){return e.Type===ro.Conflicts})[0])||void 0===n?void 0:n.Source,l=ho(r,a,!!i),s=(new Date).getTime()/1e3,u=c&&!c.ConflictFetchFailed?c.ConflictingEvents.length:0;return{meetingInfoString:"During"===l?s<r?Go():Yo():t&&0===u?"":yc(u),eventScenario:l}},Sc=function(e){return Object(L.a)(e.seriesMasterId)?"":Zo()},xc=function(e){return e.hasAttachments?Xo():""};function Cc(e,t,n){var r,a,i,o=e.insights;if(o){var c=null===(r=Object(R.a)(o,function(e){return e.Type===ro.Conflicts})[0])||void 0===r?void 0:r.Source;if(c&&!c.ConflictFetchFailed&&!Object(L.a)(c.ConflictingEvents)){var l=e.id,s=e.hexItemId,u=e.joinOnlineMeetingUrl,d=e.meetingEnd,m=e.meetingStart,p={itemId:l,hexItemId:s,itemIndex:n,onlineMeetingUrl:u,startTime:new Date(1e3*m).toISOString(),endTime:new Date(1e3*d).toISOString()},h=null==t?void 0:t.onConflictClick,f=h?function(e){null==e||e.stopPropagation(),h(p)}:void 0;return{insightType:ro.Conflicts,text:yc(c.ConflictingEvents.length),iconName:go.i,onClick:f,onKeyPress:function(e){f&&Ae(e,f)}}}var g=null===(a=Object(R.a)(o,function(e){return e.Type===ro.OutOfRoutine})[0])||void 0===a?void 0:a.Source;if(g&&g.IsOutOfRoutine)return{insightType:ro.OutOfRoutine,text:rc(),iconName:go.k};var b=null===(i=Object(R.a)(o,function(e){return e.Type===ro.Quorum})[0])||void 0===i?void 0:i.Source;return b&&b.AcceptedAttendeesCount&&b.AcceptedAttendeesCount>0?{insightType:ro.Quorum,text:ac({acceptedCount:b.AcceptedAttendeesCount.toString()}),iconName:go.l}:c&&!c.ConflictFetchFailed&&Object(L.a)(c.ConflictingEvents)?{insightType:ro.Conflicts,text:nc(),iconName:go.i}:void 0}}var kc="Calendar";var Ec,wc=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},Tc=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};function Ic(e,t,n,r,a,i,o,c,l){var s=this,u=null==l?void 0:l.rsvpEvent,d=u&&t?function(t,n){return wc(s,void 0,void 0,function(){return Tc(this,function(r){switch(r.label){case 0:return function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_RSVPItem_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),[4,u(t,n)];case 1:return[2,r.sent()]}})})}:void 0,m=null==l?void 0:l.forwardEvent,p=m&&n?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_Forward_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),m(t)}:void 0,h=null==l?void 0:l.editEvent,f=h&&r?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_Edit_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),h(t)}:void 0,g=null==l?void 0:l.reply,b=g&&a?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_Reply_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),g(t)}:void 0,v=null==l?void 0:l.replyAll,y=v&&a?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_ReplyAll_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),v(t)}:void 0,O=null==l?void 0:l.joinMeeting,j=null==l?void 0:l.openLink,S=O||j?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_Join_Teams_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),O?O(t):j&&t.onlineMeetingUrl&&j(t.onlineMeetingUrl)}:void 0,x=null==l?void 0:l.scheduleNextMeeting,C=x?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_ScheduleNextMeeting_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),x(t)}:void 0,k=null==l?void 0:l.livePersonaCard,E=k?function(e){return k(e)}:void 0,w=null==l?void 0:l.openEvent,T=null==l?void 0:l.onConflictClick,I=T?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_Conflicts_Expand_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),T(t)}:void 0;return{rsvpEvent:d,forwardEvent:p,editEvent:f,reply:b,replyAll:y,joinMeeting:S,scheduleNextMeeting:C,livePersonaCard:E,openEvent:w?function(t){!function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_Event_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex),w(t)}:void 0,dateTimeFormatter:null==l?void 0:l.dateTimeFormatter,getProfilePhotoUrl:null==l?void 0:l.getProfilePhotoUrl,onConflictClick:I,relatedAttachmentClick:function(t){t.accessUrl&&(j?j(t.accessUrl):window.open(t.accessUrl,"_blank"),function(e,t,n,r,a,i,o){Object(En.a)(e,"CalendarEvent_RelatedAttachment_Click",{eventScope:kc,cardType:n,clientSize:r,traceId:a,isHero:i},t,o)}(i,e,"Hero",o,c,!0,t.itemIndex))}}}function Pc(e,t){var n=Object(Sr.b)(e),r=null==t?void 0:t.formatUserTime,a=r?r(n.toISOString()):void 0;return a&&!Object(L.a)(a)?a:ka(n,!1,!0)}function Nc(e,t,n){var r=Object(E.a)(),a=Object(l.b)(),o=Object(ae.a)().clientActionCallbacks,c=i.useState(!1),s=c[0],u=c[1],d=i.useState(!1),m=d[0],p=d[1],h=i.useState(!1),f=h[0],g=h[1],b=i.useState(!1),v=b[0],y=b[1];if(i.useEffect(function(){var e,n,r,a;Promise.all([null===(e=null==o?void 0:o.canEdit)||void 0===e?void 0:e.call(o,t),null===(n=null==o?void 0:o.canForward)||void 0===n?void 0:n.call(o,t),null===(r=null==o?void 0:o.canRsvp)||void 0===r?void 0:r.call(o,t),null===(a=null==o?void 0:o.canReply)||void 0===a?void 0:a.call(o,t)]).then(function(e){u(!!e[0]),p(!!e[1]),g(!!e[2]),y(!!e[3])})},[t]),e)return i.useMemo(function(){return Ic(e,f,m,s,v,r,a,n,o)},[f,m,s,v])}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed",e[e.Pending=2]="Pending"}(Ec||(Ec={}));var Ac=n(123);var Fc=n(251),Dc=3;var Lc=Object(Ce.a)(function(e){var t=e.palette.themeLight;return Object(qe.t)({headerContent:["ms-search-calendarTile-headerContent",{fontSize:14,lineHeight:"24px",verticalAlign:"middle",overflow:"hidden"}],headerIcon:{width:"20px",height:"20px",float:"left",textAlign:"center",borderRadius:"50%",background:t},answerTitle:["ms-search-calendarTile-answerTitle",at,{fontWeight:"400",fontSize:14,paddingLeft:"8.75px"}],profilePhoto:["ms-search-profile-photo",{float:"left"}],boldText:{fontWeight:"600"},row:{display:"flex",flexDirection:"row"}})}),Rc=function(){return(Rc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Hc=function(e){var t=e.heroCalendar,n=e.imageUrl,r=e.coinSize,a=e.livePersonaCard,o=e.onOrganizerProfileClick,c=t.organizer,l=t.meetingStart,u=t.meetingEnd,d=c.email,m=c.fullName,p=t.isOrganizer,h=t.isCanceled;p=!!p,h=!!h;var f=Object(Sr.b)(l).getDate(),g=function(e){return e.split(" ")[0]}(m),b=function(e,t,n,r,a){var i=(new Date).getTime()/1e3;if(t)switch(e){case"Canceled":return Fo();case"Post":return No();case"During":return i<n?Io():To();case"Pre":return mc(n,t,r,a);default:return Object(s.a)(e)}else switch(e){case"Canceled":return Ao({name:r});case"Post":return Po({name:r});case"During":return i<n?wo({name:r}):Eo({name:r});case"Pre":return mc(n,t,r,a);default:return Object(s.a)(e)}}(ho(l,u,h),p,l,m,f).split(m),v=i.useMemo(function(){return $e(a,m,d)},[a,m,d]),y={imageUrl:oa(n)?n:void 0,coinSize:r,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(ca.a)(m,!1),initialsColor:Object(la.a)({text:m})},O=je(),j=Lc(O),S=i.createElement("div",{className:j.profilePhoto,role:a?"button":void 0,onClick:a?function(){return null==o?void 0:o(t)}:void 0,onKeyPress:a?function(){return null==o?void 0:o(t)}:void 0},i.createElement(sa.a,Rc({},y))),x=v?i.createElement(v,null,S):S,C=i.createElement("span",{className:j.boldText,role:a?"button":void 0,onClick:a?function(){return null==o?void 0:o(t)}:void 0,onKeyPress:a?function(){return null==o?void 0:o(t)}:void 0},g),k=v?i.createElement(v,null,C):C;return i.createElement("div",{className:j.headerContent,title:bi({preOrganizerNameText:b[0],organizerName:p?"":g,postOrganizerNameText:b[1]})},i.createElement("div",{className:j.row},x,i.createElement("div",{className:j.answerTitle},b[0],!p&&k,b[1])))},Wc=n(508),Mc=n(520),Bc="ms-search-calendarTile-joinButton-root",zc=Object(Ce.a)(function(e){return Object(qe.t)({root:{marginRight:"auto",padding:"8px 0px 8px "+(e?12:24)+"px"}})}),_c=Object(Ce.a)(function(e){return Object(qe.t)({root:{position:"relative",float:"right",padding:"8px "+(e?14:24)+"px 8px 0px"}})}),Uc=Object(Ce.a)(function(e,t){var n=e.palette,r=n.themePrimary,a=n.neutralPrimary;return Object(qe.t)({body:["ms-search-heroCalender-entity-classname",{cursor:"pointer",overflow:"hidden",margin:"0 0.8px"}],mailActionIcon:{color:r,paddingLeft:"6px"},meetingTitle:[at,{color:a,display:"inline-block",fontSize:"17px",fontWeight:"600",height:"24px",lineHeight:"22px",textDecoration:t?"line-through":"none"}],meetingTime:[{maxWidth:"100%",maxHeight:"40px",margin:"0 auto",fontSize:"14px",lineHeight:"20px",overflow:"hidden",textOverflow:"ellipsis"}],meetingVenue:[at,{fontSize:"12px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",height:"20px",lineHeight:"20px"}],dateContainer:[{width:"100%",textAlign:"center",fontSize:"17px",fontWeight:"600",color:a}],monthNameContainer:[at,{width:"100%",textAlign:"center",fontSize:"14px",color:a}],leftContainer:{width:"28px",float:"left",paddingRight:"15px"},rightContainer:{overflow:"hidden"},attachmentIcon:[{fontSize:"14px",lineHeight:"20px"},{float:"right",marginLeft:"auto"}],meetingTitleContainer:{display:"flex",alignItems:"center"}})}),qc=Object(Ce.a)(function(){return Object(qe.t)({root:["ms-search-calendarTile-editButton-root",{borderRadius:"2px"}]})}),Kc=Object(Ce.a)(function(e){var t=e.palette,n=t.themePrimary,r=t.white,a=t.themeDark,i=t.themeDarker;return Object(qe.t)({root:[Bc,{borderRadius:"2px",backgroundColor:n,padding:"0px 4px 0px 4px",minWidth:"80px",height:"32px",marginLeft:"0px",selectors:{":hover":{backgroundColor:a},":active":{backgroundColor:i}}}],label:{color:r,height:"20px",minWidth:"26px",width:"auto",lineHeight:"20px",margin:"6px 12px 6px 4px"},icon:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"},iconHovered:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"},iconPressed:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"}})}),Vc=Object(Ce.a)(function(e){var t=e.palette,n=t.white,r=t.neutralSecondaryAlt;return Object(qe.t)({root:{borderRadius:"2px",borderColor:r,borderWidth:"1px",border:"solid",backgroundColor:n,padding:"0 8px"},label:{margin:"0px"}})}),Qc=Object(Ce.a)(function(e,t){var n=e.palette,r=n.white,a=n.neutralSecondaryAlt,i=n.neutralPrimary;return Object(qe.t)({root:["ms-search-calendarTile-rsvpButton-root",{borderRadius:"2px",borderColor:a,minWidth:"80px",padding:t?"0px 8px 0px 8px":"0px 12px 0px 12px",backgroundColor:r}],label:{margin:"0px",color:i},menuIcon:{margin:"0px",paddingLeft:"8px",color:i},icon:{margin:"0px",paddingRight:"8px"}})}),Yc=function(){return(Yc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Gc=function(e){var t=e.clientActionItem,n=e.rsvpResponse,r=e.setRsvpResponse,a=e.className,o=e.onRSVPItemClick,c=function(e){switch(e){case"Accepted":return go.d;case"Declined":return go.f;case"TentativelyAccepted":return go.h;case"None":case"NotResponded":case"Organizer":return;default:Object(s.a)(e)}}(n),l=je();if(!o)return null;var u=gc(t,n,r,o),d=u.items;return Object(V.a)(d)>0?i.createElement(Zr.a,{ariaLabel:sc(),onKeyPress:function(e){e.stopPropagation()},text:bc(n),menuProps:Yc(Yc({},u),{className:a}),styles:Qc(l,!!c),iconProps:{iconName:c}}):null};var $c=function(){return($c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var Jc=function(e){var t=e.heroCalendar,n=e.actionCallbacks,a=e.isOrganizer,o=e.eventScenario,c=e.isSmall,l=je(),s=Uc(l).mailActionIcon,u={childrenGap:8},d=t.responseStatus,m=t.requiredAttendees,p=t.id,h=t.joinOnlineMeetingUrl,f=t.hexItemId,g=Object(V.a)(m);d=d||"None";var b=i.useState(d),v=b[0],y=b[1],O=n.joinMeeting,j=n.scheduleNextMeeting,S=n.reply,x=n.replyAll,C=n.editEvent,k=n.forwardEvent,E=n.rsvpEvent,w={itemId:p,hexItemId:f,onlineMeetingUrl:h};return i.createElement(i.Fragment,null,i.createElement(Wc.a,{horizontal:!0,tokens:u,horizontalAlign:"baseline",styles:zc(c)},a&&("Pre"===o||"Canceled"===o)&&C&&i.createElement(Xr.a,{"aria-label":yi(),text:bo(),styles:qc(),onClick:function(){return C(w)}}),"During"===o&&O&&h&&!Object(r.a)(h)&&i.createElement(Mc.a,{"aria-label":vi(),iconProps:{iconName:go.p},styles:Kc(l),onClick:function(){return O(w)}},Oi()),a&&"Post"===o&&j&&i.createElement(Zr.a,{text:jo(),styles:Vc(l),onClick:function(){return j(w)}}),!a&&E&&"Pre"===o&&function(e,t,n,r){var a={clientActionItem:e,rsvpResponse:t,setRsvpResponse:n,onRSVPItemClick:r};return i.createElement(Gc,$c({},a))}(w,v,y,E)),i.createElement(Wc.a,{horizontal:!0,tokens:u,styles:_c(c),horizontalAlign:"end"},!a&&S&&i.createElement(xe.a,{iconProps:{iconName:go.m},className:s,title:vo(),ariaLabel:vo(),onClick:function(){return S(w)}}),vc(g)&&x&&i.createElement(xe.a,{iconProps:{iconName:go.n},className:s,title:yo(),ariaLabel:yo(),onClick:function(){return x(w)}}),k&&i.createElement(xe.a,{iconProps:{iconName:go.g},className:s,title:Oo(),ariaLabel:Oo(),onClick:function(){return k(w)}})))},Zc=function(){return(Zc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Xc=function(e){var t,n=e.heroCalendar,r=e.actionCallbacks,a=e.getMeetingDateTimeText,o=e.imageUrl,c=e.clientSize,l=e.className,s=e.isDismissible,u=e.onOrganizerProfileClick,d=e.setAnswerHeight,m=e.onDismiss,p=n.meetingSubject,h=n.meetingStart,f=n.meetingEnd,g=n.meetingLocation,b=n.id,v=n.hexItemId,y=n.joinOnlineMeetingUrl,O=n.hasAttachments,j={itemId:b,hexItemId:v,itemIndex:-1},S=Object(L.a)(p)?uc():p,x=n.isOrganizer,C=n.isCanceled;x=!!x,C=!!C;var k=ve("HeroCalendarTile",go.q,c),E=k[0],w=k[1],T=null===(t=E.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){T&&d&&d(T)},[T]);var I,P,N,A,F,D,R,H,W,M="Small"===w,B=Object(Sr.b)(h).getDate(),z=fo(h),_=ho(h,f,C),U=Oc(g,!Object(L.a)(y)),q=je(),K=Uc(q,C),V=K.meetingTitle,Q=K.leftContainer,Y=K.rightContainer,G=K.meetingVenue,$=K.meetingTime,J=K.dateContainer,Z=K.monthNameContainer,X=K.body,ee=K.attachmentIcon,te=K.meetingTitleContainer,ne=r.openEvent,re=r.livePersonaCard,ae={heroCalendar:n,imageUrl:o,livePersonaCard:re,onOrganizerProfileClick:u},ie=function(e){e.preventDefault(),Ae(e,function(){return null==ne?void 0:ne(j)})},oe=a(h,f),ce={body:i.createElement("div",{role:"link",tabIndex:0,onClick:function(){return null==ne?void 0:ne(j)},onKeyPress:ie,className:X},i.createElement("div",{className:Q},i.createElement("div",{className:J},B),i.createElement("div",{className:Z,title:z},z)),i.createElement("div",{className:Y},i.createElement("div",{className:te},i.createElement("div",{className:V,title:S},S),O&&i.createElement(nt.a,{iconName:go.e,className:ee})),i.createElement("div",{className:$,title:oe},oe),U&&!Object(L.a)(U)&&i.createElement("div",{className:G,title:U},U))),header:i.createElement(Hc,Zc({},ae)),footer:(W={heroCalendar:n,actionCallbacks:r,isOrganizer:x,eventScenario:_,isSmall:M},!C&&(I=r.rsvpEvent,P=r.forwardEvent,N=r.editEvent,A=r.deleteEvent,F=r.cancelEvent,D=r.reply,R=r.replyAll,H=r.joinMeeting,!(!I&&!P&&!N&&!A&&!F&&!D&&!R&&(!H||"During"!==_||Object(L.a)(y))))&&i.createElement(Jc,Zc({},W))),isSmall:M,styleOverrides:function(){return{cardStyles:M?void 0:"ms-search-maxContent"}},className:l,isDismissible:s,onDismiss:m};return i.createElement("div",{ref:E},i.createElement(et,Zc({},ce)))};Xc.displayName="HeroCalendarTile";var el=n(434),tl=n(505),nl=Object(Ce.a)(function(e,t){var n,r=e.palette,a=r.themePrimary,i=r.neutralLighterAlt,o=r.neutralSecondary;return Object(qe.t)({calendarInsightsActionBlock:["ms-search-calendarInsightsActionBlock",{display:"none",alignItems:"center",cursor:"default",backgroundColor:i,minHeight:"32px"}],insightsIcon:{marginRight:"10px",marginLeft:"12px",minWidth:"26px",height:"20px",lineHeight:"20px",textAlign:"center",color:o,fill:o},rsvpMenuButttonIcon:{selectors:(n={},n["& .ms-ContextualMenu-icon"]={color:o},n)},conflictsInfoContainer:["ms-search-conflictsInfoContainer",at,{fontSize:"14px",lineHeight:"20px"},{display:"flex",paddingRight:"5px",height:"20px",lineHeight:"20px",color:o}],firstConflictName:[at],primaryActionContainer:{marginLeft:"auto"},conflictsInfoLink:{color:a,cursor:t?"pointer":"default"},insightsInfoContainer:[at,{fontSize:"14px",lineHeight:"20px"},{paddingRight:"40px",color:o,width:"175px"}]})}),rl=Object(Ce.a)(function(e,t,n,r){var a,i,o,c,l=r.palette,s=l.white,u=l.neutralDark,d=l.neutralLight,m=l.neutralLighterAlt,p=l.neutralSecondary;return Object(qe.t)({commandbar:{marginLeft:e?"auto":"0px",width:e?"24px":"100%",alignItems:"center",float:"right",padding:"0px",overflow:"hidden",minWidth:"24px",backgroundColor:"transparent",selectors:(a={},a["& .ms-OverflowSet-item"]={alignItems:"center",cursor:"pointer"},a["& .ms-OverflowSet-overflowButton"]={marginLeft:"auto",alignItems:"center",cursor:"pointer",paddingRight:"16px"},a["& .ms-OverflowSet-overflowButton:hover"]={backgroundColor:"transparent"},a["& .ms-OverflowSet-item:first-child"]={marginRight:t?"auto":void 0,marginLeft:t?void 0:"auto"},a["& .ms-OverflowSet-item:last-child"]={paddingRight:"16px"},a["& .ms-CommandBar"]={backgroundColor:"transparent"},a["& .ms-Button--commandBar"]={backgroundColor:"transparent"},a["& .ms-Button--commandBar:hover"]={backgroundColor:"transparent"},a["& .ms-Button--commandBar:active"]={backgroundColor:"transparent"},a["& .ms-Button--commandBar:hover .ms-Button-menuIcon"]={backgroundColor:d},a["& .ms-Button-menuIcon"]={fontSize:"16px",padding:"4px",borderSize:"2px"},a)},primaryActionInsightsContainer:{selectors:(i={},i["& .ms-search-calendarInsightsActionBlock"]={backgroundColor:n?m:s},i["& .ms-search-conflictsInfoContainer"]={width:"189px",marginRight:"20px"},i)},iconButton:{height:"36px",minWidth:"20px",selectors:(o={"&:hover .ms-Button-icon":{color:u,backgroundColor:d,borderRadius:"2px"},"&:active .ms-Button-icon":{color:u}},o["& .ms-Button-icon"]={color:p,fontSize:"16px",margin:"0",padding:"4px"},o["& .ms-ContextualMenu-icon"]={color:p},o)},rsvpMenuIconButton:{selectors:(c={},c["& .ms-ContextualMenu-icon"]={color:p},c)},joinMeetingButton:{marginLeft:"auto"}})}),al=Object(Ce.a)(function(e){var t=e.palette.neutralPrimary;return Object(qe.t)({root:{color:t,padding:"0px"}})}),il=(Object(Ce.a)(function(){return Object(qe.t)({root:{height:"100%",padding:"0px"}})}),Object(Ce.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:["ms-search-calendarTile-commandbarButton-root",{background:t,height:"24px",minWidth:"24px",width:"24px",border:"none"}]})})),ol=Object(Ce.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,float:"right",height:"100%",padding:"0px",width:"100%"}})}),cl=function(){return(cl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ll=function(e){var t=e.meetingItem,n=e.index,r=e.actionCallbacks,a=e.className,o=e.rsvpResponse,l=e.setRsvpResponse,s=t.meetingStart,u=t.meetingEnd,d=t.isCanceled,m=t.insights,p=t.id,h=t.hexItemId,f=t.joinOnlineMeetingUrl,g=t.isOrganizer,b=ho(s,u,!!d),v=je();if("Post"===b)return null;var y={itemId:p,hexItemId:h,itemIndex:n,onlineMeetingUrl:f,startTime:new Date(1e3*s).toISOString(),endTime:new Date(1e3*u).toISOString()},O=null==r?void 0:r.joinMeeting,j=null==r?void 0:r.rsvpEvent,S=null==r?void 0:r.editEvent,x=null==r?void 0:r.onConflictClick,C="During"===b&&O&&!Object(L.a)(f),k=!g&&j&&"Pre"===b,E=!(!g||!S||"Pre"!==b&&"Canceled"!==b),w=nl(v,!!x);if(!Cc(t,r,n)&&!(k||C||E))return null;return i.createElement("div",{className:a},i.createElement("div",{className:w.calendarInsightsActionBlock,role:"presentation",onClick:function(e){return e.stopPropagation()}},function(){var e,t,n;if(!m)return null;var r=x?function(e){null==e||e.stopPropagation(),x(y)}:void 0,a=null===(e=Object(R.a)(m,function(e){return e.Type===ro.Conflicts})[0])||void 0===e?void 0:e.Source;if(a&&!a.ConflictFetchFailed&&!Object(L.a)(a.ConflictingEvents)){var o=tc({conflictName:a.ConflictingEvents[0].Subject}),l=i.createElement(i.Fragment,null,i.createElement("div",{className:w.firstConflictName,title:o},o),a.ConflictingEvents.length>1&&i.createElement("span",null,oc({additionalNumber:(a.ConflictingEvents.length-1).toString()})));return i.createElement(i.Fragment,null,i.createElement(nt.a,{iconName:go.i,className:w.insightsIcon}),r&&i.createElement(c,{role:"button",onClick:r,onKeyPress:function(e){null==e||e.stopPropagation(),r&&Ae(e,r)},className:Ge(w.conflictsInfoContainer,w.conflictsInfoLink)},l),!r&&i.createElement("div",{className:w.conflictsInfoContainer},l))}var s=null===(t=Object(R.a)(m,function(e){return e.Type===ro.OutOfRoutine})[0])||void 0===t?void 0:t.Source;if(s&&s.IsOutOfRoutine)return i.createElement(i.Fragment,null,i.createElement(nt.a,{iconName:go.k,className:w.insightsIcon}),i.createElement("div",{className:w.insightsInfoContainer,title:rc()},rc()));var u=null===(n=Object(R.a)(m,function(e){return e.Type===ro.Quorum})[0])||void 0===n?void 0:n.Source;if(u&&u.AcceptedAttendeesCount){var d=u.AcceptedAttendeesCount>0?ac({acceptedCount:u.AcceptedAttendeesCount.toString()}):ic();return i.createElement(i.Fragment,null,i.createElement(nt.a,{iconName:go.l,className:w.insightsIcon}),i.createElement("div",{className:w.insightsInfoContainer,title:d},d))}if(a&&!a.ConflictFetchFailed&&Object(L.a)(a.ConflictingEvents)){o=nc(),l=i.createElement(i.Fragment,null,i.createElement("div",{className:w.firstConflictName,title:o},o),a.ConflictingEvents.length>1&&i.createElement("span",null,oc({additionalNumber:(a.ConflictingEvents.length-1).toString()})));return i.createElement(i.Fragment,null,i.createElement(nt.a,{iconName:go.i,className:w.insightsIcon}),i.createElement("div",{className:w.conflictsInfoContainer},l))}return null}(),function(){if(!(k||C||E))return null;var e=function(e){e.stopPropagation(),S&&S(y)},t=function(e){e.stopPropagation(),O&&f&&O(y)},n={clientActionItem:y,rsvpResponse:o,setRsvpResponse:l,onRSVPItemClick:j,className:w.rsvpMenuButttonIcon};return i.createElement("div",{className:w.primaryActionContainer},C&&O&&f&&i.createElement(Mc.a,{role:"link","aria-label":vi(),iconProps:{iconName:go.p},styles:Kc(v),onClick:function(e){return t(e)},onKeyPress:function(e){return t(e)}},Oi()),E&&S&&i.createElement(Zr.a,{role:"link","aria-label":yi(),text:bo(),styles:qc(),onClick:function(t){return e(t)},onKeyPress:function(t){return e(t)}}),k&&j&&i.createElement(Gc,cl({},n)))}()))};ll.displayName="CalendarInsightsWithPrimaryAction";var sl=function(){return(sl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ul=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},dl=function(e){var t,n=je(),r=e.heroCalendar,a=e.actionCallbacks,o=e.isMultiEntity,c=e.index,l=e.isSmall,s=e.className,u=e.rsvpResponse,d=e.setRsvpResponse,m=r.id,p=r.joinOnlineMeetingUrl,h=r.hexItemId,f=r.requiredAttendees,g=r.meetingStart,b=r.meetingEnd,v=r.isCanceled,y=r.isOrganizer,O=Object(V.a)(f),j=a.reply,S=a.replyAll,x=a.forwardEvent,C=a.rsvpEvent,k=a.editEvent,E=a.joinMeeting,w=ho(g,b,!!v),T=i.useState(!1),I=T[0],P=T[1],N="During"===w&&E&&!Object(L.a)(p);if(i.useEffect(function(){!N||!o&&l||P(!0)},[]),!(j||S||x||C||N))return null;var A=!!(j||S||x||C),F=o||!l?Cc(r,a,c):void 0;if(F){var D=F.insightType,R=F.text,H=F.onClick,W=F.onKeyPress,M=F.iconName;switch(D){case"Conflicts":t={text:R,key:R,onClick:H,onKeyPress:W,iconProps:{iconName:M,style:{color:n.palette.neutralSecondary}},style:{color:R!==nc()?n.palette.themePrimary:n.palette.neutralSecondary},disabled:!H};break;case"OutOfRoutine":case"Quorum":t={text:R,key:R,disabled:!0,iconProps:{iconName:M}};break;default:t=void 0}t&&(t.commandBarButtonAs=function(e){return i.useEffect(function(){_&&t&&P(!1)},[]),i.createElement(ml,sl({},e,{meetingItem:r,actionCallbacks:a,index:c,rsvpResponse:u,setRsvpResponse:d}))})}var B=!!y&&!!k&&(o||!o&&!l||"During"===w)&&"Post"!==w,z=!y&&!!C&&(o||!o&&!l)&&"Pre"===w||B,_=z&&!!t||!o&&!l&&!!t,U=rl(l,_||z,_,n),q=function(e){e.stopPropagation(),E&&p&&E(K)},K={itemId:m,hexItemId:h,onlineMeetingUrl:p},Q={text:vo(),title:vo(),key:vo(),tooltipHostProps:{content:""},iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==j||j(K)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:go.m},className:U.iconButton},Y={text:yo(),title:yo(),key:yo(),tooltipHostProps:{content:""},iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==S||S(K)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:go.n},className:U.iconButton},G={text:Oo(),title:Oo(),key:Oo(),tooltipHostProps:{content:""},iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==x||x(K)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:go.g},className:U.iconButton},$=C?gc(K,u,d,C):void 0,J=function(e){return _&&t?null:i.createElement(ml,sl({},e,{meetingItem:r,actionCallbacks:a,index:c,rsvpResponse:u,setRsvpResponse:d}))},Z=$?{text:So(),key:So(),subMenuProps:sl(sl({},$),{className:U.rsvpMenuIconButton}),iconProps:{iconName:"Calendar"},commandBarButtonAs:J,className:U.rsvpMenuIconButton}:void 0,X={text:bo(),key:bo(),onClick:function(){null==k||k(K)},onKeyPress:function(e){null==e||e.stopPropagation(),null==k||k(K)},iconProps:{iconName:"Edit",style:{color:n.palette.neutralSecondary}},commandBarButtonAs:J},ee={key:"divider_1",itemType:el.a.Divider,commandBarButtonAs:function(e){return null}};t&&(t.className=U.primaryActionInsightsContainer),(!t||!_&&z)&&(X.className=U.primaryActionInsightsContainer,Z&&(Z.className=U.primaryActionInsightsContainer));var te=ul(ul(ul(ul(ul([],_&&t?[t]:[]),z?B?[X,ee]:Z?[Z,ee]:[]:[]),j&&!y?[Q]:[]),S&&vc(O)&&Y?[Y]:[]),x?[G]:[]),ne=[];return i.createElement(i.Fragment,null,I&&i.createElement(Mc.a,{role:"link","aria-label":vi(),iconProps:{iconName:go.p},styles:Kc(n),onClick:function(e){return q(e)},onKeyPress:function(e){return q(e)},className:Ge(U.joinMeetingButton,s)},Oi()),A&&i.createElement(tl.a,{styles:ol(n),items:l?ne:te,overflowItems:l?te:ne,className:Ge(U.commandbar,s),overflowButtonProps:{menuProps:{items:ne,directionalHint:Wt.a.rightTopEdge,gapSpace:6},menuIconProps:{iconName:"MoreVertical",styles:al(n)},styles:il(n),onKeyPress:function(e){null==e||e.stopPropagation()}},dataDidRender:function(e){e&&0===e.primaryItems.length&&(!N||!o&&l||P(!0))}}))},ml=function(e){var t={meetingItem:e.meetingItem,actionCallbacks:e.actionCallbacks,index:e.index,className:e.className,rsvpResponse:e.rsvpResponse,setRsvpResponse:e.setRsvpResponse};return i.createElement(ll,sl({},t))};dl.displayName="CalendarCommandBar";var pl=Object(Ce.a)(function(e,t){var n,r=e.palette,a=r.white,i=r.neutralLighterAlt,o=r.neutralLighter;return Object(qe.t)({body:["ms-search-calendarBody-ItemContent",{display:t?"block":"flex",overflow:"hidden",marginBottom:"1px",backgroundColor:a,paddingLeft:t?"18px":"35px",paddingTop:"8px",paddingBottom:"8px",paddingRight:"20px",selectors:{"&:hover":{backgroundColor:i}}}],calendarActionContainer:["ms-search-calendarEntity-calendarActionContainer",{display:"none",selectors:(n={},n["& .ms-search-calendarInsightsActionBlock"]={display:"flex",marginLeft:t?"0":"auto",marginRight:t?"0":"206px",maxWidth:t?"undefined":"294px",borderTop:t?"1px solid "+o:void 0,padding:"4px "+(t?"4px":"20px")},n)}],meetingDetailsWithAction:["ms-search-calendarEntity-meetingDetailsWithActions"],calendarCommandBar:["ms-search-calendarEntity-calendarCommandBar",{display:"none",marginLeft:"auto"}]})}),hl=n(504),fl=n(260),gl=Object(Ce.a)(function(e,t){return Object(qe.t)({meetingAttachmentContainer:["ms-search-meeting-attachment-container",{display:"flex",paddingBottom:t?"0":"14px",alignItems:"center"}],shimmer:{width:"75%",marginLeft:t?"0":"17px"},attachmentIcon:{marginLeft:e?"15px":"0"},attachmentsContainer:["ms-search-attachment-container",{marginLeft:t?"0":"17px"}],additionAttachmentData:{display:"inline-block",padding:"6px"}})}),bl=Object(Ce.a)(function(e,t){var n;return Object(qe.t)({root:["ms-search-attachment-button-container",{display:e?"inline-grid":"inline-block",marginRight:t&&e?"3px":"8px",width:e?"80px":"auto",minWidth:e?"75px":"80px",padding:t?"0":"0px 16px",maxWidth:e?void 0:"122px",marginTop:"4px",selectors:(n={},n["& .ms-Button-flexContainer"]={overflow:"hidden"},n)}],label:["ms-search-text-label-container",{noWrapTruncation:at}],textContainer:["ms-search-text-button-container",{overflow:"hidden"}]})}),vl=function(e){var t=e.meetingItem,n=e.isSmall,a=e.meetingArtifactsFetchingStatus,o=e.actionCallbacks,c=e.meetingIndex,l=e.hasInsights,s=t.hasAttachments,u=t.artifacts,d=gl(n,l),m=l&&n?1:2;if(!s||a===Ec.Failed)return null;var p=Object(R.a)(u,function(e){return e.Type===ao.FileAttachment});if(a===Ec.Success&&Object(r.a)(p))return null;var h;return i.createElement("div",{className:d.meetingAttachmentContainer,role:"presentation",onClick:function(e){return e.stopPropagation()}},!l&&i.createElement(nt.a,{iconName:go.e,className:d.attachmentIcon}),a===Ec.Pending&&i.createElement(hl.a,{className:d.shimmer}),a===Ec.Success&&i.createElement("div",{className:d.attachmentsContainer},(h=p.slice(0,m),i.createElement(i.Fragment,null,Object(K.a)(h,function(e,t){var r=e.Source,a=Object(fl.getFileTypeIconProps)({extension:r.FileExtension,size:16}),s=function(e){var t;null==e||e.stopPropagation();var n={accessUrl:r.Url,itemIndex:c};null===(t=null==o?void 0:o.relatedAttachmentClick)||void 0===t||t.call(o,n)};return i.createElement(Zr.a,{iconProps:a,styles:bl(n,l),title:r.Title,onClick:s,onKeyPress:function(e){e.stopPropagation(),"Enter"!==e.key&&" "!==e.key||s(e)},key:t},r.Title)}),p.length>m&&i.createElement("div",{className:d.additionAttachmentData},oc({additionalNumber:(p.length-m).toString()}))))))},yl=Object(Ce.a)(function(e,t){var n=e.palette.neutralPrimary;return Object(qe.t)({meetingDateDayContainer:["ms-search-meetingDateDayContainer",{width:"28px",float:"left",marginRight:t?"22px":"16px"}],monthNameContainer:["ms-search-calendarTile-meetingMonth",{fontSize:"14px",lineHeight:"20px"},at,{color:n,width:"100%",textAlign:"center"}],dateContainer:["ms-search-calendarTile-meetingDate",{fontSize:"17px",fontWeight:"600"},{width:"100%",textAlign:"center",color:n}]})}),Ol=function(e){var t=e.startDate,n=e.startMonth,r=e.isSmall,a=je(),o=yl(a,r),c=o.meetingDateDayContainer,l=o.dateContainer,s=o.monthNameContainer;return i.createElement("div",{className:c},i.createElement("div",{className:l},t),i.createElement("div",{className:s,title:n},n))},jl=Object(Ce.a)(function(e,t){var n=e.palette,r=n.neutralLighterAlt,a=n.neutralPrimary;return Object(qe.t)({actionBlockContainer:["ms-search-calender-actionblock-content-classname",{backgroundColor:r,borderRadius:"4px",height:"40px",lineHeight:"40px",display:"flex",marginTop:"5px",width:t?"auto":"294px",maxWidth:"294px",alignItems:"center"}],actionContainer:{marginLeft:"auto",marginRight:"4px",display:"flex"},conflictInfoIcon:["ms-search-conflict-info-classname",{fontSize:"14px",lineHeight:"20px"},{color:a,margin:"0 13px 0 15px"}],conflictData:[at,{fontSize:"14px",lineHeight:"20px"},{color:a}]})}),Sl=function(){return(Sl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},xl=function(e){var t,n=e.meetingItem,r=e.actionCallbacks,a=e.index,o=e.isSmall,c=n.joinOnlineMeetingUrl,l=n.isOrganizer,s=n.id,u=n.hexItemId,d=n.insights,m={itemId:s,hexItemId:u,itemIndex:a,onlineMeetingUrl:c},p=n.responseStatus||"None",h=i.useState(p),f=h[0],g=h[1],b=je(),v=jl(b,o),y=v.actionBlockContainer,O=v.conflictInfoIcon,j=v.conflictData,S=v.actionContainer,x=null==r?void 0:r.joinMeeting,C=null==r?void 0:r.rsvpEvent,k=null==r?void 0:r.editEvent,E=null===(t=Object(R.a)(d,function(e){return e.Type===ro.Conflicts})[0])||void 0===t?void 0:t.Source,w=E&&!E.ConflictFetchFailed,T=jc(n),I=T.meetingInfoString,P=T.eventScenario,N="During"===P&&x&&!Object(L.a)(c),A=!l&&C&&"Pre"===P,F=!(!l||!k||"Pre"!==P&&"Canceled"!==P);if(!w)return null;if(!(A||N||F))return null;var D=function(e){e.stopPropagation(),k&&k(m)},H=function(e){e.stopPropagation(),x&&c&&x(m)},W={clientActionItem:m,rsvpResponse:f,setRsvpResponse:g,onRSVPItemClick:C};return i.createElement("div",{className:y},i.createElement(nt.a,{className:O,iconName:go.i}),i.createElement("div",{className:j,title:I},I),i.createElement("div",{className:S},N&&x&&c&&i.createElement(Mc.a,{role:"link","aria-label":vi(),iconProps:{iconName:go.p},styles:Kc(b),onClick:function(e){return H(e)},onKeyPress:function(e){return H(e)}},Oi()),F&&k&&i.createElement(Xr.a,{role:"link","aria-label":yi(),text:bo(),styles:qc(),onClick:function(e){return D(e)},onKeyPress:function(e){return D(e)}}),A&&C&&i.createElement(Gc,Sl({},W))))};xl.displayName="MeetingActionBlock";var Cl=Object(Ce.a)(function(e,t,n){var r=e.palette,a=r.neutralPrimary,i=r.themePrimary;return Object(qe.t)({meetingDetailsContainer:["ms-search-calender-meeting-detail-content-classname",{overflow:"hidden",display:t?"block":"flex"}],meetingTitleContainer:[{fontSize:"14px",lineHeight:"20px"},{display:"flex",width:t?"auto":"235px",minWidth:t?"auto":"235px",paddingRight:t?"0px":"25px",height:"22px",alignItems:"center",color:a}],moreDetailsContainer:["ms-search-calendarTile-moreDetailsContainer",{overflow:"hidden",width:t?void 0:"100%"}],meetingTitle:["ms-search-calendarTile-meetingTitle",at,{fontWeight:"600",textDecoration:n?"line-through":"none"}],meetingTimeContainer:{display:"flex"},meetingTime:["ms-search-calendarTile-meetingTime",at,{fontSize:"14px",lineHeight:"20px"},{maxHeight:"40px",whiteSpace:"nowrap",display:"inline-block"}],meetingVenue:["ms-search-meeting-venue-classname",at,{fontSize:"14px",lineHeight:"20px"},{display:"inline-block",height:"20px",marginLeft:t?"0px":"16px"}],moreDetails:["ms-search-calender-moredetail-content-classname",{display:t?"block":"flex",overflow:"hidden"}],attachmentIcon:["ms-search-calendarTile-attachmentIcon",{fontSize:"14px",lineHeight:"20px"},{float:"right",marginLeft:"auto"}],recurringIcon:[{fontSize:"14px",lineHeight:"20px"},{padding:"0 8px",verticalAlign:"middle"}],insightsIcon:["ms-search-calendarTile-insightsIcon",{display:"none",color:i,marginLeft:"4px",fontWeight:"600"}]})}),kl=function(){return(kl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},El=function(e){var t=e.meetingItem,n=e.meetingDayTimeText,r=e.isSmall,a=e.actionCallbacks,o=e.index,c=e.showActionsInBody,l=e.hasRelatedEmailArtifacts,s=e.meetingArtifactsFetchingStatus,u=e.hasInsights,d=t.meetingSubject,m=t.joinOnlineMeetingUrl,p=t.hasAttachments,h=t.isCanceled,f=t.seriesMasterId,g=t.meetingLocation,b=t.meetingStart,v=t.meetingEnd,y=je(),O=Cl(y,r,h),j=Object(L.a)(d)?uc():d,S=ho(b,v,!!h),x=O.meetingDetailsContainer,C=O.meetingTitle,k=O.meetingTime,E=O.meetingVenue,w=O.moreDetails,T=O.attachmentIcon,I=O.meetingTitleContainer,P=O.moreDetailsContainer,N=O.recurringIcon,A=O.meetingTimeContainer,F=O.insightsIcon,D=Oc(g,!Object(L.a)(m)),R={meetingItem:t,actionCallbacks:a,index:o,isSmall:r};return i.createElement("div",{className:x},i.createElement("div",{className:I},i.createElement("div",{className:C,title:j},j),l&&i.createElement(nt.a,{iconName:go.j,className:F,title:l?"Post"===S?lc():cc():void 0}),p&&i.createElement(nt.a,{iconName:go.e,className:T})),i.createElement("div",{className:P},i.createElement("div",{className:w},i.createElement("div",{className:A},i.createElement("div",{className:k,title:n},n),!Object(L.a)(f)&&i.createElement(nt.a,{className:N,iconName:go.o})),D&&!Object(L.a)(D)&&i.createElement("div",{className:E,title:D},D)),!c&&i.createElement(xl,kl({},R)),(u||!r)&&i.createElement(vl,{meetingItem:t,isSmall:r,meetingArtifactsFetchingStatus:s,actionCallbacks:a,hasInsights:u})))};El.displayName="MeetingDetails";var wl=function(){return(wl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Tl=function(e){var t,n=e.meetingItem,r=e.isSmall,a=e.maxMeetingsToDisplay,o=e.index,c=e.showActionsInBody,l=e.meetingArtifactsFetchingStatus,s=e.getMeetingDateTimeText,u=e.useCalendarCallbacks,d=e.hasInsights,m={itemId:n.id||"",hexItemId:n.hexItemId||"",itemIndex:o},p=u(n,m),h=null==p?void 0:p.openEvent,f=n.meetingStart,g=n.meetingEnd,b=n.meetingSubject,v=n.meetingLocation,y=n.joinOnlineMeetingUrl,O=n.artifacts,j=Object(Sr.b)(f).getDate(),S=fo(f),x=n.responseStatus||"None",C=i.useState(x),k=C[0],E=C[1],w=je(),T=pl(w,r),I={startDate:j,startMonth:S,isSmall:r},P=s(f,g),N=Object(L.a)(b)?uc():b,A={meetingItem:n,meetingDayTimeText:P,isSmall:r,showActionsInBody:c,actionCallbacks:p,index:o,hasRelatedEmailArtifacts:l===Ec.Success&&Object(R.a)(O,function(e){return e.Type===ao.RelatedEmail||e.Type===ao.RelatedFile}).length>0,meetingArtifactsFetchingStatus:l,hasInsights:d},F=jc(n).meetingInfoString,D=Oc(v,!Object(L.a)(y)),H=Jo({meetingName:N,startDate:j.toString(),startMonth:S,meetingDayTimeText:P,meetingLocation:Object(L.a)(D)?"":ec({meetingLocation:D}),recurringText:Sc(n),attachmentText:xc(n),additionalMeetingInfo:F}),W=a>1,M={meetingItem:n,actionCallbacks:p,index:o,className:T.calendarActionContainer,rsvpResponse:k,setRsvpResponse:E};return p&&(t={heroCalendar:n,actionCallbacks:p,isSmall:r,isMultiEntity:W,index:o,className:T.calendarCommandBar,setRsvpResponse:E,rsvpResponse:k}),i.createElement(i.Fragment,null,i.createElement("div",{className:T.body,role:"listitem",onClick:function(){return null==h?void 0:h(m)},onKeyPress:function(e){e.preventDefault(),Ae(e,function(){return null==h?void 0:h(m)})},tabIndex:h?0:-1,"aria-label":H,"aria-posinset":o+1,"aria-setsize":a},i.createElement(Ol,wl({},I)),i.createElement("div",{className:T.meetingDetailsWithAction},i.createElement(El,wl({},A)),r&&t&&i.createElement(dl,wl({},t))),!d&&r&&i.createElement(vl,{meetingItem:n,isSmall:r,meetingArtifactsFetchingStatus:l,actionCallbacks:p}),!r&&t&&i.createElement(dl,wl({},t))),!W&&r&&i.createElement(ll,wl({},M)))};Tl.displayName="CalendarEntity";var Il=Object(Ce.a)(function(e,t,n){var r,a=e.palette,i=a.neutralLight,o=a.white;return Object(qe.t)({calendarListItem:["ms-search-calendarListItem",{selectors:(r={},r["& .ms-search-calendarBody-ItemContent"]={borderBottom:t?"":"1px solid "+i,padding:"8px "+(n?"12px":"20px"),paddingBottom:"8px"},r["& .ms-search-calendarBody-ItemContent:hover"]={backgroundColor:o},r)}]})}),Pl=Object(Ce.a)(function(e,t,n){var r,a=n.palette,i=a.neutralLight,o=a.neutralQuaternaryAlt;return Object(qe.t)({calendarContainer:{selectors:(r={},r["& .ms-search-calender-moredetail-content-classname"]={display:"flex",flexDirection:"column"},r["& .ms-search-meeting-venue-classname"]={marginLeft:"0px"},r["& .ms-search-calendarEntity-calendarActionContainer"]={display:"block"},r["& .ms-search-calender-actionblock-content-classname"]={display:"none"},r["& .ms-search-calendarEntity-calendarCommandBar"]={display:"block"},r["& .ms-search-calendarTile-attachmentIcon"]={display:"none"},r["& .ms-search-calendarEntity-meetingDetailsWithActions"]={display:"flex"},r["& .ms-search-heroTile-headerContainer"]={display:e?void 0:"block"},r["& .ms-search-heroTile-bodyContainer"]={padding:"0px"},r["& .ms-search-tileHeader"]={margin:"0px",padding:"8px "+(t?"12px":"20px")},r["& .ms-search-tileBody"]={margin:"0px",padding:"0px"},r["& .ms-search-calendarTile-rsvpButton-root"]={border:"none",backgroundColor:i,borderRadius:"4px"},r["& .ms-search-calendarTile-rsvpButton-root:hover"]={backgroundColor:o,borderRadius:"4px"},r["& ."+Bc]={borderRadius:"4px"},r["& ."+Bc+":hover"]={borderRadius:"4px"},r["& .ms-search-calendarTile-commandbarButton-root"]={borderRadius:"4px"},r["& .ms-search-calendarTile-commandbarButton-root:hover"]={borderRadius:"4px"},r["& .ms-search-heroCalender-entity-classname"]={margin:"0px"},r["& .ms-search-calendarTile-editButton-root"]={border:"none",borderRadius:"4px",backgroundColor:i},r["& .ms-search-calendarTile-editButton-root:hover"]={backgroundColor:o,borderRadius:"4px"},r["& .ms-search-calendarTile-moreDetailsContainer"]={width:t?void 0:"337px"},r["& .ms-search-calendarTile-insightsIcon"]={display:"inline-block"},r["& .ms-search-calendarInsightsActionBlock"]={display:"flex"},r["& .ms-search-calender-meeting-detail-content-classname"]={marginRight:t?"10px":"0"},r["& .ms-search-meetingDateDayContainer"]={marginRight:t?"12px":"16px"},r)},multiEntityCalendarHeader:["ms-search-CalendarTile-multiEntityHeader",at,{fontWeight:"600",fontSize:14}],tileHeaderOverride:["ms-search-tileHeader"],tileBodyOverride:["ms-search-tileBody"]})}),Nl=function(){return(Nl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Al=function(e){var t=e.meetingList,n=e.meetingItem,r=e.isSmall,a=e.index,o=e.maxMeetingsToDisplay,c=e.showActionsInBody,l=e.meetingArtifactsFetchingStatus,s=e.getMeetingDateTimeText,u=e.useCalendarCallbacks,d=je(),m=Uc(d,null==n?void 0:n.isCanceled),p=Il(d,a===Object(V.a)(t)-1,r),h={meetingItem:n,isSmall:r,index:a,maxMeetingsToDisplay:o,showActionsInBody:c,meetingArtifactsFetchingStatus:l,getMeetingDateTimeText:s,useCalendarCallbacks:u,hasInsights:!0};return i.createElement("div",{className:Ge(p.calendarListItem,m.body)},i.createElement(Tl,Nl({},h)))};Al.displayName="CalendarEntityWithInsights";var Fl=function(){return(Fl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Dl=function(e){var t=e.meetingList,n=e.isSmall,r=e.hasInsights,a=e.meetingArtifactsFetchingStatus,o=e.getMeetingDateTimeText,c=e.useCalendarCallbacks;return i.createElement("div",{role:"list"},Object(K.a)(t,function(e,l){var s={meetingItem:e,isSmall:n,index:l,maxMeetingsToDisplay:t.length,showActionsInBody:!!r&&n,meetingArtifactsFetchingStatus:r?a:Ec.Failed,getMeetingDateTimeText:o,useCalendarCallbacks:c};return r?i.createElement(Al,Fl({},s,{meetingList:t,key:l})):i.createElement(Tl,Fl({},s,{key:l}))}))};Dl.displayName="CalendarTileBody";var Ll=function(){return(Ll=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Rl=function(e){var t=e.meetingList,n=e.calendarWithInsightsDesignStyles,r=e.headingLevel,a=e.imageUrl,o=e.livePersonaCard,c=e.onOrganizerProfileClick;if(Object(V.a)(t)>1)return i.createElement("div",{className:n.multiEntityCalendarHeader,role:"heading","aria-level":r},fi());var l={heroCalendar:t[0],imageUrl:a,livePersonaCard:o,onOrganizerProfileClick:c};return i.createElement(Hc,Ll({},l))};Rl.displayName="CalendarTileHeader";var Hl=function(){return(Hl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Wl=function(e){var t,n=e.meetingList,r=e.getMeetingDateTimeText,a=e.clientSize,o=e.getClientSizeCallback,c=e.getCalendarAnswerStyleOverrides,l=e.useCalendarCallbacks,s=e.setAnswerHeight,u=e.imageUrl,d=e.onOrganizerProfileClick,m=e.onDismiss,p=e.livePersonaCard,h=e.isDismissible,f=e.className,g=e.hasInsights,b=e.headingLevel,v=e.meetingArtifactsFetchingStatus,y=je(),O=e.maxMeetingsToShow||go.b,j=po(n,O),S=ve("HeroMultiEntityCalendarTile",go.q,a,o),x=S[0],C=S[1],k=null===(t=x.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){k&&s&&s(k)},[k]);var E="Small"===C,w=Pl(!!h,E,y),T=void 0;c&&(T=c(y,E).heroTileWrapper);if(Object(L.a)(n))return null;var I,P,N={body:(P={meetingList:j,isSmall:E,hasInsights:g,meetingArtifactsFetchingStatus:v,getMeetingDateTimeText:r,useCalendarCallbacks:l},i.createElement(Dl,Hl({},P))),header:(I={meetingList:n,calendarWithInsightsDesignStyles:w,headingLevel:b,imageUrl:u,livePersonaCard:p,onOrganizerProfileClick:d},i.createElement(Rl,Hl({},I))),isSmall:E,styleOverrides:function(){return{cardStyles:w.calendarContainer,headerStyles:w.tileHeaderOverride,bodyStyles:w.tileBodyOverride}},isDismissible:h,onDismiss:m,className:Ge(f,T)};return i.createElement("div",{ref:x},i.createElement(et,Hl({},N)))};Wl.displayName="HeroCalendarTileCard";var Ml=Object(Ce.a)(function(e,t){var n=e.palette.neutralLighterAlt;return Object(qe.t)({resultTypeDescription:[{fontSize:"14px",lineHeight:"20px"},{fontWeight:600,backgroundColor:n,height:"40px",display:"flex",alignItems:"center",paddingLeft:t?"52px":"72px",paddingRight:"12px",marginBottom:"1px"}]})}),Bl=function(e){var t=e.resultType,n=e.className,r=e.isSmall,a=e.headingLevel,o=je(),c=Ml(o,r).resultTypeDescription;return i.createElement("div",{className:n},i.createElement("div",{className:c,role:"heading","aria-level":a},function(e){switch(e){case"Event":return Me();case"File":return Be();case"People":return ze();default:Object(s.a)(e)}}(t)),e.children)};Bl.displayName="HeroMultiEntityTile";var zl=function(){return(zl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},_l=function(e){var t,n=e.meetingList,r=e.getMeetingDateTimeText,a=e.clientSize,o=e.getClientSizeCallback,c=e.getCalendarAnswerStyleOverrides,l=e.useCalendarCallbacks,s=e.setAnswerHeight,u=e.isDismissible,d=e.className,m=e.hasInsights,p=e.headingLevel,h=e.meetingArtifactsFetchingStatus,f=je(),g=po(n,e.maxMeetingsToShow||go.b),b=ve("HeroMultiEntityCalendarTile",go.q,a,o),v=b[0],y=b[1],O=null===(t=v.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){O&&s&&s(O)},[O]);var j="Small"===y,S=Pl(!!u,j,f),x=void 0;c&&(x=c(f,j).heroTileWrapper);if(Object(L.a)(n))return null;var C;return i.createElement("div",{ref:v},i.createElement(Bl,{resultType:go.c,isSmall:j,headingLevel:p,className:m?Ge(S.calendarContainer,x,d):void 0},(C={meetingList:g,isSmall:j,hasInsights:m,meetingArtifactsFetchingStatus:h,getMeetingDateTimeText:r,useCalendarCallbacks:l},i.createElement(Dl,zl({},C)))))};_l.displayName="HeroMultiEntityCalendarTile";var Ul=Object(Ce.a)(function(e,t){var n,r=e.palette,a=r.neutralSecondary,i=r.neutralLighterAlt,o=r.themeDark,c=r.themeDarker,l=r.neutralDark,s=r.neutralPrimary;return Object(qe.t)({heroTileWrapper:{selectors:(n={},n["& .ms-search-calendarListItem .ms-search-calendarBody-ItemContent"]={padding:"0"},n["& .ms-search-calendarListItem .ms-search-calendarBody-ItemContent:hover"]={backgroundColor:i,cursor:"default"},n["& .ms-search-meeting-venue-classname"]={color:a},n["& ."+Bc]={marginRight:"4px",marginTop:"auto",marginBottom:"auto"},n["& ."+Bc]={margin:"auto 4px auto 0"},n["& ."+Bc+":hover"]={backgroundColor:o},n["& ."+Bc+":active"]={borderRadius:"4px",backgroundColor:c},n["& .ms-search-calendarTile-meetingTitle"]={color:l},n["& .ms-search-calender-meeting-detail-content-classname"]={padding:"12px 12px 12px 0",marginRight:"auto"},n["& .ms-search-meetingDateDayContainer"]={margin:"12px 16px 12px 12px"},n["& .ms-search-calendarTile-meetingTime"]={color:s},n["& .ms-search-calendarTile-moreDetailsContainer"]={width:t?void 0:"285px"},n["& .ms-search-calendarEntity-calendarCommandBar"]={display:t?"flex":"block",marginTop:"auto",marginBottom:"auto"},n)}})}),ql=function(){return(ql=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Kl=function(e){var t,n,r=e.className,a=Object(l.a)(),o=Object(l.b)(),c=Object(u.useSelector)(f.k),s=Object(E.a)(),d=Object(l.h)().additionalAnswerConfigs,m=null==a?void 0:a.setAnswerHeight,p=Object(l.i)(),h=null==d?void 0:d.answerBlockId,g=null==a?void 0:a.livePersonaCard,b=function(e){var t=Object(u.useSelector)(Fc.a),n=Object(E.a)(),r=Object(jn.a)(t,e||Dc);return[i.useMemo(function(){var e=r&&r.filter(function(e){var t=function(e){var t=e.organizer,n=e.meetingStart,r=e.meetingEnd;return t.fullName&&t.email&&n&&r?{isValid:!0}:{isValid:!1,missingFields:(t.fullName?"":"organizer_fullName ")+(t.email?"":"organizer_email ")+(n?"":"meetingStart ")+(r?"":"meetingEnd ")}}(e),r=t.isValid,a=t.missingFields;return!r&&Object(w.e)(n,"Event entity dropped due to missing required fields",a),r});return e&&!Object(L.a)(e)||Object(w.e)(n,"Calendar Answer dropped due to missing required fields"),e},[JSON.stringify(r)]),r]}(),v=b[0],y=b[1],O=se(v),j=Object(U.a)(v),S=null==j?void 0:j.organizer,x=(null==j?void 0:j.id)||"",C=(null==j?void 0:j.hexItemId)||"",k=Nc(j,{itemId:x,hexItemId:C},c),T=null==k?void 0:k.getProfilePhotoUrl,I=!!(null==d?void 0:d.enableMultiEntityCalendarAnswer)&&Object(V.a)(v)>1,P=I?"Hero_MeetingList_Impression":"Hero_SingleMeeting_Impression",N=null==d?void 0:d.enableCalendarInsights,A=null==d?void 0:d.enableCalendarAnswerV2,F=null==d?void 0:d.enableCalendarAnswerV3,D=Mn({entities:v,domain:"Calendar",isHero:!0,impressionEventId:P,intent:"CalendarEntry",groupReferenceId:h,clickEventId:"CalendarEvent_Organizer_Profile_Click",traceId:c,cardType:"Hero"}),R=(t=Object(u.useSelector)(Ac.c),n=Object(u.useSelector)(Ac.b),t?Ec.Pending:n?Ec.Success:Ec.Failed),H=Da(I?void 0:null==S?void 0:S.email,T),W=function(e,t){return function(e,t,n){var r=Pc(e,n),a=Pc(t,n),i=pi({start:r.toUpperCase(),end:a.toUpperCase()}),o=dc(e),c=dc(t);return o!==c?gi({startDay:o,endDay:c,startTime:r.toUpperCase(),endTime:a.toUpperCase()}):mi({day:o,time:i})}(e,t,null==a?void 0:a.dateTimeFormatter)};i.useEffect(function(){var e;!O&&v&&j&&(null===(e=null==a?void 0:a.setAnswerBlockRendered)||void 0===e||e.call(a,D.placeholderId))});if(!y||Object(L.a)(y))return Object(w.h)(s,"Unexpected Empty response received for Calendar"),null;if(!v||Object(L.a)(v)||!j)return null;var M=null==d?void 0:d.isAnswerDismissible,B=null==a?void 0:a.getCurrentClientSize,z=!!A||!!F,_={meetingList:z?Object(K.a)(v,function(e){return ql(ql({},e),{insights:N?e.insights:void 0,artifacts:N?e.artifacts:void 0})}):v,clientSize:o,getMeetingDateTimeText:W,useCalendarCallbacks:function(e,t){return Nc(e,t,c)},headingLevel:p,maxMeetingsToShow:3,imageUrl:H,livePersonaCard:g,getClientSizeCallback:B,setAnswerHeight:m,onOrganizerProfileClick:D.entityActions.onEntityClick,isDismissible:M,className:r,hasInsights:z,meetingArtifactsFetchingStatus:N?R:Ec.Failed};if(A||F)return F&&Object(V.a)(v)>1?i.createElement(_l,ql({},_,{getCalendarAnswerStyleOverrides:Ul})):i.createElement(Wl,ql({},_,{getCalendarAnswerStyleOverrides:Ul}));if(I)return i.createElement(_l,ql({},_));if(!j||!k)return null;var q={heroCalendar:j,actionCallbacks:k,className:r,getMeetingDateTimeText:W,imageUrl:H,clientSize:o,setAnswerHeight:m,onOrganizerProfileClick:D.entityActions.onEntityClick,isDismissible:M};return i.createElement(Xc,ql({},q))};function Vl(e,t){return e.map(function(n,r){var a,i;t&&e.length+r<t.length&&t[r]&&t[r].body&&t[e.length+r]&&t[e.length+r].body&&(a=t[r].body.getUrl,i=t[e.length+r].body.url);var o,c=n.fileExtension,l=n.fileName,s=n.fileSize,u=n.accessUrl,d=n.spoUniqueId,m=n.id,p=n.modifiedBy,h=n.modifiedByDisplayName,f=n.dateModified,g=n.userRelationshipType,b=n.fileType,v=n.subject,y=n.dateCreated,O=n.dateAccessed,j=n.sender,S=n.propertyHits,x=n.author,C=n.authorEmail,k=n.attachmentId,E=n.conversationId,w=n.itemId,T=n.sharingReferenceType,I=n.itemHexId,P=n.fileSourceType,N=n.sharingReferenceUrl;if(c&&l.toLowerCase().includes(c.toLowerCase())){var A=l.toLowerCase().lastIndexOf(c.toLowerCase())-1;o=l.slice(0,A)}else o=l;return{fileExtension:c,title:o,fileSize:s,accessUrl:u,spoUniqueId:d,id:m,mappingId:Object(Q.c)(n),modifiedBy:p,modifiedByDisplayName:h,dateModified:f,userRelationshipType:g,previewUrl:a,thumbnailUrl:i,fileType:b,subject:v,dateCreated:y,dateAccessed:O,sender:j,propertyHits:S,author:x,authorEmail:C,attachmentId:k,conversationId:E,itemId:w,sharingReferenceType:T,fileName:l,itemHexId:I,fileSourceType:P,sharingReferenceUrl:N}})}function Ql(e,t){var n;if(t)try{n=Vl(e,t.responses.sort(function(e,t){return e.id.valueOf()-t.id.valueOf()}))}catch(t){n=Vl(e)}else n=Vl(e);return n}var Yl=n(295),Gl=3;function $l(e){var t=Object(u.useSelector)(Yl.a),n=Object(E.a)(),r=Object(jn.a)(t,e||Gl);return[i.useMemo(function(){var e=r&&r.filter(function(e){var t,r,a,i,o=(r=(t=e).accessUrl,a=t.fileName,i=t.fileType,r&&a&&i?{isValid:!0}:{isValid:!1,missingFields:(r?"":"accessUrl ")+(a?"":"fileName ")+(i?"":"fileType ")}),c=o.isValid,l=o.missingFields;return!c&&Object(w.e)(n,"File entity dropped due to missing required fields",l),c});return e&&!Object(L.a)(e)||Object(w.e)(n,"File Answer dropped due to missing required fields"),e},[JSON.stringify(r)]),r]}var Jl=function(){return(Jl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Zl="Hero";var Xl,es,ts,ns;Object(Ce.a)(function(e){var t=e.palette,n=t.blue,r=t.neutralLight;return Object(qe.t)({commandBarItem:{display:"none"},shareButton:{color:n,height:"28px",width:"28px",float:"left",marginRight:"5px",selectors:{":hover":{backgroundColor:r,color:n}}},commandbar:{float:"left"},appLogo:{height:"16px",width:"16px"}})}),Object(Ce.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,minWidth:"28px",maxWidth:"28px",height:"28px",border:"none"}})}),Object(Ce.a)(function(){return Object(qe.t)({root:{paddingLeft:"10px",paddingRight:"10px",height:"45px"}})}),Object(Ce.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,float:"right",paddingRight:"0px",paddingLeft:"0px"}})}),Object(Ce.a)(function(e){var t=e.palette.blue;return Object(qe.t)({root:{color:t}})}),Object(Ce.a)(function(){return Object(qe.t)({root:{height:"16px",width:"16px"}})}),Object(Ce.a)(function(e){var t=e.palette.neutralSecondary;return Object(qe.t)({root:{color:t}})}),Object(Ce.a)(function(){return Object(qe.t)({root:{display:"block"}})});function rs(e){return e+"?web=1"}function as(e,t,n,r,a){var i=function(e){a&&e?a(e):window.open(e,"_blank"),r&&r()};return Object(K.a)(e,function(e,r){var a=function(e,t){if(t>e.length)return;return e.slice(0,t+1).join("/")}(t,r+n);return{key:e,text:decodeURIComponent(e),onClick:function(e){null==e||e.stopPropagation(),i(a)},onKeyPress:function(e){null==e||e.stopPropagation(),i(a)}}})}function is(e,t,n,r){void 0===r&&(r=new Date);var a=r.getTime(),i=new Date(t),o=a-i.getTime(),c=Math.floor(o/Or.c),l=Object(Ja.a)(i,r);if("Link"===e||"Attachment"===e)return Object(yr.l)(r,i)?Object(ji.o)({name:n}):Object(Sr.p)(i,r)?Object(ji.p)({name:n}):c<r.getDay()?Object(ji.m)({name:n,day:Object($a.a)(i.getDay())}):c<Or.w/Or.c+r.getDay()?Object(ji.l)({name:n}):i.getMonth()===r.getMonth()&&i.getFullYear()===r.getFullYear()?Object(ji.n)({name:n}):Object(ji.m)({name:n,day:l});var s=new Date(t),u=new Date,d=Object(Ja.b)(s,u),m=Object(ji.w)(d,n);return d?m:ms(m)}function os(e,t,n){var r,a,i,o,c,l,s=e.fileType,u=e.sender,d=e.dateCreated,m=e.modifiedByDisplayName,p=e.dateModified,h=e.modifiedBy,f=e.propertyHits,g=e.author,b=e.authorEmail,v=function(){if(s&&u&&d){var e=u.emailAddress,m=e.name,p=e.address;o=p,c=m,l="Sender",m&&(cs(o,t,n)?(a=ms(a=is(s,d,Object(ji.Y)())),i=[a]):(a=is(s,d,r=m),i=a.split(r)))}};return Object(D.a)(f,"EmailSenderName")&&u&&d?v():g&&f&&Object(D.a)(f,"Author")?(c=g,l="Author",cs(o=b,t,n)?(a=ms(a=Object(ji.a)({name:Object(ji.Y)()})),i=[a]):(a=Object(ji.a)({name:g}),r=g,i=a.split(r))):("Attachment"===s||"Link"===s)&&u&&d?v():("File"===s||"Folder"===s)&&m&&p&&(o=h,c=m,l="Modifier",cs(h,t,n)?(a=ms(a=is(s,p,Object(ji.Y)())),i=[a]):(a=is(s,p,m),i=a.split(m),r=m)),{connectionName:r,headerString:a,headerStringSplits:i,connectionEmail:o,personFullName:c,relation:l}}function cs(e,t,n){return(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase())||(null==n?void 0:n.toLowerCase())===(null==e?void 0:e.toLowerCase())}function ls(e,t,n){return!!n&&("File"===e||"Attachment"===e&&"ClassicAttachment"===t)}function ss(e,t,n){return!!n&&("Link"===e||"File"===e||"Folder"===e||"Attachment"===e&&"ClassicAttachment"!==t)}function us(e,t){return!!e&&!!t}function ds(e,t,n,r){if(e)switch(e){case"Mail":return function(e,t){if(t)return Object(ji.i)({title:e||Object(ji.y)()});return Object(ji.j)({title:e||Object(ji.y)()})}(t,r);case"Teams":return function(e,t,n){if(e)return n?Object(ji.W)({chat:e}):Object(ji.Q)({chat:e});if(t)return n?Object(ji.W)({chat:t}):Object(ji.R)({name:t});return Object(ji.Q)({chat:Object(ji.y)()})}(t,n,r);case"CalendarEvent":return function(e,t){if(e)return t&&Object(ji.x)({title:e}),Object(ji.P)({title:e});return}(t,r);default:return}}function ms(e){var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.substr(1)}function ps(e,t,n,r,a,i){var o;if(null==t||t.stopPropagation(),"Attachment"===e.fileType){var c="ClassicAttachment"!==e.fileSourceType;null==r||r({attachmentId:null===(o=e.attachmentId)||void 0===o?void 0:o.id},c)}i?i(e.accessUrl):window.open(e.accessUrl),null==a||a(e,n)}function hs(e,t,n,r,a){null==t||t.stopPropagation();var i=rs(e.accessUrl);null==r||r(i),null==a||a(e,n)}function fs(e,t,n,r,a,i){var o,c=e.fileType,l=e.sharingReferenceType,s=rs(e.accessUrl);null==t||t.stopPropagation(),"Attachment"===c&&"Mail"===l&&(null==a||a(null===(o=e.attachmentId)||void 0===o?void 0:o.id)),("Link"===c||"File"===c||"Folder"===c||"Teams"===l)&&(null==i||i(s)),null==r||r(e,n)}!function(e){e[e.docx=0]="docx",e[e.doc=1]="doc"}(Xl||(Xl={})),function(e){e[e.pptx=0]="pptx",e[e.ppt=1]="ppt",e[e.pot=2]="pot",e[e.potx=3]="potx",e[e.potm=4]="potm",e[e.ppam=5]="ppam",e[e.ppsx=6]="ppsx",e[e.ppsm=7]="ppsm",e[e.sldx=8]="sldx",e[e.sldm=9]="sldm",e[e.ppa=10]="ppa",e[e.pps=11]="pps",e[e.pptm=12]="pptm",e[e.powerpoint=13]="powerpoint"}(es||(es={})),function(e){e[e.xls=0]="xls",e[e.xlsx=1]="xlsx",e[e.xlb=2]="xlb",e[e.xlc=3]="xlc",e[e.xlsb=4]="xlsb",e[e.xlsm=5]="xlsm",e[e.xlt=6]="xlt",e[e.xltx=7]="xltx",e[e.xltm=8]="xltm",e[e.xlm=9]="xlm",e[e.xla=10]="xla",e[e.xll=11]="xll",e[e.xlam=12]="xlam",e[e.xlw=13]="xlw",e[e.excel=14]="excel",e[e.csv=15]="csv"}(ts||(ts={})),function(e){e[e.one=0]="one",e[e.note=1]="note"}(ns||(ns={}));var gs=Object(Ce.a)(function(){return Object(qe.t)({headerContent:["ms-search-fileTile-headerContent",{fontSize:"14px",lineHeight:"24px",verticalAlign:"middle",display:"flex",flexDirection:"row",overflow:"hidden"}],senderFullName:{fontWeight:"600"},answerTitle:["ms-search-fileTile-answerTitle",at,{fontWeight:"400",fontSize:"14px",paddingLeft:"8.75px"}],profilePhoto:{float:"left"}})}),bs=function(){return(bs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},vs=function(e){var t=e.file,n=e.profilePictureUrl,r=e.userEmail,a=e.userUpn,o=e.livePersonaCard,c=e.onProfileClick,l=t.fileType,s=t.sender,u=t.dateCreated,d=t.modifiedByDisplayName,m=t.dateModified,p=i.useState(!1),h=p[0],f=p[1],g=gs(),b=g.headerContent,v=g.profilePhoto,y=g.answerTitle,O=g.senderFullName,j=oa(n);if(!(("File"!==l||d&&m)&&("Link"!==l&&"Attachment"!==l||s&&s.emailAddress&&s.emailAddress.name&&u)))return null;var S=os(t,r,a),x=S.connectionName,C=S.headerString,k=S.headerStringSplits,E=S.connectionEmail,w=S.personFullName,T=S.relation;if(!k)return null;var I={imageUrl:j?n:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(ca.a)(w,!1),initialsColor:Object(la.a)({text:w})},P=$e(o,w,E),N=i.createElement("div",{className:v,role:o?"button":void 0,onClick:o?function(){return T&&(null==c?void 0:c(T))}:void 0,onKeyPress:o?function(){return T&&(null==c?void 0:c(T))}:void 0},i.createElement(sa.a,bs({},I))),A=P?i.createElement(P,null,N):N,F=i.createElement("span",{className:O,role:o?"button":void 0,onClick:o?function(){return T&&(null==c?void 0:c(T))}:void 0,onKeyPress:o?function(){return T&&(null==c?void 0:c(T))}:void 0},x),D=P?i.createElement(P,null,F):F;return i.createElement("div",{className:b},A,i.createElement("div",{className:y,title:h?C:void 0,role:"presentation","aria-label":C,onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;f(n!==r)}(e)}},k[0],i.createElement("span",{className:O},D),k[1]))},ys=Object(Ce.a)(function(e){return Object(qe.t)({fileTypeIcon:{flexShrink:0,flexGrow:0,width:e+"px",height:e+"px"}})});function Os(e){if(e)switch(e){case"Folder":case"WebPage":return fl.FileIconType.folder;default:return Object(s.a)(e)}}var js=function(e){var t=e.fileExtension,n=e.fileType,r=e.iconSize,o=e.className,c=Object(fl.getFileTypeIconProps)({extension:t,size:r||32,type:Os(n)}),l=ys(r||32).fileTypeIcon+" "+o;return i.createElement(nt.a,Object(a.__assign)({role:"presentation"},c,{className:l,"aria-hidden":!0}))},Ss=n(498),xs=Object(Ce.a)(function(e,t,n){var r=e.palette,a=r.neutralDark,i=r.neutralLighter;return Object(qe.t)({breadcrumbContainer:{display:"flex",height:"20px",marginRight:t?"0":"16px"},folderInfoContainer:["ms-search-folderInfoContainer",at,{marginRight:t?"0":"16px"}],folderInfo:["ms-search-folderInfo",{color:a,fontWeight:"400",fontSize:14}],folder:[at,"ms-search-file-breadCrumbFolder",{fontSize:14,color:a,maxWidth:t?"120px":"150px",height:"20px",selectors:{"&:hover":{background:n?void 0:i,textDecoration:"underline"},cursor:"Pointer"}}],overflowIcon:{margin:"-5px 0 0 0",height:"20px"},chevron:{margin:"5px 5px",height:"20px",fontSize:"10px"}})}),Cs=function(e){var t=e.items,n=e.overflowTitle,r=e.isSmall,a=e.fileSourceType,o=e.enableFileSourceClick,c=je(),l=xs(c,r,o),s=l.folder,u=l.overflowIcon,d=l.chevron,m=l.breadcrumbContainer,p=t[0],h=t[t.length-1],f=t.length>2;if(o){var g=function(e,t,n){return"SharepointOnline"===e?n?Object(ji.S)({folder:t}):Object(ji.v)({folder:t}):"OneDriveForBusiness"===e?n?Object(ji.z)({folder:t}):Object(ji.u)({folder:t}):void 0}(a,h.text,o),b=null==g?void 0:g.split(h.text);return b?i.createElement("div",{className:l.folderInfoContainer,title:g},i.createElement("span",{className:l.folderInfo},b[0]),i.createElement("span",{role:"Link",tabIndex:0,title:h.text,onClick:h.onClick,onKeyPress:h.onKeyPress,className:s},h.text),i.createElement("span",null,b[1])):null}return i.createElement("div",{className:m},i.createElement("div",{role:"Link",onClick:p.onClick,onKeyPress:p.onKeyPress,tabIndex:0,title:p.text,className:s},p.text),i.createElement(nt.a,{iconName:"ChevronRightMed",className:d}),f&&i.createElement(i.Fragment,null,i.createElement("span",{title:n,className:u,role:"presentation",onClick:function(e){e.stopPropagation()}},"..."),i.createElement(nt.a,{iconName:"ChevronRightMed",className:d})),i.createElement("div",{role:"Link",tabIndex:0,title:h.text,onClick:h.onClick,onKeyPress:h.onKeyPress,className:s},h.text))},ks=function(e){var t=e.accessUrl,n=e.minFolderPath,r=e.maxFolderPath,a=e.isSmall,o=e.fileSourceType,c=e.enableFileSourceClick,l=e.onMalformedURLError,s=e.onBreadcrumbclick,u=e.openLink,d=i.useRef(null),m=t.split("/");if(m.length<=n+2)return null;var p,h,f=Math.max(n,m.length-(r||m.length+1)-1),g=Object(Ss.a)(m,f,m.length-1);try{p=g.map(function(e){return decodeURIComponent(e)}).join(" > "),h=as(g,m,f,s,u)}catch(e){return null==l||l("FolderBreadCrumb"),null}return i.createElement("div",{ref:d},i.createElement(Cs,{items:h,isSmall:!!a,overflowTitle:p,fileSourceType:o,enableFileSourceClick:c}))},Es=Object(Ce.a)(function(e){var t=e.palette,n=t.neutralDark,r=t.white;return Object(qe.t)({actionContainer:{height:"32px",marginTop:"-5px",paddingRight:"8px",borderRadius:"3px",display:"flex",minWidth:"100px"},icon:{height:"20px",width:"20px",margin:"5px 0 10px 12px",color:n},disabledIcon:{opacity:"40%",selectors:{":hover":{background:r}}}})}),ws=function(e){var t=e.file,n=e.index,r=e.onFileShareClick,a=e.shareByEmail,o=e.composeEmail,c=e.onFileCopyLinkClick,l=e.onFileDownloadClick,s=e.downloadAttachment,u=e.copyLink,d=e.openLink,m=t.fileType,p=t.fileSourceType,h=je();if(!us(a,o)&&!ls(m,p,s)&&!ss(m,p,u))return null;var f=Es(h),g=us(a,o),b=ls(m,p,s),v=ss(m,p,u),y=Ge(f.icon,f.disabledIcon);return i.createElement("div",{className:f.actionContainer},i.createElement(xe.a,{iconProps:{iconName:"Share"},title:g?Object(ji.O)():Object(ji.h)({action:Object(ji.O)()}),onClick:g?function(e){return fs(t,e,n,r,a,o)}:function(e){return e.stopPropagation()},className:g?f.icon:y}),i.createElement(xe.a,{iconProps:{iconName:"Download"},title:b?Object(ji.k)():Object(ji.h)({action:Object(ji.k)()}),onClick:b?function(e){return ps(t,e,n,s,l,d)}:function(e){return e.stopPropagation()},className:b?f.icon:y}),i.createElement(xe.a,{iconProps:{iconName:"PageLink"},title:v?Object(ji.b)():Object(ji.h)({action:Object(ji.b)()}),onClick:v?function(e){return hs(t,e,n,u,c)}:function(e){return e.stopPropagation()},className:v?f.icon:y}))},Ts=Object(Ce.a)(function(){return Object(qe.t)({commandbar:{marginLeft:"auto",marginTop:"16px",alignItems:"center",float:"right",padding:"0"}})}),Is=Object(Ce.a)(function(e){var t=e.palette.blue;return Object(qe.t)({root:{color:t,padding:"0"}})}),Ps=(Object(Ce.a)(function(){return Object(qe.t)({root:{height:"100%",padding:"0"}})}),Object(Ce.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,minWidth:"20px",maxWidth:"20px",height:"28px",border:"none"}})}),Object(Ce.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,float:"right",height:"100%",padding:"0"}})})),Ns=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},As=function(e){var t=e.file,n=e.index,r=e.onFileShareClick,a=e.shareByEmail,o=e.composeEmail,c=e.onFileCopyLinkClick,l=e.onFileDownloadClick,s=e.downloadAttachment,u=e.copyLink,d=e.openLink,m=t.fileType,p=t.fileSourceType,h=je();if(!us(a,o)&&!ls(m,p,s)&&!ss(m,p,u))return null;var f={text:Object(ji.k)(),key:Object(ji.k)(),onClick:function(e){return ps(t,e,n,s,l,d)},iconProps:{iconName:"Download"}},g={text:Object(ji.O)(),key:Object(ji.O)(),onClick:function(e){return fs(t,e,n,r,a,o)},iconProps:{iconName:"Share"}},b={text:Object(ji.b)(),key:Object(ji.b)(),onClick:function(e){return hs(t,e,n,u,c)},iconProps:{iconName:"PageLink"}},v=Ns(Ns(Ns([],us(a,o)?[g]:[]),ls(m,p,s)?[f]:[]),ss(m,p,u)?[b]:[]);return i.createElement(tl.a,{styles:Ps(h),items:[],overflowItems:v,className:Ts().commandbar,overflowButtonProps:{menuIconProps:{styles:Is(h)}}})},Fs=Object(Ce.a)(function(e,t,n,r,a,i,o,c,l){var s=e.palette,u=s.neutralDark,d=s.neutralSecondary,m=s.white,p=s.neutralLight,h=s.neutralLighterAlt;return Object(qe.t)({fileContainer:["ms-search-fileTile-fileContainer",{backgroundColor:m,height:t?"auto":"40px",borderBottom:c?void 0:a?"none":"1px solid",borderColor:p,selectors:{"&:hover":{backgroundColor:h}}}],fileCard:["ms-search-fileTile-fileCard",{height:t?"auto":"39px",display:t?"flex":"block",padding:t?"8px 0 12px 0":"0",margin:t?"0 12px":c?"0 24px":"0 32px",borderBottom:c?a?"none":"1px solid":void 0,borderColor:p}],fileInfoContainer:{width:o?"calc(100% - 84px)":"calc(100% - 40px)",float:"left",height:t?"auto":"30px",display:t?"block":"flex",marginTop:t?"0":"10px"},fileNameContainer:["ms-search-fileTile-fileNameContainer",{height:"20px",float:"left",width:t?"100%":"240px",marginRight:t?"0":"25px"}],titleText:["ms-search-fileTile-titleText",at,{color:u,float:"left",width:t?"100%":"240px",fontSize:i?14:17,fontWeight:"600",display:"inline-block",selectors:{"&:hover":{textDecoration:"none",color:u}}}],folderBreadcrumb:{width:n&&t?"calc(100% - 65px)":"100%",float:"left"},emailSubject:["ms-search-fileTile-emailSubject",at,{color:u,fontWeight:"400",fontSize:14,display:"flex",height:"20px",float:"left",width:t&&n?"calc(100% - 65px)":"100%",maxWidth:t?void 0:"400px",marginRight:t?"0":"16px"}],sourceSubject:[at,{marginLeft:"3px",selectors:{":hover":{textDecoration:l?"underline":"none"}}}],fileIcon:[vn,{float:"left",marginRight:"12px",marginTop:t?"0":"4px",height:"auto",selectors:{"> img":{height:"28px",width:"28px",marginTop:"2px"}}}],fileIconContainer:{width:"40px",height:"100%",float:"left"},tertiaryInfo:["ms-search-file-tertiaryInfo",at,{fontWeight:"400",fontSize:14,height:"20px",width:t&&n&&!r?"calc(100% - 65px)":"100%",color:d,float:"left"}],actionContainer:{width:"55px",float:"left",fontSize:12,display:"inline-block"},sizeInfo:{width:"55px",float:"right",fontSize:12,textAlign:"right",color:d},sizeContainer:{flex:"auto"},sourceContainer:{width:i||t?void 0:"calc(100% - 373px)"}})}),Ds=function(){return(Ds=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ls=function(e){var t=e.file,n=e.index,r=e.isSmall,a=e.userEmail,o=e.userUpn,c=e.showActions,l=e.enableFileSourceClick,s=e.numberOfFiles,u=e.showConnection,d=e.showSameLargeView,m=e.onFileShareClick,p=e.onFileSourceClick,h=e.shareByEmail,f=e.composeEmail,g=e.onFileCopyLinkClick,b=e.onFileDownloadClick,v=e.downloadAttachment,y=e.copyLink,O=e.onFileClick,j=e.openAttachmentInClient,S=e.onFolderBreadcrumbClick,x=e.onMalformedURLError,C=e.openLink,k=t.fileExtension,E=t.accessUrl,w=t.title,T=t.subject,I=t.fileType,P=t.attachmentId,N=t.itemId,A=(t.fileSize,t.sharingReferenceType),F=t.itemHexId,D=t.fileName,L=t.sharingReferenceUrl,R=t.sender,H=t.fileSourceType,W=je(),M=i.useState(!1),B=M[0],z=M[1],_=i.useState(!1),U=_[0],q=_[1],K=ds(A,T,null==R?void 0:R.emailAddress.name,l),V=T||("Teams"===A&&(null==R?void 0:R.emailAddress.name)?null==R?void 0:R.emailAddress.name:Object(ji.y)()),Q=null==K?void 0:K.split(V),Y=!!K||"File"===I,G=!(!c||!r||!(h||f||v||y)),$=Fs(W,r||!!d,!1,Y,n===s-1,1!==s,G,!!c,!!(l&&L)),J=$.titleText,Z=$.fileIcon,X=$.fileInfoContainer,ee=$.folderBreadcrumb,te=$.fileIconContainer,ne=$.fileNameContainer,re=$.tertiaryInfo,ae=$.emailSubject,ie=$.fileCard,oe=$.fileContainer,ce=($.sizeInfo,$.sizeContainer,rs(E)),le=os(t,a,o).headerString,se=function(){var e={itemId:null==N?void 0:N.id,accessUrl:ce,attachmentId:null==P?void 0:P.id,hexItemId:F,attachmentName:D,fileType:I};j&&P&&N&&"Attachment"===I&&A&&"Mail"===A?j(e):j&&A&&"Mail"===A?j(e):C?C(ce):window.open(ce),O(t,n)};var ue={accessUrl:E,isSmall:r,minFolderPath:4,fileSourceType:H,enableFileSourceClick:l,onBreadcrumbclick:function(){S&&S(t,n)},onMalformedURLError:x,openLink:C},de={file:t,index:0,onFileShareClick:m,shareByEmail:h,composeEmail:f,onFileCopyLinkClick:g,onFileDownloadClick:b,copyLink:y,downloadAttachment:v,openLink:C};function me(e){L&&l&&(null==e||e.stopPropagation(),C?C(L):window.open(L,"_blank"),null==p||p(t,n,A))}var pe=de,he="Attachment"===I?"button":"link",fe="File"!==I?K:ji.t,ge=(Object(ji.X)({type:k})+" "+D+" "+fe+" "+le).substring(0,512);return i.createElement("div",{className:oe,tabIndex:0,role:"listitem",onKeyPress:function(){return se()},onClick:se,"aria-posinset":n+1,"aria-setsize":s},i.createElement("div",{role:he,className:ie},i.createElement("div",{className:te,"aria-label":ge,"aria-hidden":!1},i.createElement(js,{className:Z,fileExtension:k})),i.createElement("div",{className:X},i.createElement("div",{className:ne},i.createElement("div",{className:J,role:"presentation",onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;z(n!==r)}(e)},title:B?w:void 0},w)),i.createElement("div",{className:$.sourceContainer},"File"===I&&i.createElement("div",{className:ee},i.createElement(ks,Ds({},ue))),"File"!==I&&K&&Y&&Q&&i.createElement("div",{className:ae,role:"Tooltip",title:K},i.createElement("span",null,Q[0]),i.createElement("span",{className:$.sourceSubject,role:l?"link":"tooltip",tabIndex:l?0:-1,onClick:function(e){return me(e)},onKeyPress:function(e){return Ae(e,me)}},V),i.createElement("span",null,Q[1])),!1),le&&u&&i.createElement("div",{className:re,role:"tooltip",onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;q(n!==r)}(e)},title:U?le:void 0},le),c&&!G&&i.createElement(ws,Ds({},de)),!1),G&&i.createElement(As,Ds({},pe))))};Ls.displayName="FileEntity";var Rs=Object(Ce.a)(function(e){var t;return Object(qe.t)({fileContainer:{selectors:(t={},t["& .ms-search-fileTile-fileNameContainer"]={height:"25px"},t["& .ms-search-fileTile-fileCard"]={margin:"0",padding:"0 0 8px 0"},t["& .ms-search-fileTile-fileContainer:hover"]={backgroundColor:e.palette.white,cursor:"pointer"},t)}})}),Hs=function(){return(Hs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ws=function(e){var t,n=e.file,r=e.clientSize,a=e.profilePictureUrl,o=e.userEmail,c=e.userUpn,l=e.className,s=e.isDismissible,u=e.showActions,d=e.enableFileSourceClick,m=e.onFileClick,p=e.onFileSourceClick,h=e.livePersonaCard,f=e.onMalformedURLError,g=e.openAttachmentInClient,b=e.setAnswerHeight,v=e.openLink,y=e.onFolderBreadcrumbClick,O=e.onProfileClick,j=e.onDismiss,S=e.onFileShareClick,x=e.shareByEmail,C=e.composeEmail,k=e.onFileCopyLinkClick,E=e.onFileDownloadClick,w=e.copyLink,T=e.downloadAttachment,I=n.thumbnailUrl,P=ve("HeroFileTile",752,r),N=P[0],A=P[1],F=je(),D=null===(t=N.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){D&&b&&b(D)},[D]);var L,R="Small"===A,H={file:n,profilePictureUrl:a,userEmail:o,userUpn:c,livePersonaCard:h,onProfileClick:O},W={headerImageUrl:I,imagePosition:R?void 0:"Right",imageHeight:"100%",imageWidth:"185px"},M={body:(L={file:n,index:0,isSmall:R,userEmail:o,userUpn:c,numberOfFiles:1,showConnection:!1,showSameLargeView:!u,showActions:u,enableFileSourceClick:d,onFileShareClick:S,shareByEmail:x,onFileSourceClick:p,composeEmail:C,onFileCopyLinkClick:k,onFileDownloadClick:E,copyLink:w,downloadAttachment:T,onFileClick:m,openAttachmentInClient:g,onFolderBreadcrumbClick:y,onMalformedURLError:f,openLink:v},i.createElement(Ls,Hs({key:"File0"},L))),header:i.createElement(vs,Hs({},H)),isSmall:R,imageProps:W,styleOverrides:function(){return{cardStyles:R||u?void 0:"ms-search-maxContent"}},className:l,isDismissible:s,onDismiss:j},B=Rs(F);return i.createElement("div",{className:B.fileContainer,ref:N},i.createElement(et,Hs({},M)))};Ws.displayName="HeroFileTile";var Ms=function(){return(Ms=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Bs=function(e){var t=e.files,n=e.userEmail,r=e.userUpn,a=e.showActions,o=e.isSmall,c=e.enableFileSourceClick,l=e.onFileClick,s=e.onFileSourceClick,u=e.onMalformedURLError,d=e.openAttachmentInClient,m=e.onFolderBreadcrumbClick,p=e.openLink,h=e.onFileShareClick,f=e.shareByEmail,g=e.composeEmail,b=e.onFileCopyLinkClick,v=e.onFileDownloadClick,y=e.copyLink,O=e.downloadAttachment;if(!t)return null;var j=t.length;return i.createElement(i.Fragment,null,t.map(function(e,t){var S={file:e,index:t,isSmall:!!o,userEmail:n,userUpn:r,numberOfFiles:j,showActions:a,enableFileSourceClick:c,showConnection:!0,onFileClick:l,onFileSourceClick:s,openAttachmentInClient:d,onFolderBreadcrumbClick:m,onMalformedURLError:u,openLink:p,onFileShareClick:h,shareByEmail:f,composeEmail:g,onFileCopyLinkClick:b,onFileDownloadClick:v,copyLink:y,downloadAttachment:O};return i.createElement(Ls,Ms({key:"File"+t},S))}))};Bs.displayName="MultiEntityFileBody";var zs=function(){return(zs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},_s=function(e){var t,n=e.files,r=e.clientSize,a=e.headingLevel,o=e.className,c=e.getClientSizeCallback,l=e.setAnswerHeight,s=ve("HeroMultiEntityFileTile",752,r,c),u=s[0],d=s[1],m=null===(t=u.current)||void 0===t?void 0:t.offsetHeight;if(i.useEffect(function(){m&&l&&l(m)},[m]),!n)return null;var p,h="Small"===d;return i.createElement("div",{ref:u,className:o,role:"list"},i.createElement(Bl,{resultType:"File",isSmall:h,headingLevel:a},(p=e,i.createElement(Bs,zs({},p,{isSmall:h})))))};_s.displayName="HeroMultiEntityFileTile";var Us=Object(Ce.a)(function(e){var t,n;return Object(qe.t)({tileBodyOverride:["ms-search-tile-body"],tile:{selectors:(t={},t["& .ms-search-tile-body"]={margin:"0",padding:"0"},t)},tileHeader:{padding:0},multiEntityFileHeader:["ms-search-fileTile-multiEntityHeader",at,{fontWeight:"600",fontSize:14}],multiEntityFileBody:["ms-search-multiEntityFileBody",{selectors:(n={},n["& .ms-search-fileTile-fileContainer:hover"]={backgroundColor:e.palette.white},n["& .ms-search-fileTile-fileContainer"]={cursor:"pointer"},n["& .ms-search-heroTile-headerContainer"]={margin:"0",padding:"8px 24px"},n)}]})}),qs=function(){return(qs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ks=function(e){var t,n=e.className,r=e.isDismissible,a=e.headingLevel,o=e.clientSize,c=e.getClientSizeCallback,l=e.onDismiss,s=e.setAnswerHeight,u=ve("HeroMultiEntityFileTile",752,o,c),d=u[0],m=u[1],p=null===(t=d.current)||void 0===t?void 0:t.offsetHeight,h="Small"===m;i.useEffect(function(){p&&s&&s(p)},[p]);var f,g=je(),b=Us(g),v=Us(g),y={body:(f=e,i.createElement(Bs,qs({},f,{isSmall:h}))),header:i.createElement("div",{className:b.multiEntityFileHeader,role:"heading","aria-level":a},Object(ji.r)()),isSmall:h,styleOverrides:function(){return{bodyStyles:b.tileBodyOverride,cardStyles:b.tile}},className:Ge(n,v.multiEntityFileBody),isDismissible:r,onDismiss:l};return i.createElement("div",{ref:d,role:"list"},i.createElement(et,qs({},y)))};Ks.displayName="HeroMultiEntityFileTileCard";var Vs=Object(Ce.a)(function(e){var t,n=e.palette.neutralLighterAlt;return Object(qe.t)({fileEntityHover:{selectors:(t={},t["&.ms-search-multiEntityFileBody .ms-search-fileTile-fileContainer:hover"]={backgroundColor:n},t["&.ms-search-multiEntityFileBody .ms-search-fileTile-fileContainer"]={cursor:"default"},t)}})}),Qs=function(){return(Qs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ys=function(e){var t=e.className,n=$l(),r=n[0],a=n[1],o=je(),c=se(r),s=Object(ae.a)(),u=Object(l.h)().additionalAnswerConfigs,d=s.clientActionCallbacks,m=s.logger,p=Object(l.i)(),h=function(){var e=Object(ae.a)(),t=Object(l.c)(),n=Object(l.h)().additionalAnswerConfigs,r=e.clientActionCallbacks,a=e.logger,i=Zn(),o=Xn(),c=Object(l.b)(),s=$l(),u=s[0],d=(s[1],Ql(u)),m=null==r?void 0:r.openAttachmentInClient,p=null==r?void 0:r.shareByEmail,h=null==r?void 0:r.composeEmail,f=null==r?void 0:r.openLink,g=null==r?void 0:r.downloadAttachment,b=null==r?void 0:r.copyLink,v=null==r?void 0:r.setAnswerHeight,y=!!(null==n?void 0:n.enableMultiEntityFileAnswer)&&Object(V.a)(u)>1?"Hero_MultiEntity_File_Impression":"Hero_File_Impression",O=null==n?void 0:n.answerBlockId,j=Mn({entities:u,domain:"File",isHero:!0,impressionEventId:y,clickEventId:"File_Click",cardType:Zl,isFromMainSearch:!0,groupReferenceId:O});return{userUpn:o,userEmail:i,culture:t,clientSize:c,clientLogger:j,onFileClick:function(e,t){j.entityActions.onEntityClick(e,t,{EntityClickDetails:m&&f?"OpenInViewer":void 0},"File_Click")},onMalformedURLError:function(e){Object(w.d)(a,e)},onProfileClick:function(e){var t;if("Author"===e)t="File_Author_Profile_Click";else if("Modifier"===e)t="File_Modifier_Profile_Click";else{if("Sender"!==e)return;t="File_Sender_Profile_Click"}j.entityActions.onActionClick(d[0],t,0)},openAttachmentInClient:m,setAnswerHeight:v,openLink:f,onFolderBreadcrumbClick:function(e,t){return j.entityActions.onActionClick(e,"File_FolderBreadcrumb_Click",t,{RelatedEntityType:"EntityLocationClick"})},onFileShareClick:function(e,t){return j.entityActions.onActionClick(e,"File_Share_Click",t)},shareByEmail:p,composeEmail:h,onFileCopyLinkClick:function(e,t){return j.entityActions.onActionClick(e,"File_CopyLink_Click",t)},onFileDownloadClick:function(e,t){return j.entityActions.onActionClick(e,"File_Download_Click",t)},onFileSourceClick:function(e,t,n){j.entityActions.onActionClick(e,"File_Source_Click",t,Jl({},function(e){if(e)switch(e){case"Mail":return{RelatedEntityType:"EmailSource"};case"CalendarEvent":return{RelatedEntityType:"EmailCalendarSource"};case"Teams":return{RelatedEntityType:"TeamsChatSource"};default:return}}(n)))},downloadAttachment:g,copyLink:b}}(),f=!!(null==u?void 0:u.enableMultiEntityFileAnswer)&&Object(V.a)(r)>1,g=null==u?void 0:u.enableFileAnswerV2,b=null==u?void 0:u.enableFileAnswerV3,v=null==u?void 0:u.enableFileAnswerV4,y=null==u?void 0:u.enableFileSourceClick,O=Ge(Vs(o).fileEntityHover,t),j=null==d?void 0:d.livePersonaCard,S=null==d?void 0:d.getCurrentClientSize,x=null==d?void 0:d.getProfilePhotoUrl;i.useEffect(function(){var e;r&&!Object(L.a)(r)&&Object(L.a)(c)&&(null===(e=null==d?void 0:d.setAnswerBlockRendered)||void 0===e||e.call(d,h.clientLogger.placeholderId))},[r,c]);var C=Da(function(e,t){var n,r;if(e&&!Object(L.a)(e)&&!t){var a=e[0],i=a.fileType,o=a.modifiedBy,c=a.propertyHits,l=a.authorEmail;return c&&Object(D.a)(c,"EmailSenderName")?null===(n=null==a?void 0:a.sender)||void 0===n?void 0:n.emailAddress.address:c&&Object(D.a)(c,"Author")?l:"Attachment"===i||"Link"===i?null===(r=null==a?void 0:a.sender)||void 0===r?void 0:r.emailAddress.address:o}}(r,f),x);if(!a||Object(L.a)(a))return Object(w.h)(m,"Unexpected Empty response received for File"),null;if(!r||Object(L.a)(r))return null;var k=Ql(r),E=Qs({files:k,headingLevel:p,className:v?O:t,showActions:g,enableFileSourceClick:y,getClientSizeCallback:S},h);if(f)return g||b||v?i.createElement(Ks,Qs({},E)):i.createElement(_s,Qs({},E));var T=Qs({profilePictureUrl:C,file:k[0],className:t,showActions:g,enableFileSourceClick:y,livePersonaCard:j},h);return i.createElement(Ws,Qs({},T))},Gs=function(e){var t=e.domain,n=e.className,r=Object(l.h)().additionalAnswerConfigs;switch(t){case"Bookmark":return(null==r?void 0:r.bookmarkTriggerControl)?null:i.createElement(fr,{className:n});case"Calendar":return(null==r?void 0:r.calendarTriggerControl)?null:i.createElement(Kl,{className:n});case"Flight":return(null==r?void 0:r.flightTriggerControl)?null:i.createElement(Ha,{className:n});case"File":return(null==r?void 0:r.fileTriggerControl)?null:i.createElement(Ys,{className:n});case"Link":return(null==r?void 0:r.linkTriggerControl)?null:i.createElement(si,{className:n});case"Acronym":return(null==r?void 0:r.acronymTriggerControl)?null:i.createElement(or,{className:n});case"Person":return(null==r?void 0:r.personTriggerControl)?null:i.createElement(uo,{className:n});case"TuringQnA":case"PeopleAlsoAsk":case"MeetingRoomProposal":case"Qna":case"FloorPlan":case"Building":case"Group":case"Calendar":case"FileEntity":case"Conversation":case"Message":case"Site":case"PowerBi":case"CalendarAvailability":case"Notification":case"Turing":case"Topic":case"Connectors":case"External":case"EmployeeOffer":case"SharePoint":case"EducationAssignment":case"EducationClass":case"QueryReformulation":case"EnterpriseLearning":return null;default:return Object(s.a)(t)}},$s=Object(u.connect)(function(e){return{topHeroDomain:Object(W.c)(e),shouldShowHeroCard:Object(W.i)(e),rankedConversationProvenances:C(e)}})(function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return M(n,t),n.prototype.render=function(){var t=this.getShownDomains(),n=B({shownDomains:t},this.props);return i.createElement(e,B({},n))},n.prototype.getShownDomains=function(){var e=this.filterConflictedDomains();return this.getEnabledAsyncDomains().forEach(function(t){Object(F.a)(e,function(e){return t===e})||e.push(t)}),Object(D.a)(e,"Turing")||e.push("Turing"),this.sortDomains(e)},n.prototype.getEnabledAsyncDomains=function(){var e=this.props,t=e.domainsFilter,n=e.areConnectorsEnabled,r=e.variantEnabledAsyncDomains,a=Object(L.a)(t)?r:Object(R.a)(r,function(e){return Object(F.a)(t,function(t){return e===Object(H.b)(t)})});return n&&a.push("Connectors"),a},n.prototype.sortDomains=function(e){var t=this.props.heroDomain;return Object(O.a)(e,function(e){return e===t||"External"===t&&"Connectors"===e?-1:Object(A.d)(e)?1:0})},n.prototype.filterConflictedDomains=function(){var e=this.props,t=e.allResultDomains,n=e.heroDomain;return Object(R.a)(t,function(e){return"Calendar"===e?"Calendar"===n:"Person"!==e||"Calendar"!==n})||[]},n}(i.Component);return Object(u.connect)(z)(t)}(function(e){var t,n=e.topHeroDomain,a=e.shouldShowHeroCard,c=e.shownDomains,d=e.rankedConversationProvenances,m=e.entityOverride,p=e.query,h=Object(l.d)()&&m?Object(he.j)(m):n,g=Object(E.a)(),b=Object(l.f)(),y=Object(u.useSelector)(x.w),O=Object(l.h)(),j=Object(u.useSelector)(f.g),S=v(),C=O.externalLinkDefaultTarget;return function(e){var t=this,n=Object(u.useDispatch)(),r=Object(ae.a)(),a=r.searchOptions,o=se(e),c=Object(u.useSelector)(f.g),l=Object(u.useSelector)(x.z),s=a.useSubstrateUnifiedSearch,d=a.getVerticalConfig,m=a.isTuringMarkerEnabled,p=function(){return ue(t,void 0,void 0,function(){var i,o,c;return de(this,function(l){switch(l.label){case 0:return e?s?[4,Object(ie.a)(d)]:[3,3]:[3,5];case 1:return i=l.sent(),o=Object(ie.b)(i,!0),c=Object(le.c)(e,a,void 0,void 0,o),[4,n(Object(oe.c)(r,c,o,m))];case 2:return l.sent(),[3,5];case 3:return c=Object(le.b)(e,a),[4,n(Object(oe.b)(r,c))];case 4:l.sent(),l.label=5;case 5:return[4,ue(t,void 0,void 0,function(){return de(this,function(t){switch(t.label){case 0:return[4,n(Object(ce.h)({query:e}))];case 1:return t.sent(),[2]}})})];case 6:return l.sent(),[2]}})})};i.useEffect(function(){e!==o&&e!==c&&!l&&oe.b&&oe.c&&p()},[e,o,c,l,p,a])}(p),X(),t=re(void 0),i.useEffect(function(){return window.addEventListener("beforeunload",t),function(){t(),window.removeEventListener("beforeunload",t)}},[]),i.useEffect(function(){Object(r.a)(c)||Object(me.d)(g,c,d)},[g,c,d]),i.useEffect(function(){h&&pe(g,h)},[g,h]),i.useEffect(function(){if(y&&h&&!function(e,t){if(!t)return!1;switch(e){case"Bookmark":return!!t.bookmarkTriggerControl;case"Calendar":return!!t.calendarTriggerControl;case"Flight":return!!t.flightTriggerControl;case"File":return!!t.fileTriggerControl;case"Link":return!!t.linkTriggerControl;case"Acronym":return!!t.acronymTriggerControl;case"Person":return!!t.personTriggerControl;case"TuringQnA":case"PeopleAlsoAsk":case"MeetingRoomProposal":case"Qna":case"FloorPlan":case"Building":case"Group":case"Calendar":case"FileEntity":case"Conversation":case"Message":case"Site":case"PowerBi":case"CalendarAvailability":case"Notification":case"Turing":case"Topic":case"Connectors":case"External":case"EmployeeOffer":case"SharePoint":case"EducationAssignment":case"EducationClass":case"QueryReformulation":case"EnterpriseLearning":return!1;default:return Object(s.a)(e)}}(h,O.additionalAnswerConfigs)){var e=new Date;p!==j&&Object(w.c)(g,"Rendering previous experience for new query",b&&(e.getTime()-b.getTime()).toString()),b&&(!function(e,t,n,r,a){if(n&&r){var i=a&&Object(G.b)(a),o={name:"PageLoadTime",value:(r.getTime()-n.getTime()).toString(),eventScope:i};Object(Q.C)(e,{eventId:t,properties:o})}}(g,"FullPageLoadTime",b,e,h),Object(Y.e)({logger:g,domain:h,impressionEventId:"Answer_Impression",traceId:S,startTime:b,endTime:e}))}},[b,g,y,h]),h?i.createElement(N,{codeLocation:"HeroCardRouterContainer.Owa."+h},i.createElement(o.Provider,{value:C},a&&i.createElement(Gs,{domain:h}))):null}))}}]);